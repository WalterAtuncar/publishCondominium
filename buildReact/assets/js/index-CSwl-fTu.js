const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/commonAreaSchedule.service-BPiBg1Sw.js","assets/js/vendor-ui-BTwQ5mwh.js","assets/js/vendor-react-oDTAMDcs.js","assets/js/vendor-data-DpfMPUjR.js","assets/js/vendor-utils-20T_BUbV.js"])))=>i.map(i=>d[i]);
var __defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__getProtoOf=Object.getPrototypeOf,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__reflectGet=Reflect.get,__defNormalProp=(e,t,a)=>t in e?__defProp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,__spreadValues=(e,t)=>{for(var a in t||(t={}))__hasOwnProp.call(t,a)&&__defNormalProp(e,a,t[a]);if(__getOwnPropSymbols)for(var a of __getOwnPropSymbols(t))__propIsEnum.call(t,a)&&__defNormalProp(e,a,t[a]);return e},__spreadProps=(e,t)=>__defProps(e,__getOwnPropDescs(t)),__objRest=(e,t)=>{var a={};for(var r in e)__hasOwnProp.call(e,r)&&t.indexOf(r)<0&&(a[r]=e[r]);if(null!=e&&__getOwnPropSymbols)for(var r of __getOwnPropSymbols(e))t.indexOf(r)<0&&__propIsEnum.call(e,r)&&(a[r]=e[r]);return a},__publicField=(e,t,a)=>__defNormalProp(e,"symbol"!=typeof t?t+"":t,a),__superGet=(e,t,a)=>__reflectGet(__getProtoOf(e),a,t),__async=(e,t,a)=>new Promise((r,s)=>{var n=e=>{try{o(a.next(e))}catch(t){s(t)}},i=e=>{try{o(a.throw(e))}catch(t){s(t)}},o=e=>e.done?r(e.value):Promise.resolve(e.value).then(n,i);o((a=a.apply(e,t)).next())}),createRoot;import{j as jsxRuntimeExports,R as Rodal,A as AnimatePresence,m as motion,X as X$1,I as Info,H as HelpCircle,a as AlertTriangle,b as AlertCircle,C as CheckCircle,c as Clock,d as CalendarRange,e as Calendar,f as Camera,U as UploadCloud,B as Building,g as User,M as Mail,P as Phone,h as MapPin,i as Users,F as FileText,k as Briefcase,l as UserCheck,L as Lock,E as EyeOff,n as Eye,S as Save,o as Menu,p as Bell,q as LogOut,r as Home,D as DollarSign,s as BarChart3,T as TrendingDown,t as TrendingUp,u as Activity,v as ClipboardList,w as Timer,x as Shield,W as Wrench,y as XCircle,z as Star,G as Archive,J as Package,K as MessageSquare,N as ChevronsLeft,O as ChevronLeft,Q as ChevronRight,V as ChevronsRight,Y as ChevronUp,Z as ChevronDown,_ as ArrowUpDown,$ as Plus,a0 as Minus,a1 as Building2,a2 as Receipt,a3 as Filter,a4 as Search,a5 as SquarePen,a6 as Trash2,a7 as AlignLeft,a8 as Hash,a9 as DoorOpen,aa as Download,ab as Upload,ac as Box,ad as Ruler,ae as Bed,af as Bath,ag as Percent,ah as Dog,ai as Dumbbell,aj as ScrollText,ak as Scroll,al as DoorClosed,am as ArrowLeft,an as File,ao as Database,ap as PlusCircle,aq as Pencil,ar as Tag,as as Calculator,at as ArrowRight,au as CreditCard,av as Check,aw as Send,ax as RefreshCw,ay as Settings,az as Copy,aA as Pen,aB as RotateCcw,aC as ExternalLink,aD as Unlock,aE as Palette,aF as Loader2,aG as Brain,aH as Zap,aI as Image$1,aJ as LayoutDashboard,aK as List,aL as BookOpen,aM as CalendarDays,aN as UserPlus,aO as Clipboard,aP as Bug,aQ as Hammer,aR as UserCog,aS as Cog}from"./vendor-ui-BTwQ5mwh.js";import{a as reactDomExports,r as reactExports,b as ReactDOM,u as useNavigate,c as useParams,d as useLocation,O as Outlet,B as BrowserRouter,e as Routes,f as Route,N as Navigate}from"./vendor-react-oDTAMDcs.js";import{a5 as axios,a6 as buildFormatLongFn,a7 as buildLocalizeFn,a8 as buildMatchFn,a9 as buildMatchPatternFn,o as parse,j as isValid,a as isAfter,J as format,aa as useReactTable,ab as flexRender,ac as getPaginationRowModel,ad as getSortedRowModel,ae as getCoreRowModel}from"./vendor-data-DpfMPUjR.js";import{r as registerLocale,D as DatePicker,$ as $5cff71254109409f$export$e21573137ccb7f5d,a as readSync,u as utils}from"./vendor-utils-20T_BUbV.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var m$3=reactDomExports;createRoot=m$3.createRoot,m$3.hydrateRoot;const scriptRel="modulepreload",assetsURL=function(e){return"/"+e},seen={},__vitePreload=function(e,t,a){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),a=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));r=Promise.allSettled(t.map(e=>{if((e=assetsURL(e))in seen)return;seen[e]=!0;const t=e.endsWith(".css"),r=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${r}`))return;const s=document.createElement("link");return s.rel=t?"stylesheet":scriptRel,t||(s.as="script"),s.crossOrigin="",s.href=e,a&&s.setAttribute("nonce",a),document.head.appendChild(s),t?new Promise((t,a)=>{s.addEventListener("load",t),s.addEventListener("error",()=>a(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function s(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(const e of t||[])"rejected"===e.status&&s(e.reason);return e().catch(s)})},environment={apiUrl:"http://102.37.130.239:5000/api"},_ApiBaseService=class e{constructor(e=""){__publicField(this,"axiosInstance"),__publicField(this,"baseEndpoint"),this.baseEndpoint=e,this.axiosInstance=this.createAxiosInstance(),this.setupInterceptors()}static setLoadingManager(t){e.loadingManager=t}createAxiosInstance(){return axios.create({baseURL:environment.apiUrl,timeout:3e4,headers:{"Content-Type":"application/json",Accept:"application/json"}})}requiresAuthentication(e){return!["/auth","/health","/swagger"].some(t=>e.toLowerCase().includes(t.toLowerCase()))}setupInterceptors(){this.axiosInstance.interceptors.request.use(t=>{e.loadingManager&&e.loadingManager.incrementLoading();const a=localStorage.getItem("authToken");return a&&t.url&&this.requiresAuthentication(t.url)&&t.headers&&(t.headers.Authorization=`Bearer ${a}`),t},t=>(e.loadingManager&&e.loadingManager.decrementLoading(),Promise.reject(t))),this.axiosInstance.interceptors.response.use(t=>(e.loadingManager&&e.loadingManager.decrementLoading(),t),t=>{var a;return e.loadingManager&&e.loadingManager.decrementLoading(),401===(null==(a=t.response)?void 0:a.status)&&(localStorage.removeItem("authToken"),window.location.href="/login"),Promise.reject(t)})}buildUrl(e=""){const t=this.baseEndpoint.startsWith("/")?this.baseEndpoint.slice(1):this.baseEndpoint,a=e.startsWith("/")?e.slice(1):e;return t&&a?`/${t}/${a}`:t?`/${t}`:a?`/${a}`:""}handleResponse(e){const t=e.data;return t&&"object"==typeof t&&"statusCode"in t&&"isSuccess"in t&&"data"in t?{statusCode:t.statusCode,data:t.data,error:t.error||null,isSuccess:t.isSuccess}:{statusCode:e.status,data:e.data,error:null,isSuccess:e.status>=200&&e.status<300}}handleError(e){var t;return e.response?{statusCode:e.response.status,data:null,error:(null==(t=e.response.data)?void 0:t.message)||e.response.statusText||"Error del servidor",isSuccess:!1}:e.request?{statusCode:0,data:null,error:"Error de conexión. Verifique su conexión a internet.",isSuccess:!1}:{statusCode:0,data:null,error:e.message||"Error inesperado",isSuccess:!1}}get(e="",t){return __async(this,null,function*(){try{const a=this.buildUrl(e),r={};t&&(r.params=t);const s=yield this.axiosInstance.get(a,r);return this.handleResponse(s)}catch(a){return this.handleError(a)}})}post(e="",t){return __async(this,null,function*(){try{const a=this.buildUrl(e),r=yield this.axiosInstance.post(a,t);return this.handleResponse(r)}catch(a){return this.handleError(a)}})}put(e="",t){return __async(this,null,function*(){try{const a=this.buildUrl(e),r=yield this.axiosInstance.put(a,t);return this.handleResponse(r)}catch(a){return this.handleError(a)}})}patch(e="",t){return __async(this,null,function*(){try{const a=this.buildUrl(e),r=yield this.axiosInstance.patch(a,t);return this.handleResponse(r)}catch(a){return this.handleError(a)}})}delete(e=""){return __async(this,null,function*(){try{const t=this.buildUrl(e),a=yield this.axiosInstance.delete(t);return this.handleResponse(a)}catch(t){return this.handleError(t)}})}getPaged(e="",t){return __async(this,null,function*(){try{const a=this.buildUrl(e),r={};t&&(r.params=t);const s=yield this.axiosInstance.get(a,r);return this.handleResponse(s)}catch(a){return this.handleError(a)}})}getById(e,t=""){return __async(this,null,function*(){const a=t?`${t}/${e}`:`${e}`;return this.get(a)})}updateById(e,t,a=""){return __async(this,null,function*(){const r=a?`${a}/${e}`:`${e}`;return this.put(r,t)})}deleteById(e,t=""){return __async(this,null,function*(){const a=t?`${t}/${e}`:`${e}`;return this.delete(a)})}customRequest(e){return __async(this,null,function*(){try{const t=yield this.axiosInstance.request(e);return this.handleResponse(t)}catch(t){return this.handleError(t)}})}};__publicField(_ApiBaseService,"loadingManager",null);let ApiBaseService=_ApiBaseService;const BRANDING_COOKIE_NAME="habitad-branding",BRANDING_LOGOS_KEY="habitad-branding-logos",COOKIE_EXPIRY_DAYS=30,CACHE_VERSION="1.0",BrandingCache={saveBrandingData:e=>{try{const t=JSON.stringify(e),a=new Date;return a.setDate(a.getDate()+COOKIE_EXPIRY_DAYS),t.length>3500?!1:(document.cookie=`${BRANDING_COOKIE_NAME}=${encodeURIComponent(t)}; expires=${a.toUTCString()}; path=/; SameSite=Strict`,!0)}catch(t){return!1}},getBrandingData:()=>{var e;try{const t=null==(e=document.cookie.split("; ").find(e=>e.startsWith(`${BRANDING_COOKIE_NAME}=`)))?void 0:e.split("=")[1];if(!t)return null;const a=decodeURIComponent(t);return JSON.parse(a)}catch(t){return BrandingCache.clearBrandingCookie(),null}},saveBrandingLogos:e=>{try{const t=`${BRANDING_LOGOS_KEY}-${e.companyId}`,a=JSON.stringify(e);return localStorage.setItem(t,a),!0}catch(t){if(!(t instanceof Error&&"QuotaExceededError"===t.name))return!1;BrandingCache.cleanupOldLogos();try{const t=`${BRANDING_LOGOS_KEY}-${e.companyId}`;return localStorage.setItem(t,JSON.stringify(e)),!0}catch(a){return!1}}},getBrandingLogos:e=>{try{const t=`${BRANDING_LOGOS_KEY}-${e}`,a=localStorage.getItem(t);if(!a)return null;return JSON.parse(a)}catch(t){const a=`${BRANDING_LOGOS_KEY}-${e}`;return localStorage.removeItem(a),null}},clearBrandingCookie:()=>{document.cookie=`${BRANDING_COOKIE_NAME}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`},clearBrandingLogos:e=>{if(e){const t=`${BRANDING_LOGOS_KEY}-${e}`;localStorage.removeItem(t)}else Object.keys(localStorage).filter(e=>e.startsWith(BRANDING_LOGOS_KEY)).forEach(e=>localStorage.removeItem(e))},clearAllBrandingCache:()=>{BrandingCache.clearBrandingCookie(),BrandingCache.clearBrandingLogos()},cleanupOldLogos:()=>{try{const e=new Date,t=Object.keys(localStorage).filter(e=>e.startsWith(BRANDING_LOGOS_KEY));let a=0;t.forEach(t=>{try{const r=localStorage.getItem(t);if(r){const s=JSON.parse(r),n=new Date(s.lastUpdated);(e.getTime()-n.getTime())/864e5>30&&(localStorage.removeItem(t),a++)}}catch(r){localStorage.removeItem(t),a++}})}catch(e){}},isCacheValid:e=>{try{const t=new Date,a=new Date(e.lastUpdated),r=(t.getTime()-a.getTime())/36e5<24,s=e.version===CACHE_VERSION;return r&&s}catch(t){return!1}},getCacheStats:()=>{const e=BrandingCache.getBrandingData(),t=Object.keys(localStorage).filter(e=>e.startsWith(BRANDING_LOGOS_KEY));let a=0;return t.forEach(e=>{const t=localStorage.getItem(e);t&&(a+=t.length)}),{hasCookie:!!e,cookieSize:e?JSON.stringify(e).length:void 0,logosCount:t.length,totalLogosSize:Math.round(a/1024),lastUpdated:null==e?void 0:e.lastUpdated}}},brandingCache=Object.freeze(Object.defineProperty({__proto__:null,BrandingCache:BrandingCache},Symbol.toStringTag,{value:"Module"}));class BrandingConfigService extends ApiBaseService{constructor(){super("/BrandingConfig")}getBrandingConfigByCompany(e){return __async(this,null,function*(){return this.get(`company/${e}`)})}getColorsJSFormat(e){return __async(this,null,function*(){return this.get(`company/${e}/colors-js`)})}create(e){return __async(this,null,function*(){return this.post("",e)})}update(e,t){return __async(this,null,function*(){const a=__spreadProps(__spreadValues({},t),{id:e});return this.put(`/${e}`,a)})}createWithDefaults(e,t){return __async(this,null,function*(){const a={companyId:e,brandName:t,primaryMain:"#047857",primaryAdmin:"#629E3E",primaryLight:"#10b981",primaryMint:"#ecfdf5",primarySage:"#CCDAA0",navyMain:"#1a2234",navyHeader:"#1a2234",navyDark:"#283249",secondaryMain:"#CCDAA0",stateSuccessMain:"#10b981",stateWarningMain:"#f59e0b",stateErrorMain:"#ef4444",stateInfoMain:"#3b82f6",actionViewMain:"#629E3E",actionEditMain:"#D97706",actionDeleteMain:"#DC2626",actionCreateMain:"#047857",actionCancelMain:"#6B7280",surfaceSidebar:"#ecfdf5",surfaceModal:"#ECFDF5",surfaceContent:"#ecfdf5",surfaceCard:"#ffffff",surfaceInput:"#ffffff",borderLight:"#e5e7eb",borderMedium:"#d1d5db",borderDark:"#9ca3af",borderPrimary:"#629E3E",borderAccent:"#047857",textPrimary:"#111827",textSecondary:"#6b7280",textMuted:"#9ca3af",textInverse:"#ffffff",textAccent:"#047857",textLink:"#2563eb"};return this.create(a)})}updateColors(e,t){return __async(this,null,function*(){const a=__spreadValues({id:e},t);return this.update(e,a)})}updateLogos(e,t,a){return __async(this,null,function*(){const r={id:e,logoPrimary:t,logoSecondary:a};return this.update(e,r)})}hasActiveBrandingConfig(e){return __async(this,null,function*(){try{const t=yield this.getBrandingConfigByCompany(e);return t.isSuccess&&null!==t.data}catch(t){return!1}})}getOrCreateBrandingConfig(e,t="Configuración Por Defecto"){return __async(this,null,function*(){const a=yield this.getBrandingConfigByCompany(e);if(a.isSuccess&&a.data)return a;const r=yield this.createWithDefaults(e,t);return r.isSuccess?this.getBrandingConfigByCompany(e):{statusCode:r.statusCode,data:null,error:r.error,isSuccess:!1}})}convertToColorsFormat(e){return{primary:{main:e.primaryMain,admin:e.primaryAdmin,light:e.primaryLight,mint:e.primaryMint,sage:e.primarySage},navy:{main:e.navyMain,header:e.navyHeader,dark:e.navyDark},secondary:{main:e.secondaryMain},states:{success:{main:e.stateSuccessMain},warning:{main:e.stateWarningMain},error:{main:e.stateErrorMain},info:{main:e.stateInfoMain}},actions:{view:{main:e.actionViewMain},edit:{main:e.actionEditMain},delete:{main:e.actionDeleteMain},create:{main:e.actionCreateMain},cancel:{main:e.actionCancelMain}},surfaces:{sidebar:e.surfaceSidebar,modal:e.surfaceModal,content:e.surfaceContent,card:e.surfaceCard,input:e.surfaceInput},borders:{light:e.borderLight,medium:e.borderMedium,dark:e.borderDark,primary:e.borderPrimary,accent:e.borderAccent},text:{primary:e.textPrimary,secondary:e.textSecondary,muted:e.textMuted,inverse:e.textInverse,accent:e.textAccent,link:e.textLink},logos:{primary:e.logoPrimary,secondary:e.logoSecondary}}}getBrandingFromCache(e){try{const t=BrandingCache.getBrandingData();if(!t||t.companyId!==e||!BrandingCache.isCacheValid(t))return null;const a=BrandingCache.getBrandingLogos(e);return{colors:{primary:{main:t.colors.primaryMain,admin:t.colors.primaryAdmin,light:t.colors.primaryLight,mint:t.colors.primaryMint,sage:t.colors.primarySage},navy:{main:t.colors.navyMain,header:t.colors.navyHeader,dark:t.colors.navyDark},secondary:{main:t.colors.secondaryMain},states:{success:{main:t.colors.stateSuccessMain},warning:{main:t.colors.stateWarningMain},error:{main:t.colors.stateErrorMain},info:{main:t.colors.stateInfoMain}},actions:{view:{main:t.colors.actionViewMain},edit:{main:t.colors.actionEditMain},delete:{main:t.colors.actionDeleteMain},create:{main:t.colors.actionCreateMain},cancel:{main:t.colors.actionCancelMain}},surfaces:{sidebar:t.colors.surfaceSidebar,modal:t.colors.surfaceModal,content:t.colors.surfaceContent,card:t.colors.surfaceCard,input:t.colors.surfaceInput},borders:{light:t.colors.borderLight,medium:t.colors.borderMedium,dark:t.colors.borderDark,primary:t.colors.borderPrimary,accent:t.colors.borderAccent},text:{primary:t.colors.textPrimary,secondary:t.colors.textSecondary,muted:t.colors.textMuted,inverse:t.colors.textInverse,accent:t.colors.textAccent,link:t.colors.textLink},logos:{primary:(null==a?void 0:a.logoPrimary)||null,secondary:(null==a?void 0:a.logoSecondary)||null}},logos:a}}catch(t){return null}}saveBrandingToCache(e){try{const t=(new Date).toISOString(),a="1.0",r={companyId:e.companyId,brandName:e.brandName,version:a,lastUpdated:t,colors:{primaryMain:e.primaryMain,primaryAdmin:e.primaryAdmin,primaryLight:e.primaryLight,primaryMint:e.primaryMint,primarySage:e.primarySage,navyMain:e.navyMain,navyHeader:e.navyHeader,navyDark:e.navyDark,secondaryMain:e.secondaryMain,stateSuccessMain:e.stateSuccessMain,stateWarningMain:e.stateWarningMain,stateErrorMain:e.stateErrorMain,stateInfoMain:e.stateInfoMain,actionViewMain:e.actionViewMain,actionEditMain:e.actionEditMain,actionDeleteMain:e.actionDeleteMain,actionCreateMain:e.actionCreateMain,actionCancelMain:e.actionCancelMain,surfaceSidebar:e.surfaceSidebar,surfaceModal:e.surfaceModal,surfaceContent:e.surfaceContent,surfaceCard:e.surfaceCard,surfaceInput:e.surfaceInput,borderLight:e.borderLight,borderMedium:e.borderMedium,borderDark:e.borderDark,borderPrimary:e.borderPrimary,borderAccent:e.borderAccent,textPrimary:e.textPrimary,textSecondary:e.textSecondary,textMuted:e.textMuted,textInverse:e.textInverse,textAccent:e.textAccent,textLink:e.textLink}},s=BrandingCache.saveBrandingData(r);let n=!0;if(e.logoPrimary||e.logoSecondary){const r={companyId:e.companyId,logoPrimary:e.logoPrimary,logoSecondary:e.logoSecondary,version:a,lastUpdated:t};n=BrandingCache.saveBrandingLogos(r)}return s&&n}catch(t){return!1}}getBrandingWithCache(e){return __async(this,null,function*(){try{const t=this.getBrandingFromCache(e);if(t)return{statusCode:200,data:t.colors,error:null,isSuccess:!0};const a=yield this.getBrandingConfigByCompany(e);if(a.isSuccess&&a.data){this.saveBrandingToCache(a.data);return{statusCode:200,data:this.convertToColorsFormat(a.data),error:null,isSuccess:!0}}return{statusCode:a.statusCode,data:null,error:a.error,isSuccess:!1}}catch(t){return{statusCode:500,data:null,error:t instanceof Error?t.message:"Error desconocido",isSuccess:!1}}})}clearBrandingCache(e){if(e){const t=BrandingCache.getBrandingData();t&&t.companyId===e&&BrandingCache.clearBrandingCookie(),BrandingCache.clearBrandingLogos(e)}else BrandingCache.clearAllBrandingCache()}getCacheStats(){return BrandingCache.getCacheStats()}}const THEME_COLORS$1={primary:{main:"#047857",admin:"#629E3E",light:"#10b981",mint:"#ecfdf5",sage:"#CCDAA0"},navy:{main:"#1a2234",header:"#1a2234",dark:"#283249"},secondary:{300:"#CCDAA0",main:"#CCDAA0"},states:{success:{main:"#10b981"},warning:{main:"#f59e0b"},error:{main:"#ef4444"},info:{main:"#3b82f6"}},actions:{view:{main:"#629E3E"},edit:{main:"#D97706"},delete:{main:"#DC2626"},create:{main:"#047857"},cancel:{main:"#6B7280"}},surfaces:{sidebar:"#ecfdf5",modal:"#ECFDF5",card:"#ffffff",input:"#ffffff"},borders:{light:"#e5e7eb",medium:"#d1d5db",dark:"#9ca3af",primary:"#629E3E",accent:"#047857"},text:{primary:"#111827",secondary:"#6b7280",muted:"#9ca3af",inverse:"#ffffff",accent:"#047857",link:"#2563eb"}},applyDynamicColors=e=>{try{const t=document.documentElement;t.style.setProperty("--color-primary-main",e.primary.main),t.style.setProperty("--color-primary-admin",e.primary.admin),t.style.setProperty("--color-primary-light",e.primary.light),t.style.setProperty("--color-primary-mint",e.primary.mint),t.style.setProperty("--color-primary-sage",e.primary.sage),t.style.setProperty("--color-navy-main",e.navy.main),t.style.setProperty("--color-navy-header",e.navy.header),t.style.setProperty("--color-navy-dark",e.navy.dark),t.style.setProperty("--color-secondary-main",e.secondary.main),t.style.setProperty("--color-success-main",e.states.success.main),t.style.setProperty("--color-warning-main",e.states.warning.main),t.style.setProperty("--color-error-main",e.states.error.main),t.style.setProperty("--color-info-main",e.states.info.main),t.style.setProperty("--color-action-view",e.actions.view.main),t.style.setProperty("--color-action-edit",e.actions.edit.main),t.style.setProperty("--color-action-delete",e.actions.delete.main),t.style.setProperty("--color-action-create",e.actions.create.main),t.style.setProperty("--color-action-cancel",e.actions.cancel.main),t.style.setProperty("--color-surface-sidebar",e.surfaces.sidebar),t.style.setProperty("--color-surface-modal",e.surfaces.modal),t.style.setProperty("--color-surface-content",e.surfaces.content),t.style.setProperty("--color-surface-card",e.surfaces.card),t.style.setProperty("--color-surface-input",e.surfaces.input),t.style.setProperty("--color-border-light",e.borders.light),t.style.setProperty("--color-border-medium",e.borders.medium),t.style.setProperty("--color-border-dark",e.borders.dark),t.style.setProperty("--color-border-primary",e.borders.primary),t.style.setProperty("--color-border-accent",e.borders.accent),t.style.setProperty("--color-text-primary",e.text.primary),t.style.setProperty("--color-text-secondary",e.text.secondary),t.style.setProperty("--color-text-muted",e.text.muted),t.style.setProperty("--color-text-inverse",e.text.inverse),t.style.setProperty("--color-text-accent",e.text.accent),t.style.setProperty("--color-text-link",e.text.link),e.logos.primary&&t.style.setProperty("--logo-primary",`url('${e.logos.primary}')`),e.logos.secondary&&t.style.setProperty("--logo-secondary",`url('${e.logos.secondary}')`)}catch(t){}},applyDefaultColors=()=>{const e={primary:{main:THEME_COLORS$1.primary.main,admin:THEME_COLORS$1.primary.admin,light:THEME_COLORS$1.primary.light,mint:THEME_COLORS$1.primary.mint,sage:THEME_COLORS$1.primary.sage},navy:{main:THEME_COLORS$1.navy.main,header:THEME_COLORS$1.navy.header,dark:THEME_COLORS$1.navy.dark},secondary:{main:THEME_COLORS$1.secondary[300]},states:{success:{main:THEME_COLORS$1.states.success.main},warning:{main:THEME_COLORS$1.states.warning.main},error:{main:THEME_COLORS$1.states.error.main},info:{main:THEME_COLORS$1.states.info.main}},actions:{view:{main:THEME_COLORS$1.actions.view.main},edit:{main:THEME_COLORS$1.actions.edit.main},delete:{main:THEME_COLORS$1.actions.delete.main},create:{main:THEME_COLORS$1.actions.create.main},cancel:{main:THEME_COLORS$1.actions.cancel.main}},surfaces:{sidebar:THEME_COLORS$1.surfaces.sidebar,modal:THEME_COLORS$1.surfaces.modal,content:THEME_COLORS$1.surfaces.content,card:THEME_COLORS$1.surfaces.card,input:THEME_COLORS$1.surfaces.input},borders:{light:THEME_COLORS$1.borders.light,medium:THEME_COLORS$1.borders.medium,dark:THEME_COLORS$1.borders.dark,primary:THEME_COLORS$1.borders.primary,accent:THEME_COLORS$1.borders.accent},text:{primary:THEME_COLORS$1.text.primary,secondary:THEME_COLORS$1.text.secondary,muted:THEME_COLORS$1.text.muted,inverse:THEME_COLORS$1.text.inverse,accent:THEME_COLORS$1.text.accent,link:THEME_COLORS$1.text.link},logos:{primary:null,secondary:null}};applyDynamicColors(e)},dynamicColors=Object.freeze(Object.defineProperty({__proto__:null,applyDefaultColors:applyDefaultColors,applyDynamicColors:applyDynamicColors},Symbol.toStringTag,{value:"Module"})),BrandingContext=reactExports.createContext(void 0),useBranding=()=>{const e=reactExports.useContext(BrandingContext);if(void 0===e)throw new Error("useBranding must be used within a BrandingProvider");return e},BrandingProvider=({children:e})=>{const[t,a]=reactExports.useState(null),[r,s]=reactExports.useState(!0),[n,i]=reactExports.useState(!1),[o,l]=reactExports.useState(null),[c,d]=reactExports.useState(!1),[u,m]=reactExports.useState(null),[p,x]=reactExports.useState(!1),[h,g]=reactExports.useState(0),y=reactExports.useMemo(()=>new BrandingConfigService,[]),v=reactExports.useCallback(e=>{a(e),applyDynamicColors(e),n||i(!0)},[n]),E=reactExports.useCallback(e=>__async(void 0,null,function*(){try{let t=e;if(!t){const e=localStorage.getItem("userData");if(e){const a=JSON.parse(e);t=null==a?void 0:a.companyId}}if(t){const e=y.getBrandingFromCache(t);if(e)return void v(e.colors)}applyDefaultColors(),i(!0)}catch(t){applyDefaultColors(),i(!0)}}),[y,v]),f=reactExports.useCallback(()=>__async(void 0,null,function*(){if(!c)try{s(!0),l(null);const{BrandingCache:e}=yield __vitePreload(()=>__async(void 0,null,function*(){const{BrandingCache:e}=yield Promise.resolve().then(()=>brandingCache);return{BrandingCache:e}}),void 0),t=e.getBrandingData();if(t&&e.isCacheValid(t)){const e=y.getBrandingFromCache(t.companyId);if(e)return v(e.colors),void d(!0)}applyDefaultColors(),i(!0),d(!0)}catch(e){l(e instanceof Error?e.message:"Error cargando cache"),applyDefaultColors(),i(!0),d(!0)}finally{s(!1)}}),[y,v,c]),b=reactExports.useCallback(e=>__async(void 0,null,function*(){try{s(!0),l(null);const a=yield y.getBrandingWithCache(e);a.isSuccess&&a.data?v(a.data):t||(applyDefaultColors(),i(!0))}catch(a){l(a instanceof Error?a.message:"Error cargando branding")}finally{s(!1)}}),[y,v,t]),j=reactExports.useCallback(()=>{a(null),applyDefaultColors(),i(!0)},[]),R=reactExports.useCallback(()=>{l(null)},[]),I=reactExports.useCallback(()=>y.getCacheStats(),[y]),S=reactExports.useCallback(e=>{if(p&&u){if("primary"===e&&u.primary)return u.primary;if("secondary"===e&&u.secondary)return u.secondary}try{let t=null;const a=localStorage.getItem("userData");if(a){const e=JSON.parse(a);t=null==e?void 0:e.companyId}t||(t=1);const r=`habitad-branding-logos-${t}`,s=localStorage.getItem(r);if(s){const t=JSON.parse(s);if("primary"===e&&t.logoPrimary&&""!==t.logoPrimary.trim())return t.logoPrimary;if("secondary"===e&&t.logoSecondary&&""!==t.logoSecondary.trim())return t.logoSecondary}}catch(t){}return"primary"===e?"/logo/logohabitad011.png":"/logo/logohabitad021.png"},[p,u,h]),_=reactExports.useCallback(()=>{g(e=>e+1)},[]);reactExports.useEffect(()=>{c||f()},[f,c]);const N=reactExports.useMemo(()=>({colors:t,isLoading:r,isReady:n,error:o,loadBrandingFromCache:f,loadBrandingByCompany:b,applyColors:v,resetToDefaults:j,clearError:R,getCacheStats:I,previewLogos:u,isPreviewMode:p,setPreviewLogos:m,setIsPreviewMode:x,getLogoSrc:S,refreshLogos:_,forceApplyFromCache:E}),[t,r,n,o,f,b,v,j,R,I,u,p,S,_,E]);return jsxRuntimeExports.jsx(BrandingContext.Provider,{value:N,children:e})},BrandingLoading=({children:e})=>{const{isLoading:t,isReady:a}=useBranding();return t||!a?jsxRuntimeExports.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"animate-spin w-12 h-12 border-4 border-green-600 border-t-transparent rounded-full mx-auto mb-4"}),jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold text-gray-700",children:"Cargando Branding..."}),jsxRuntimeExports.jsx("p",{className:"text-gray-500 mt-2",children:t?"Aplicando colores corporativos...":"Preparando interfaz..."})]})}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:e})};class AuthService extends ApiBaseService{constructor(){super("/Auth"),__publicField(this,"brandingService"),this.brandingService=new BrandingConfigService}login(e){return __async(this,null,function*(){const t=yield this.post("login",e);let a=null;if(t.isSuccess&&t.data){const e=t.data;if(e.data&&e.data.token)a=e.data;else{const e=t.data;e.id&&e.token&&(a=e)}a&&a.token&&(localStorage.setItem("authToken",a.token),this.setUser(a),yield this.forceUpdateBrandingOnLogin(a))}return{statusCode:t.statusCode,data:a?{success:!0,data:a}:null,error:t.error||(a?void 0:"No se recibieron datos de usuario válidos"),isSuccess:t.isSuccess&&!!a}})}forceUpdateBrandingOnLogin(e){return __async(this,null,function*(){try{if(!e.companyId)return;const t=this.brandingService.getBrandingFromCache(e.companyId);if(t){const{applyDynamicColors:e}=yield __vitePreload(()=>__async(this,null,function*(){const{applyDynamicColors:e}=yield Promise.resolve().then(()=>dynamicColors);return{applyDynamicColors:e}}),void 0);e(t.colors)}this.updateBrandingInBackground(e.companyId).catch(e=>{})}catch(t){}})}updateBrandingInBackground(e){return __async(this,null,function*(){try{const t=yield this.brandingService.getBrandingConfigByCompany(e);if(t.isSuccess&&t.data){const a=t.data,r=this.brandingService.getBrandingFromCache(e);let s=!0;if(r){const e=this.brandingService.convertToColorsFormat(a),t=r.colors.primary.main!==e.primary.main||r.colors.primary.admin!==e.primary.admin||r.colors.navy.main!==e.navy.main,n=r.colors.logos.primary!==a.logoPrimary||r.colors.logos.secondary!==a.logoSecondary;s=t||n}if(s){if(this.brandingService.saveBrandingToCache(a)){const{applyDynamicColors:e}=yield __vitePreload(()=>__async(this,null,function*(){const{applyDynamicColors:e}=yield Promise.resolve().then(()=>dynamicColors);return{applyDynamicColors:e}}),void 0);e(this.brandingService.convertToColorsFormat(a))}}}}catch(t){}})}health(){return __async(this,null,function*(){var e;const t=yield this.get("health");return{isSuccess:t.isSuccess,message:(null==(e=t.data)?void 0:e.status)||(t.isSuccess?"Service available":"Service unavailable")}})}logout(){localStorage.removeItem("authToken"),localStorage.removeItem("userData")}getToken(){return localStorage.getItem("authToken")}isAuthenticated(){const e=this.getToken();return null!==e&&e.length>0}getUser(){try{const e=localStorage.getItem("userData");if(e){return JSON.parse(e)}return null}catch(e){return null}}setUser(e){const t=__spreadProps(__spreadValues({},e),{token:e.token||void 0});localStorage.setItem("userData",JSON.stringify(t))}}class UserUtils{static getCurrentUser(){return this.authService.getUser()}static getUserHierarchy(){const e=this.getCurrentUser();return{company:(null==e?void 0:e.companyId)?{id:e.companyId,name:e.companyName||"Sin nombre"}:null,condo:(null==e?void 0:e.condoId)?{id:e.condoId,name:e.condoName||"Sin nombre"}:null,building:(null==e?void 0:e.buildingId)?{id:e.buildingId,name:e.buildingName||"Sin nombre"}:null}}static getUserFullName(){const e=this.getCurrentUser();if(!e)return"";return[e.firstName,e.lastName,e.secondLastName].filter(Boolean).join(" ")}static getUserLocation(){const e=this.getUserHierarchy(),t=[];return e.company&&t.push(e.company.name),e.condo&&t.push(e.condo.name),e.building&&t.push(e.building.name),t.join(" • ")}static hasBuilding(){const e=this.getCurrentUser();return!!(null==e?void 0:e.buildingId)}static getUserProfile(){const e=this.getCurrentUser(),t=(null==e?void 0:e.profileTypeId)||0;return{typeId:t,isResident:[4,6,7].includes(t),isAdmin:[1,2,3].includes(t),isStaff:[5].includes(t)}}}__publicField(UserUtils,"authService",new AuthService);const useUserData=()=>{var e,t,a;const r=UserUtils.getCurrentUser(),s=UserUtils.getUserHierarchy();return{user:r,hierarchy:s,fullName:UserUtils.getUserFullName(),location:UserUtils.getUserLocation(),profile:UserUtils.getUserProfile(),hasBuilding:UserUtils.hasBuilding(),companyName:null==(e=s.company)?void 0:e.name,condoName:null==(t=s.condo)?void 0:t.name,buildingName:null==(a=s.building)?void 0:a.name}},mockNotifications=[{id:"1",title:"Pago Recibido",message:"Su pago de mantenimiento ha sido procesado exitosamente",type:"success",read:!1,date:"2024-03-10T08:00:00Z"},{id:"2",title:"Mantenimiento Programado",message:"Mañana se realizará mantenimiento en la piscina",type:"info",read:!1,date:"2024-03-09T14:30:00Z"},{id:"3",title:"Recordatorio de Pago",message:"Su cuota de mantenimiento vence en 3 días",type:"warning",read:!0,date:"2024-03-08T10:15:00Z"}],THEME_COLORS={secondary:{main:"#CCDAA0"},states:{success:{50:"#ecfdf5",100:"#d1fae5",200:"#a7f3d0",500:"#10b981",600:"#059669",700:"#047857",main:"#10b981"},warning:{50:"#fffbeb",100:"#fef3c7",200:"#fde68a",500:"#f59e0b",600:"#d97706",700:"#b45309",main:"#f59e0b"},error:{50:"#fef2f2",100:"#fee2e2",200:"#fecaca",500:"#ef4444",600:"#dc2626",700:"#b91c1c",main:"#ef4444"},info:{50:"#eff6ff",100:"#dbeafe",200:"#bfdbfe",500:"#3b82f6",600:"#2563eb",700:"#1d4ed8",main:"#3b82f6"}},surfaces:{white:"#ffffff",gray:{50:"#f9fafb",100:"#f3f4f6",700:"#374151"}},text:{primary:"#111827"}},getStateColors=e=>{const t=THEME_COLORS.states[e];return{background:t[50],border:t[500],text:t[700],button:t[500],buttonHover:t[600],icon:t[500]}},getGridColors=()=>({header:{background:"var(--color-navy-header)",text:"var(--color-text-inverse)",hover:"var(--color-navy-dark)"},row:{even:"#ffffff",odd:"#f9fafb",hover:"#f3f4f6"},border:"#e5e7eb",icon:"var(--color-primary-light)"}),AlertContext=reactExports.createContext(void 0),AlertProvider=({children:e})=>{const[t,a]=reactExports.useState(!1),[r,s]=reactExports.useState(null),[n,i]=reactExports.useState([]),[o,l]=reactExports.useState(0),c=()=>{a(!1),(null==r?void 0:r.onCancel)&&"confirmation"===r.type&&r.onCancel()},d=e=>{"toast"===e.presentation?u(e.type,e.message,e.duration):(s(e),a(!0))},u=(e,t,a=3e3)=>{const r=o+1;l(r);const s={id:r,type:e,message:t,duration:a};i(e=>[...e,s]),setTimeout(()=>{i(e=>e.filter(e=>e.id!==r))},a)},m=e=>{const t=getStateColors("confirmation"===e?"success":e);switch(e){case"success":return jsxRuntimeExports.jsx(CheckCircle,{className:"w-8 h-8",style:{color:t.icon}});case"error":return jsxRuntimeExports.jsx(AlertCircle,{className:"w-8 h-8",style:{color:t.icon}});case"warning":return jsxRuntimeExports.jsx(AlertTriangle,{className:"w-8 h-8",style:{color:t.icon}});case"info":return jsxRuntimeExports.jsx(Info,{className:"w-8 h-8",style:{color:t.icon}});case"confirmation":return jsxRuntimeExports.jsx(HelpCircle,{className:"w-8 h-8",style:{color:t.icon}});default:return jsxRuntimeExports.jsx(Info,{className:"w-8 h-8",style:{color:getStateColors("info").icon}})}},p=e=>{const t=getStateColors("confirmation"===e?"success":e);return{background:`${t.background} border-${t.border}`,text:t.text,button:{background:t.button,hover:t.buttonHover}}};return jsxRuntimeExports.jsxs(AlertContext.Provider,{value:{showAlert:d,showToast:u,showConfirm:(e,t,a,r)=>{d({title:e,message:t,type:"confirmation",onConfirm:a,onCancel:r,presentation:"modal",confirmText:"Confirmar",cancelText:"Cancelar"})}},children:[e,jsxRuntimeExports.jsx(Rodal,{visible:t,onClose:c,width:400,height:"confirmation"===(null==r?void 0:r.type)?220:200,animation:"zoom",closeOnEsc:!0,showCloseButton:"confirmation"!==(null==r?void 0:r.type),customStyles:{borderRadius:"8px",padding:"20px",display:"flex",flexDirection:"column",justifyContent:"flex-start",overflow:"hidden",zIndex:"9999 !important"},children:r&&jsxRuntimeExports.jsxs("div",{className:"flex flex-col h-full",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start mb-4",children:[jsxRuntimeExports.jsx("div",{className:"mr-3 flex-shrink-0",children:m(r.type)}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[r.title&&jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold mb-1",style:{color:p(r.type).text},children:r.title}),jsxRuntimeExports.jsx("p",{className:"text-gray-700",children:r.message})]})]}),"confirmation"===r.type?jsxRuntimeExports.jsxs("div",{className:"flex justify-end gap-3 mt-auto",children:[jsxRuntimeExports.jsx("button",{className:"px-4 py-2 rounded border border-gray-300 text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-300",onClick:c,children:r.cancelText||"Cancelar"}),jsxRuntimeExports.jsx("button",{className:"px-4 py-2 rounded text-white focus:outline-none focus:ring-2",style:{backgroundColor:p(r.type).button.background},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=p(r.type).button.hover},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=p(r.type).button.background},onClick:()=>{a(!1),(null==r?void 0:r.onConfirm)&&r.onConfirm()},children:r.confirmText||"Confirmar"})]}):jsxRuntimeExports.jsx("div",{className:"flex justify-end mt-auto",children:jsxRuntimeExports.jsx("button",{className:"px-4 py-2 rounded text-white focus:outline-none focus:ring-2",style:{backgroundColor:p(r.type).button.background},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=p(r.type).button.hover},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=p(r.type).button.background},onClick:c,children:"Aceptar"})})]})}),jsxRuntimeExports.jsx("div",{className:"fixed top-4 right-4 flex flex-col gap-2",style:{zIndex:"9999 !important"},children:jsxRuntimeExports.jsx(AnimatePresence,{children:n.map(e=>{p(e.type);const t=getStateColors("confirmation"===e.type?"success":e.type);return jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0,x:100},animate:{opacity:1,x:0},exit:{opacity:0,x:100},transition:{duration:.3},className:"pointer-events-auto w-80 overflow-hidden rounded-lg border-l-4 shadow-md",style:{backgroundColor:t.background,borderLeftColor:t.button},children:jsxRuntimeExports.jsxs("div",{className:"p-4 flex",children:[jsxRuntimeExports.jsx("div",{className:"flex-shrink-0",children:m(e.type)}),jsxRuntimeExports.jsx("div",{className:"ml-3 w-0 flex-1",style:{color:t.text},children:jsxRuntimeExports.jsx("p",{className:"text-sm font-medium",children:e.message})}),jsxRuntimeExports.jsx("div",{className:"ml-4 flex-shrink-0 flex",children:jsxRuntimeExports.jsx("button",{className:"inline-flex focus:outline-none",style:{color:t.textSecondary||"#6B7280"},onMouseEnter:e=>{e.currentTarget.style.color=t.text},onMouseLeave:e=>{e.currentTarget.style.color=t.textSecondary||"#6B7280"},onClick:()=>i(t=>t.filter(t=>t.id!==e.id)),children:jsxRuntimeExports.jsx(X$1,{className:"h-5 w-5"})})})]})},e.id)})})})]})},useAlerts=()=>{const e=reactExports.useContext(AlertContext);if(!e)throw new Error("useAlerts debe ser usado dentro de un AlertProvider");return e},BUTTON_THEMES={primary:{borderColor:"var(--color-primary-admin)",textColor:THEME_COLORS.surfaces.white,backgroundColor:"var(--color-primary-admin)"},primaryOutline:{borderColor:"var(--color-primary-admin)",textColor:"var(--color-primary-admin)",backgroundColor:"transparent"},primaryLight:{borderColor:"var(--color-primary-admin)",backgroundColor:THEME_COLORS.surfaces.gray[50],textColor:"var(--color-primary-admin)"},edit:{borderColor:"var(--color-action-edit)",textColor:"var(--color-action-edit)",backgroundColor:"transparent"},delete:{borderColor:"var(--color-action-delete)",textColor:"var(--color-action-delete)",backgroundColor:"transparent"},view:{borderColor:"var(--color-action-view)",textColor:"var(--color-action-view)",backgroundColor:"transparent"},cancel:{borderColor:"var(--color-action-cancel)",textColor:"var(--color-action-cancel)",backgroundColor:"transparent"},info:{borderColor:"var(--color-info-main)",textColor:THEME_COLORS.surfaces.white,backgroundColor:"var(--color-info-main)"},secondary:{borderColor:THEME_COLORS.secondary.main,textColor:THEME_COLORS.text.primary,backgroundColor:THEME_COLORS.secondary.main},gridView:{borderColor:"var(--color-action-view)",textColor:"var(--color-action-view)",backgroundColor:THEME_COLORS.surfaces.white},gridEdit:{borderColor:"var(--color-action-edit)",textColor:"var(--color-action-edit)",backgroundColor:THEME_COLORS.surfaces.white},gridDelete:{borderColor:"var(--color-action-delete)",textColor:"var(--color-action-delete)",backgroundColor:THEME_COLORS.surfaces.white},gridInfo:{borderColor:"var(--color-info-main)",textColor:"var(--color-info-main)",backgroundColor:THEME_COLORS.surfaces.white},filter:{borderColor:"var(--color-primary-admin)",textColor:"var(--color-primary-admin)",backgroundColor:THEME_COLORS.surfaces.white},modalCancel:{borderColor:"var(--color-action-delete)",textColor:"var(--color-action-delete)",backgroundColor:THEME_COLORS.surfaces.white},modalSave:{borderColor:"var(--color-primary-admin)",textColor:THEME_COLORS.surfaces.white,backgroundColor:"var(--color-primary-admin)"},modalEdit:{borderColor:"var(--color-action-edit)",textColor:"var(--color-action-edit)",backgroundColor:THEME_COLORS.surfaces.white},modalDelete:{borderColor:"var(--color-action-delete)",textColor:"var(--color-action-delete)",backgroundColor:THEME_COLORS.surfaces.white},paginator:{borderColor:"var(--color-navy-main)",textColor:"var(--color-navy-main)",backgroundColor:THEME_COLORS.surfaces.white},circular:{borderColor:"var(--color-primary-admin)",textColor:"var(--color-primary-admin)",backgroundColor:THEME_COLORS.surfaces.white},adminNav:{borderColor:"var(--color-navy-main)",textColor:"var(--color-navy-main)",backgroundColor:THEME_COLORS.surfaces.white}},sizeClasses={s:"px-2 py-1 text-sm",m:"px-4 py-2",l:"px-6 py-3 text-lg",xl:"px-8 py-4 text-xl",xxl:"px-10 py-5 text-2xl"},iconSizes={s:16,m:20,l:24,xl:28,xxl:32};function ButtonUI({title:e,icon:t,iconPosition:a="left",borderColor:r,textColor:s,iconColor:n,backgroundColor:i,theme:o,size:l="m",tooltip:c,onClick:d,type:u="button",disabled:m=!1,className:p="",forceResponsive:x=!0}){const h=!e&&t,g=!o&&h?"circular":o,y=g?BUTTON_THEMES[g]:null,v=r||(null==y?void 0:y.borderColor)||"var(--color-primary-admin)",E=s||(null==y?void 0:y.textColor)||"#ffffff",f=i||(null==y?void 0:y.backgroundColor)||"var(--color-primary-admin)",[b,j]=reactExports.useState(!1),[R,I]=reactExports.useState(!1),S=reactExports.useRef(null),_=n||E,N=()=>{if("transparent"===f)return"rgba(0,0,0,0.05)";if(f.startsWith("var("))return f.includes("--color-primary-admin")?"var(--color-primary-main)":f.includes("--color-navy")?"var(--color-navy-dark)":`color-mix(in srgb, ${f} 80%, black 20%)`;if("transparent"!==f&&f.startsWith("#")){const e=f.replace("#",""),t=parseInt(e.substr(0,2),16),a=parseInt(e.substr(2,2),16),r=parseInt(e.substr(4,2),16);return`rgb(${Math.floor(.8*t)}, ${Math.floor(.8*a)}, ${Math.floor(.8*r)})`}return f};reactExports.useEffect(()=>{const e=()=>{j(window.innerWidth<768)};if(x)return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[x]);const C=b&&x?"s":l,T=h?"rounded-full p-2 aspect-square":`rounded-lg ${sizeClasses[C]}`,D={borderColor:v,borderStyle:"solid",borderWidth:"2px",color:E,backgroundColor:R?N():f,transition:"all 0.2s ease-in-out"};reactExports.useEffect(()=>{var e;(e=S.current)&&(e.style.setProperty("border-color",v,"important"),e.style.setProperty("border-style","solid","important"),e.style.setProperty("border-width","2px","important"),e.style.setProperty("color",E,"important"),e.style.setProperty("background-color",R?N():f,"important"))},[v,E,f,R]);const A={initial:{rotate:0},hover:{rotate:20,transition:{duration:.3}}},P=b?1.05:1.1,w=b?.95:.9;return jsxRuntimeExports.jsxs(motion.button,{ref:S,whileHover:{scale:P},whileTap:{scale:w},transition:{duration:.3},type:u,onClick:d,disabled:m,onMouseEnter:()=>I(!0),onMouseLeave:()=>I(!1),className:`\n    inline-flex items-center justify-center\n    transition-all duration-200\n    focus:outline-none focus:ring-2 focus:ring-offset-2\n    disabled:opacity-50 disabled:cursor-not-allowed\n   ${T} ${p}`,style:D,title:c,children:[t&&"left"===a&&jsxRuntimeExports.jsx(motion.div,{variants:A,initial:"initial",whileHover:"hover",className:e?"mr-2":"",children:jsxRuntimeExports.jsx(t,{size:iconSizes[C],color:_,className:h?"hover:text-primary/80":""})}),e&&jsxRuntimeExports.jsx("span",{className:"truncate",children:e}),t&&"right"===a&&jsxRuntimeExports.jsx(motion.div,{variants:A,initial:"initial",whileHover:"hover",className:e?"ml-2":"",children:jsxRuntimeExports.jsx(t,{size:iconSizes[C],color:_,className:h?"hover:text-primary/80":""})})]})}function ModalUI({isOpen:e,onClose:t,title:a,children:r,footer:s,size:n="2xl"}){const[i,o]=reactExports.useState("80vh");reactExports.useEffect(()=>{const e=()=>{const e=window.innerHeight;o(e>=1080?"85vh":e>=900?"80vh":e>=768?"75vh":"70vh")};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const l=e=>{e.stopPropagation()};return jsxRuntimeExports.jsx(AnimatePresence,{children:e&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0},animate:{opacity:.5},exit:{opacity:0},className:"fixed inset-0 z-40",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},onClick:t}),jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.2},className:"fixed inset-0 z-50 flex items-center justify-center p-4 sm:p-6",onClick:l,children:jsxRuntimeExports.jsxs("div",{className:"rounded-lg shadow-xl w-full flex flex-col "+("sm"===n?"max-w-sm":"md"===n?"max-w-md":"lg"===n?"max-w-lg":"xl"===n?"max-w-xl":"2xl"===n?"max-w-2xl":"3xl"===n?"max-w-3xl":"4xl"===n?"max-w-4xl":"5xl"===n?"max-w-5xl":"6xl"===n?"max-w-6xl":"7xl"===n?"max-w-7xl":"max-w-2xl"),style:{backgroundColor:"var(--color-surface-modal)",maxHeight:i,minHeight:"50vh"},onClick:l,onSubmit:l,children:[jsxRuntimeExports.jsxs("div",{className:"px-6 py-4 rounded-t-lg flex items-center justify-between border-b flex-shrink-0",style:{backgroundColor:"var(--color-navy-header)",borderBottomColor:"var(--color-action-edit)",color:"var(--color-text-inverse)"},children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-semibold",style:{color:"var(--color-text-inverse)"},children:a}),jsxRuntimeExports.jsx(ButtonUI,{icon:X$1,size:"s",onClick:t,borderColor:"var(--color-text-inverse)",textColor:"var(--color-navy-header)",backgroundColor:"var(--color-text-inverse)",className:"hover:bg-opacity-80"})]}),jsxRuntimeExports.jsx("div",{className:"p-6 overflow-y-auto flex-grow",style:{backgroundColor:"var(--color-primary-mint)"},children:r}),s&&jsxRuntimeExports.jsx("div",{className:"px-6 py-4 rounded-b-lg border-t flex-shrink-0",style:{backgroundColor:"var(--color-surface-secondary)",borderTopColor:"var(--color-border-light)"},children:jsxRuntimeExports.jsx("div",{className:"flex justify-end space-x-3",children:s})})]})})]})})}function InputUI({id:e,label:t,type:a="text",icon:r,value:s,onChange:n,placeholder:i,required:o=!1,maxLength:l,className:c="",disabled:d=!1,hasError:u,errorMessage:m}){const[p,x]=reactExports.useState(!1),h=p&&o&&!s.trim(),g=void 0!==u?u:h;return jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsxs("label",{htmlFor:e,className:"block text-sm font-medium mb-1",style:{color:"var(--color-text-primary)"},children:[t," ",o&&jsxRuntimeExports.jsx("span",{style:{color:"var(--color-error-main)"},children:"*"})]}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[r&&jsxRuntimeExports.jsx(r,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5",style:{color:g?"var(--color-error-main)":"var(--color-text-muted)"}}),jsxRuntimeExports.jsx("input",{type:a,id:e,required:o,maxLength:l,value:s,onChange:e=>{const t=e.target.value;(!l||t.length<=l)&&n(t)},onPaste:e=>{const t=e.clipboardData.getData("text");if(l&&s.length+t.length>l){e.preventDefault();const a=t.slice(0,l-s.length);n(s+a)}},className:`\n            ${r?"pl-10":"pl-4"}\n            w-full px-4 py-3 border-2 rounded-lg\n            transition-all duration-200\n            focus:outline-none focus:ring-2\n            ${c}\n          `,style:{backgroundColor:d?"var(--color-surface-modal)":g?"rgba(239, 68, 68, 0.05)":"var(--color-surface-input)",borderColor:g?"var(--color-error-main)":"var(--color-border-light)",color:"var(--color-text-primary)","--tw-ring-color":g?"rgba(239, 68, 68, 0.2)":"rgba(98, 158, 62, 0.2)",opacity:d?.6:1,cursor:d?"not-allowed":"text"},placeholder:i,disabled:d,onFocus:e=>{e.target.style.borderColor=g?"var(--color-error-main)":"var(--color-primary-admin)"},onBlur:e=>{x(!0),e.target.style.borderColor=g?"var(--color-error-main)":"var(--color-border-light)"}})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between mt-1",children:[g&&jsxRuntimeExports.jsx("span",{className:"text-sm font-medium",style:{color:"var(--color-error-main)"},children:m||(h?`El campo ${t.toLowerCase()} es obligatorio`:"")}),l&&jsxRuntimeExports.jsxs("span",{className:"text-sm ml-auto",style:{color:g?"var(--color-error-main)":"var(--color-text-muted)"},children:[s.length,"/",l]})]})]})}const formatDistanceLocale={lessThanXSeconds:{one:"menos de un segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"medio minuto",lessThanXMinutes:{one:"menos de un minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"alrededor de 1 hora",other:"alrededor de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 día",other:"{{count}} días"},aboutXWeeks:{one:"alrededor de 1 semana",other:"alrededor de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"alrededor de 1 mes",other:"alrededor de {{count}} meses"},xMonths:{one:"1 mes",other:"{{count}} meses"},aboutXYears:{one:"alrededor de 1 año",other:"alrededor de {{count}} años"},xYears:{one:"1 año",other:"{{count}} años"},overXYears:{one:"más de 1 año",other:"más de {{count}} años"},almostXYears:{one:"casi 1 año",other:"casi {{count}} años"}},formatDistance=(e,t,a)=>{let r;const s=formatDistanceLocale[e];return r="string"==typeof s?s:1===t?s.one:s.other.replace("{{count}}",t.toString()),(null==a?void 0:a.addSuffix)?a.comparison&&a.comparison>0?"en "+r:"hace "+r:r},dateFormats={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/y"},timeFormats={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},dateTimeFormats={full:"{{date}} 'a las' {{time}}",long:"{{date}} 'a las' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},formatLong={date:buildFormatLongFn({formats:dateFormats,defaultWidth:"full"}),time:buildFormatLongFn({formats:timeFormats,defaultWidth:"full"}),dateTime:buildFormatLongFn({formats:dateTimeFormats,defaultWidth:"full"})},formatRelativeLocale={lastWeek:"'el' eeee 'pasado a la' p",yesterday:"'ayer a la' p",today:"'hoy a la' p",tomorrow:"'mañana a la' p",nextWeek:"eeee 'a la' p",other:"P"},formatRelativeLocalePlural={lastWeek:"'el' eeee 'pasado a las' p",yesterday:"'ayer a las' p",today:"'hoy a las' p",tomorrow:"'mañana a las' p",nextWeek:"eeee 'a las' p",other:"P"},formatRelative=(e,t,a,r)=>1!==t.getHours()?formatRelativeLocalePlural[e]:formatRelativeLocale[e],eraValues={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","después de cristo"]},quarterValues={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1º trimestre","2º trimestre","3º trimestre","4º trimestre"]},monthValues={narrow:["e","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],wide:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]},dayValues={narrow:["d","l","m","m","j","v","s"],short:["do","lu","ma","mi","ju","vi","sá"],abbreviated:["dom","lun","mar","mié","jue","vie","sáb"],wide:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"]},dayPeriodValues={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"}},formattingDayPeriodValues={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"}},ordinalNumber=(e,t)=>Number(e)+"º",localize={ordinalNumber:ordinalNumber,era:buildLocalizeFn({values:eraValues,defaultWidth:"wide"}),quarter:buildLocalizeFn({values:quarterValues,defaultWidth:"wide",argumentCallback:e=>Number(e)-1}),month:buildLocalizeFn({values:monthValues,defaultWidth:"wide"}),day:buildLocalizeFn({values:dayValues,defaultWidth:"wide"}),dayPeriod:buildLocalizeFn({values:dayPeriodValues,defaultWidth:"wide",formattingValues:formattingDayPeriodValues,defaultFormattingWidth:"wide"})},matchOrdinalNumberPattern=/^(\d+)(º)?/i,parseOrdinalNumberPattern=/\d+/i,matchEraPatterns={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|a\.?\s?e\.?\s?c\.?|d\.?\s?c\.?|e\.?\s?c\.?)/i,wide:/^(antes de cristo|antes de la era com[uú]n|despu[eé]s de cristo|era com[uú]n)/i},parseEraPatterns={any:[/^ac/i,/^dc/i],wide:[/^(antes de cristo|antes de la era com[uú]n)/i,/^(despu[eé]s de cristo|era com[uú]n)/i]},matchQuarterPatterns={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234](º)? trimestre/i},parseQuarterPatterns={any:[/1/i,/2/i,/3/i,/4/i]},matchMonthPatterns={narrow:/^[efmajsond]/i,abbreviated:/^(ene|feb|mar|abr|may|jun|jul|ago|sep|oct|nov|dic)/i,wide:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i},parseMonthPatterns={narrow:[/^e/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^en/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i]},matchDayPatterns={narrow:/^[dlmjvs]/i,short:/^(do|lu|ma|mi|ju|vi|s[áa])/i,abbreviated:/^(dom|lun|mar|mi[ée]|jue|vie|s[áa]b)/i,wide:/^(domingo|lunes|martes|mi[ée]rcoles|jueves|viernes|s[áa]bado)/i},parseDayPatterns={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^do/i,/^lu/i,/^ma/i,/^mi/i,/^ju/i,/^vi/i,/^sa/i]},matchDayPeriodPatterns={narrow:/^(a|p|mn|md|(de la|a las) (mañana|tarde|noche))/i,any:/^([ap]\.?\s?m\.?|medianoche|mediodia|(de la|a las) (mañana|tarde|noche))/i},parseDayPeriodPatterns={any:{am:/^a/i,pm:/^p/i,midnight:/^mn/i,noon:/^md/i,morning:/mañana/i,afternoon:/tarde/i,evening:/tarde/i,night:/noche/i}},match={ordinalNumber:buildMatchPatternFn({matchPattern:matchOrdinalNumberPattern,parsePattern:parseOrdinalNumberPattern,valueCallback:function(e){return parseInt(e,10)}}),era:buildMatchFn({matchPatterns:matchEraPatterns,defaultMatchWidth:"wide",parsePatterns:parseEraPatterns,defaultParseWidth:"any"}),quarter:buildMatchFn({matchPatterns:matchQuarterPatterns,defaultMatchWidth:"wide",parsePatterns:parseQuarterPatterns,defaultParseWidth:"any",valueCallback:e=>e+1}),month:buildMatchFn({matchPatterns:matchMonthPatterns,defaultMatchWidth:"wide",parsePatterns:parseMonthPatterns,defaultParseWidth:"any"}),day:buildMatchFn({matchPatterns:matchDayPatterns,defaultMatchWidth:"wide",parsePatterns:parseDayPatterns,defaultParseWidth:"any"}),dayPeriod:buildMatchFn({matchPatterns:matchDayPeriodPatterns,defaultMatchWidth:"any",parsePatterns:parseDayPeriodPatterns,defaultParseWidth:"any"})},es={code:"es",formatDistance:formatDistance,formatLong:formatLong,formatRelative:formatRelative,localize:localize,match:match,options:{weekStartsOn:1,firstWeekContainsDate:1}};registerLocale("es",es);const DATE_FORMATS={"dd/MM/yyyy":"dd/MM/yyyy","dd-MM-yyyy":"dd-MM-yyyy","yyyy-MM-dd":"yyyy-MM-dd","MM/dd/yyyy":"MM/dd/yyyy","yyyy/MM/dd":"yyyy/MM/dd"},INTERNAL_FORMAT="yyyy-MM-dd",DISPLAY_FORMAT="dd/MM/yyyy",formatDate$1=(e,t)=>e?format(e,t):"",detectDateFormat=e=>{if(!e)return null;const t=Object.values(DATE_FORMATS);for(const a of t){const t=parse(e,a,new Date);if(isValid(t))return a}return null},parseDate=(e,t)=>{if(!e)return null;try{const a=parse(e,t,new Date);return isValid(a)?a:null}catch(a){return null}},DatepickerUI=({id:e,label:t,value:a,onChange:r,type:s="date",formatString:n,placeholder:i="Seleccione fecha",icon:o=Calendar,required:l=!1,minDate:c,maxDate:d,showTimeSelect:u=!1,showTimeSelectOnly:m=!1,timeIntervals:p=15,dateFormat:x,className:h="",disabled:g=!1,error:y})=>{const v=INTERNAL_FORMAT,E=n||v,f=x||(u?`${DISPLAY_FORMAT} HH:mm`:DISPLAY_FORMAT),[b,j]=reactExports.useState(null),[R,I]=reactExports.useState(null);reactExports.useEffect(()=>{if(!a)return j(null),void I(null);if("string"==typeof a){const e=detectDateFormat(a)||E,t=parseDate(a,e);j(t)}else if(Array.isArray(a)){const e=a[0]&&detectDateFormat(a[0])||E,t=a[1]&&detectDateFormat(a[1])||E,r=a[0]?parseDate(a[0],e):null,s=a[1]?parseDate(a[1],t):null;j(r),I(s)}},[a,E]);const S=e=>{if(e)if(Array.isArray(e)){const[t,a]=e;if(t&&a&&isAfter(t,a))return;j(t),I(a),r(t&&a?[formatDate$1(t,v),formatDate$1(a,v)]:null)}else j(e),r(formatDate$1(e,v));else r(null)},_={id:e,placeholderText:i,dateFormat:f,showTimeSelect:u,showTimeSelectOnly:m,timeIntervals:p,minDate:c,maxDate:d,disabled:g,locale:"es",isClearable:!0,withPortal:!0,portalId:"datepicker-portal",popperPlacement:"bottom-start",className:`w-full pl-10 pr-4 py-3 rounded-lg transition-all duration-200 focus:outline-none ${h}`,"aria-invalid":y?"true":"false"};return jsxRuntimeExports.jsxs("div",{className:"relative",children:[t&&jsxRuntimeExports.jsxs("label",{htmlFor:e,className:"block text-sm font-medium mb-1",style:{color:"var(--color-text-primary)"},children:[t," ",l&&jsxRuntimeExports.jsx("span",{style:{color:"var(--color-error-main)"},children:"*"})]}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 z-10",style:{color:"var(--color-text-muted)"},children:"datetime"===s?jsxRuntimeExports.jsx(Clock,{}):"daterange"===s?jsxRuntimeExports.jsx(CalendarRange,{}):jsxRuntimeExports.jsx(o,{})}),jsxRuntimeExports.jsx("div",{className:"relative w-full",style:{"--datepicker-bg":"var(--color-surface-input)","--datepicker-border":y?"var(--color-error-main)":"var(--color-border-light)","--datepicker-focus":"var(--color-primary-admin)","--datepicker-text":"var(--color-text-primary)"},children:"daterange"===s?jsxRuntimeExports.jsx(DatePicker,__spreadProps(__spreadValues({},_),{selectsRange:!0,startDate:b,endDate:R,onChange:e=>S(e)})):jsxRuntimeExports.jsx(DatePicker,__spreadProps(__spreadValues({},_),{selected:b,onChange:e=>S(e)}))})]}),y&&jsxRuntimeExports.jsx("p",{className:"mt-1 text-sm",style:{color:"var(--color-error-main)"},children:y})]})};function SelectUI$1({id:e,label:t,icon:a,options:r,value:s,onChange:n,placeholder:i="Seleccione una opción",required:o=!1,includeAll:l=!1,allLabel:c="--Todos--",className:d="",disabled:u=!1}){const[m,p]=reactExports.useState(!1),[x,h]=reactExports.useState(!1),[g,y]=reactExports.useState(!1),[v,E]=reactExports.useState({top:0,left:0,width:0}),[f,b]=reactExports.useState(null),j=reactExports.useRef(null),R=m&&o&&(""===s||-1===s);reactExports.useEffect(()=>{if("undefined"!=typeof document){let e=document.getElementById("select-ui-portal");e||(e=document.createElement("div"),e.id="select-ui-portal",e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.width="0",e.style.height="0",e.style.zIndex="99999",e.style.pointerEvents="none",document.body.appendChild(e)),b(e)}return()=>{}},[]),reactExports.useEffect(()=>{const e=()=>{y(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),reactExports.useEffect(()=>{if(x&&j.current){const e=j.current.getBoundingClientRect(),t=window.innerHeight-e.bottom<260&&e.top>300?e.top-300:e.bottom+5;E({top:t,left:e.left,width:e.width})}},[x]),reactExports.useEffect(()=>{function e(e){!j.current||j.current.contains(e.target)||e.target.closest("#select-ui-portal")||h(!1)}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),reactExports.useEffect(()=>{function e(){x&&h(!1)}return window.addEventListener("scroll",e,!0),()=>{window.removeEventListener("scroll",e,!0)}},[x]);const I=()=>{u||(h(!x),m||p(!0))},S=l?[{value:-1,label:c},...r]:r,_=S.find(e=>e.value===s),N=_?_.label:i;return jsxRuntimeExports.jsxs("div",{className:"w-full",children:[jsxRuntimeExports.jsxs("label",{htmlFor:e,className:"block text-sm font-medium mb-1",style:{color:"var(--color-text-primary)"},children:[t," ",o&&jsxRuntimeExports.jsx("span",{style:{color:"var(--color-error-main)"},children:"*"})]}),jsxRuntimeExports.jsxs("div",{ref:j,className:"relative w-full",children:[jsxRuntimeExports.jsxs("div",{id:e,role:"combobox","aria-controls":`dropdown-${e}`,"aria-expanded":x,"aria-haspopup":"listbox","aria-required":o,"aria-label":t,className:`\n            relative w-full flex items-center rounded-lg\n            ${a?"pl-10":"pl-4"}\n            pr-4 py-3 transition-all duration-200 ease-in-out\n            ${u?"cursor-not-allowed":"cursor-pointer"}\n            ${d}\n          `,style:{backgroundColor:u?"var(--color-surface-disabled)":"var(--color-surface-input)",borderWidth:"1px",borderStyle:"solid",borderColor:R?"var(--color-error-main)":"var(--color-border-light)"},onMouseEnter:e=>{u||R||(e.currentTarget.style.borderColor="var(--color-primary-admin)")},onMouseLeave:e=>{u||R||(e.currentTarget.style.borderColor="var(--color-border-light)")},onFocus:e=>{u||(e.currentTarget.style.outline="none",e.currentTarget.style.boxShadow="0 0 0 2px var(--tw-ring-color)",e.currentTarget.style.borderColor=R?"var(--color-error-main)":"var(--color-primary-admin)")},onBlur:e=>{u||(e.currentTarget.style.boxShadow="none",e.currentTarget.style.borderColor=R?"var(--color-error-main)":"var(--color-border-light)")},onClick:I,tabIndex:u?-1:0,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),I())},children:[a&&jsxRuntimeExports.jsx(a,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5",style:{color:R?"var(--color-error-main)":"var(--color-text-muted)"}}),jsxRuntimeExports.jsx("div",{className:"flex-grow truncate text-left",style:{color:""===s||-1===s?"var(--color-text-muted)":"var(--color-text-primary)"},children:N}),jsxRuntimeExports.jsx("div",{className:"flex-shrink-0 ml-2",children:jsxRuntimeExports.jsx("svg",{className:"h-5 w-5 transition-transform duration-200 "+(x?"rotate-180":""),style:{color:"var(--color-text-muted)"},viewBox:"0 0 20 20",fill:"none",stroke:"currentColor","aria-hidden":"true",children:jsxRuntimeExports.jsx("path",{d:"M6 8l4 4 4-4",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),R&&jsxRuntimeExports.jsxs("p",{className:"mt-1 text-sm",style:{color:"var(--color-error-main)"},children:["El campo ",t.toLowerCase()," es obligatorio"]})]}),x&&f?ReactDOM.createPortal(jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"fixed inset-0",style:{backgroundColor:"rgba(0,0,0,0.01)",zIndex:99998,pointerEvents:"auto"},onClick:()=>h(!1)}),jsxRuntimeExports.jsx("div",{className:`\n            fixed overflow-hidden rounded-lg shadow-lg\n            ${g?"max-h-80":"max-h-60"}\n          `,style:{top:`${v.top}px`,left:`${v.left}px`,width:`${v.width}px`,zIndex:99999,pointerEvents:"auto",backgroundColor:"var(--color-surface-modal)",borderColor:"var(--color-border-light)",borderWidth:"1px",borderStyle:"solid",boxShadow:"0 10px 25px -5px rgba(0, 0, 0, 0.15), 0 8px 10px -6px rgba(0, 0, 0, 0.1)"},children:jsxRuntimeExports.jsx("div",{className:"overflow-y-auto max-h-full",children:jsxRuntimeExports.jsxs("ul",{role:"listbox",className:"py-1",children:[S.map(e=>jsxRuntimeExports.jsx("li",{role:"option","aria-selected":s===e.value,onClick:()=>(e=>{const t="string"==typeof e&&/^-?\d+$/.test(e)?parseInt(e,10):e;n(t),h(!1),p(!0)})(e.value),className:`\n                    ${g?"py-4":"py-3"}\n                    px-4 cursor-pointer\n                    transition-colors duration-150 ease-in-out\n                  `,style:{backgroundColor:s===e.value?"var(--color-primary-admin-alpha)":"transparent",color:s===e.value?"var(--color-primary-admin)":"var(--color-text-primary)",fontWeight:s===e.value?"500":"normal"},onMouseEnter:t=>{s!==e.value&&(t.currentTarget.style.backgroundColor="var(--color-surface-hover)")},onMouseLeave:t=>{s!==e.value&&(t.currentTarget.style.backgroundColor="transparent")},children:e.label},e.value)),0===S.length&&jsxRuntimeExports.jsx("li",{className:"py-3 px-4 italic text-center",style:{color:"var(--color-text-muted)"},children:"No hay opciones disponibles"})]})})})]}),f):null]})}const ProfilePictureUpload=({value:e,onChange:t,size:a="md"})=>{const[r,s]=reactExports.useState(!1),n=reactExports.useRef(null),i=reactExports.useCallback(e=>__async(void 0,null,function*(){try{if(!e.type.match("image.*"))return;if(e.size>5242880)return;const a=yield(e=>new Promise((t,a)=>{const r=new FileReader;r.readAsDataURL(e),r.onload=()=>t(r.result),r.onerror=e=>a(e)}))(e);t(a)}catch(a){}}),[t]),o=reactExports.useCallback(e=>{e.preventDefault(),s(!0)},[]),l=reactExports.useCallback(e=>{e.preventDefault(),s(!1)},[]),c=reactExports.useCallback(e=>{var t;e.preventDefault(),s(!1);const a=null==(t=e.dataTransfer.files)?void 0:t[0];a&&i(a)},[i]),d=()=>{var e;null==(e=n.current)||e.click()};return jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center",children:[jsxRuntimeExports.jsxs("div",{className:`${{sm:"w-24 h-24",md:"w-36 h-36",lg:"w-48 h-48"}[a]} relative rounded-full overflow-hidden border-2 transition-all duration-200 ${e?"":"cursor-pointer"}`,style:{borderColor:r?"var(--color-primary-admin)":"var(--color-border-light)",backgroundColor:r?"var(--color-primary-admin-alpha)":"var(--color-surface-secondary)"},onMouseEnter:t=>{e||r||(t.currentTarget.style.backgroundColor="var(--color-surface-hover)")},onMouseLeave:t=>{e||r||(t.currentTarget.style.backgroundColor="var(--color-surface-secondary)")},onDragOver:o,onDragLeave:l,onDrop:c,onClick:e?void 0:d,children:[e?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("img",{src:e,alt:"Foto de perfil",className:"w-full h-full object-cover"}),jsxRuntimeExports.jsx("button",{type:"button",onClick:e=>{e.stopPropagation(),t(null),n.current&&(n.current.value="")},className:"absolute right-1 top-1 rounded-full p-1 transition-colors",style:{backgroundColor:"var(--color-error-main)",color:"white"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="var(--color-error-dark)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="var(--color-error-main)"},children:jsxRuntimeExports.jsx(X$1,{size:16})})]}):jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center h-full",style:{color:"var(--color-text-muted)"},children:[jsxRuntimeExports.jsx(Camera,{size:"sm"===a?24:"md"===a?32:40,className:"mb-2"}),jsxRuntimeExports.jsx("span",{className:"text-xs "+("sm"===a?"hidden":""),children:"Foto de perfil"})]}),jsxRuntimeExports.jsx("input",{type:"file",ref:n,onChange:e=>{var t;const a=null==(t=e.target.files)?void 0:t[0];a&&i(a)},accept:"image/*",className:"hidden"})]}),!e&&jsxRuntimeExports.jsx("div",{className:"mt-2 flex space-x-2",children:jsxRuntimeExports.jsxs("button",{type:"button",onClick:d,className:"flex items-center text-xs transition-colors",style:{color:"var(--color-primary-admin)"},onMouseEnter:e=>{e.currentTarget.style.color="var(--color-primary-admin-dark)"},onMouseLeave:e=>{e.currentTarget.style.color="var(--color-primary-admin)"},children:[jsxRuntimeExports.jsx(UploadCloud,{size:16,className:"mr-1"}),"Subir foto"]})})]})};class SystemUserService extends ApiBaseService{constructor(){super("/SystemUser")}getSystemUserById(e){return __async(this,null,function*(){return __superGet(SystemUserService.prototype,this,"getById").call(this,e)})}getPagedSystemUsers(e){return __async(this,null,function*(){const t=e?__spreadProps(__spreadValues({},e),{FirstName:e.FirstName||void 0,LastName:e.LastName||void 0,Email:e.Email||void 0}):void 0;return __superGet(SystemUserService.prototype,this,"getPaged").call(this,"paged",t)})}create(e){return __async(this,null,function*(){return this.post("",e)})}update(e,t){return __async(this,null,function*(){return this.put(`/${e}`,t)})}deleteSystemUser(e){return __async(this,null,function*(){return __superGet(SystemUserService.prototype,this,"deleteById").call(this,e)})}getByCompany(e,t=1,a=10){return __async(this,null,function*(){const r={Page:t,PageSize:a,CompanyId:e};return this.getPagedSystemUsers(r)})}getByCondominium(e,t=1,a=10){return __async(this,null,function*(){const r={Page:t,PageSize:a,CondoId:e};return this.getPagedSystemUsers(r)})}getByProfileType(e,t=1,a=10){return __async(this,null,function*(){const r={Page:t,PageSize:a,ProfileTypeId:e};return this.getPagedSystemUsers(r)})}searchByEmail(e,t=1,a=10){return __async(this,null,function*(){const r={Page:t,PageSize:a,Email:e};return this.getPagedSystemUsers(r)})}searchByName(e,t,a=1,r=10){return __async(this,null,function*(){const s={Page:a,PageSize:r,FirstName:e,LastName:t};return this.getPagedSystemUsers(s)})}getResidentDashboard(e){return __async(this,null,function*(){return this.get(`/${e}/dashboard`)})}getProfiles(e=!1){return __async(this,null,function*(){return this.get(`/profiles?isResident=${e}`)})}}class ManagementCompanyService extends ApiBaseService{constructor(){super("/ManagementCompany")}getCompanyById(e){return __async(this,null,function*(){return __superGet(ManagementCompanyService.prototype,this,"getById").call(this,e)})}getPagedCompanies(e){return __async(this,null,function*(){const t=e?__spreadProps(__spreadValues({},e),{NameFilter:e.NameFilter||void 0,EmailFilter:e.EmailFilter||void 0,CompanyId:e.CompanyId||void 0}):void 0;return __superGet(ManagementCompanyService.prototype,this,"getPaged").call(this,"paged",t)})}create(e){return __async(this,null,function*(){return this.post("",e)})}update(e,t){return __async(this,null,function*(){return this.put(`/${e}`,t)})}deleteCompany(e){return __async(this,null,function*(){return __superGet(ManagementCompanyService.prototype,this,"deleteById").call(this,e)})}searchByName(e,t=1,a=10){return __async(this,null,function*(){const r={Page:t,PageSize:a,NameFilter:e};return this.getPagedCompanies(r)})}searchByEmail(e,t=1,a=10){return __async(this,null,function*(){const r={Page:t,PageSize:a,EmailFilter:e};return this.getPagedCompanies(r)})}getAdministrativeDashboard(e){return __async(this,null,function*(){const t=new URLSearchParams;e.companyId&&t.append("companyId",e.companyId.toString()),e.condominiumId&&t.append("condominiumId",e.condominiumId.toString());const a="dashboard"+(t.toString()?`?${t.toString()}`:"");return this.get(a)})}}const managementCompany_service=Object.freeze(Object.defineProperty({__proto__:null,ManagementCompanyService:ManagementCompanyService},Symbol.toStringTag,{value:"Module"}));class CondominiumService extends ApiBaseService{constructor(){super("/Condominium")}getCondominiumById(e){return __async(this,null,function*(){return __superGet(CondominiumService.prototype,this,"getById").call(this,e)})}getPagedCondominiums(e){return __async(this,null,function*(){const t=e?__spreadProps(__spreadValues({},e),{Name:e.Name||void 0,Address:e.Address||void 0,ContactEmail:e.ContactEmail||void 0,ContactPhone:e.ContactPhone||void 0}):void 0;return __superGet(CondominiumService.prototype,this,"getPaged").call(this,"paged",t)})}create(e){return __async(this,null,function*(){return this.post("",e)})}update(e,t){return __async(this,null,function*(){return this.put(`/${e}`,t)})}deleteCondominium(e){return __async(this,null,function*(){return __superGet(CondominiumService.prototype,this,"deleteById").call(this,e)})}getByCompany(e,t=1,a=10){return __async(this,null,function*(){const r={Page:t,PageSize:a,CompanyId:e};return this.getPagedCondominiums(r)})}searchByName(e,t=1,a=10){return __async(this,null,function*(){const r={Page:t,PageSize:a,Name:e};return this.getPagedCondominiums(r)})}searchByAddress(e,t=1,a=10){return __async(this,null,function*(){const r={Page:t,PageSize:a,Address:e};return this.getPagedCondominiums(r)})}}const condominium_service=Object.freeze(Object.defineProperty({__proto__:null,CondominiumService:CondominiumService},Symbol.toStringTag,{value:"Module"})),FIXED_PROFILES=[{profileTypeId:1,profileName:"Administrador",description:"Usuario administrador del sistema"},{profileTypeId:2,profileName:"Residente",description:"Residente del condominio"},{profileTypeId:3,profileName:"Portero",description:"Personal de seguridad"},{profileTypeId:4,profileName:"Conserje",description:"Personal de mantenimiento"},{profileTypeId:5,profileName:"Propietario",description:"Propietario de unidad"},{profileTypeId:6,profileName:"Inquilino",description:"Inquilino de unidad"}],FIXED_ACCESS_STATUSES$1=[{statusTypeId:1,statusName:"Activo",description:"Usuario activo en el sistema"},{statusTypeId:2,statusName:"Inactivo",description:"Usuario inactivo temporalmente"},{statusTypeId:3,statusName:"Bloqueado",description:"Usuario bloqueado por seguridad"},{statusTypeId:4,statusName:"Suspendido",description:"Usuario suspendido administrativamente"}],FIXED_DOCUMENT_TYPES$1=[{documentTypeId:1,documentName:"DNI",description:"Documento Nacional de Identidad"},{documentTypeId:2,documentName:"Pasaporte",description:"Pasaporte"},{documentTypeId:3,documentName:"Carné de Extranjería",description:"Carné de Extranjería"},{documentTypeId:4,documentName:"RUC",description:"Registro Único de Contribuyentes"}];function MyProfileModal({isOpen:e,onClose:t}){var a,r,s,n;const[i,o]=reactExports.useState(!1),[l,c]=reactExports.useState(null),[d,u]=reactExports.useState({}),[m,p]=reactExports.useState(!1),[x,h]=reactExports.useState(!1),[g]=reactExports.useState(FIXED_PROFILES),[y]=reactExports.useState(FIXED_ACCESS_STATUSES$1),[v]=reactExports.useState(FIXED_DOCUMENT_TYPES$1),[E,f]=reactExports.useState([]),[b,j]=reactExports.useState([]),[R,I]=reactExports.useState(-1),[S,_]=reactExports.useState(-1),[N,C]=reactExports.useState({firstName:"",lastName:"",secondLastName:"",email:"",contactNumber:"",address:"",dateOfBirth:"",genderId:void 0,documentTypeId:void 0,documentNumber:"",profileTypeId:void 0,companyId:void 0,condoId:void 0,username:"",password:"",statusTypeId:1,profilePicture:null,isInternalUser:!0}),T=new SystemUserService,D=new ManagementCompanyService,A=new CondominiumService,{showToast:P}=useAlerts(),w=reactExports.useCallback(()=>__async(this,null,function*(){try{o(!0);const e=localStorage.getItem("userData");if(!e)return void P("error","No se encontraron datos del usuario");const t=JSON.parse(e).id;if(!t)return void P("error","No se encontró ID del usuario");const a=yield T.getSystemUserById(t);if(a.isSuccess&&a.data){const e=a.data;c(e),I(e.companyId||-1),_(e.condoId||-1),C({userId:e.userId,firstName:e.firstName||"",lastName:e.lastName||"",secondLastName:e.secondLastName||"",email:e.email||"",contactNumber:e.contactNumber||"",address:e.address||"",dateOfBirth:e.dateOfBirth||"",genderId:e.genderId,documentTypeId:e.documentTypeId,documentNumber:e.documentNumber||"",profileTypeId:e.profileTypeId,companyId:e.companyId,condoId:e.condoId,username:e.username||"",statusTypeId:e.statusTypeId,profilePicture:e.profilePicture||null,isInternalUser:void 0===e.isInternalUser||e.isInternalUser}),e.companyId&&(yield k(e.companyId))}else P("error",a.error||"Error al cargar datos del usuario")}catch(e){P("error","Error al cargar datos del usuario")}finally{o(!1)}}),[P]),M=reactExports.useCallback(()=>__async(this,null,function*(){try{const e=yield D.getPagedCompanies();e.isSuccess&&e.data&&e.data.items&&f(e.data.items)}catch(e){}}),[]),k=reactExports.useCallback(e=>__async(this,null,function*(){try{const t={CompanyId:e},a=yield A.getPagedCondominiums(t);if(a.isSuccess&&a.data){const e=a.data;e.data&&Array.isArray(e.data)?j(e.data):e.items&&Array.isArray(e.items)?j(e.items):j([])}else P("error","Error al cargar los condominios"),j([])}catch(t){P("error","Error al cargar los condominios"),j([])}}),[P]),O=E.map(e=>({value:e.companyId||e.managementCompanyId||0,label:e.name||"Sin nombre"})),$=b.map(e=>({value:e.condoId||0,label:e.name||"Sin nombre"}));reactExports.useEffect(()=>{e&&(M(),w(),u({}),p(!1),h(!1))},[e,w,M]);const U=e=>{const{name:t,value:a}=e.target;F(t),["companyId","condoId","profileTypeId","statusTypeId","genderId","documentTypeId"].includes(t)&&""!==a?C(e=>__spreadProps(__spreadValues({},e),{[t]:Number(a)})):C(e=>__spreadProps(__spreadValues({},e),{[t]:a}))},L=(e,t)=>{if(F(e),""===t)C(t=>__spreadProps(__spreadValues({},t),{[e]:void 0}));else{const a=Number(t);if(isNaN(a))return;C(t=>__spreadProps(__spreadValues({},t),{[e]:a}))}},B=e=>{C(t=>__spreadProps(__spreadValues({},t),{profilePicture:e}))},F=e=>{d[e]&&u(t=>{const a=__spreadValues({},t);return delete a[e],a})},V=()=>{u({}),p(!1),h(!1),t()};return jsxRuntimeExports.jsx(ModalUI,{isOpen:e,onClose:V,title:"Mi Perfil",size:"4xl",footer:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ButtonUI,{title:"Cancelar",icon:X$1,onClick:V,theme:"delete"}),jsxRuntimeExports.jsx(ButtonUI,{title:"Guardar",icon:Save,onClick:()=>__async(this,null,function*(){try{if(!l)return void P("error","No se han cargado los datos del usuario");if(p(!0),!(()=>{var e,t,a,r,s;const n={};(null==(e=N.firstName)?void 0:e.trim())||(n.firstName="El nombre es obligatorio"),(null==(t=N.lastName)?void 0:t.trim())||(n.lastName="El apellido paterno es obligatorio"),(null==(a=N.email)?void 0:a.trim())||(n.email="El email es obligatorio"),void 0===N.statusTypeId&&(n.statusTypeId="El estado es obligatorio"),void 0===N.documentTypeId&&(n.documentTypeId="El tipo de documento es obligatorio"),(null==(r=N.documentNumber)?void 0:r.trim())||(n.documentNumber="El número de documento es obligatorio"),(null==(s=N.email)?void 0:s.trim())&&(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(N.email)||(n.email="El formato del email no es válido"));return u(n),0===Object.keys(n).length})())return void P("error","Por favor corrija los errores en el formulario");o(!0);const a={userId:l.userId,firstName:N.firstName||"",lastName:N.lastName||"",secondLastName:N.secondLastName||null,email:N.email||"",contactNumber:N.contactNumber||null,address:N.address||null,dateOfBirth:N.dateOfBirth||null,genderId:N.genderId||null,documentTypeId:N.documentTypeId||null,documentNumber:N.documentNumber||null,profileTypeId:l.profileTypeId,companyId:l.companyId,condoId:l.condoId,username:N.username||null,password:N.password||null,statusTypeId:Number(N.statusTypeId||1),profilePicture:N.profilePicture||null,isInternalUser:void 0===N.isInternalUser||N.isInternalUser},r=yield T.update(l.userId,a);if(r.isSuccess){P("success","Perfil actualizado exitosamente");try{const e=localStorage.getItem("userData");if(e){const t=JSON.parse(e),a=__spreadProps(__spreadValues({},t),{firstName:N.firstName,lastName:N.lastName,email:N.email});localStorage.setItem("userData",JSON.stringify(a))}}catch(e){}t()}else P("error",r.error||"Error al actualizar perfil")}catch(e){P("error","Error al actualizar perfil")}finally{o(!1)}}),theme:"primary",disabled:i})]}),children:i?jsxRuntimeExports.jsx("div",{className:"flex justify-center items-center py-12",children:jsxRuntimeExports.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center mb-6",children:[jsxRuntimeExports.jsx(ProfilePictureUpload,{value:N.profilePicture||null,onChange:B,size:"lg"}),N.profilePicture&&jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>B(null),className:"mt-2 text-sm text-red-600 hover:text-red-800",children:"Eliminar foto de perfil"})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(SelectUI$1,{id:"companyId-profile",label:"Empresa *",value:R,onChange:e=>__async(this,null,function*(){const t=Number(e);I(t),_(-1),F("companyId"),F("condoId"),C(e=>__spreadProps(__spreadValues({},e),{companyId:-1===t?void 0:t,condoId:void 0})),-1!==t?yield k(t):j([])}),options:O,icon:Building,required:!0,includeAll:!0,placeholder:"Seleccione una empresa",disabled:!0}),m&&d.companyId&&jsxRuntimeExports.jsx("span",{className:"text-sm mt-1",style:{color:"var(--color-error-main)"},children:d.companyId})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(SelectUI$1,{id:"condoId-profile",label:"Condominio *",value:S,onChange:e=>__async(this,null,function*(){const t=Number(e);_(t),F("condoId"),C(e=>__spreadProps(__spreadValues({},e),{condoId:-1===t?void 0:t}))}),options:$,icon:Building,required:!0,includeAll:!0,placeholder:"Seleccione un condominio",disabled:!0}),m&&d.condoId&&jsxRuntimeExports.jsx("span",{className:"text-sm mt-1",style:{color:"var(--color-error-main)"},children:d.condoId})]}),jsxRuntimeExports.jsx(InputUI,{id:"firstName-profile",type:"text",label:"Nombre *",value:N.firstName||"",onChange:e=>U({target:{name:"firstName",value:e}}),required:!0,icon:User,hasError:m&&!!d.firstName,errorMessage:d.firstName}),jsxRuntimeExports.jsx(InputUI,{id:"lastName-profile",type:"text",label:"Apellido Paterno *",value:N.lastName||"",onChange:e=>U({target:{name:"lastName",value:e}}),required:!0,icon:User,hasError:m&&!!d.lastName,errorMessage:d.lastName}),jsxRuntimeExports.jsx(InputUI,{id:"secondLastName-profile",type:"text",label:"Apellido Materno",value:N.secondLastName||"",onChange:e=>U({target:{name:"secondLastName",value:e}}),icon:User}),jsxRuntimeExports.jsx(InputUI,{id:"email-profile",type:"email",label:"Email *",value:N.email||"",onChange:e=>U({target:{name:"email",value:e}}),required:!0,icon:Mail,hasError:m&&!!d.email,errorMessage:d.email}),jsxRuntimeExports.jsx(InputUI,{id:"contactNumber-profile",type:"text",label:"Teléfono",value:N.contactNumber||"",onChange:e=>U({target:{name:"contactNumber",value:e}}),icon:Phone}),jsxRuntimeExports.jsx(InputUI,{id:"address-profile",type:"text",label:"Dirección",value:N.address||"",onChange:e=>U({target:{name:"address",value:e}}),icon:MapPin}),jsxRuntimeExports.jsx(DatepickerUI,{id:"dateOfBirth-profile",label:"Fecha de Nacimiento",value:N.dateOfBirth||null,onChange:e=>((e,t)=>{F(e),C(a=>__spreadProps(__spreadValues({},a),{[e]:t}))})("dateOfBirth",e),type:"date",formatString:"yyyy-MM-dd",placeholder:"DD-MM-AAAA",icon:Calendar}),jsxRuntimeExports.jsx(SelectUI$1,{id:"genderId-profile",label:"Género",value:(null==(a=N.genderId)?void 0:a.toString())||"",onChange:e=>L("genderId",e.toString()),options:[{value:"",label:"--Seleccione género--"},{value:"1",label:"Masculino"},{value:"2",label:"Femenino"},{value:"3",label:"Otro"}],icon:Users,placeholder:"--Seleccione género--"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(SelectUI$1,{id:"documentTypeId-profile",label:"Tipo de Documento *",value:(null==(r=N.documentTypeId)?void 0:r.toString())||"",onChange:e=>L("documentTypeId",e.toString()),options:[{value:"",label:"--Seleccione un tipo de documento--"},...v.map(e=>({value:e.documentTypeId.toString(),label:e.documentName||""}))],icon:FileText,required:!0,placeholder:"--Seleccione un tipo de documento--"}),m&&d.documentTypeId&&jsxRuntimeExports.jsx("span",{className:"text-sm mt-1",style:{color:"var(--color-error-main)"},children:d.documentTypeId})]}),jsxRuntimeExports.jsx(InputUI,{id:"documentNumber-profile",type:"text",label:"Número de Documento *",value:N.documentNumber||"",onChange:e=>U({target:{name:"documentNumber",value:e}}),icon:FileText,required:!0,hasError:m&&!!d.documentNumber,errorMessage:d.documentNumber}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(SelectUI$1,{id:"profileTypeId-profile",label:"Perfil *",value:(null==(s=N.profileTypeId)?void 0:s.toString())||"",onChange:e=>L("profileTypeId",e.toString()),options:[{value:"",label:"--Seleccione un perfil--"},...g.map(e=>({value:e.profileTypeId.toString(),label:e.profileName}))],required:!0,icon:Briefcase,placeholder:"--Seleccione un perfil--",disabled:!0}),m&&d.profileTypeId&&jsxRuntimeExports.jsx("span",{className:"text-sm mt-1",style:{color:"var(--color-error-main)"},children:d.profileTypeId})]}),jsxRuntimeExports.jsx(InputUI,{id:"username-profile",type:"text",label:"Usuario",value:N.username||"",onChange:e=>U({target:{name:"username",value:e}}),placeholder:"Dejar en blanco para mantener actual",icon:UserCheck}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{htmlFor:"password-profile",className:"block text-sm font-medium text-gray-700 mb-1",children:"Contraseña"}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx(Lock,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),jsxRuntimeExports.jsx("input",{id:"password-profile",name:"password",type:x?"text":"password",className:"pl-10 w-full px-4 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-200",placeholder:"Dejar en blanco para mantener actual",value:N.password||"",onChange:e=>U(e)}),jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>{h(!x)},className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 focus:outline-none",children:x?jsxRuntimeExports.jsx(EyeOff,{size:20}):jsxRuntimeExports.jsx(Eye,{size:20})})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(SelectUI$1,{id:"statusTypeId-profile",label:"Estado *",value:(null==(n=N.statusTypeId)?void 0:n.toString())||"1",onChange:e=>L("statusTypeId",e.toString()),options:[{value:"",label:"--Seleccione un estado--"},...y.map(e=>({value:e.statusTypeId.toString(),label:e.statusName}))],required:!0,icon:CheckCircle,placeholder:"--Seleccione un estado--"}),m&&d.statusTypeId&&jsxRuntimeExports.jsx("span",{className:"text-sm mt-1",style:{color:"var(--color-error-main)"},children:d.statusTypeId})]})]})]})})}function Header({user:e,onMenuClick:t,onLogout:a}){var r,s;const[n,i]=reactExports.useState(!1),[o,l]=reactExports.useState(!1),[c,d]=reactExports.useState(!1),u=reactExports.useRef(null),m=useNavigate(),p=reactExports.useMemo(()=>new AuthService,[]),{getLogoSrc:x}=useBranding(),{fullName:h,hierarchy:g,profile:y}=useUserData(),v={background:"var(--color-primary-mint)",borderBottom:"1px solid var(--color-primary-admin)",color:"var(--color-primary-admin)"},E={color:"var(--color-primary-admin)",borderColor:"var(--color-primary-admin)"},f={backgroundColor:"var(--color-action-edit)",color:"var(--color-text-inverse)"},b={borderColor:"var(--color-primary-admin)"},j={color:"var(--color-navy-main)",backgroundColor:"transparent",fontSize:"18px",fontWeight:"bold"},R=reactExports.useMemo(()=>({initial:{rotate:0},animate:{rotate:[-45,0,45,0],transition:{duration:4,times:[0,.33,.66,1],ease:"easeInOut"}}}),[]),I=reactExports.useMemo(()=>({initial:{x:0},animate:{x:[20,0,-20,0],transition:{duration:4,times:[0,.33,.66,1],ease:"easeInOut"}}}),[]),S=mockNotifications.filter(e=>!e.read).length,_=reactExports.useCallback(()=>{i(window.innerWidth<768)},[]);reactExports.useEffect(()=>(_(),window.addEventListener("resize",_),()=>{window.removeEventListener("resize",_)}),[_]),reactExports.useEffect(()=>{const e=e=>{u.current&&!u.current.contains(e.target)&&l(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);const N=reactExports.useCallback(()=>{l(!1),p.logout(),a(),m("/login")},[p,a,m]),C=reactExports.useCallback(()=>{l(!1),d(!0)},[]),T=reactExports.useCallback(()=>{d(!1)},[]);return n?jsxRuntimeExports.jsxs("header",{className:"shadow-lg border-b relative z-50",style:v,children:[jsxRuntimeExports.jsx("div",{className:"max-w-7xl mx-auto px-2",children:jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center py-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("button",{onClick:t,"aria-label":"Menú principal",className:"p-2 rounded-md hover:bg-white focus:outline-none focus:ring-2 focus:ring-inset",style:E,children:jsxRuntimeExports.jsx(Menu,{className:"h-5 w-5"})}),jsxRuntimeExports.jsxs("div",{className:"ml-2 flex items-center",children:[jsxRuntimeExports.jsx(motion.div,{variants:R,initial:"initial",animate:"animate",children:jsxRuntimeExports.jsx("img",{src:x("primary"),alt:"HatibaLink Logo",className:"h-8 w-auto mr-2"})}),jsxRuntimeExports.jsx(motion.div,{variants:I,initial:"initial",animate:"animate",children:jsxRuntimeExports.jsx("img",{src:x("secondary"),alt:"HatibaLink Text",className:"h-5 w-auto"})})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx("div",{style:j,children:(null==(r=g.condo)?void 0:r.name)||"Condominio"}),jsxRuntimeExports.jsx("div",{className:"relative",children:jsxRuntimeExports.jsxs("button",{className:"relative p-1 hover:opacity-80",style:E,children:[jsxRuntimeExports.jsx(Bell,{className:"h-4 w-4"}),jsxRuntimeExports.jsx("span",{className:"absolute top-0 right-0 block h-3 w-3 rounded-full text-[10px] text-white flex items-center justify-center",style:f,children:"5"})]})}),jsxRuntimeExports.jsxs("div",{className:"relative",ref:u,children:[jsxRuntimeExports.jsx("button",{onClick:()=>l(!o),className:"rounded-full ring-1 border-2 border-white cursor-pointer",style:b,children:jsxRuntimeExports.jsx("img",{style:{height:"55px",width:"55px"},className:"rounded-full ring-1 border-2 border-white",src:e.avatar,alt:h||e.name})}),o&&jsxRuntimeExports.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-10",children:[jsxRuntimeExports.jsxs("button",{onClick:C,className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[jsxRuntimeExports.jsx(User,{className:"mr-2 h-4 w-4"}),"Mi Perfil"]}),jsxRuntimeExports.jsxs("button",{onClick:N,className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[jsxRuntimeExports.jsx(LogOut,{className:"mr-2 h-4 w-4"}),"Cerrar sesión"]})]})]})]})]})}),jsxRuntimeExports.jsx(AlertProvider,{children:jsxRuntimeExports.jsx(MyProfileModal,{isOpen:c,onClose:T})})]}):jsxRuntimeExports.jsxs("header",{className:"shadow-lg border-b relative z-50",style:v,children:[jsxRuntimeExports.jsx("div",{className:"w-full mx-auto px-4 sm:px-6 lg:px-8",children:jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center py-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("button",{onClick:t,className:"p-2 rounded-md hover:bg-white focus:outline-none focus:ring-2 focus:ring-inset",style:E,children:jsxRuntimeExports.jsx(Menu,{className:"h-6 w-6"})}),jsxRuntimeExports.jsxs("div",{className:"ml-4 flex items-center",children:[jsxRuntimeExports.jsx(motion.div,{variants:R,initial:"initial",animate:"animate",children:jsxRuntimeExports.jsx("img",{src:x("primary"),alt:"HatibaLink Logo",className:"h-10 w-auto mr-3"})}),jsxRuntimeExports.jsx(motion.div,{variants:I,initial:"initial",animate:"animate",children:jsxRuntimeExports.jsx("img",{src:x("secondary"),alt:"HatibaLink Text",className:"h-6 w-auto"})})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-6",children:[jsxRuntimeExports.jsx("div",{className:"flex-1 flex justify-center",children:jsxRuntimeExports.jsx("div",{style:j,children:(null==(s=g.condo)?void 0:s.name)||"Condominio"})}),jsxRuntimeExports.jsx("div",{className:"relative",children:jsxRuntimeExports.jsxs("button",{className:"relative p-2 hover:opacity-80",style:E,children:[jsxRuntimeExports.jsx(Bell,{className:"h-6 w-6"}),S>0&&jsxRuntimeExports.jsx("span",{className:"absolute top-0 right-0 block h-4 w-4 rounded-full text-xs text-white flex items-center justify-center",style:f,children:S})]})}),jsxRuntimeExports.jsxs("div",{className:"relative",ref:u,children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-3 cursor-pointer",onClick:()=>l(!o),children:[jsxRuntimeExports.jsx("img",{className:"h-8 w-8 rounded-full ring-2",style:b,src:e.avatar,alt:h||e.name}),jsxRuntimeExports.jsx("div",{className:"flex flex-col",children:jsxRuntimeExports.jsx("span",{className:"text-sm font-medium",style:E,title:`Perfil: ${y.isAdmin?"Administrador":y.isResident?"Residente":"Staff"} (ID: ${y.typeId})`,children:h||e.name})})]}),o&&jsxRuntimeExports.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-10",children:[jsxRuntimeExports.jsxs("button",{onClick:C,className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[jsxRuntimeExports.jsx(User,{className:"mr-2 h-4 w-4"}),"Mi Perfil"]}),jsxRuntimeExports.jsxs("button",{onClick:N,className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[jsxRuntimeExports.jsx(LogOut,{className:"mr-2 h-4 w-4"}),"Cerrar sesión"]})]})]})]})]})}),jsxRuntimeExports.jsx(AlertProvider,{children:jsxRuntimeExports.jsx(MyProfileModal,{isOpen:c,onClose:T})})]})}var Action=(e=>(e.VIEW="view",e.CREATE="create",e.EDIT="edit",e.DELETE="delete",e.MANAGE="manage",e.EXPORT="export",e.IMPORT="import",e.APPROVE="approve",e.REJECT="reject",e))(Action||{}),Resource=(e=>(e.DASHBOARD="dashboard",e.CONDOMINIUMS="condominiums",e.PAYMENTS="payments",e.COMMON_AREAS="common_areas",e.VISITS="visits",e.INCIDENTS="incidents",e.MAINTENANCE="maintenance",e.INFORMATION="information",e.SETTINGS="settings",e.RESIDENTS="residents",e))(Resource||{}),SubResource=(e=>(e.DASHBOARD_GENERAL="dashboard.general",e.DASHBOARD_INDICATORS="dashboard.indicators",e.DASHBOARD_CALENDAR="dashboard.calendar",e.CONDOMINIUMS_LIST="condominiums.list",e.CONDOMINIUMS_DATA_BULK="condominiums.data_bulk",e.CONDOMINIUMS_DEPARTMENTS="condominiums.departments",e.CONDOMINIUMS_COMMON_AREAS="condominiums.common_areas",e.PAYMENTS_MONTHLY="payments.monthly",e.PAYMENTS_LIST="payments.list",e.PAYMENTS_OVERDUE="payments.overdue",e.COMMON_AREAS_BOOKINGS="common_areas.bookings",e.COMMON_AREAS_SCHEDULES="common_areas.schedules",e.VISITS_REGISTRY="visits.registry",e.INCIDENTS_REPORTS="incidents.reports",e.INCIDENTS_LOG="incidents.log",e.INCIDENTS_TYPES="incidents.types",e.MAINTENANCE_PREVENTIVE="maintenance.preventive",e.MAINTENANCE_CORRECTIVE="maintenance.corrective",e.INFORMATION_DOCUMENTS="information.documents",e.SETTINGS_USERS="settings.users",e.SETTINGS_SYSTEM_PARAMETERS="settings.system_parameters",e.RESIDENTS_MANAGEMENT="residents.management",e))(SubResource||{}),UserRole=(e=>(e.SUPER_ADMIN="super_admin",e.ADMIN_COMPANY="admin_company",e.ADMIN_CONDO="admin_condo",e.SECURITY="security",e.MAINTENANCE="maintenance",e.RESIDENT="resident",e.TENANT="tenant",e))(UserRole||{});const createPermission=(e,t,a)=>({resource:e,action:t,conditions:a}),createResourcePermissions=(e,t,a)=>t.map(t=>createPermission(e,t,a)),ROLE_PERMISSIONS={[UserRole.SUPER_ADMIN]:[...createResourcePermissions(Resource.DASHBOARD,[Action.VIEW,Action.MANAGE]),...createResourcePermissions(SubResource.DASHBOARD_GENERAL,[Action.VIEW,Action.MANAGE]),...createResourcePermissions(SubResource.DASHBOARD_INDICATORS,[Action.VIEW,Action.MANAGE]),...createResourcePermissions(SubResource.DASHBOARD_CALENDAR,[Action.VIEW,Action.MANAGE]),...createResourcePermissions(Resource.CONDOMINIUMS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT,Action.IMPORT]),...createResourcePermissions(SubResource.CONDOMINIUMS_LIST,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT,Action.IMPORT]),...createResourcePermissions(SubResource.CONDOMINIUMS_DATA_BULK,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT,Action.IMPORT]),...createResourcePermissions(SubResource.CONDOMINIUMS_DEPARTMENTS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT,Action.IMPORT]),...createResourcePermissions(SubResource.CONDOMINIUMS_COMMON_AREAS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT,Action.IMPORT]),...createResourcePermissions(Resource.PAYMENTS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT,Action.APPROVE]),...createResourcePermissions(SubResource.PAYMENTS_MONTHLY,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT,Action.APPROVE]),...createResourcePermissions(SubResource.PAYMENTS_LIST,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT,Action.APPROVE]),...createResourcePermissions(SubResource.PAYMENTS_OVERDUE,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT,Action.APPROVE]),...createResourcePermissions(Resource.COMMON_AREAS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT]),...createResourcePermissions(SubResource.COMMON_AREAS_BOOKINGS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT,Action.APPROVE,Action.REJECT]),...createResourcePermissions(SubResource.COMMON_AREAS_SCHEDULES,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT]),...createResourcePermissions(Resource.VISITS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT]),...createResourcePermissions(SubResource.VISITS_REGISTRY,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT]),...createResourcePermissions(Resource.INCIDENTS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT]),...createResourcePermissions(SubResource.INCIDENTS_REPORTS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT]),...createResourcePermissions(SubResource.INCIDENTS_LOG,[Action.VIEW,Action.EXPORT]),...createResourcePermissions(SubResource.INCIDENTS_TYPES,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE]),...createResourcePermissions(Resource.MAINTENANCE,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT]),...createResourcePermissions(SubResource.MAINTENANCE_PREVENTIVE,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT]),...createResourcePermissions(SubResource.MAINTENANCE_CORRECTIVE,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT]),...createResourcePermissions(Resource.INFORMATION,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT]),...createResourcePermissions(SubResource.INFORMATION_DOCUMENTS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT]),...createResourcePermissions(Resource.SETTINGS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE]),...createResourcePermissions(SubResource.SETTINGS_USERS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE]),...createResourcePermissions(SubResource.SETTINGS_SYSTEM_PARAMETERS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE]),...createResourcePermissions(Resource.RESIDENTS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT]),...createResourcePermissions(SubResource.RESIDENTS_MANAGEMENT,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT])],[UserRole.ADMIN_COMPANY]:[...createResourcePermissions(Resource.DASHBOARD,[Action.VIEW]),...createResourcePermissions(SubResource.DASHBOARD_GENERAL,[Action.VIEW]),...createResourcePermissions(SubResource.DASHBOARD_INDICATORS,[Action.VIEW]),...createResourcePermissions(Resource.CONDOMINIUMS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT,Action.IMPORT]),...createResourcePermissions(SubResource.CONDOMINIUMS_LIST,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT,Action.IMPORT]),...createResourcePermissions(SubResource.CONDOMINIUMS_DATA_BULK,[Action.VIEW,Action.CREATE,Action.EDIT,Action.IMPORT]),...createResourcePermissions(SubResource.CONDOMINIUMS_DEPARTMENTS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT]),...createResourcePermissions(SubResource.CONDOMINIUMS_COMMON_AREAS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE]),...createResourcePermissions(Resource.PAYMENTS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.MANAGE,Action.EXPORT]),...createResourcePermissions(SubResource.PAYMENTS_MONTHLY,[Action.VIEW,Action.CREATE,Action.EDIT,Action.MANAGE,Action.EXPORT]),...createResourcePermissions(SubResource.PAYMENTS_LIST,[Action.VIEW,Action.CREATE,Action.EDIT,Action.MANAGE,Action.EXPORT]),...createResourcePermissions(SubResource.PAYMENTS_OVERDUE,[Action.VIEW,Action.MANAGE,Action.EXPORT]),...createResourcePermissions(Resource.COMMON_AREAS,[Action.VIEW,Action.MANAGE]),...createResourcePermissions(SubResource.COMMON_AREAS_BOOKINGS,[Action.VIEW,Action.MANAGE,Action.EXPORT]),...createResourcePermissions(SubResource.COMMON_AREAS_SCHEDULES,[Action.VIEW,Action.CREATE,Action.EDIT,Action.MANAGE]),...createResourcePermissions(Resource.INCIDENTS,[Action.VIEW,Action.EXPORT]),...createResourcePermissions(SubResource.INCIDENTS_REPORTS,[Action.VIEW,Action.EXPORT]),...createResourcePermissions(SubResource.INCIDENTS_LOG,[Action.VIEW,Action.EXPORT]),...createResourcePermissions(Resource.INFORMATION,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE]),...createResourcePermissions(SubResource.INFORMATION_DOCUMENTS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE]),...createResourcePermissions(Resource.SETTINGS,[Action.VIEW,Action.MANAGE]),...createResourcePermissions(SubResource.SETTINGS_USERS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE]),...createResourcePermissions(Resource.RESIDENTS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT]),...createResourcePermissions(SubResource.RESIDENTS_MANAGEMENT,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT])],[UserRole.ADMIN_CONDO]:[...createResourcePermissions(Resource.DASHBOARD,[Action.VIEW]),...createResourcePermissions(SubResource.DASHBOARD_GENERAL,[Action.VIEW]),...createResourcePermissions(SubResource.DASHBOARD_INDICATORS,[Action.VIEW]),...createResourcePermissions(Resource.CONDOMINIUMS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT,Action.IMPORT]),...createResourcePermissions(SubResource.CONDOMINIUMS_LIST,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT,Action.IMPORT]),...createResourcePermissions(SubResource.CONDOMINIUMS_DATA_BULK,[Action.VIEW,Action.CREATE,Action.EDIT,Action.IMPORT]),...createResourcePermissions(SubResource.CONDOMINIUMS_DEPARTMENTS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT]),...createResourcePermissions(SubResource.CONDOMINIUMS_COMMON_AREAS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE]),...createResourcePermissions(Resource.PAYMENTS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.MANAGE,Action.EXPORT]),...createResourcePermissions(SubResource.PAYMENTS_MONTHLY,[Action.VIEW,Action.CREATE,Action.EDIT,Action.MANAGE,Action.EXPORT]),...createResourcePermissions(SubResource.PAYMENTS_LIST,[Action.VIEW,Action.CREATE,Action.EDIT,Action.MANAGE,Action.EXPORT]),...createResourcePermissions(SubResource.PAYMENTS_OVERDUE,[Action.VIEW,Action.MANAGE,Action.EXPORT]),...createResourcePermissions(Resource.COMMON_AREAS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE]),...createResourcePermissions(SubResource.COMMON_AREAS_BOOKINGS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.APPROVE,Action.REJECT]),...createResourcePermissions(SubResource.COMMON_AREAS_SCHEDULES,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE]),...createResourcePermissions(Resource.VISITS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT]),...createResourcePermissions(SubResource.VISITS_REGISTRY,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT]),...createResourcePermissions(Resource.INCIDENTS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT]),...createResourcePermissions(SubResource.INCIDENTS_REPORTS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT]),...createResourcePermissions(SubResource.INCIDENTS_LOG,[Action.VIEW,Action.EXPORT]),...createResourcePermissions(SubResource.INCIDENTS_TYPES,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE]),...createResourcePermissions(Resource.MAINTENANCE,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT]),...createResourcePermissions(SubResource.MAINTENANCE_PREVENTIVE,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT]),...createResourcePermissions(SubResource.MAINTENANCE_CORRECTIVE,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE,Action.EXPORT]),...createResourcePermissions(Resource.INFORMATION,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE]),...createResourcePermissions(SubResource.INFORMATION_DOCUMENTS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE]),...createResourcePermissions(Resource.SETTINGS,[Action.VIEW,Action.MANAGE]),...createResourcePermissions(SubResource.SETTINGS_USERS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE]),...createResourcePermissions(Resource.RESIDENTS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.MANAGE,Action.EXPORT]),...createResourcePermissions(SubResource.RESIDENTS_MANAGEMENT,[Action.VIEW,Action.CREATE,Action.EDIT,Action.MANAGE,Action.EXPORT])],[UserRole.SECURITY]:[...createResourcePermissions(SubResource.DASHBOARD_GENERAL,[Action.VIEW]),...createResourcePermissions(Resource.VISITS,[Action.VIEW,Action.CREATE,Action.EDIT,Action.MANAGE]),...createResourcePermissions(SubResource.VISITS_REGISTRY,[Action.VIEW,Action.CREATE,Action.EDIT,Action.MANAGE]),...createResourcePermissions(Resource.INCIDENTS,[Action.VIEW,Action.CREATE]),...createResourcePermissions(SubResource.INCIDENTS_REPORTS,[Action.VIEW,Action.CREATE]),...createResourcePermissions(SubResource.INCIDENTS_LOG,[Action.VIEW]),...createResourcePermissions(SubResource.COMMON_AREAS_BOOKINGS,[Action.VIEW]),...createResourcePermissions(SubResource.INFORMATION_DOCUMENTS,[Action.VIEW])],[UserRole.MAINTENANCE]:[...createResourcePermissions(SubResource.DASHBOARD_GENERAL,[Action.VIEW]),...createResourcePermissions(Resource.INCIDENTS,[Action.VIEW,Action.CREATE,Action.EDIT]),...createResourcePermissions(SubResource.INCIDENTS_REPORTS,[Action.VIEW,Action.CREATE,Action.EDIT]),...createResourcePermissions(SubResource.INCIDENTS_LOG,[Action.VIEW]),...createResourcePermissions(Resource.MAINTENANCE,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE]),...createResourcePermissions(SubResource.MAINTENANCE_PREVENTIVE,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE]),...createResourcePermissions(SubResource.MAINTENANCE_CORRECTIVE,[Action.VIEW,Action.CREATE,Action.EDIT,Action.DELETE,Action.MANAGE]),...createResourcePermissions(SubResource.CONDOMINIUMS_COMMON_AREAS,[Action.VIEW]),...createResourcePermissions(SubResource.INFORMATION_DOCUMENTS,[Action.VIEW])],[UserRole.RESIDENT]:[...createResourcePermissions(SubResource.DASHBOARD_GENERAL,[Action.VIEW]),...createResourcePermissions(SubResource.PAYMENTS_LIST,[Action.VIEW]),...createResourcePermissions(SubResource.PAYMENTS_MONTHLY,[Action.VIEW]),...createResourcePermissions(Resource.COMMON_AREAS,[Action.VIEW,Action.CREATE]),...createResourcePermissions(SubResource.COMMON_AREAS_BOOKINGS,[Action.VIEW,Action.CREATE]),...createResourcePermissions(SubResource.COMMON_AREAS_SCHEDULES,[Action.VIEW]),...createResourcePermissions(SubResource.VISITS_REGISTRY,[Action.VIEW,Action.CREATE]),...createResourcePermissions(SubResource.INCIDENTS_REPORTS,[Action.VIEW,Action.CREATE]),...createResourcePermissions(SubResource.INFORMATION_DOCUMENTS,[Action.VIEW])],[UserRole.TENANT]:[...createResourcePermissions(SubResource.DASHBOARD_GENERAL,[Action.VIEW]),...createResourcePermissions(SubResource.COMMON_AREAS_SCHEDULES,[Action.VIEW]),...createResourcePermissions(SubResource.VISITS_REGISTRY,[Action.VIEW,Action.CREATE]),...createResourcePermissions(SubResource.INCIDENTS_REPORTS,[Action.CREATE]),...createResourcePermissions(SubResource.INFORMATION_DOCUMENTS,[Action.VIEW])]},getRolePermissions=e=>ROLE_PERMISSIONS[e]||[],canAccessMainMenu=(e,t)=>{const a=getRolePermissions(e);if(a.some(e=>e.resource===t&&e.action===Action.VIEW))return!0;return a.some(e=>!("string"!=typeof e.resource||!e.resource.startsWith(`${t}.`))&&e.action===Action.VIEW)},getAccessibleSubMenus=(e,t)=>{const a=getRolePermissions(e),r=[];return a.forEach(e=>{"string"==typeof e.resource&&e.resource.startsWith(`${t}.`)&&e.action===Action.VIEW&&r.push(e.resource)}),r},AuthorizationContext=reactExports.createContext(void 0),ROUTE_TO_RESOURCE_MAP={"/dashboard":{resource:Resource.DASHBOARD},"/dashboard/general":{subResource:SubResource.DASHBOARD_GENERAL},"/dashboard/indicators":{subResource:SubResource.DASHBOARD_INDICATORS},"/dashboard/calendar":{subResource:SubResource.DASHBOARD_CALENDAR},"/condominiums":{resource:Resource.CONDOMINIUMS},"/condominiums/list":{subResource:SubResource.CONDOMINIUMS_LIST},"/condominiums/data-bulk":{subResource:SubResource.CONDOMINIUMS_DATA_BULK},"/condominiums/departments":{subResource:SubResource.CONDOMINIUMS_DEPARTMENTS},"/condominiums/common-areas":{subResource:SubResource.CONDOMINIUMS_COMMON_AREAS},"/payments":{resource:Resource.PAYMENTS},"/payments/monthly":{subResource:SubResource.PAYMENTS_MONTHLY},"/payments/list":{subResource:SubResource.PAYMENTS_LIST},"/payments/overdue":{subResource:SubResource.PAYMENTS_OVERDUE},"/common-areas":{resource:Resource.COMMON_AREAS},"/common-areas/bookings":{subResource:SubResource.COMMON_AREAS_BOOKINGS},"/common-areas/schedules":{subResource:SubResource.COMMON_AREAS_SCHEDULES},"/visits":{resource:Resource.VISITS},"/visits/registry":{subResource:SubResource.VISITS_REGISTRY},"/incidents":{resource:Resource.INCIDENTS},"/incidents/reports":{subResource:SubResource.INCIDENTS_REPORTS},"/incidents/log":{subResource:SubResource.INCIDENTS_LOG},"/incidents/types":{subResource:SubResource.INCIDENTS_TYPES},"/maintenance":{resource:Resource.MAINTENANCE},"/maintenance/preventive":{subResource:SubResource.MAINTENANCE_PREVENTIVE},"/maintenance/corrective":{subResource:SubResource.MAINTENANCE_CORRECTIVE},"/information":{resource:Resource.INFORMATION},"/information/documents":{subResource:SubResource.INFORMATION_DOCUMENTS},"/settings":{resource:Resource.SETTINGS},"/settings/users":{subResource:SubResource.SETTINGS_USERS},"/settings/system-parameters":{subResource:SubResource.SETTINGS_SYSTEM_PARAMETERS},"/residents":{resource:Resource.RESIDENTS},"/residents/management":{subResource:SubResource.RESIDENTS_MANAGEMENT}},AuthorizationProvider=({children:e,user:t})=>{const a=reactExports.useMemo(()=>{if(!t)return[];return[...getRolePermissions(t.role),...t.customPermissions||[]]},[t]),r=reactExports.useCallback(e=>!e||0===e.length||!!t&&e.every(e=>{const a=t[e.field];switch(e.operator){case"equals":return a===e.value;case"not_equals":return a!==e.value;case"in":return!!Array.isArray(e.value)&&e.value.includes(a);case"not_in":return!Array.isArray(e.value)||!e.value.includes(a);case"greater_than":return a>e.value;case"less_than":return a<e.value;default:return!1}}),[t]),s=reactExports.useCallback((e,s,n)=>{if(!t)return!1;return!!a.some(t=>t.resource===e&&t.action===s&&r(t.conditions))&&r(n)},[t,a,r]),n=reactExports.useCallback(e=>e.some(({resource:e,action:t})=>s(e,t)),[s]),i=reactExports.useCallback(e=>e.every(({resource:e,action:t})=>s(e,t)),[s]),o=reactExports.useCallback(e=>!!t&&canAccessMainMenu(t.role,e),[t]),l=reactExports.useCallback(e=>s(e,Action.VIEW),[s]),c=reactExports.useCallback(()=>t?Object.values(Resource).filter(e=>o(e)):[],[t,o]),d=reactExports.useCallback(e=>t?getAccessibleSubMenus(t.role,e).filter(e=>s(e,Action.VIEW)):[],[t,s]),u=reactExports.useCallback(e=>{if(!t)return!1;const a=e.split("?")[0].split("#")[0],r=ROUTE_TO_RESOURCE_MAP[a];if(r){if(r.subResource)return s(r.subResource,Action.VIEW);if(r.resource)return o(r.resource)}for(const[t,n]of Object.entries(ROUTE_TO_RESOURCE_MAP))if(a.startsWith(t)){if(n.subResource)return s(n.subResource,Action.VIEW);if(n.resource)return o(n.resource)}return!1},[t,s,o]),m=reactExports.useCallback(e=>s(e,Action.VIEW),[s]),p=reactExports.useCallback(e=>s(e,Action.CREATE),[s]),x=reactExports.useCallback(e=>s(e,Action.EDIT),[s]),h=reactExports.useCallback(e=>s(e,Action.DELETE),[s]),g=reactExports.useCallback(e=>s(e,Action.MANAGE),[s]),y=reactExports.useCallback(e=>s(e,Action.EXPORT),[s]),v=reactExports.useCallback(e=>s(e,Action.APPROVE),[s]),E=reactExports.useCallback(e=>s(e,Action.REJECT),[s]),f=reactExports.useMemo(()=>({user:t,userPermissions:a,hasPermission:s,hasAnyPermission:n,hasAllPermissions:i,canAccessMenu:o,canAccessSubMenu:l,getAccessibleMenus:c,getAccessibleSubMenusForMenu:d,canAccessRoute:u,canView:m,canCreate:p,canEdit:x,canDelete:h,canManage:g,canExport:y,canApprove:v,canReject:E}),[t,a,s,n,i,o,l,c,d,u,m,p,x,h,g,y,v,E]);return jsxRuntimeExports.jsx(AuthorizationContext.Provider,{value:f,children:e})},useAuthorization=()=>{const e=reactExports.useContext(AuthorizationContext);if(void 0===e)throw new Error("useAuthorization debe ser usado dentro de un AuthorizationProvider");return e},AuthContext=reactExports.createContext(void 0),AuthProvider=({children:e})=>{const t=reactExports.useMemo(()=>new AuthService,[]),{refreshLogos:a}=useBranding(),[r,s]=reactExports.useState(null),[n,i]=reactExports.useState(!1),[o,l]=reactExports.useState(!1),[c,d]=reactExports.useState(null),u=reactExports.useCallback(e=>__async(void 0,null,function*(){var r;l(!0),d(null);try{const n=yield t.login(e);if(n.isSuccess&&(null==(r=n.data)?void 0:r.data)){const e=n.data.data;return s(e),i(!0),d(null),setTimeout(()=>{a()},500),!0}return d(n.error||"Error en el login"),!1}catch(n){const e=n instanceof Error?n.message:"Error desconocido";return d(e),!1}finally{l(!1)}}),[t,a]),m=reactExports.useCallback(()=>{t.logout(),s(null),i(!1),d(null)},[t]),p=reactExports.useCallback(()=>{try{const e=t.isAuthenticated(),a=e?t.getUser():null;return i(e),s(a),e}catch(e){const t=e instanceof Error?e.message:"Error al verificar autenticación";return i(!1),s(null),d(t),!1}},[t]),x=reactExports.useCallback(()=>{d(null)},[]),h=reactExports.useCallback(e=>{s(e),i(!!e)},[]),g=reactExports.useCallback(()=>{try{const e=t.getUser();s(e),i(!!e)}catch(e){s(null),i(!1)}},[t]),y=reactExports.useMemo(()=>({user:r,isAuthenticated:n,isLoading:o,error:c,login:u,logout:m,checkAuth:p,clearError:x,setUser:h,refreshUser:g}),[r,n,o,c,u,m,p,x,h,g]);return jsxRuntimeExports.jsx(AuthContext.Provider,{value:y,children:e})},useAuth=()=>{const e=reactExports.useContext(AuthContext);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e},KPICard=({title:e,value:t,subtitle:a,icon:r,trend:s,trendValue:n,color:i,bgColor:o})=>jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:`${o} rounded-lg p-6 shadow-sm border border-gray-200`,children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:`p-2 rounded-lg ${i}`,children:jsxRuntimeExports.jsx(r,{className:"h-6 w-6 text-white"})}),jsxRuntimeExports.jsxs("div",{className:"ml-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-medium text-gray-600",children:e}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t}),a&&jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500",children:a})]})]}),s&&n&&jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[(()=>{switch(s){case"up":return jsxRuntimeExports.jsx(TrendingUp,{className:"h-4 w-4 text-green-500"});case"down":return jsxRuntimeExports.jsx(TrendingDown,{className:"h-4 w-4 text-red-500"});default:return null}})(),jsxRuntimeExports.jsx("span",{className:"ml-1 text-sm font-medium "+("up"===s?"text-green-500":"down"===s?"text-red-500":"text-gray-500"),children:n})]})]})});function AdministrativeDashboard(){const e=!1,t=!1,a=!1,r=!1,s=!1,n=!1,[i,o]=reactExports.useState(null),[l,c]=reactExports.useState(null),[d,u]=reactExports.useState(null),[m,p]=reactExports.useState(null),[x,h]=reactExports.useState(null),[g,y]=reactExports.useState(null),[v,E]=reactExports.useState(null),[f,b]=reactExports.useState(null),[j,R]=reactExports.useState(null),[I,S]=reactExports.useState(null),[_,N]=reactExports.useState(!0),[C,T]=reactExports.useState(null),{user:D}=useAuth(),A=new ManagementCompanyService;reactExports.useEffect(()=>{1===(null==D?void 0:D.profileTypeId)&&(null==D?void 0:D.companyId)||2===(null==D?void 0:D.profileTypeId)&&(null==D?void 0:D.condoId)?P():(N(!1),T("No se pudo identificar la empresa/condominio del usuario"),M())},[null==D?void 0:D.companyId,null==D?void 0:D.condoId,null==D?void 0:D.profileTypeId]);const P=()=>__async(this,null,function*(){let e={};if(1===(null==D?void 0:D.profileTypeId)&&(null==D?void 0:D.companyId))e={companyId:D.companyId};else{if(2!==(null==D?void 0:D.profileTypeId)||!(null==D?void 0:D.condoId))return;e={condominiumId:D.condoId}}try{N(!0),T(null);const t=yield A.getAdministrativeDashboard(e);t.isSuccess&&t.data?(S(t.data),w(t.data)):(T(t.error||"Error al cargar los datos del dashboard"),M())}catch(t){T("Error de conexión al cargar los datos"),M()}finally{N(!1)}}),w=e=>{c({occupancyPercentage:e.occupancy.occupancyPercentage,totalUnits:e.occupancy.totalUnits,occupiedUnits:e.occupancy.occupiedUnits,vacantUnits:e.occupancy.vacantUnits,ownerUnits:e.occupancy.ownerUnits,tenantUnits:e.occupancy.tenantUnits}),p({monthlyIncidents:e.incidents.monthlyIncidents,averageResponseTime:e.incidents.averageResponseTime,resolvedIncidents:e.incidents.resolvedIncidents,pendingIncidents:e.incidents.pendingIncidents,topIncidentTypes:e.incidents.topIncidentTypes.map(e=>({type:e.type,count:e.count}))}),y({occupancyPercentage:e.commonAreas.occupancyPercentage,rentalIncome:e.commonAreas.rentalIncome,activeReservations:e.commonAreas.activeReservations,topAreas:e.commonAreas.topAreas.map(e=>({area:e.area,usage:e.usage}))}),b({totalUsers:e.community.totalUsers,activeUsers:e.community.activeUsers,surveyParticipation:e.community.surveyParticipation})},M=()=>{N(!1),c({occupancyPercentage:0,totalUnits:0,occupiedUnits:0,vacantUnits:0,ownerUnits:0,tenantUnits:0}),y({occupancyPercentage:0,rentalIncome:0,activeReservations:0,topAreas:[]}),b({totalUsers:0,activeUsers:0,surveyParticipation:0}),p({monthlyIncidents:0,averageResponseTime:0,resolvedIncidents:0,pendingIncidents:0,topIncidentTypes:[]})};return _?jsxRuntimeExports.jsx("div",{className:"p-6 flex items-center justify-center min-h-64",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600",children:"Cargando datos del dashboard..."})]})}):jsxRuntimeExports.jsxs("div",{className:"p-6 space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard Administrativo"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600",children:"Resumen ejecutivo de la gestión del condominio"}),C&&jsxRuntimeExports.jsxs("p",{className:"text-sm text-red-600 mt-1",children:["⚠️ ",C," (Mostrando datos de ejemplo)"]})]}),jsxRuntimeExports.jsxs("div",{className:"text-right",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500",children:"Última actualización"}),jsxRuntimeExports.jsx("p",{className:"text-lg font-semibold",children:(new Date).toLocaleDateString()}),I&&jsxRuntimeExports.jsx("p",{className:"text-xs text-green-600",children:"✅ Datos reales cargados"})]})]}),e,jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[jsxRuntimeExports.jsx(Home,{className:"h-6 w-6 mr-2 text-blue-600"}),"Ocupación y Unidades"]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:l&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(KPICard,{title:"Ocupación",value:`${l.occupancyPercentage}%`,subtitle:`${l.occupiedUnits}/${l.totalUnits} unidades`,icon:Home,trend:"up",trendValue:"+3%",color:"bg-blue-600",bgColor:"bg-white"}),jsxRuntimeExports.jsx(KPICard,{title:"Unidades Vacías",value:l.vacantUnits,subtitle:"Disponibles para alquiler",icon:Home,color:"bg-orange-600",bgColor:"bg-white"}),jsxRuntimeExports.jsx(KPICard,{title:"Propietarios",value:l.ownerUnits,subtitle:`${Math.round(l.ownerUnits/l.totalUnits*100)}% del total`,icon:Users,color:"bg-purple-600",bgColor:"bg-white"}),jsxRuntimeExports.jsx(KPICard,{title:"Inquilinos",value:l.tenantUnits,subtitle:`${Math.round(l.tenantUnits/l.totalUnits*100)}% del total`,icon:UserCheck,color:"bg-indigo-600",bgColor:"bg-white"})]})})]}),n,t,jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[jsxRuntimeExports.jsx(MapPin,{className:"h-6 w-6 mr-2 text-purple-600"}),"Áreas Comunes"]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:g&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(KPICard,{title:"Ocupación",value:`${g.occupancyPercentage}%`,subtitle:`${g.activeReservations} reservas activas`,icon:Calendar,color:"bg-purple-600",bgColor:"bg-white"}),jsxRuntimeExports.jsx(KPICard,{title:"Ingresos por Alquiler",value:`$${g.rentalIncome.toLocaleString()}`,subtitle:"Este mes",icon:DollarSign,color:"bg-emerald-600",bgColor:"bg-white"})]})})]}),a,jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[jsxRuntimeExports.jsx(Users,{className:"h-6 w-6 mr-2 text-indigo-600"}),"Usuarios y Comunidad"]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:f&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(KPICard,{title:"Usuarios Registrados",value:f.totalUsers,subtitle:`${f.activeUsers} activos`,icon:Users,color:"bg-indigo-600",bgColor:"bg-white"}),jsxRuntimeExports.jsx(KPICard,{title:"Participación",value:`${f.surveyParticipation}%`,subtitle:"En encuestas/votaciones",icon:BarChart3,color:"bg-purple-600",bgColor:"bg-white"})]})})]}),r,s]})}const ServiceKPICard=({title:e,value:t,subtitle:a,icon:r,trend:s,trendValue:n,color:i,bgColor:o,size:l="md"})=>jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:`${o} rounded-lg ${{sm:"p-4",md:"p-5",lg:"p-6"}[l]} shadow-sm border border-gray-200 hover:shadow-md transition-shadow`,children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:`p-2 rounded-lg ${i}`,children:jsxRuntimeExports.jsx(r,{className:"h-5 w-5 text-white"})}),jsxRuntimeExports.jsxs("div",{className:"ml-3",children:[jsxRuntimeExports.jsx("h3",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide",children:e}),jsxRuntimeExports.jsx("p",{className:"text-xl font-bold text-gray-900",children:t}),a&&jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500",children:a})]})]}),s&&n&&jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[(()=>{switch(s){case"up":return jsxRuntimeExports.jsx(Activity,{className:"h-3 w-3 text-green-500"});case"down":return jsxRuntimeExports.jsx(Activity,{className:"h-3 w-3 text-red-500 rotate-180"});default:return null}})(),jsxRuntimeExports.jsx("span",{className:"ml-1 text-xs font-medium "+("up"===s?"text-green-500":"down"===s?"text-red-500":"text-gray-500"),children:n})]})]})});function ServicesDashboard(){const[e,t]=reactExports.useState(null),[a,r]=reactExports.useState(null),[s,n]=reactExports.useState(null),[i,o]=reactExports.useState(null);reactExports.useEffect(()=>{l()},[]);const l=()=>{t({visitsToday:28,currentVisitors:5,afterHoursAccess:3,securityAlerts:2,camerasOffline:1,camerasActive:15,averageVerificationTime:2.5,patrolsCompleted:8,patrolsScheduled:10,suspiciousReports:1}),r({openWorkOrders:12,completedWorkOrders:25,averageResponseTime:4.2,overdueEquipment:3,urgentAlerts:2,repairCostsByArea:[{area:"Plomería",cost:2500},{area:"Eléctrico",cost:1800},{area:"Ascensores",cost:3200}],userSatisfaction:4.3,criticalInventory:5,preventiveCompleted:18,preventiveScheduled:20}),n({tasksToday:15,tasksCompleted:12,packagesReceived:8,minorIncidents:3,unitsWithoutDelivery:2,activeHours:8.5,cleanAreas:12,pendingAreas:3,messagesDelivered:6}),o({newAlertsToday:7,shiftsCovered:22,shiftsTotal:24,totalTasksByRole:{security:15,maintenance:12,concierge:15},assignedIncidents:8,averageTaskResponseTime:3.2})};return jsxRuntimeExports.jsxs("div",{className:"p-6 space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard de Servicios"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600",children:"Panel de control para personal operativo"})]}),jsxRuntimeExports.jsxs("div",{className:"text-right",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500",children:"Turno actual"}),jsxRuntimeExports.jsx("p",{className:"text-lg font-semibold",children:(new Date).toLocaleTimeString()})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[jsxRuntimeExports.jsx(Activity,{className:"h-6 w-6 mr-2 text-gray-600"}),"Indicadores Generales"]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:i&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ServiceKPICard,{title:"Alertas Nuevas",value:i.newAlertsToday,subtitle:"Asignadas hoy",icon:AlertTriangle,color:"bg-red-600",bgColor:"bg-white",size:"sm"}),jsxRuntimeExports.jsx(ServiceKPICard,{title:"Turnos Cubiertos",value:`${i.shiftsCovered}/${i.shiftsTotal}`,subtitle:`${Math.round(i.shiftsCovered/i.shiftsTotal*100)}% cobertura`,icon:Clock,color:"bg-blue-600",bgColor:"bg-white",size:"sm"}),jsxRuntimeExports.jsx(ServiceKPICard,{title:"Incidentes Asignados",value:i.assignedIncidents,subtitle:"En proceso",icon:ClipboardList,color:"bg-orange-600",bgColor:"bg-white",size:"sm"}),jsxRuntimeExports.jsx(ServiceKPICard,{title:"Tiempo Respuesta",value:`${i.averageTaskResponseTime}h`,subtitle:"Promedio por tarea",icon:Timer,trend:"down",trendValue:"-0.8h",color:"bg-green-600",bgColor:"bg-white",size:"sm"}),jsxRuntimeExports.jsx(ServiceKPICard,{title:"Total Tareas",value:Object.values(i.totalTasksByRole).reduce((e,t)=>e+t,0),subtitle:"Todos los roles",icon:CheckCircle,color:"bg-purple-600",bgColor:"bg-white",size:"sm"})]})})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[jsxRuntimeExports.jsx(Shield,{className:"h-6 w-6 mr-2 text-blue-600"}),"Seguridad"]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:e&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ServiceKPICard,{title:"Visitas Hoy",value:e.visitsToday,subtitle:`${e.currentVisitors} visitantes actuales`,icon:Users,trend:"up",trendValue:"+12%",color:"bg-green-600",bgColor:"bg-white"}),jsxRuntimeExports.jsx(ServiceKPICard,{title:"Accesos Fuera de Horario",value:e.afterHoursAccess,subtitle:"Requieren verificación",icon:Clock,color:"bg-yellow-600",bgColor:"bg-white"}),jsxRuntimeExports.jsx(ServiceKPICard,{title:"Alertas de Seguridad",value:e.securityAlerts,subtitle:"Registradas hoy",icon:AlertTriangle,color:"bg-red-600",bgColor:"bg-white"}),jsxRuntimeExports.jsx(ServiceKPICard,{title:"Cámaras Activas",value:`${e.camerasActive}/${e.camerasActive+e.camerasOffline}`,subtitle:`${e.camerasOffline} fuera de servicio`,icon:Camera,color:"bg-blue-600",bgColor:"bg-white"}),jsxRuntimeExports.jsx(ServiceKPICard,{title:"Tiempo Verificación",value:`${e.averageVerificationTime} min`,subtitle:"Promedio de ingreso",icon:Timer,trend:"down",trendValue:"-0.5 min",color:"bg-emerald-600",bgColor:"bg-white"}),jsxRuntimeExports.jsx(ServiceKPICard,{title:"Patrullajes",value:`${e.patrolsCompleted}/${e.patrolsScheduled}`,subtitle:`${Math.round(e.patrolsCompleted/e.patrolsScheduled*100)}% completado`,icon:MapPin,color:"bg-indigo-600",bgColor:"bg-white"}),jsxRuntimeExports.jsx(ServiceKPICard,{title:"Reportes Sospechosos",value:e.suspiciousReports,subtitle:"Comportamiento anómalo",icon:AlertTriangle,color:"bg-orange-600",bgColor:"bg-white"})]})})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[jsxRuntimeExports.jsx(Wrench,{className:"h-6 w-6 mr-2 text-yellow-600"}),"Mantenimiento"]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:a&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ServiceKPICard,{title:"Órdenes de Trabajo",value:`${a.completedWorkOrders}/${a.openWorkOrders+a.completedWorkOrders}`,subtitle:`${a.openWorkOrders} abiertas`,icon:ClipboardList,color:"bg-blue-600",bgColor:"bg-white"}),jsxRuntimeExports.jsx(ServiceKPICard,{title:"Tiempo de Atención",value:`${a.averageResponseTime}h`,subtitle:"Promedio a fallas",icon:Clock,trend:"down",trendValue:"-1.2h",color:"bg-green-600",bgColor:"bg-white"}),jsxRuntimeExports.jsx(ServiceKPICard,{title:"Equipos Vencidos",value:a.overdueEquipment,subtitle:"Mantenimiento atrasado",icon:AlertTriangle,color:"bg-red-600",bgColor:"bg-white"}),jsxRuntimeExports.jsx(ServiceKPICard,{title:"Alertas Urgentes",value:a.urgentAlerts,subtitle:"Requieren atención inmediata",icon:XCircle,color:"bg-orange-600",bgColor:"bg-white"}),jsxRuntimeExports.jsx(ServiceKPICard,{title:"Costo Reparaciones",value:`$${a.repairCostsByArea.reduce((e,t)=>e+t.cost,0).toLocaleString()}`,subtitle:"Acumulado por área",icon:DollarSign,color:"bg-purple-600",bgColor:"bg-white"}),jsxRuntimeExports.jsx(ServiceKPICard,{title:"Satisfacción Usuario",value:`${a.userSatisfaction}/5`,subtitle:"Trabajos realizados",icon:Star,trend:"up",trendValue:"+0.2",color:"bg-yellow-600",bgColor:"bg-white"}),jsxRuntimeExports.jsx(ServiceKPICard,{title:"Inventario Crítico",value:a.criticalInventory,subtitle:"Repuestos/materiales",icon:Archive,color:"bg-red-600",bgColor:"bg-white"}),jsxRuntimeExports.jsx(ServiceKPICard,{title:"Preventivos",value:`${a.preventiveCompleted}/${a.preventiveScheduled}`,subtitle:`${Math.round(a.preventiveCompleted/a.preventiveScheduled*100)}% completado`,icon:CheckCircle,color:"bg-emerald-600",bgColor:"bg-white"})]})})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[jsxRuntimeExports.jsx(UserCheck,{className:"h-6 w-6 mr-2 text-green-600"}),"Conserje"]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:s&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ServiceKPICard,{title:"Tareas del Día",value:`${s.tasksCompleted}/${s.tasksToday}`,subtitle:`${Math.round(s.tasksCompleted/s.tasksToday*100)}% completado`,icon:CheckCircle,color:"bg-green-600",bgColor:"bg-white"}),jsxRuntimeExports.jsx(ServiceKPICard,{title:"Paquetería Recibida",value:s.packagesReceived,subtitle:"Entregas del día",icon:Package,color:"bg-blue-600",bgColor:"bg-white"}),jsxRuntimeExports.jsx(ServiceKPICard,{title:"Incidencias Menores",value:s.minorIncidents,subtitle:"Reportadas hoy",icon:AlertTriangle,color:"bg-yellow-600",bgColor:"bg-white"}),jsxRuntimeExports.jsx(ServiceKPICard,{title:"Unidades sin Entrega",value:s.unitsWithoutDelivery,subtitle:"Últimos 3 días",icon:XCircle,color:"bg-orange-600",bgColor:"bg-white"}),jsxRuntimeExports.jsx(ServiceKPICard,{title:"Horas Activas",value:`${s.activeHours}h`,subtitle:"En turno actual",icon:Clock,color:"bg-indigo-600",bgColor:"bg-white"}),jsxRuntimeExports.jsx(ServiceKPICard,{title:"Zonas Limpias",value:`${s.cleanAreas}/${s.cleanAreas+s.pendingAreas}`,subtitle:`${s.pendingAreas} pendientes`,icon:CheckCircle,color:"bg-emerald-600",bgColor:"bg-white"}),jsxRuntimeExports.jsx(ServiceKPICard,{title:"Comunicaciones",value:s.messagesDelivered,subtitle:"Avisos entregados",icon:MessageSquare,color:"bg-purple-600",bgColor:"bg-white"})]})})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Distribución de Tareas por Rol"}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:i&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg p-6 border border-blue-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center mb-4",children:[jsxRuntimeExports.jsx(Shield,{className:"h-8 w-8 text-blue-600 mr-3"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-blue-800",children:"Seguridad"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-blue-600",children:"Personal de vigilancia"})]})]}),jsxRuntimeExports.jsx("div",{className:"text-3xl font-bold text-blue-900 mb-2",children:i.totalTasksByRole.security}),jsxRuntimeExports.jsx("p",{className:"text-sm text-blue-700",children:"Tareas asignadas"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg p-6 border border-yellow-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center mb-4",children:[jsxRuntimeExports.jsx(Wrench,{className:"h-8 w-8 text-yellow-600 mr-3"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-yellow-800",children:"Mantenimiento"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-yellow-600",children:"Personal técnico"})]})]}),jsxRuntimeExports.jsx("div",{className:"text-3xl font-bold text-yellow-900 mb-2",children:i.totalTasksByRole.maintenance}),jsxRuntimeExports.jsx("p",{className:"text-sm text-yellow-700",children:"Tareas asignadas"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg p-6 border border-green-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center mb-4",children:[jsxRuntimeExports.jsx(UserCheck,{className:"h-8 w-8 text-green-600 mr-3"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-green-800",children:"Conserje"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-green-600",children:"Personal de servicio"})]})]}),jsxRuntimeExports.jsx("div",{className:"text-3xl font-bold text-green-900 mb-2",children:i.totalTasksByRole.concierge}),jsxRuntimeExports.jsx("p",{className:"text-sm text-green-700",children:"Tareas asignadas"})]})]})})]})]})}const ResidentKPICard=({title:e,value:t,subtitle:a,icon:r,status:s="info",trend:n,trendValue:i,onClick:o})=>{const l=(()=>{switch(s){case"success":return{bg:"bg-white",border:"border-green-200",icon:"bg-green-600",text:"text-green-800"};case"warning":return{bg:"bg-white",border:"border-yellow-200",icon:"bg-yellow-600",text:"text-yellow-800"};case"error":return{bg:"bg-white",border:"border-red-200",icon:"bg-red-600",text:"text-red-800"};default:return{bg:"bg-white",border:"border-blue-200",icon:"bg-blue-600",text:"text-blue-800"}}})();return jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`${l.bg} ${l.border} rounded-lg p-5 border hover:shadow-md transition-all cursor-pointer`,onClick:o,children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:`p-2 rounded-lg ${l.icon}`,children:jsxRuntimeExports.jsx(r,{className:"h-5 w-5 text-white"})}),jsxRuntimeExports.jsxs("div",{className:"ml-4",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-medium text-gray-600",children:e}),jsxRuntimeExports.jsx("p",{className:`text-xl font-bold ${l.text}`,children:t}),a&&jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500",children:a})]})]}),n&&i&&jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[(()=>{switch(n){case"up":return jsxRuntimeExports.jsx(TrendingUp,{className:"h-3 w-3 text-green-500"});case"down":return jsxRuntimeExports.jsx(TrendingUp,{className:"h-3 w-3 text-red-500 rotate-180"});default:return null}})(),jsxRuntimeExports.jsx("span",{className:"ml-1 text-sm font-medium "+("up"===n?"text-green-500":"down"===n?"text-red-500":"text-gray-500"),children:i})]})]})})};function ResidentsDashboard(){const[e,t]=reactExports.useState(null),[a,r]=reactExports.useState(null),[s,n]=reactExports.useState(null),[i,o]=reactExports.useState(null),[l,c]=reactExports.useState(null),[d,u]=reactExports.useState(null),[m,p]=reactExports.useState(!0),[x,h]=reactExports.useState(null),{user:g}=useAuth(),y=new SystemUserService;reactExports.useEffect(()=>{(null==g?void 0:g.id)&&v()},[null==g?void 0:g.id]);const v=()=>__async(this,null,function*(){if(null==g?void 0:g.id)try{p(!0),h(null);const e=yield y.getResidentDashboard(g.id);e.isSuccess&&e.data?E(e.data):(h(e.error||"Error al cargar los datos del dashboard"),f())}catch(e){h("Error de conexión al cargar los datos"),f()}finally{p(!1)}}),E=e=>{t({unitNumber:e.unitInfo.unitNumber,tower:e.unitInfo.tower,floor:e.unitInfo.floor,parkingSpot:e.unitInfo.parkingSpot,contractStatus:e.unitInfo.contractStatus,contractExpiryDate:new Date(e.unitInfo.contractExpiryDate).toISOString().split("T")[0]}),o({activeReservations:e.reservations.activeReservations,reservationHistory:e.reservations.reservationHistory.map(e=>({area:e.area,date:new Date(e.date).toISOString().split("T")[0],status:e.status})),weeklyAvailability:e.reservations.weeklyAvailability}),u({unreadAnnouncements:e.communications.unreadAnnouncements,importantAlerts:e.communications.importantAlerts,pendingSurveys:e.communications.pendingSurveys,lastCommunication:e.communications.lastCommunication?new Date(e.communications.lastCommunication).toISOString().split("T")[0]:"2024-05-24"}),r({pendingBalance:0,paidThisMonth:850,lastThreeMonthsPayments:[850,850,825],nextDueDate:"2024-06-15",latePenalty:0,monthlyWaterConsumption:18.5}),n({openIncidents:1,inProgressIncidents:0,resolvedIncidents:3,averageResponseTime:2.5,lastMaintenanceRequest:"2024-05-20"}),c({monthlyVisits:12,lastVisit:"2024-05-23",pendingApprovals:1,scheduledVisits:3})},f=()=>{t({unitNumber:"304",tower:"Torre A",floor:3,parkingSpot:"A-15",contractStatus:"vigente",contractExpiryDate:"2024-12-31"}),r({pendingBalance:0,paidThisMonth:850,lastThreeMonthsPayments:[850,850,825],nextDueDate:"2024-06-15",latePenalty:0,monthlyWaterConsumption:18.5}),n({openIncidents:1,inProgressIncidents:0,resolvedIncidents:3,averageResponseTime:2.5,lastMaintenanceRequest:"2024-05-20"}),o({activeReservations:2,reservationHistory:[{area:"Salón de Eventos",date:"2024-05-25",status:"confirmada"},{area:"Gimnasio",date:"2024-05-22",status:"completada"},{area:"Piscina",date:"2024-05-18",status:"completada"}],weeklyAvailability:[{area:"Gimnasio",availability:85},{area:"Piscina",availability:60},{area:"Salón de Eventos",availability:40}]}),c({monthlyVisits:12,lastVisit:"2024-05-23",pendingApprovals:1,scheduledVisits:3}),u({unreadAnnouncements:2,importantAlerts:1,pendingSurveys:1,lastCommunication:"2024-05-24"})},b=e=>{switch(e){case"vigente":return{text:"Vigente",status:"success"};case"por_renovar":return{text:"Por Renovar",status:"warning"};case"vencido":return{text:"Vencido",status:"error"};default:return{text:"Desconocido",status:"info"}}};return m?jsxRuntimeExports.jsx("div",{className:"p-6 space-y-6",children:jsxRuntimeExports.jsxs("div",{className:"flex justify-center items-center h-64",children:[jsxRuntimeExports.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"}),jsxRuntimeExports.jsx("span",{className:"ml-3 text-gray-600",children:"Cargando datos del dashboard..."})]})}):jsxRuntimeExports.jsxs("div",{className:"p-6 space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Mi Dashboard"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600",children:"Información personal y estado de mi unidad"}),x&&jsxRuntimeExports.jsx("div",{className:"mt-2 p-2 bg-yellow-100 border border-yellow-400 text-yellow-700 rounded",children:jsxRuntimeExports.jsxs("p",{className:"text-sm",children:["⚠️ ",x," - Mostrando datos de respaldo"]})})]}),jsxRuntimeExports.jsxs("div",{className:"text-right",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500",children:"Última actualización"}),jsxRuntimeExports.jsx("p",{className:"text-lg font-semibold",children:(new Date).toLocaleDateString()})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[jsxRuntimeExports.jsx(Home,{className:"h-6 w-6 mr-2 text-blue-600"}),"Mi Unidad"]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:e&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ResidentKPICard,{title:"Unidad",value:`${e.tower} - ${e.unitNumber}`,subtitle:`Piso ${e.floor}`,icon:Home,status:"info"}),jsxRuntimeExports.jsx(ResidentKPICard,{title:"Estacionamiento",value:e.parkingSpot,subtitle:"Asignado",icon:MapPin,status:"info"}),jsxRuntimeExports.jsx(ResidentKPICard,{title:"Estado del Contrato",value:b(e.contractStatus).text,subtitle:`Vence: ${new Date(e.contractExpiryDate).toLocaleDateString()}`,icon:FileText,status:b(e.contractStatus).status}),jsxRuntimeExports.jsx(ResidentKPICard,{title:"Días para Vencimiento",value:Math.ceil((new Date(e.contractExpiryDate).getTime()-(new Date).getTime())/864e5),subtitle:"Días restantes",icon:Calendar,status:Math.ceil((new Date(e.contractExpiryDate).getTime()-(new Date).getTime())/864e5)<30?"warning":"success"})]})})]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[jsxRuntimeExports.jsx(Calendar,{className:"h-6 w-6 mr-2 text-purple-600"}),"Reservas de Áreas Comunes"]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:i&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ResidentKPICard,{title:"Reservas Activas",value:i.activeReservations,subtitle:"Confirmadas",icon:Calendar,status:i.activeReservations>0?"success":"info"}),jsxRuntimeExports.jsx(ResidentKPICard,{title:"Historial",value:i.reservationHistory.length,subtitle:"Últimas reservas",icon:FileText,status:"info"})]})}),i&&jsxRuntimeExports.jsxs("div",{className:"mt-4 bg-gray-50 rounded-lg p-4",children:[jsxRuntimeExports.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Disponibilidad esta Semana"}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:i.weeklyAvailability.map((e,t)=>jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-gray-600",children:e.area}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"w-20 bg-gray-200 rounded-full h-2 mr-2",children:jsxRuntimeExports.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${e.availability}%`}})}),jsxRuntimeExports.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[e.availability,"%"]})]})]},t))})]})]})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[jsxRuntimeExports.jsx(MessageSquare,{className:"h-6 w-6 mr-2 text-indigo-600"}),"Comunicaciones"]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:d&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ResidentKPICard,{title:"Comunicados Nuevos",value:d.unreadAnnouncements,subtitle:"Sin leer",icon:MessageSquare,status:d.unreadAnnouncements>0?"warning":"success"}),jsxRuntimeExports.jsx(ResidentKPICard,{title:"Alertas Importantes",value:d.importantAlerts,subtitle:"Requieren atención",icon:Bell,status:d.importantAlerts>0?"error":"success"}),jsxRuntimeExports.jsx(ResidentKPICard,{title:"Encuestas Pendientes",value:d.pendingSurveys,subtitle:"Para completar",icon:Star,status:d.pendingSurveys>0?"info":"success"}),jsxRuntimeExports.jsx(ResidentKPICard,{title:"Última Comunicación",value:new Date(d.lastCommunication).toLocaleDateString(),subtitle:"Recibida",icon:Clock,status:"info"})]})})]})]})}class Audit{constructor(){__publicField(this,"createdAt"),__publicField(this,"createdBy"),__publicField(this,"updatedAt"),__publicField(this,"updatedBy"),__publicField(this,"isDeleted"),this.createdAt=new Date,this.createdBy="",this.isDeleted=!1}}class ManagementCompany extends Audit{constructor(){super(),__publicField(this,"companyId"),__publicField(this,"name"),__publicField(this,"contactEmail"),__publicField(this,"contactPhone"),__publicField(this,"address"),this.companyId=0,this.name=""}}const getGridActionTheme=e=>{const t=e.toLowerCase();return t.includes("ver")||t.includes("edificio")||t.includes("view")?"gridView":t.includes("editar")||t.includes("edit")?"gridEdit":t.includes("eliminar")||t.includes("delete")||t.includes("trash")?"gridDelete":t.includes("gasto")||t.includes("expense")||t.includes("info")||t.includes("receipt")?"gridInfo":"gridView"},PAGE_SIZES=[5,10,25];function DataGrid({data:e,columns:t,actions:a,onPageChange:r,onPageSizeChange:s,initialPage:n=1,initialPageSize:i=10,totalRecords:o,manualPagination:l=!0}){const[c,d]=reactExports.useState([]),[u,m]=reactExports.useState(!1),[p,x]=reactExports.useState([]),h=reactExports.useMemo(()=>Array.isArray(e)?e:[],[e]),[g,y]=reactExports.useState(i),[v,E]=reactExports.useState(Math.max(0,n-1));reactExports.useEffect(()=>{i!==g&&y(i);const e=Math.max(0,n-1);e!==v&&E(e)},[n,i]),reactExports.useEffect(()=>{const e=()=>{m(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]);const f=reactExports.useCallback(e=>{var t;if(!h.length)return"string";const a=null==(t=h.find(t=>{const a=null==t?void 0:t[e];return null!=a}))?void 0:t[e];return void 0===a?"string":a instanceof Date||"string"==typeof a&&!isNaN(Date.parse(a))?"date":"number"==typeof a||"string"==typeof a&&!isNaN(Number(a))?"number":"string"},[h]),b=reactExports.useCallback(e=>{d(t=>{const a="function"==typeof e?e(t):e;if(!a.length)return x([]),a;const r=a[0].id,s=t.some(e=>e.id===r),n=t.some(e=>e.id===r&&e.desc);return s&&n?(x(e=>[...e,r]),[]):(p.includes(r)&&x(e=>e.filter(e=>e!==r)),a)})},[p]),j=getGridColors(),R=reactExports.useMemo(()=>t.map(e=>{if(!e.id)return e;const t=f(e.id);return __spreadProps(__spreadValues({},e),{sortingFn:(e,a,r)=>{const s=e.getValue(r),n=a.getValue(r);switch(t){case"number":{const e=parseFloat(String(s||0)),t=parseFloat(String(n||0));return isNaN(e)?1:isNaN(t)?-1:e-t}case"date":{const e=s?new Date(String(s)).getTime():0,t=n?new Date(String(n)).getTime():0;return isNaN(e)?1:isNaN(t)?-1:e-t}default:return String(s||"").localeCompare(String(n||""))}}})}),[t,f]),I=reactExports.useMemo(()=>(null==a?void 0:a.length)?[...R,{id:"actions",header:"Acciones",enableSorting:!1,cell:({row:e})=>jsxRuntimeExports.jsx("div",{className:"flex gap-2 justify-center",children:a.map((t,a)=>{const r=getGridActionTheme(t.label);return jsxRuntimeExports.jsx(ButtonUI,{icon:t.icon,tooltip:t.label,size:"s",onClick:()=>t.onClick(e.original),theme:r},a)})})}]:R,[R,a]),S=reactExports.useCallback((e,t)=>{E(e),y(t);null==r||r(e+1,t)},[r]),_=reactExports.useCallback((e,t)=>{y(e),E(t);null==s||s(e,t+1)},[s]),N=useReactTable({data:h,columns:I,state:{sorting:c,pagination:{pageIndex:v,pageSize:g}},onSortingChange:b,getCoreRowModel:getCoreRowModel(),getSortedRowModel:getSortedRowModel(),getPaginationRowModel:getPaginationRowModel(),manualPagination:l,pageCount:l&&o?Math.ceil(o/g):Math.ceil(h.length/g),sortDescFirst:!1,onPaginationChange:e=>{const t="function"==typeof e?e({pageIndex:v,pageSize:g}):e;t.pageSize!==g?_(t.pageSize,0):t.pageIndex!==v&&S(t.pageIndex,t.pageSize)}});return jsxRuntimeExports.jsxs("div",{className:"w-full rounded-lg shadow overflow-hidden",style:{backgroundColor:"var(--color-surface-modal)"},children:[u?jsxRuntimeExports.jsx("div",{className:"space-y-2 p-2",children:0===h.length?jsxRuntimeExports.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 text-center",children:jsxRuntimeExports.jsx("p",{className:"text-gray-500",children:"No hay datos disponibles"})}):N.getRowModel().rows.map(e=>jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg shadow-md p-3 border-l-4 border border-gray-200 border-l-primary transition-all",style:{boxShadow:"0 2px 4px -1px rgba(0, 0, 0, 0.06), 0 1px 2px -1px rgba(0, 0, 0, 0.04)"},children:[e.getVisibleCells().map(e=>{if("actions"===e.column.id)return null;let t="";const a=e.column.columnDef.header;t="string"==typeof a?a:e.column.id;const r=e.column.columnDef.icon;return jsxRuntimeExports.jsxs("div",{className:"py-1 border-b border-gray-100 last:border-b-0",children:[jsxRuntimeExports.jsx("div",{className:"text-xs font-medium uppercase py-1 rounded text-center",style:{backgroundColor:j.header.background,color:j.header.text},children:t}),jsxRuntimeExports.jsxs("div",{className:"text-sm font-medium text-center pt-1 flex items-center justify-center gap-2",style:{color:"var(--color-text-primary)"},children:[r&&jsxRuntimeExports.jsx(r,{className:"w-4 h-4",style:{color:j.icon}}),flexRender(e.column.columnDef.cell,e.getContext())]})]},e.id)}),a&&a.length>0&&jsxRuntimeExports.jsx("div",{className:"mt-2 pt-2 border-t flex justify-center gap-2",style:{borderTopColor:"var(--color-border-light)"},children:a.map((t,a)=>{const r=getGridActionTheme(t.label);return jsxRuntimeExports.jsx(ButtonUI,{icon:t.icon,tooltip:t.label,size:"s",onClick:()=>t.onClick(e.original),theme:r},a)})})]},e.id))}):jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"min-w-full divide-y",style:{"--tw-divide-color":"var(--color-border-light)"},children:[jsxRuntimeExports.jsx("thead",{style:{backgroundColor:j.header.background},children:N.getHeaderGroups().map(e=>jsxRuntimeExports.jsx("tr",{children:e.headers.map(e=>jsxRuntimeExports.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium uppercase tracking-wider transition-colors duration-200 "+(e.column.getCanSort()?"cursor-pointer":""),style:__spreadValues({color:j.header.text},e.column.getCanSort()?{":hover":{backgroundColor:j.header.hover}}:{}),onMouseEnter:t=>{e.column.getCanSort()&&(t.currentTarget.style.backgroundColor=j.header.hover)},onMouseLeave:t=>{e.column.getCanSort()&&(t.currentTarget.style.backgroundColor="transparent")},onClick:e.column.getCanSort()?e.column.getToggleSortingHandler():void 0,children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-2",children:[flexRender(e.column.columnDef.header,e.getContext()),e.column.getCanSort()?e.column.getIsSorted()?"asc"===e.column.getIsSorted()?jsxRuntimeExports.jsx(ChevronUp,{className:"w-4 h-4",style:{color:j.header.text}}):jsxRuntimeExports.jsx(ChevronDown,{className:"w-4 h-4",style:{color:j.header.text}}):jsxRuntimeExports.jsx(ArrowUpDown,{className:"w-3 h-3 opacity-50",style:{color:j.header.text}}):null]})},e.id))},e.id))}),jsxRuntimeExports.jsx("tbody",{className:"divide-y",style:{backgroundColor:"var(--color-surface-modal)","--tw-divide-color":"var(--color-border-light)"},children:0===h.length?jsxRuntimeExports.jsx("tr",{children:jsxRuntimeExports.jsx("td",{colSpan:I.length,className:"px-6 py-4 whitespace-nowrap text-sm text-center",style:{color:"var(--color-text-muted)"},children:"No hay datos disponibles"})}):N.getRowModel().rows.map((e,t)=>jsxRuntimeExports.jsx("tr",{style:{backgroundColor:t%2==0?j.row.even:j.row.odd,transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=j.row.hover},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=t%2==0?j.row.even:j.row.odd},children:e.getVisibleCells().map(e=>{const t=e.column.columnDef.icon;return jsxRuntimeExports.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-center",style:{color:"var(--color-text-primary)"},children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t&&jsxRuntimeExports.jsx(t,{className:"w-4 h-4",style:{color:j.icon}}),flexRender(e.column.columnDef.cell,e.getContext())]})},e.id)})},e.id))})]})}),jsxRuntimeExports.jsxs("div",{className:"px-4 md:px-6 py-4 border-t "+(u?"flex flex-col space-y-3":"flex items-center justify-between"),style:{borderTopColor:"var(--color-border-light)",backgroundColor:"var(--color-surface-secondary)"},children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center "+(u?"justify-between":"gap-4"),children:[jsxRuntimeExports.jsx("span",{className:"text-sm",style:{color:"var(--color-text-primary)"},children:"Filas por página:"}),jsxRuntimeExports.jsx("select",{value:g,onChange:e=>{const t=Number(e.target.value);N.setPageSize(t),N.setPageIndex(0)},className:"block w-20 rounded-md shadow-sm focus:outline-none focus:ring-2",style:{backgroundColor:"var(--color-surface-input)",borderColor:"var(--color-border-light)",borderWidth:"1px",borderStyle:"solid",color:"var(--color-text-primary)","--tw-ring-color":"rgba(98, 158, 62, 0.2)"},onFocus:e=>{e.target.style.borderColor="var(--color-primary-admin)",e.target.style.boxShadow="0 0 0 2px var(--tw-ring-color)"},onBlur:e=>{e.target.style.borderColor="var(--color-border-light)",e.target.style.boxShadow="none"},children:PAGE_SIZES.map(e=>jsxRuntimeExports.jsx("option",{value:e,children:e},e))})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center "+(u?"justify-between":"gap-2"),children:[jsxRuntimeExports.jsx("div",{className:"flex items-center gap-1",children:jsxRuntimeExports.jsxs("span",{className:"text-sm",style:{color:"var(--color-text-primary)"},children:["Página"," ",jsxRuntimeExports.jsx("span",{className:"font-medium",children:v+1})," ","de"," ",jsxRuntimeExports.jsx("span",{className:"font-medium",children:Math.max(1,N.getPageCount())})]})}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(ButtonUI,{icon:ChevronsLeft,tooltip:"Primera página",size:"s",onClick:()=>{N.setPageIndex(0)},disabled:!N.getCanPreviousPage(),theme:"paginator"}),jsxRuntimeExports.jsx(ButtonUI,{icon:ChevronLeft,tooltip:"Página anterior",size:"s",onClick:()=>{N.previousPage()},disabled:!N.getCanPreviousPage(),theme:"paginator"}),jsxRuntimeExports.jsx(ButtonUI,{icon:ChevronRight,tooltip:"Página siguiente",size:"s",onClick:()=>{N.nextPage()},disabled:!N.getCanNextPage(),theme:"paginator"}),jsxRuntimeExports.jsx(ButtonUI,{icon:ChevronsRight,tooltip:"Última página",size:"s",onClick:()=>{N.setPageIndex(N.getPageCount()-1)},disabled:!N.getCanNextPage(),theme:"paginator"})]})]})]})]})}function Expandex({children:e,title:t,initialExpanded:a=!1,expandIcon:r=Plus,collapseIcon:s=Minus,borderColor:n="var(--color-primary-admin)",backgroundColor:i="#ffffff",className:o=""}){const[l,c]=reactExports.useState(a),d=()=>{c(!l)};return jsxRuntimeExports.jsxs("div",{className:`w-full overflow-hidden ${o}`,children:[jsxRuntimeExports.jsx(AnimatePresence,{mode:"wait",children:!l&&jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.5,ease:"easeInOut"},className:"flex justify-end",children:jsxRuntimeExports.jsx(ButtonUI,{icon:r,tooltip:t?`Expandir ${t}`:"Expandir",onClick:d,theme:"filter",size:"m"})})}),jsxRuntimeExports.jsx(AnimatePresence,{mode:"wait",children:l&&jsxRuntimeExports.jsx(motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.7,ease:"easeInOut",opacity:{duration:.4}},className:"relative",children:jsxRuntimeExports.jsxs("div",{className:"p-4 rounded-lg border-2 shadow-sm",style:{borderColor:n,backgroundColor:i},children:[jsxRuntimeExports.jsx("div",{className:"absolute top-2 right-2",children:jsxRuntimeExports.jsx(ButtonUI,{icon:s,tooltip:t?`Colapsar ${t}`:"Colapsar",onClick:d,theme:"filter",size:"s"})}),t&&jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium mb-4 pr-10",style:{color:n},children:t}),jsxRuntimeExports.jsx("div",{className:"pt-2",children:e})]})})})]})}function TextAreaUI({id:e,label:t,icon:a,value:r,onChange:s,placeholder:n,required:i=!1,maxLength:o,rows:l=3,className:c=""}){const[d,u]=reactExports.useState(!1),m=d&&i&&!r.trim();return jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsxs("label",{htmlFor:e,className:"block text-sm font-medium mb-1",style:{color:"var(--color-text-primary)"},children:[t," ",i&&jsxRuntimeExports.jsx("span",{style:{color:"var(--color-error-main)"},children:"*"})]}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[a&&jsxRuntimeExports.jsx(a,{className:"absolute left-3 top-3 h-5 w-5",style:{color:m?"var(--color-error-main)":"var(--color-text-muted)"}}),jsxRuntimeExports.jsx("textarea",{id:e,required:i,maxLength:o,value:r,onChange:e=>{const t=e.target.value;(!o||t.length<=o)&&s(t)},onPaste:e=>{const t=e.clipboardData.getData("text");if(o&&r.length+t.length>o){e.preventDefault();const a=t.slice(0,o-r.length);s(r+a)}},rows:l,className:`\n            ${a?"pl-10":"pl-4"}\n            w-full px-4 py-3 border-2 rounded-lg\n            transition-all duration-200 resize-none\n            focus:outline-none focus:ring-2\n            ${c}\n          `,style:{backgroundColor:m?"rgba(239, 68, 68, 0.05)":"var(--color-surface-input)",borderColor:m?"var(--color-error-main)":"var(--color-border-light)",color:"var(--color-text-primary)","--tw-ring-color":m?"rgba(239, 68, 68, 0.2)":"rgba(98, 158, 62, 0.2)"},placeholder:n,onFocus:e=>{e.target.style.borderColor=m?"var(--color-error-main)":"var(--color-primary-admin)"},onBlur:e=>{u(!0),e.target.style.borderColor=m?"var(--color-error-main)":"var(--color-border-light)"}})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between mt-1",children:[m&&jsxRuntimeExports.jsxs("span",{className:"text-sm",style:{color:"var(--color-error-main)"},children:["El campo ",t.toLowerCase()," es obligatorio"]}),o&&jsxRuntimeExports.jsxs("span",{className:"text-sm",style:{color:m?"var(--color-error-main)":"var(--color-text-muted)"},children:[r.length,"/",o]})]})]})}function ManagementCompanyForm({company:e,onSubmit:t}){const[a,r]=reactExports.useState({name:"",contactEmail:"",contactPhone:"",address:""});reactExports.useEffect(()=>{r(e?{name:e.name,contactEmail:e.contactEmail,contactPhone:e.contactPhone,address:e.address}:{name:"",contactEmail:"",contactPhone:"",address:""})},[e]);return jsxRuntimeExports.jsxs("form",{onSubmit:e=>{e.preventDefault(),t(a)},className:"space-y-6",children:[jsxRuntimeExports.jsx(InputUI,{id:"name",label:"Nombre",icon:User,value:a.name||"",onChange:e=>r(__spreadProps(__spreadValues({},a),{name:e})),placeholder:"Ingrese el nombre de la empresa",required:!0,maxLength:100}),jsxRuntimeExports.jsx(InputUI,{id:"contactEmail",label:"Email de Contacto",type:"email",icon:Mail,value:a.contactEmail||"",onChange:e=>r(__spreadProps(__spreadValues({},a),{contactEmail:e})),placeholder:"ejemplo@empresa.com",maxLength:100}),jsxRuntimeExports.jsx(InputUI,{id:"contactPhone",label:"Teléfono de Contacto",type:"tel",icon:Phone,value:a.contactPhone||"",onChange:e=>r(__spreadProps(__spreadValues({},a),{contactPhone:e})),placeholder:"+51 999 888 777",maxLength:20}),jsxRuntimeExports.jsx(TextAreaUI,{id:"address",label:"Dirección",icon:Building2,value:a.address||"",onChange:e=>r(__spreadProps(__spreadValues({},a),{address:e})),placeholder:"Ingrese la dirección completa",maxLength:200})]})}class ExpenseService extends ApiBaseService{constructor(){super("/Expense")}getExpenseById(e){return __async(this,null,function*(){return __superGet(ExpenseService.prototype,this,"getById").call(this,e)})}getPagedExpenses(e){return __async(this,null,function*(){const t=e?__spreadProps(__spreadValues({},e),{Description:e.Description||void 0}):void 0;return __superGet(ExpenseService.prototype,this,"getPaged").call(this,"paged",t)})}create(e){return __async(this,null,function*(){return this.post("",e)})}update(e,t){return __async(this,null,function*(){return this.put(`/${e}`,t)})}deleteExpense(e){return __async(this,null,function*(){return __superGet(ExpenseService.prototype,this,"deleteById").call(this,e)})}getByCondominium(e,t=1,a=10){return __async(this,null,function*(){const r={Page:t,PageSize:a,CondoId:e};return this.getPagedExpenses(r)})}getByExpenseType(e,t=1,a=10){return __async(this,null,function*(){const r={Page:t,PageSize:a,ExpenseTypeId:e};return this.getPagedExpenses(r)})}getByStatus(e,t=1,a=10){return __async(this,null,function*(){const r={Page:t,PageSize:a,StatusTypeId:e};return this.getPaged(`by-status/${e}`,r)})}getByDescription(e,t=1,a=10){return __async(this,null,function*(){const r={Page:t,PageSize:a,Description:e};return this.getPagedExpenses(r)})}getByDateRange(e,t,a=1,r=10){return __async(this,null,function*(){const s={Page:a,PageSize:r,FromDate:e,ToDate:t};return this.getPagedExpenses(s)})}getByAmountRange(e,t,a=1,r=10){return __async(this,null,function*(){const s={Page:a,PageSize:r,MinAmount:e,MaxAmount:t};return this.getPagedExpenses(s)})}}const LoadingSpinner$1=reactExports.memo(()=>jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center p-8",children:[jsxRuntimeExports.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),jsxRuntimeExports.jsx("span",{className:"ml-3 text-gray-600",children:"Cargando condominios..."})]}));LoadingSpinner$1.displayName="LoadingSpinner";const ErrorAlert$1=reactExports.memo(({message:e,onDismiss:t,onRetry:a})=>jsxRuntimeExports.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4 mb-4",children:jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("div",{className:"flex-shrink-0",children:jsxRuntimeExports.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:jsxRuntimeExports.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),jsxRuntimeExports.jsx("div",{className:"ml-3 flex-1",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-red-800",children:e})}),jsxRuntimeExports.jsx("div",{className:"ml-auto pl-3",children:jsxRuntimeExports.jsxs("div",{className:"flex space-x-2",children:[a&&jsxRuntimeExports.jsx(ButtonUI,{title:"Reintentar",onClick:a,theme:"delete",className:"text-xs px-2 py-1"}),t&&jsxRuntimeExports.jsx(ButtonUI,{title:"Cerrar",onClick:t,theme:"cancel",className:"text-xs px-2 py-1"})]})})]})}));ErrorAlert$1.displayName="ErrorAlert";const CondominiumFormModal=reactExports.memo(({isOpen:e,onClose:t,condominium:a,onSubmit:r,isSubmitting:s})=>{var n,i,o;const[l,c]=reactExports.useState({name:"",address:"",contactEmail:"",contactPhone:"",totalUnits:0,totalFloors:0,amenities:"",parkingSpaces:0,securityFeatures:"",websiteUrl:"",latitude:0,longitude:0}),[d,u]=reactExports.useState({});reactExports.useEffect(()=>{c(a?{name:a.name||"",address:a.address||"",contactEmail:a.contactEmail||"",contactPhone:a.contactPhone||"",totalUnits:a.totalUnits||0,totalFloors:a.totalFloors||0,amenities:a.amenities||"",parkingSpaces:a.parkingSpaces||0,securityFeatures:a.securityFeatures||"",websiteUrl:a.websiteUrl||"",latitude:a.latitude||0,longitude:a.longitude||0}:{name:"",address:"",contactEmail:"",contactPhone:"",totalUnits:0,totalFloors:0,amenities:"",parkingSpaces:0,securityFeatures:"",websiteUrl:"",latitude:0,longitude:0}),u({})},[a,e]);const m=()=>{var e,t;const a={};return(null==(e=l.name)?void 0:e.trim())||(a.name="El nombre es obligatorio"),(null==(t=l.address)?void 0:t.trim())||(a.address="La dirección es obligatoria"),l.contactEmail&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l.contactEmail)&&(a.contactEmail="Email inválido"),u(a),0===Object.keys(a).length},p=(e,t)=>{c(a=>__spreadProps(__spreadValues({},a),{[e]:t})),d[e]&&u(t=>__spreadProps(__spreadValues({},t),{[e]:void 0}))};return jsxRuntimeExports.jsx(ModalUI,{isOpen:e,onClose:t,title:a?"Editar Condominio":"Nuevo Condominio",footer:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ButtonUI,{icon:X$1,title:"Cancelar",onClick:t,theme:"modalCancel",disabled:s}),jsxRuntimeExports.jsx(ButtonUI,{icon:Save,title:s?"Guardando...":"Guardar",onClick:()=>__async(void 0,null,function*(){m()&&(yield r(l))}),theme:"modalSave",disabled:s})]}),children:jsxRuntimeExports.jsx("form",{onSubmit:e=>__async(void 0,null,function*(){e.preventDefault(),m()&&(yield r(l))}),className:"space-y-6",children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(InputUI,{id:"name",label:"Nombre del Condominio",value:l.name,onChange:e=>p("name",e),placeholder:"Ej: Condominio Las Palmas",required:!0,className:d.name?"border-red-500":""}),d.name&&jsxRuntimeExports.jsx("p",{className:"text-red-500 text-sm col-span-2",children:d.name}),jsxRuntimeExports.jsx(InputUI,{id:"address",label:"Dirección",value:l.address,onChange:e=>p("address",e),placeholder:"Calle 100 #15-30",required:!0,className:d.address?"border-red-500":""}),d.address&&jsxRuntimeExports.jsx("p",{className:"text-red-500 text-sm col-span-2",children:d.address}),jsxRuntimeExports.jsx(InputUI,{id:"contactEmail",label:"Email de Contacto",type:"email",value:l.contactEmail||"",onChange:e=>p("contactEmail",e),placeholder:"info@condominio.com",className:d.contactEmail?"border-red-500":""}),d.contactEmail&&jsxRuntimeExports.jsx("p",{className:"text-red-500 text-sm col-span-2",children:d.contactEmail}),jsxRuntimeExports.jsx(InputUI,{id:"contactPhone",label:"Teléfono de Contacto",value:l.contactPhone||"",onChange:e=>p("contactPhone",e),placeholder:"601-234-5678"}),jsxRuntimeExports.jsx(InputUI,{id:"totalUnits",label:"Total de Unidades",type:"number",value:(null==(n=l.totalUnits)?void 0:n.toString())||"0",onChange:e=>p("totalUnits",parseInt(e)||0)}),jsxRuntimeExports.jsx(InputUI,{id:"totalFloors",label:"Total de Pisos",type:"number",value:(null==(i=l.totalFloors)?void 0:i.toString())||"0",onChange:e=>p("totalFloors",parseInt(e)||0)}),jsxRuntimeExports.jsx(InputUI,{id:"parkingSpaces",label:"Espacios de Parqueadero",type:"number",value:(null==(o=l.parkingSpaces)?void 0:o.toString())||"0",onChange:e=>p("parkingSpaces",parseInt(e)||0)}),jsxRuntimeExports.jsx(TextAreaUI,{id:"amenities",label:"Amenidades",value:l.amenities||"",onChange:e=>p("amenities",e),placeholder:"Piscina, Gimnasio, Salón Social, etc.",rows:3}),jsxRuntimeExports.jsx(TextAreaUI,{id:"securityFeatures",label:"Características de Seguridad",value:l.securityFeatures||"",onChange:e=>p("securityFeatures",e),placeholder:"Portería 24h, Circuito cerrado, etc.",rows:3}),jsxRuntimeExports.jsx(InputUI,{id:"websiteUrl",label:"Sitio Web",value:l.websiteUrl||"",onChange:e=>p("websiteUrl",e),placeholder:"https://www.condominio.com"})]})})})});CondominiumFormModal.displayName="CondominiumFormModal";const ExpensesModal=reactExports.memo(({isOpen:e,onClose:t,condominium:a})=>{const[r,s]=reactExports.useState([]),[n,i]=reactExports.useState(!1),[o,l]=reactExports.useState((new Date).getMonth()),{showToast:c}=useAlerts(),d=reactExports.useMemo(()=>new ExpenseService,[]),u=reactExports.useMemo(()=>[{value:0,label:"Enero"},{value:1,label:"Febrero"},{value:2,label:"Marzo"},{value:3,label:"Abril"},{value:4,label:"Mayo"},{value:5,label:"Junio"},{value:6,label:"Julio"},{value:7,label:"Agosto"},{value:8,label:"Septiembre"},{value:9,label:"Octubre"},{value:10,label:"Noviembre"},{value:11,label:"Diciembre"}],[]),m=reactExports.useCallback(()=>__async(void 0,null,function*(){if(a){i(!0);try{const e=yield d.getByCondominium(a.condoId);if(e.isSuccess&&e.data){let t=[];"items"in e.data&&Array.isArray(e.data.items)?t=e.data.items:Array.isArray(e.data)?t=e.data:"data"in e.data&&Array.isArray(e.data.data)&&(t=e.data.data),s(t)}else c("error",e.error||"Error al cargar gastos"),s([]);i(!1)}catch(e){c("error","Error al cargar los gastos"),s([]),i(!1)}}}),[a,d]);reactExports.useEffect(()=>{e&&a&&m()},[e,a,o,m]);const p=reactExports.useMemo(()=>r.reduce((e,t)=>e+t.amount,0),[r]),x=[{accessorKey:"dateIncurred",header:"Fecha",cell:({getValue:e})=>{const t=e();return t?new Date(t).toLocaleDateString():""}},{accessorKey:"expenseTypeId",header:"Tipo",cell:({row:e})=>`Tipo #${e.original.expenseTypeId}`},{accessorKey:"description",header:"Descripción"},{accessorKey:"amount",header:"Monto",cell:({getValue:e})=>`S/.${e().toLocaleString("es-ES",{minimumFractionDigits:2})}`}];return jsxRuntimeExports.jsx(ModalUI,{isOpen:e,onClose:t,title:`Generar Cobranzas - ${(null==a?void 0:a.name)||""}`,footer:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ButtonUI,{title:"Cancelar",onClick:t,theme:"modalCancel"}),jsxRuntimeExports.jsx(ButtonUI,{title:"Generar Cobros",icon:Receipt,onClick:()=>{a&&r.length>0?c("success","Función de generación de cobros en desarrollo"):c("warning","No hay gastos disponibles para generar cobros")},theme:"modalSave",disabled:0===r.length})]}),children:jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Información del Condominio"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500",children:"Nombre:"}),jsxRuntimeExports.jsx("p",{className:"font-medium",children:(null==a?void 0:a.name)||"-"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500",children:"Dirección:"}),jsxRuntimeExports.jsx("p",{className:"font-medium",children:(null==a?void 0:a.address)||"-"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500",children:"Total Unidades:"}),jsxRuntimeExports.jsx("p",{className:"font-medium",children:(null==a?void 0:a.totalUnits)||"-"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500",children:"Total Pisos:"}),jsxRuntimeExports.jsx("p",{className:"font-medium",children:(null==a?void 0:a.totalFloors)||"-"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Selección de Periodo"}),jsxRuntimeExports.jsx(SelectUI$1,{id:"month-selector",label:"Mes para generación de cobros",options:u,value:o,onChange:e=>l("string"==typeof e?parseInt(e):e)}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Seleccione el mes para el que desea generar los cobros basados en los gastos."}),jsxRuntimeExports.jsx("div",{className:"mt-4 p-3 bg-green-50 rounded-lg",children:jsxRuntimeExports.jsxs("p",{className:"text-sm font-medium text-green-800",children:["Total de gastos del mes: S/.",p.toLocaleString("es-ES",{minimumFractionDigits:2})]})})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Gastos Registrados"}),n?jsxRuntimeExports.jsxs("div",{className:"text-center py-4",children:[jsxRuntimeExports.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-primary border-t-transparent mx-auto"}),jsxRuntimeExports.jsx("p",{className:"mt-2 text-gray-500",children:"Cargando gastos..."})]}):r.length>0?jsxRuntimeExports.jsx(DataGrid,{data:r,columns:x,initialPage:1,initialPageSize:5,totalRecords:r.length}):jsxRuntimeExports.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[jsxRuntimeExports.jsx(Receipt,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),jsxRuntimeExports.jsx("p",{className:"text-gray-500",children:"No hay gastos registrados para este condominio"})]})]})]})})});ExpensesModal.displayName="ExpensesModal";const CondominiumListAdvancedContent=reactExports.memo(({companyId:e,onViewBuildings:t,embedded:a=!1})=>{const r=reactExports.useRef(!1),s=reactExports.useMemo(()=>new CondominiumService,[]),n=reactExports.useMemo(()=>new ManagementCompanyService,[]),i=useNavigate(),{showToast:o,showConfirm:l}=useAlerts(),[c,d]=reactExports.useState(),[u,m]=reactExports.useState([]),[p,x]=reactExports.useState(!0),[h,g]=reactExports.useState(0),[y,v]=reactExports.useState(null),[E,f]=reactExports.useState(!1),[b,j]=reactExports.useState(!1),[R,I]=reactExports.useState(null),[S,_]=reactExports.useState(""),[N,C]=reactExports.useState(1),[T,D]=reactExports.useState(10),[A,P]=reactExports.useState(),[w,M]=reactExports.useState(!1),k=reactExports.useCallback(()=>__async(void 0,null,function*(){try{x(!0),v(null);const t={CompanyId:e,PageNumber:N,PageSize:T};S.trim()&&(t.Name=S.trim());const a=yield s.getPagedCondominiums(t);if(a.isSuccess&&a.data){const e=a.data;"data"in e&&Array.isArray(e.data)?(m(e.data),g(e.data.length)):"items"in e&&Array.isArray(e.items)?(m(e.items),g(e.items.length)):(m([]),g(0))}else{const e=a.error||"Error al cargar los condominios";v(e),o("error",e),401===a.statusCode&&i("/login")}}catch(t){const e=t instanceof Error?t.message:"Error desconocido";v(`Error al conectar con el servidor: ${e}`),o("error",`Error al conectar con el servidor: ${e}`)}finally{x(!1)}}),[e,N,T,S]);reactExports.useEffect(()=>{r.current||(r.current=!0,O()),k()},[e,N,T]),reactExports.useEffect(()=>{if(S.length>2||0===S.length){const e=setTimeout(()=>{k()},300);return()=>{clearTimeout(e)}}},[S]);const O=()=>__async(void 0,null,function*(){try{const t=yield n.getCompanyById(e);t.isSuccess&&t.data&&d(t.data)}catch(t){}}),$=e=>{P(e),f(!0)},U=()=>{f(!1),P(void 0)},L=reactExports.useCallback(e=>{t?t(e.condoId):i(`/condominiums/${e.condoId}/buildings`)},[t,i]),B=reactExports.useCallback(e=>{I(e),j(!0)},[]),F=reactExports.useCallback(()=>{j(!1),I(null)},[]),V=[{accessorKey:"name",header:"Nombre",icon:Building2},{accessorKey:"address",header:"Dirección",icon:MapPin,cell:({getValue:e})=>{const t=e();return t&&t.length>70?`${t.substring(0,70)}...`:t}},{accessorKey:"totalUnits",header:"Total Unidades"},{accessorKey:"totalFloors",header:"Pisos"},{accessorKey:"contactEmail",header:"Email",icon:Mail},{accessorKey:"contactPhone",header:"Teléfono",icon:Phone}],W=[{icon:Building,label:"Ver Edificios",onClick:e=>L(e)},{icon:Receipt,label:"Gastos",onClick:B},{icon:SquarePen,label:"Editar",onClick:e=>$(e)},{icon:Trash2,label:"Eliminar",onClick:e=>(e=>__async(void 0,null,function*(){l("Eliminar condominio",`¿Estás seguro de eliminar el condominio ${e.name}? Esta acción no se puede deshacer.`,()=>__async(void 0,null,function*(){try{const t=yield s.deleteCondominium(e.condoId);t.isSuccess?(o("success",`Condominio ${e.name} eliminado correctamente`),yield k()):o("error",`Error al eliminar el condominio: ${t.error||"Error desconocido"}`)}catch(t){const e=t instanceof Error?t.message:"Error desconocido";o("error",`Error al conectar con el servidor: ${e}`)}}))}))(e)}];return y?jsxRuntimeExports.jsx(ErrorAlert$1,{message:y,onDismiss:()=>v(null),onRetry:()=>k()}):c||p?jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:a?"":"space-y-6 p-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Gestión de Condominios"}),jsxRuntimeExports.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Administra los condominios de la empresa"})]}),jsxRuntimeExports.jsx("div",{className:"flex items-center space-x-3",children:jsxRuntimeExports.jsx(ButtonUI,{icon:Plus,title:"Nuevo Condominio",theme:"primary",onClick:()=>$()})})]}),c&&jsxRuntimeExports.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[jsxRuntimeExports.jsx(Building2,{className:"h-5 w-5 text-primary"}),"Información de la Empresa"]}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsxs("p",{className:"text-gray-700",children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Nombre:"})," ",c.name]}),jsxRuntimeExports.jsxs("p",{className:"text-gray-700 flex items-center gap-2",children:[jsxRuntimeExports.jsx(Mail,{className:"h-4 w-4 text-gray-500"}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Email:"})," ",c.contactEmail]}),jsxRuntimeExports.jsxs("p",{className:"text-gray-700 flex items-center gap-2",children:[jsxRuntimeExports.jsx(Phone,{className:"h-4 w-4 text-gray-500"}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Teléfono:"})," ",c.contactPhone]}),jsxRuntimeExports.jsxs("p",{className:"text-gray-700 flex items-center gap-2",children:[jsxRuntimeExports.jsx(MapPin,{className:"h-4 w-4 text-gray-500"}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Dirección:"})," ",c.address]})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Resumen"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-primary/5 p-4 rounded-lg",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500",children:"Total de Condominios"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-primary",children:h})]}),jsxRuntimeExports.jsxs("div",{className:"bg-accent/5 p-4 rounded-lg",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500",children:"Total de Unidades"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-accent",children:u.reduce((e,t)=>e+(t.totalUnits||0),0)})]})]})]})]})}),jsxRuntimeExports.jsx(Expandex,{title:"Filtros de búsqueda",initialExpanded:!1,expandIcon:Filter,className:"mb-6",children:jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(InputUI,{id:"nameFilter",label:"Nombre del condominio",placeholder:"Buscar por nombre...",icon:Search,value:S,onChange:e=>_(e),className:""+(S?"border-primary":"")}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Escribe al menos 3 caracteres para filtrar automáticamente"})]})})}),p?jsxRuntimeExports.jsx(LoadingSpinner$1,{}):jsxRuntimeExports.jsx(DataGrid,{data:u,columns:V,actions:W,onPageChange:(e,t)=>{C(e),D(t)},onPageSizeChange:(e,t)=>{D(e),C(t)},initialPage:N,initialPageSize:T,totalRecords:h}),jsxRuntimeExports.jsx(CondominiumFormModal,{isOpen:E,onClose:U,condominium:A,onSubmit:t=>__async(void 0,null,function*(){try{if(M(!0),A){const a={condoId:A.condoId,companyId:e,name:t.name,address:t.address,latitude:t.latitude,longitude:t.longitude,totalUnits:t.totalUnits,totalFloors:t.totalFloors,amenities:t.amenities,parkingSpaces:t.parkingSpaces,securityFeatures:t.securityFeatures,contactEmail:t.contactEmail,contactPhone:t.contactPhone,websiteUrl:t.websiteUrl,routeId:1,updatedBy:"current-user",updatedAt:(new Date).toISOString()},r=yield s.update(A.condoId,a);r.isSuccess?(o("success",`Condominio ${t.name} actualizado correctamente`),yield k(),U()):o("error",r.error||"Error al actualizar el condominio")}else{const a={companyId:e,name:t.name||"",address:t.address||"",latitude:t.latitude,longitude:t.longitude,totalUnits:t.totalUnits,totalFloors:t.totalFloors,amenities:t.amenities,parkingSpaces:t.parkingSpaces,securityFeatures:t.securityFeatures,contactEmail:t.contactEmail,contactPhone:t.contactPhone,websiteUrl:t.websiteUrl,createdBy:"current-user"},r=yield s.create(a);r.isSuccess?(o("success",`Condominio ${t.name} creado correctamente`),yield k(),U()):o("error",r.error||"Error al crear el condominio")}}catch(a){const e=a instanceof Error?a.message:"Error desconocido";o("error",`Error al guardar: ${e}`)}finally{M(!1)}}),isSubmitting:w}),jsxRuntimeExports.jsx(ExpensesModal,{isOpen:b,onClose:F,condominium:R})]}):jsxRuntimeExports.jsx("div",{className:"p-6 text-center",children:jsxRuntimeExports.jsx("p",{className:"text-gray-500",children:"No se encontró información de la empresa"})})});CondominiumListAdvancedContent.displayName="CondominiumListAdvancedContent";const CondominiumListAdvanced=e=>jsxRuntimeExports.jsx(AlertProvider,{children:jsxRuntimeExports.jsx(CondominiumListAdvancedContent,__spreadValues({},e))});class BuildingService extends ApiBaseService{constructor(){super("/Building")}getBuildingById(e){return __async(this,null,function*(){return __superGet(BuildingService.prototype,this,"getById").call(this,e)})}getPagedBuildings(e){return __async(this,null,function*(){const t=e?__spreadProps(__spreadValues({},e),{Name:e.Name||void 0,Description:e.Description||void 0}):void 0;return __superGet(BuildingService.prototype,this,"getPaged").call(this,"paged",t)})}create(e){return __async(this,null,function*(){return this.post("",e)})}update(e,t){return __async(this,null,function*(){return this.put(`/${e}`,t)})}deleteBuilding(e){return __async(this,null,function*(){return __superGet(BuildingService.prototype,this,"deleteById").call(this,e)})}getByCondominium(e,t=1,a=10){return __async(this,null,function*(){const r={Page:t,PageSize:a,CondoId:e};return this.getPagedBuildings(r)})}searchByName(e,t=1,a=10){return __async(this,null,function*(){const r={Page:t,PageSize:a,Name:e};return this.getPagedBuildings(r)})}}const building_service=Object.freeze(Object.defineProperty({__proto__:null,BuildingService:BuildingService},Symbol.toStringTag,{value:"Module"}));function BuildingForm({building:e,onSubmit:t}){var a,r;const[s,n]=reactExports.useState({name:"",description:"",totalFloors:void 0,totalUnits:void 0});reactExports.useEffect(()=>{e&&n({name:e.name,description:e.description,totalFloors:e.totalFloors,totalUnits:e.totalUnits})},[e]);return jsxRuntimeExports.jsxs("form",{onSubmit:e=>{e.preventDefault(),t(s)},className:"space-y-6",children:[jsxRuntimeExports.jsx(InputUI,{id:"name",label:"Nombre",icon:Building2,value:s.name||"",onChange:e=>n(__spreadProps(__spreadValues({},s),{name:e})),placeholder:"Nombre del edificio",required:!0,maxLength:100}),jsxRuntimeExports.jsx(TextAreaUI,{id:"description",label:"Descripción",icon:AlignLeft,value:s.description||"",onChange:e=>n(__spreadProps(__spreadValues({},s),{description:e})),placeholder:"Descripción del edificio",maxLength:200}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[jsxRuntimeExports.jsx(InputUI,{id:"totalFloors",label:"Número de Pisos",type:"number",icon:Hash,value:(null==(a=s.totalFloors)?void 0:a.toString())||"",onChange:e=>n(__spreadProps(__spreadValues({},s),{totalFloors:parseInt(e)||void 0})),placeholder:"Cantidad de pisos",required:!0}),jsxRuntimeExports.jsx(InputUI,{id:"totalUnits",label:"Total de Departamentos",type:"number",icon:Home,value:(null==(r=s.totalUnits)?void 0:r.toString())||"",onChange:e=>n(__spreadProps(__spreadValues({},s),{totalUnits:parseInt(e)||void 0})),placeholder:"Número de departamentos",required:!0})]})]})}const BuildingListAdvanced=reactExports.memo(({companyId:e,condoId:t,embedded:a=!1})=>{const r=useNavigate(),s=reactExports.useMemo(()=>new BuildingService,[]),n=reactExports.useMemo(()=>new CondominiumService,[]),i=reactExports.useMemo(()=>new ManagementCompanyService,[]),[o,l]=reactExports.useState(),[c,d]=reactExports.useState(),[u,m]=reactExports.useState([]),[p,x]=reactExports.useState(!1),[h,g]=reactExports.useState(),[y,v]=reactExports.useState(null),[E,f]=reactExports.useState(!1),[b,j]=reactExports.useState([]),[R,I]=reactExports.useState([]),[S,_]=reactExports.useState(e||0),[N,C]=reactExports.useState(t||0),[T,D]=reactExports.useState(!1);reactExports.useEffect(()=>{e||t?(D(!1),w()):(D(!0),A())},[e,t]),reactExports.useEffect(()=>{N>0&&M()},[N]);const A=reactExports.useCallback(()=>__async(void 0,null,function*(){try{f(!0);const e=yield i.getPagedCompanies();if(e.isSuccess&&e.data){let t=[];e.data.items&&Array.isArray(e.data.items)?t=e.data.items:Array.isArray(e.data)&&(t=e.data),j(t)}}catch(e){}finally{f(!1)}}),[i]),P=reactExports.useCallback(e=>__async(void 0,null,function*(){try{const t={CompanyId:e},a=yield n.getPagedCondominiums(t);if(a.isSuccess&&a.data){const e=a.data;e.data&&Array.isArray(e.data)?I(e.data):e.items&&Array.isArray(e.items)?I(e.items):I([])}else I([])}catch(t){I([])}}),[n]),w=reactExports.useCallback(()=>__async(void 0,null,function*(){try{if(f(!0),t){const e=yield n.getCondominiumById(t);if(e.isSuccess&&e.data){const t=e.data,a={condoId:t.condoId,companyId:t.companyId,name:t.name,address:t.address,latitude:t.latitude||0,longitude:t.longitude||0,totalUnits:t.totalUnits||0,totalFloors:t.totalFloors||0,amenities:t.amenities||"",parkingSpaces:t.parkingSpaces||0,securityFeatures:t.securityFeatures||"",contactEmail:t.contactEmail||"",contactPhone:t.contactPhone||"",websiteUrl:t.websiteUrl||"",createdAt:new Date(t.createdAt),createdBy:t.createdBy||"",isDeleted:t.isDeleted};if(d(a),t.companyId){const e=yield i.getCompanyById(t.companyId);if(e.isSuccess&&e.data){const t=e.data,a={companyId:t.companyId||t.managementCompanyId||0,name:t.name||"",contactEmail:t.contactEmail||"",contactPhone:t.contactPhone||"",address:t.address||"",createdAt:new Date(t.createdAt),createdBy:t.createdBy||"",isDeleted:t.isDeleted||!1};l(a)}}}}}catch(e){}finally{f(!1)}}),[e,t,n,i]),M=reactExports.useCallback(()=>__async(void 0,null,function*(){try{f(!0),v(null);const e=N||t,a=yield s.getByCondominium(e);if(a.isSuccess&&a.data){const t=a.data;if(t.data&&Array.isArray(t.data)){const a=t.data.map(t=>({buildingId:t.buildingId,condoId:t.condoId||e,name:t.name,description:t.description,totalFloors:t.totalFloors,totalUnits:t.totalUnits,departmentsCount:t.totalUnits}));m(a)}else if(t.items&&Array.isArray(t.items)){const a=t.items.map(t=>({buildingId:t.buildingId,condoId:t.condoId||e,name:t.name,description:t.description,totalFloors:t.totalFloors,totalUnits:t.totalUnits,departmentsCount:t.totalUnits}));m(a)}else if(Array.isArray(t)){const a=t.map(t=>({buildingId:t.buildingId,condoId:t.condoId||e,name:t.name,description:t.description,totalFloors:t.totalFloors,totalUnits:t.totalUnits,departmentsCount:t.totalUnits}));m(a)}else m([])}else v(a.error||"Error al cargar los edificios")}catch(e){v("Error al cargar los edificios")}finally{f(!1)}}),[t,s]),k=reactExports.useCallback(e=>{g(e),x(!0)},[]),O=reactExports.useCallback(()=>{x(!1),g(void 0)},[]),$=reactExports.useCallback(e=>__async(void 0,null,function*(){try{if(f(!0),h){const a=N||t,r={buildingId:h.buildingId,condoId:a,name:e.name,description:e.description,totalFloors:e.totalFloors,totalUnits:e.totalUnits,routeId:1,updatedBy:"currentUser",updatedAt:(new Date).toISOString()},n=yield s.update(h.buildingId,r);n.isSuccess?yield M():v(n.error||"Error al actualizar el edificio")}else{const a={condoId:N||t,name:e.name,description:e.description,totalFloors:e.totalFloors||0,totalUnits:e.totalUnits||0,createdBy:"currentUser",createdAt:(new Date).toISOString()},r=yield s.create(a);r.isSuccess?yield M():v(r.error||"Error al crear el edificio")}}catch(a){v("Error al guardar los datos del edificio")}finally{f(!1),O()}}),[h,t,s,M,O]),U=reactExports.useCallback(e=>__async(void 0,null,function*(){if(window.confirm(`¿Está seguro que desea eliminar el edificio "${e.name}"?`))try{f(!0);const t=yield s.deleteBuilding(e.buildingId);t.isSuccess?yield M():v(t.error||"Error al eliminar el edificio")}catch(t){v("Error al eliminar el edificio")}finally{f(!1)}}),[s,M]),L=reactExports.useCallback(a=>{r(`/condominiums/departments/${S||e}/${N||t}/${a.buildingId}`)},[r,e,t,S,N]),B=reactExports.useCallback(e=>__async(void 0,null,function*(){const t=Number(e);_(t),C(0),I([]),m([]),t>0&&(yield P(t))}),[P]),F=reactExports.useCallback(e=>__async(void 0,null,function*(){const t=Number(e);C(t),m([]),t>0&&(yield w())}),[w]),V=reactExports.useCallback(()=>{N>0&&M()},[N,M]),W=[{accessorKey:"name",header:"Nombre"},{accessorKey:"description",header:"Descripción"},{accessorKey:"totalFloors",header:"Pisos"},{accessorKey:"totalUnits",header:"Total Departamentos"}],z=[{icon:DoorOpen,label:"Ver departamentos",onClick:e=>L(e)},{icon:SquarePen,label:"Editar",onClick:e=>k(e)},{icon:Trash2,label:"Eliminar",onClick:e=>U(e)}],H=b.map(e=>({value:e.companyId||e.managementCompanyId||0,label:e.name||"Sin nombre"})),G=R.map(e=>({value:e.condoId||0,label:e.name||"Sin nombre"}));return!E||o||c||T?T?jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6 p-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center mb-8",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Gestión de Edificios"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600",children:"Selecciona una empresa y condominio para ver sus edificios"})]}),jsxRuntimeExports.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-end",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Empresa Administradora"}),jsxRuntimeExports.jsx(SelectUI$1,{id:"company-select",label:"",value:S,onChange:e=>B(e),options:[{value:0,label:"Seleccione una empresa"},...H],placeholder:"Seleccione empresa..."})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Condominio"}),jsxRuntimeExports.jsx(SelectUI$1,{id:"condo-select",label:"",value:N,onChange:e=>F(e),options:[{value:0,label:"Seleccione un condominio"},...G],placeholder:"Seleccione condominio...",disabled:!S||0===R.length})]}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(ButtonUI,{icon:Search,title:"Buscar Edificios",theme:"primary",onClick:V,disabled:!N})})]})}),y&&jsxRuntimeExports.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:y}),E&&jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center p-8",children:[jsxRuntimeExports.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),jsxRuntimeExports.jsx("span",{className:"ml-3 text-gray-600",children:"Cargando edificios..."})]}),u.length>0&&o&&c&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[jsxRuntimeExports.jsx(Building2,{className:"h-5 w-5 text-primary"}),"Información General"]}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsxs("p",{className:"text-gray-700",children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Empresa:"})," ",o.name]}),jsxRuntimeExports.jsxs("p",{className:"text-gray-700",children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Condominio:"})," ",c.name]}),jsxRuntimeExports.jsxs("p",{className:"text-gray-700 flex items-center gap-2",children:[jsxRuntimeExports.jsx(MapPin,{className:"h-5 w-5 text-gray-500"}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Dirección:"})," ",c.address&&c.address.length>70?`${c.address.substring(0,70)}...`:c.address]})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Resumen"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-primary/5 p-4 rounded-lg",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500",children:"Total de Edificios"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-primary",children:u.length})]}),jsxRuntimeExports.jsxs("div",{className:"bg-accent/5 p-4 rounded-lg",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500",children:"Total de Departamentos"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-accent",children:u.reduce((e,t)=>e+t.totalUnits,0)})]})]})]})]})}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Lista de Edificios"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500",children:"Administra los edificios del condominio seleccionado"})]}),jsxRuntimeExports.jsx(ButtonUI,{icon:Plus,title:"Nuevo Edificio",theme:"primary",onClick:()=>k()})]}),jsxRuntimeExports.jsx(DataGrid,{data:u,columns:W,actions:z})]})]}):o&&c?jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:a?"":"space-y-6 p-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Gestión de Edificios"}),jsxRuntimeExports.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Administra los edificios del condominio"})]}),jsxRuntimeExports.jsx(ButtonUI,{icon:Plus,title:"Nuevo Edificio",theme:"primary",onClick:()=>k()})]}),jsxRuntimeExports.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200 mb-6",children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[jsxRuntimeExports.jsx(Building2,{className:"h-5 w-5 text-primary"}),"Información General"]}),jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsxs("p",{className:"text-gray-700",children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Empresa:"})," ",o.name]}),jsxRuntimeExports.jsxs("p",{className:"text-gray-700",children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Condominio:"})," ",c.name]}),jsxRuntimeExports.jsxs("p",{className:"text-gray-700 flex items-center gap-2",children:[jsxRuntimeExports.jsx(MapPin,{className:"h-5 w-5 text-gray-500"}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Dirección:"})," ",c.address&&c.address.length>70?`${c.address.substring(0,70)}...`:c.address]}),jsxRuntimeExports.jsxs("p",{className:"text-gray-700 flex items-center gap-2",children:[jsxRuntimeExports.jsx(Mail,{className:"h-5 w-5 text-gray-500"}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Email:"})," ",c.contactEmail]}),jsxRuntimeExports.jsxs("p",{className:"text-gray-700 flex items-center gap-2",children:[jsxRuntimeExports.jsx(Phone,{className:"h-5 w-5 text-gray-500"}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Teléfono:"})," ",c.contactPhone]})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Resumen"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-primary/5 p-4 rounded-lg",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500",children:"Total de Edificios"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-primary",children:u.length})]}),jsxRuntimeExports.jsxs("div",{className:"bg-accent/5 p-4 rounded-lg",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500",children:"Total de Departamentos"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-accent",children:u.reduce((e,t)=>e+t.totalUnits,0)})]})]})]})]})}),y&&jsxRuntimeExports.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-6",children:y}),jsxRuntimeExports.jsx(DataGrid,{data:u,columns:W,actions:z}),jsxRuntimeExports.jsx(ModalUI,{isOpen:p,onClose:O,title:h?"Editar Edificio":"Nuevo Edificio",footer:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ButtonUI,{icon:X$1,title:"Cancelar",onClick:O,theme:"modalCancel"}),jsxRuntimeExports.jsx(ButtonUI,{icon:Save,title:"Guardar",onClick:()=>document.forms[0].requestSubmit(),theme:"modalSave"})]}),children:jsxRuntimeExports.jsx(BuildingForm,{building:h,onSubmit:$})})]}):null:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center p-8",children:[jsxRuntimeExports.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),jsxRuntimeExports.jsx("span",{className:"ml-3 text-gray-600",children:"Cargando..."})]})});BuildingListAdvanced.displayName="BuildingListAdvanced";const LoadingSpinner=()=>jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center p-8",children:[jsxRuntimeExports.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),jsxRuntimeExports.jsx("span",{className:"ml-3 text-gray-600",children:"Cargando empresas gestoras..."})]}),ErrorAlert=({message:e,onDismiss:t,onRetry:a})=>jsxRuntimeExports.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4 mb-4",children:jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("div",{className:"flex-shrink-0",children:jsxRuntimeExports.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:jsxRuntimeExports.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),jsxRuntimeExports.jsx("div",{className:"ml-3 flex-1",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-red-800",children:e})}),jsxRuntimeExports.jsx("div",{className:"ml-auto pl-3",children:jsxRuntimeExports.jsxs("div",{className:"flex space-x-2",children:[a&&jsxRuntimeExports.jsx(ButtonUI,{title:"Reintentar",onClick:a,theme:"cancel",className:"text-xs px-2 py-1"}),t&&jsxRuntimeExports.jsx("button",{onClick:t,className:"bg-red-100 text-red-800 px-2 py-1 text-xs rounded hover:bg-red-200",children:"×"})]})})]})}),convertToManagementCompany=e=>{if(!e)return;const t=new ManagementCompany;return t.companyId=e.companyId||e.managementCompanyId||0,t.name=e.name||"",t.contactEmail=e.contactEmail,t.contactPhone=e.contactPhone,t.address=e.address,t.createdAt=new Date(e.createdAt),t.createdBy=e.createdBy||"",e.updatedAt&&(t.updatedAt=new Date(e.updatedAt)),t.updatedBy=e.updatedBy,t.isDeleted=e.isDeleted,t},ManagementCompanyAdvancedContent=reactExports.memo(()=>{const e=new ManagementCompanyService,{showToast:t,showConfirm:a}=useAlerts(),r=useNavigate(),{user:s}=useAuth(),[n,i]=reactExports.useState([]),[o,l]=reactExports.useState(!0),[c,d]=reactExports.useState(0),[u,m]=reactExports.useState(null),[p,x]=reactExports.useState(!1),[h,g]=reactExports.useState(""),[y,v]=reactExports.useState(1),[E,f]=reactExports.useState(10),[b,j]=reactExports.useState(null),[R,I]=reactExports.useState(),S=()=>__async(void 0,null,function*(){try{l(!0),m(null);const a={PageNumber:y,PageSize:E};h.trim()&&(a.NameFilter=h.trim()),2===(null==s?void 0:s.profileTypeId)&&(null==s?void 0:s.companyId)&&(a.CompanyId=s.companyId);const n=yield e.getPagedCompanies(a);if(n.isSuccess&&n.data){const e=n.data;i(e.items||[]),d(e.totalCount||0)}else{const e=n.error||"Error al cargar las empresas gestoras";m(e),t("error",e),401===n.statusCode&&r("/login")}}catch(a){const e=a instanceof Error?a.message:"Error desconocido";m(e),t("error",`Error al conectar con el servidor: ${e}`)}finally{l(!1)}}),_=reactExports.useCallback(()=>{I(void 0),x(!0)},[]),N=reactExports.useCallback(e=>{I(e),x(!0)},[]),C=reactExports.useCallback(r=>__async(void 0,null,function*(){a("Eliminar empresa gestora",`¿Estás seguro de eliminar la empresa "${r.name}"? Esta acción no se puede deshacer.`,()=>__async(void 0,null,function*(){try{const a=yield e.deleteCompany(r.companyId);a.isSuccess?(t("success",`Empresa ${r.name} eliminada correctamente`),yield S()):t("error",a.error||"Error al eliminar la empresa")}catch(a){const e=a instanceof Error?a.message:"Error desconocido";t("error",`Error al conectar con el servidor: ${e}`)}}))}),[e,a,t]),T=reactExports.useCallback(()=>{x(!1),I(void 0)},[]),D=reactExports.useCallback(a=>__async(void 0,null,function*(){try{if(R){const r=R.companyId,s={companyId:r,name:a.name||"",contactEmail:a.contactEmail||"",contactPhone:a.contactPhone||"",address:a.address||"",routeId:1,updatedAt:(new Date).toISOString(),updatedBy:"system"},n=yield e.update(r,s);n.isSuccess?(t("success",`Empresa ${s.name} actualizada correctamente`),T(),yield S()):t("error",n.error||"Error al actualizar la empresa")}else{const r={name:a.name||"",contactEmail:a.contactEmail||"",contactPhone:a.contactPhone||"",address:a.address||"",createdAt:(new Date).toISOString(),createdBy:"system"},s=yield e.create(r);s.isSuccess?(t("success",`Empresa ${r.name} creada correctamente`),T(),yield S()):t("error",s.error||"Error al crear la empresa")}}catch(r){const e=r instanceof Error?r.message:"Error desconocido";t("error",`Error al conectar con el servidor: ${e}`)}}),[R,e,t,T]),A=reactExports.useCallback(()=>__async(void 0,null,function*(){try{t("info","Descargando plantilla...");const e=document.createElement("a");e.href="/plantilla_condominios.xlsx",e.download="plantilla_condominios.xlsx",document.body.appendChild(e),e.click(),document.body.removeChild(e),t("success","Plantilla descargada correctamente")}catch(e){t("error","Error al descargar la plantilla")}}),[t]),P=reactExports.useCallback(()=>{r("/condominiums/data-bulk")},[r]),w=reactExports.useCallback(e=>{j({type:"condominiums",companyId:e.companyId||e.managementCompanyId})},[]),M=reactExports.useCallback((e,t)=>{j({type:"buildings",companyId:e,condoId:t})},[]),k=reactExports.useMemo(()=>{const e=n.reduce((e,t)=>e+(t.condominiumCount||0),0),t=n.reduce((e,t)=>e+(t.systemUserCount||0),0),a=n.filter(e=>!e.isDeleted).length;return{totalCompanies:n.length,activeCompanies:a,totalCondominiums:e,totalUsers:t}},[n]);reactExports.useEffect(()=>{S()},[y,E]),reactExports.useEffect(()=>{(h.length>2||0===h.length)&&(v(1),S())},[h]);const O=[{accessorKey:"name",header:"Empresa",cell:({getValue:e,row:t})=>jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"font-medium text-gray-900",children:e()}),jsxRuntimeExports.jsxs("div",{className:"text-sm text-gray-500",children:[t.original.condominiumCount||0," condominios • ",t.original.systemUserCount||0," usuarios"]})]})},{accessorKey:"contactEmail",header:"Contacto",icon:Mail,cell:({getValue:e,row:t})=>jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-sm text-gray-900",children:e()}),jsxRuntimeExports.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-1",children:[jsxRuntimeExports.jsx(Phone,{className:"h-3 w-3"}),t.original.contactPhone]})]})},{accessorKey:"address",header:"Dirección",icon:MapPin,cell:({getValue:e})=>{const t=e();return t&&t.length>50?`${t.substring(0,50)}...`:t}},{accessorKey:"createdAt",header:"Fecha Creación",cell:({getValue:e})=>{const t=e();return t?new Date(t).toLocaleDateString("es-ES"):""}},{accessorKey:"isDeleted",header:"Estado",cell:({getValue:e})=>{const t=e();return jsxRuntimeExports.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full "+(t?"bg-red-100 text-red-800":"bg-green-100 text-green-800"),children:t?"Inactivo":"Activo"})}}],$=reactExports.useMemo(()=>{const e=[{icon:Eye,label:"Ver condominios",onClick:w},{icon:Building,label:"Ver Departamentos",onClick:e=>{r(`/condominiums/departments/${e.companyId}`)}}];return 2===(null==s?void 0:s.profileTypeId)?e:[...e,{icon:SquarePen,label:"Editar",onClick:N},{icon:Trash2,label:"Eliminar",onClick:C}]},[null==s?void 0:s.profileTypeId,w,r,N,C]),U=()=>jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[jsxRuntimeExports.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"flex-shrink-0",children:jsxRuntimeExports.jsx(Building2,{className:"h-8 w-8 text-blue-600"})}),jsxRuntimeExports.jsxs("div",{className:"ml-4",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Empresas"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-gray-900",children:k.totalCompanies})]})]})}),jsxRuntimeExports.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"flex-shrink-0",children:jsxRuntimeExports.jsx("div",{className:"h-8 w-8 bg-green-100 rounded-full flex items-center justify-center",children:jsxRuntimeExports.jsx("div",{className:"h-4 w-4 bg-green-600 rounded-full"})})}),jsxRuntimeExports.jsxs("div",{className:"ml-4",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Empresas Activas"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-gray-900",children:k.activeCompanies})]})]})}),jsxRuntimeExports.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"flex-shrink-0",children:jsxRuntimeExports.jsx(Building,{className:"h-8 w-8 text-purple-600"})}),jsxRuntimeExports.jsxs("div",{className:"ml-4",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Condominios"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-gray-900",children:k.totalCondominiums})]})]})}),jsxRuntimeExports.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"flex-shrink-0",children:jsxRuntimeExports.jsx("svg",{className:"h-8 w-8 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})})}),jsxRuntimeExports.jsxs("div",{className:"ml-4",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Usuarios"}),jsxRuntimeExports.jsx("p",{className:"text-2xl font-bold text-gray-900",children:k.totalUsers})]})]})})]});return jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6 p-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Empresas Administradoras"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 mt-2",children:2===(null==s?void 0:s.profileTypeId)?"Visualiza la información de tu empresa":"Gestiona las empresas que administran los condominios"})]}),2!==(null==s?void 0:s.profileTypeId)&&jsxRuntimeExports.jsxs("div",{className:"flex space-x-3",children:[jsxRuntimeExports.jsx(ButtonUI,{icon:Download,title:"Descargar Plantilla",theme:"info",onClick:A}),jsxRuntimeExports.jsx(ButtonUI,{icon:Upload,title:"Carga Masiva",theme:"secondary",onClick:P}),jsxRuntimeExports.jsx(ButtonUI,{icon:Plus,title:"Nueva Empresa",theme:"primary",onClick:_})]})]}),jsxRuntimeExports.jsx(U,{}),u&&jsxRuntimeExports.jsx(ErrorAlert,{message:u,onDismiss:()=>m(null),onRetry:S}),jsxRuntimeExports.jsx(Expandex,{title:"Filtros de búsqueda",initialExpanded:!1,expandIcon:Filter,backgroundColor:"#f9fafb",className:"mb-6",children:jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(InputUI,{id:"nameFilter",label:"Nombre de la empresa",placeholder:"Buscar por nombre...",icon:Search,value:h,onChange:e=>g(e),className:""+(h?"border-primary":"")}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Escribe al menos 3 caracteres para filtrar automáticamente"})]})})}),o?jsxRuntimeExports.jsx(LoadingSpinner,{}):jsxRuntimeExports.jsx(DataGrid,{data:n,columns:O,actions:$,onPageChange:(e,t)=>{v(e),f(t)},onPageSizeChange:(e,t)=>{f(e),v(t)},initialPage:y,initialPageSize:E,totalRecords:c,getRowId:e=>`${e.companyId}`}),jsxRuntimeExports.jsx(AnimatePresence,{mode:"wait",children:b&&jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"bg-white rounded-lg shadow-lg border border-gray-200 overflow-hidden",children:["condominiums"===b.type&&b.companyId&&jsxRuntimeExports.jsx("div",{className:"p-6",children:jsxRuntimeExports.jsx(CondominiumListAdvanced,{companyId:b.companyId,onViewBuildings:e=>M(b.companyId,e),embedded:!0})}),"buildings"===b.type&&b.companyId&&b.condoId&&jsxRuntimeExports.jsx("div",{className:"p-6",children:jsxRuntimeExports.jsx(BuildingListAdvanced,{companyId:b.companyId,condoId:b.condoId,embedded:!0})})]},`${b.type}-${b.companyId}-${b.condoId}`)}),jsxRuntimeExports.jsx(ModalUI,{isOpen:p,onClose:T,title:R?"Editar Empresa":"Nueva Empresa",footer:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ButtonUI,{icon:X$1,title:"Cancelar",onClick:T,theme:"modalCancel"}),jsxRuntimeExports.jsx(ButtonUI,{icon:Save,title:"Guardar",onClick:()=>document.forms[0].requestSubmit(),theme:"modalSave"})]}),children:jsxRuntimeExports.jsx(ManagementCompanyForm,{company:convertToManagementCompany(R),onSubmit:D})})]})});ManagementCompanyAdvancedContent.displayName="ManagementCompanyAdvancedContent";const ManagementCompanyAdvanced=()=>jsxRuntimeExports.jsx(AlertProvider,{children:jsxRuntimeExports.jsx(ManagementCompanyAdvancedContent,{})});class DepartmentService extends ApiBaseService{constructor(){super("/Department")}getDepartmentById(e){return __async(this,null,function*(){return __superGet(DepartmentService.prototype,this,"getById").call(this,e)})}getPagedDepartments(e){return __async(this,null,function*(){const t=e?__spreadProps(__spreadValues({},e),{DepartmentNumber:e.DepartmentNumber||void 0}):void 0;return __superGet(DepartmentService.prototype,this,"getPaged").call(this,"paged",t)})}getStatuses(){return __async(this,null,function*(){return this.get("status")})}create(e){return __async(this,null,function*(){return this.post("",e)})}update(e,t){return __async(this,null,function*(){return this.put(`/${e}`,t)})}deleteDepartment(e){return __async(this,null,function*(){return __superGet(DepartmentService.prototype,this,"deleteById").call(this,e)})}getDepartmentsByBuilding(e){return __async(this,null,function*(){return this.get(`by-building/${e}`)})}getByBuilding(e,t=1,a=10){return __async(this,null,function*(){const r={Page:t,PageSize:a,BuildingId:e};return this.getPagedDepartments(r)})}searchByNumber(e,t=1,a=10){return __async(this,null,function*(){const r={Page:t,PageSize:a,DepartmentNumber:e};return this.getPagedDepartments(r)})}getByStatus(e,t=1,a=10){return __async(this,null,function*(){const r={Page:t,PageSize:a,StatusTypeId:e};return this.getPagedDepartments(r)})}getByFloor(e,t,a=1,r=10){return __async(this,null,function*(){const s={Page:a,PageSize:r,FloorNumber:e,BuildingId:t};return this.getPagedDepartments(s)})}}function AnnexForm({annex:e,departmentId:t,condoId:a,onSubmit:r,formId:s="annexForm",annexTypes:n}){var i;const[o,l]=reactExports.useState({departmentId:t,condoId:a,annexTypeId:(null==e?void 0:e.annexTypeId)||0,annexNumber:"annexNumber"in(e||{})?e.annexNumber:"",squareMeters:(null==e?void 0:e.squareMeters)||0,description:(null==e?void 0:e.description)||""});reactExports.useEffect(()=>{if(e){const r={departmentId:t,condoId:a,annexTypeId:e.annexTypeId,description:e.description,squareMeters:e.squareMeters||0,annexNumber:"annexNumber"in e?e.annexNumber:"",annexPropertyId:"annexPropertyId"in e?e.annexPropertyId:void 0};l(r)}},[e,t,a]);const c=n.map(e=>({value:e.annexTypeId,label:e.annexName}));reactExports.useEffect(()=>{if(n.length>0&&(null==e?void 0:e.annexTypeId)){n.some(t=>t.annexTypeId===e.annexTypeId)&&l(t=>__spreadProps(__spreadValues({},t),{annexTypeId:e.annexTypeId}))}},[n,null==e?void 0:e.annexTypeId]);return jsxRuntimeExports.jsxs("form",{id:s,onSubmit:e=>{e.preventDefault(),e.stopPropagation(),r(o)},className:"space-y-6",children:[jsxRuntimeExports.jsx(SelectUI$1,{id:`${s}-annexType`,label:"Tipo de Anexo",icon:Box,value:(()=>{if(0===o.annexTypeId||void 0===o.annexTypeId||null===o.annexTypeId)return"";const e=Number(o.annexTypeId);c.some(t=>t.value===e);return e})(),onChange:e=>{const t="string"==typeof e?parseInt(e):e;l(__spreadProps(__spreadValues({},o),{annexTypeId:t}))},options:c,placeholder:"Seleccione el tipo de anexo",required:!0,disabled:0===c.length}),jsxRuntimeExports.jsx(InputUI,{id:`${s}-annexNumber`,label:"Número de Anexo",icon:Hash,value:o.annexNumber||"",onChange:e=>l(__spreadProps(__spreadValues({},o),{annexNumber:e})),placeholder:"Ej: C-101",required:!0,maxLength:20}),jsxRuntimeExports.jsx(InputUI,{id:`${s}-squareMeters`,label:"Metros Cuadrados",type:"number",icon:Ruler,value:(null==(i=o.squareMeters)?void 0:i.toString())||"",onChange:e=>l(__spreadProps(__spreadValues({},o),{squareMeters:parseFloat(e)||0})),placeholder:"Ej: 12.5",required:!0}),jsxRuntimeExports.jsx(TextAreaUI,{id:`${s}-description`,label:"Descripción",icon:AlignLeft,value:o.description||"",onChange:e=>l(__spreadProps(__spreadValues({},o),{description:e})),placeholder:"Descripción del anexo",maxLength:200})]})}class AnnexPropertyService extends ApiBaseService{constructor(){super("/AnnexProperty")}getAnnexPropertyById(e){return __async(this,null,function*(){return __superGet(AnnexPropertyService.prototype,this,"getById").call(this,e)})}getPagedAnnexProperties(e){return __async(this,null,function*(){const t=e?{SearchTerm:e.SearchTerm||void 0,DepartmentId:e.DepartmentId||void 0,AnnexTypeId:e.AnnexTypeId||void 0,IsDeleted:e.IsDeleted||void 0,page:e.page||void 0,pageSize:e.pageSize||void 0}:void 0;return __superGet(AnnexPropertyService.prototype,this,"getPaged").call(this,"paged",t)})}create(e){return __async(this,null,function*(){return this.post("",e)})}update(e,t){return __async(this,null,function*(){return this.put(`/${e}`,t)})}deleteAnnexProperty(e){return __async(this,null,function*(){return __superGet(AnnexPropertyService.prototype,this,"deleteById").call(this,e)})}getByDepartment(e,t=1,a=10){return __async(this,null,function*(){const r={page:t,pageSize:a,DepartmentId:e};return this.getPagedAnnexProperties(r)})}getByAnnexType(e,t=1,a=10){return __async(this,null,function*(){const r={page:t,pageSize:a,AnnexTypeId:e};return this.getPagedAnnexProperties(r)})}getActiveProperties(e=1,t=10){return __async(this,null,function*(){const a={page:e,pageSize:t,IsDeleted:!1};return this.getPagedAnnexProperties(a)})}searchByTerm(e,t=1,a=10){return __async(this,null,function*(){const r={page:t,pageSize:a,SearchTerm:e};return this.getPagedAnnexProperties(r)})}setAvailability(e,t){return __async(this,null,function*(){const a={isAvailable:t,updatedAt:(new Date).toISOString()};return this.patch(`/${e}/availability`,a)})}assignToDepartment(e,t){return __async(this,null,function*(){const a={departmentId:t,isAvailable:!1,updatedAt:(new Date).toISOString()};return this.patch(`/${e}/assign`,a)})}unassignFromDepartment(e){return __async(this,null,function*(){const t={departmentId:null,isAvailable:!0,updatedAt:(new Date).toISOString()};return this.patch(`/${e}/unassign`,t)})}}function AnnexList({departmentId:e,condoId:t}){const{showToast:a,showConfirm:r}=useAlerts(),[s,n]=reactExports.useState([]),[i,o]=reactExports.useState(!1),[l,c]=reactExports.useState(),[d,u]=reactExports.useState(!1),[m,p]=reactExports.useState([]),[x,h]=reactExports.useState(!1),[g,y]=reactExports.useState(void 0),v=new AnnexPropertyService,E="annexForm",f=e=>"annexId"in e&&!("annexPropertyId"in e)?__spreadProps(__spreadValues({},e),{annexPropertyId:e.annexId}):e;reactExports.useEffect(()=>{e>0&&b()},[e]);const b=()=>__async(this,null,function*(){try{u(!0);const t=yield v.getPaged({DepartmentId:e,IsDeleted:!1});if(t.isSuccess&&t.data){let e=[];if("items"in t.data&&Array.isArray(t.data.items))e=t.data.items.map(f),e.forEach((e,t)=>{});else if(Array.isArray(t.data))e=t.data.map(f),e.forEach((e,t)=>{});else if("object"==typeof t.data&&null!==t.data){const a=t.data;if("annexId"in a||"annexPropertyId"in a){e=[f(a)]}else"data"in a&&Array.isArray(a.data)&&(e=a.data.map(f),e.forEach((e,t)=>{}))}e.filter(e=>!e.annexPropertyId).length,n(e),e.length}else n([]),t.isSuccess||a("error",`Error al cargar los anexos: ${t.error}`)}catch(t){a("error","Error al cargar los anexos"),n([])}finally{u(!1)}}),j=()=>__async(this,null,function*(){try{0;const e=yield v.getTypes();return e.isSuccess&&e.data?(p(e.data),!0):(a("error","Error al cargar los tipos de anexos"),!1)}catch(e){return a("error","Error al cargar los tipos de anexos"),!1}}),R=e=>__async(this,null,function*(){try{u(!0),y(e),h(!0);if(!(yield j()))return a("error","No se pudieron cargar los tipos de anexos"),void u(!1);0;const t=yield v.getById(e);if(t.isSuccess&&t.data){if(t.data.annexPropertyId||(t.data.annexPropertyId=e),!t.data.annexTypeId&&t.data.annexTypeName){const e=m.find(e=>e.annexName===t.data.annexTypeName);e&&(t.data.annexTypeId=e.annexTypeId)}setTimeout(()=>{c(t.data),o(!0),u(!1)},100)}else a("error","Error al cargar los detalles del anexo, pero se mantendrá en modo edición"),u(!1)}catch(t){a("error","Error al cargar los detalles del anexo, pero se mantendrá en modo edición"),u(!1)}}),I=e=>__async(this,null,function*(){u(!0),e&&e.annexPropertyId?(h(!0),y(e.annexPropertyId)):(h(!1),y(void 0));if(!(yield j()))return a("error","No se pudieron cargar los tipos de anexos"),void u(!1);e&&e.annexPropertyId?R(e.annexPropertyId):(c(void 0),setTimeout(()=>{o(!0),u(!1)},100))}),S=()=>{o(!1),c(void 0),h(!1),y(void 0),e>0&&b()},_=e=>{e&&void 0!==e.annexPropertyId?r("Eliminar anexo","¿Está seguro que desea eliminar este anexo?",()=>__async(this,null,function*(){try{u(!0);const t=e.annexPropertyId,r=yield v.delete(t);r.isSuccess?(a("success","Anexo eliminado correctamente"),yield b()):a("error",`Error: ${r.error||"Ha ocurrido un error"}`)}catch(t){a("error","Error al eliminar el anexo")}finally{u(!1)}}),()=>{}):a("error","Error: El ID del anexo no es válido")},N=[{icon:SquarePen,label:"Editar",onClick:e=>I(e)},{icon:Trash2,label:"Eliminar",onClick:e=>_(e)}];return jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Anexos"}),jsxRuntimeExports.jsx(ButtonUI,{icon:Plus,title:"Nuevo Anexo",borderColor:"var(--color-primary-admin)",textColor:"#ffffff",className:"bg-primary hover:bg-primary/90",onClick:()=>I(),disabled:d})]}),d&&0===s.length?jsxRuntimeExports.jsx("div",{className:"text-center py-4 text-gray-500",children:"Cargando anexos..."}):0===s.length?jsxRuntimeExports.jsxs("div",{className:"text-center py-4 text-gray-500",children:["No hay datos disponibles",jsxRuntimeExports.jsx("button",{onClick:()=>b(),className:"ml-2 text-blue-500 underline hover:text-blue-700",children:"Refrescar"})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("pre",{className:"text-xs text-gray-500 mb-2",children:["Anexos cargados: ",s.length]}),jsxRuntimeExports.jsx(DataGrid,{data:s,columns:[{accessorKey:"annexTypeName",header:"Tipo"},{accessorKey:"departmentNumber",header:"Departamento"},{accessorKey:"squareMeters",header:"Área (m²)"},{accessorKey:"description",header:"Descripción"}],actions:N})]}),jsxRuntimeExports.jsx(ModalUI,{isOpen:i,onClose:S,title:x?"Editar Anexo":"Nuevo Anexo",footer:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ButtonUI,{icon:X$1,title:"Cancelar",onClick:S,borderColor:"var(--color-action-delete)",textColor:"var(--color-action-delete)",className:"hover:bg-red-50",disabled:d}),jsxRuntimeExports.jsx(ButtonUI,{icon:Save,title:"Guardar",onClick:e=>{e&&(e.preventDefault(),e.stopPropagation());const t=document.getElementById(E);t&&t.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))},borderColor:"var(--color-primary-admin)",textColor:"#ffffff",className:"bg-primary hover:bg-primary/90",disabled:d})]}),children:jsxRuntimeExports.jsx(AnnexForm,{annex:l,departmentId:e,condoId:t,onSubmit:r=>__async(this,null,function*(){try{let s;u(!0);let n=!1;const i=l&&l.annexPropertyId?l.annexPropertyId:g;if(x){if(!i)return a("error","Error: No se pudo determinar el ID del anexo a actualizar"),void u(!1);const o={annexPropertyId:i,annexId:i,condoId:r.condoId||t,departmentId:r.departmentId||e,annexTypeId:r.annexTypeId,annexNumber:r.annexNumber||"",description:r.description,squareMeters:r.squareMeters,updatedBy:"user",updatedAt:(new Date).toISOString(),routeId:i};s=yield v.update(i,o),s.isSuccess&&(a("success","Anexo actualizado correctamente"),n=!0)}else{const i={condoId:r.condoId||t,departmentId:r.departmentId||e,annexTypeId:r.annexTypeId||0,annexNumber:r.annexNumber||"",description:r.description,squareMeters:r.squareMeters,createdBy:"user"};s=yield v.create(i),s.isSuccess&&(a("success","Anexo creado correctamente"),n=!0)}s.isSuccess?(n&&(yield b()),S()):a("error",`Error: ${s.error||"Ha ocurrido un error"}`)}catch(s){a("error","Error al guardar el anexo")}finally{u(!1)}}),formId:E,annexTypes:m})})]})}const LoadingContext=reactExports.createContext(void 0),useLoading=()=>{const e=reactExports.useContext(LoadingContext);if(!e)throw new Error("useLoading debe ser usado dentro de un LoadingProvider");return e},LoadingProvider=({children:e})=>{const[t,a]=reactExports.useState(!1),[r,s]=reactExports.useState(0),[n,i]=reactExports.useState(!1);reactExports.useEffect(()=>{let e;return t?e=setTimeout(()=>{i(!0)},50):i(!1),()=>{e&&clearTimeout(e)}},[t]);const o=reactExports.useCallback(e=>{a(e)},[]),l=reactExports.useCallback(()=>{s(e=>{const t=e+1;return t>0&&a(!0),t})},[]),c=reactExports.useCallback(()=>{s(e=>{const t=Math.max(0,e-1);return 0===t&&a(!1),t})},[]);return jsxRuntimeExports.jsxs(LoadingContext.Provider,{value:{isLoading:t,setLoading:o,incrementLoading:l,decrementLoading:c},children:[e,n&&jsxRuntimeExports.jsxs("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9999,animation:"fadeIn 0.2s ease-in-out"},children:[jsxRuntimeExports.jsx($5cff71254109409f$export$e21573137ccb7f5d,{height:"150",width:"150",color:"var(--color-primary-admin)",wrapperStyle:{},wrapperClass:"",visible:!0,ariaLabel:"three-circles-rotating",outerCircleColor:"var(--color-primary-admin)",innerCircleColor:"var(--color-primary-admin)",middleCircleColor:"var(--color-primary-admin)"}),jsxRuntimeExports.jsx("p",{className:"text-inverse-dynamic",style:{fontSize:"18px",fontWeight:"bold",marginTop:"15px",textShadow:"1px 1px 3px rgba(0,0,0,0.5)"},children:"... Cargando"})]}),jsxRuntimeExports.jsx("style",{children:"\n        @keyframes fadeIn {\n          from { opacity: 0; }\n          to { opacity: 1; }\n        }\n      "})]})};function DepartmentForm({department:e,buildingId:t,onSubmit:a}){var r,s,n,i,o;const{setLoading:l}=useLoading(),[c,d]=reactExports.useState([]),[u,m]=reactExports.useState({buildingId:t,departmentNumber:"",floorNumber:void 0,squareMeters:void 0,bedrooms:void 0,bathrooms:void 0,balcony:!1,participationPercentage:void 0,statusTypeId:1,petsAllowed:!1});reactExports.useEffect(()=>{if(e){const a="string"==typeof e.statusTypeId?parseInt(e.statusTypeId):e.statusTypeId||1;m(__spreadProps(__spreadValues({},e),{buildingId:t||e.buildingId,statusTypeId:a}))}else m({buildingId:t,departmentNumber:"",floorNumber:void 0,squareMeters:void 0,bedrooms:void 0,bathrooms:void 0,balcony:!1,participationPercentage:void 0,statusTypeId:1,petsAllowed:!1});p()},[e,t]);const p=()=>__async(this,null,function*(){try{l(!0);const t=new DepartmentService,a=yield t.getStatusTypes();if(a.isSuccess&&a.data&&(d(a.data),e&&e.statusTypeId)){const t="string"==typeof e.statusTypeId?parseInt(e.statusTypeId):e.statusTypeId;m(e=>__spreadProps(__spreadValues({},e),{statusTypeId:t}))}}catch(t){}finally{l(!1)}}),x=c.length>0?c.map(e=>({value:e.statusTypeId,label:e.statusName})):[{value:1,label:"Cargando estados..."}];return jsxRuntimeExports.jsxs("div",{className:"space-y-8",children:[jsxRuntimeExports.jsx("form",{onSubmit:e=>{e.preventDefault(),u.departmentNumber&&u.statusTypeId&&a(u)},className:"space-y-6",children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[jsxRuntimeExports.jsx(InputUI,{id:"departmentNumber",label:"Número de Departamento",icon:Home,value:u.departmentNumber||"",onChange:e=>m(__spreadProps(__spreadValues({},u),{departmentNumber:e})),placeholder:"Ej: 101",required:!0,maxLength:10}),jsxRuntimeExports.jsx(InputUI,{id:"floorNumber",label:"Número de Piso",type:"number",icon:Hash,value:(null==(r=u.floorNumber)?void 0:r.toString())||"",onChange:e=>m(__spreadProps(__spreadValues({},u),{floorNumber:parseInt(e)||void 0})),placeholder:"Ej: 1",required:!0}),jsxRuntimeExports.jsx(InputUI,{id:"squareMeters",label:"Metros Cuadrados",type:"number",icon:Ruler,value:(null==(s=u.squareMeters)?void 0:s.toString())||"",onChange:e=>m(__spreadProps(__spreadValues({},u),{squareMeters:parseFloat(e)||void 0})),placeholder:"Ej: 75.5",required:!0}),jsxRuntimeExports.jsx(InputUI,{id:"bedrooms",label:"Dormitorios",type:"number",icon:Bed,value:(null==(n=u.bedrooms)?void 0:n.toString())||"",onChange:e=>m(__spreadProps(__spreadValues({},u),{bedrooms:parseInt(e)||void 0})),placeholder:"Ej: 2",required:!0}),jsxRuntimeExports.jsx(InputUI,{id:"bathrooms",label:"Baños",type:"number",icon:Bath,value:(null==(i=u.bathrooms)?void 0:i.toString())||"",onChange:e=>m(__spreadProps(__spreadValues({},u),{bathrooms:parseInt(e)||void 0})),placeholder:"Ej: 1",required:!0}),jsxRuntimeExports.jsx(InputUI,{id:"participationPercentage",label:"Porcentaje de Cobranza",type:"number",icon:Percent,value:(null==(o=u.participationPercentage)?void 0:o.toString())||"",onChange:e=>m(__spreadProps(__spreadValues({},u),{participationPercentage:parseFloat(e)||void 0})),placeholder:"Ej: 2.5",required:!0}),jsxRuntimeExports.jsx(SelectUI$1,{id:"balcony",label:"Balcón",icon:Home,value:u.balcony?"1":"0",onChange:e=>m(__spreadProps(__spreadValues({},u),{balcony:"1"===e})),options:[{value:"1",label:"Sí"},{value:"0",label:"No"}],required:!0}),jsxRuntimeExports.jsx(SelectUI$1,{id:"petsAllowed",label:"Mascotas Permitidas",icon:Dog,value:u.petsAllowed?"1":"0",onChange:e=>m(__spreadProps(__spreadValues({},u),{petsAllowed:"1"===e})),options:[{value:"1",label:"Sí"},{value:"0",label:"No"}],required:!0}),jsxRuntimeExports.jsx(SelectUI$1,{id:"statusTypeId",label:"Estado del Departamento",icon:Activity,value:u.statusTypeId||1,onChange:e=>m(__spreadProps(__spreadValues({},u),{statusTypeId:"string"==typeof e?parseInt(e):e})),options:x,placeholder:"Seleccione un estado",required:!0,disabled:0===x.length})]})}),e&&jsxRuntimeExports.jsx("div",{className:"border-t pt-6",children:jsxRuntimeExports.jsx(AnnexList,{departmentId:e.departmentId,condoId:e.condoId})})]})}var TipoRelacionDepartamentoUsuario=(e=>(e[e.PROPIETARIO=1]="PROPIETARIO",e[e.INQUILINO=2]="INQUILINO",e[e.FAMILIAR=3]="FAMILIAR",e[e.REPRESENTANTE_LEGAL=4]="REPRESENTANTE_LEGAL",e[e.COPROPIETARIO=5]="COPROPIETARIO",e))(TipoRelacionDepartamentoUsuario||{});class DepartamentUserService extends ApiBaseService{constructor(){super("/DepartamentUser")}getByDepartmentAndUser(e,t){return __async(this,null,function*(){return this.get(`/${e}/${t}`)})}getPagedDepartamentUsers(e){return __async(this,null,function*(){const t=e?__spreadValues({},e):void 0;return __superGet(DepartamentUserService.prototype,this,"getPaged").call(this,"paged",t)})}create(e){return __async(this,null,function*(){return this.post("",e)})}update(e,t,a){return __async(this,null,function*(){return this.put(`/${e}/${t}`,a)})}deleteDepartamentUser(e,t){return __async(this,null,function*(){return this.delete(`/${e}/${t}`)})}delete(e,t){return __async(this,null,function*(){return this.deleteDepartamentUser(e,t)})}getByDepartment(e,t=1,a=10){return __async(this,null,function*(){const r={Page:t,PageSize:a,DepartmentId:e};return this.getPagedDepartamentUsers(r)})}getByUser(e,t=1,a=10){return __async(this,null,function*(){const r={Page:t,PageSize:a,UserId:e};return this.getPagedDepartamentUsers(r)})}getByRelationshipType(e,t=1,a=10){return __async(this,null,function*(){const e={Page:t,PageSize:a};return this.getPagedDepartamentUsers(e)})}getActive(e=1,t=10){return __async(this,null,function*(){const a={Page:e,PageSize:t,IsActive:!0};return this.getPagedDepartamentUsers(a)})}}const DepartmentResidentsModal=({isOpen:e,onClose:t,department:a})=>{var r;const[s,n]=reactExports.useState([]),[i,o]=reactExports.useState([]),[l,c]=reactExports.useState(""),[d,u]=reactExports.useState(void 0),[m,p]=reactExports.useState(null),[x,h]=reactExports.useState(!1),[g,y]=reactExports.useState(1),[v,E]=reactExports.useState(5),[f,b]=reactExports.useState(0),[j,R]=reactExports.useState(!1),[I,S]=reactExports.useState({departmentId:a.departmentId,userId:void 0,tipoRelacionId:void 0,fechaInicio:(new Date).toISOString().split("T")[0],fechaFin:null,isActive:!0}),[_,N]=reactExports.useState({}),{showToast:C,showConfirm:T}=useAlerts(),D=new DepartamentUserService,A=new SystemUserService,P=reactExports.useRef(null),w=reactExports.useRef(null),M=[{value:TipoRelacionDepartamentoUsuario.PROPIETARIO.toString(),label:"Propietario"},{value:TipoRelacionDepartamentoUsuario.INQUILINO.toString(),label:"Inquilino"},{value:TipoRelacionDepartamentoUsuario.FAMILIAR.toString(),label:"Familiar"},{value:TipoRelacionDepartamentoUsuario.REPRESENTANTE_LEGAL.toString(),label:"Representante Legal"},{value:TipoRelacionDepartamentoUsuario.COPROPIETARIO.toString(),label:"Copropietario"}];reactExports.useEffect(()=>{e&&a&&k()},[e,a,g,v]),reactExports.useEffect(()=>{e&&a&&l.length>2?O():o([])},[e,a,l]),reactExports.useEffect(()=>{function e(e){P.current&&!P.current.contains(e.target)&&w.current&&!w.current.contains(e.target)&&o([])}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),reactExports.useEffect(()=>{if(l&&l.includes(" ")&&i.length>0){i.find(e=>`${e.firstName} ${e.lastName}${e.secondLastName?" "+e.secondLastName:""}`===l)&&o([])}},[l,i]);const k=()=>__async(void 0,null,function*(){try{const e=yield D.getByDepartment(a.departmentId,1,100);if(e.isSuccess&&e.data){let t=[];Array.isArray(e.data)?t=e.data:e.data.items?t=e.data.items:e.data.data&&Array.isArray(e.data.data)&&(t=e.data.data);const a=t.map(e=>__spreadProps(__spreadValues({},e),{userName:e.userName||`Usuario ID: ${e.userId}`,firstName:e.firstName||"",lastName:e.lastName||"",secondLastName:e.secondLastName||"",email:e.userEmail||""}));n(a),b(a.length),a.length>0&&C("success",`Se cargaron ${a.length} residentes correctamente.`)}else C("error",e.error||"Error al cargar residentes")}catch(e){C("error","Error al cargar residentes")}}),O=()=>__async(void 0,null,function*(){try{const e={SearchTerm:l,CompanyId:a.companyId,CondoId:a.condoId,IsInternalUser:!1,Page:1,PageSize:20},t=yield A.getPaged(e);if(t.isSuccess&&t.data){let e=[];Array.isArray(t.data)?e=t.data:t.data.items?e=t.data.items:t.data.data&&Array.isArray(t.data.data)&&(e=t.data.data),o(e)}}catch(e){}}),$=(e,t)=>{S(a=>__spreadProps(__spreadValues({},a),{[e]:t}))},U=(e,t)=>{S(a=>__spreadProps(__spreadValues({},a),{[e]:t}))},L=()=>{S({departmentId:a.departmentId,userId:void 0,tipoRelacionId:void 0,fechaInicio:(new Date).toISOString().split("T")[0],fechaFin:null,isActive:!0}),u(void 0),p(null),c(""),h(!1),o([]),N({}),x||R(!1),setTimeout(()=>{document.querySelectorAll(".border-red-500").forEach(e=>{e.classList.remove("border-red-500"),e.classList.remove("focus:ring-red-500"),e.classList.remove("focus:border-red-500")});document.querySelectorAll(".text-red-500").forEach(e=>{var t;(null==(t=e.textContent)?void 0:t.includes("obligatorio"))&&(e.textContent="",e.classList.add("hidden"))});document.querySelectorAll("input[required], select[required]").forEach(e=>{e.classList.remove("border-red-500"),e.setCustomValidity("")})},0)},B=()=>{const e={userId:!I.userId,tipoRelacionId:!I.tipoRelacionId,fechaInicio:!I.fechaInicio};return N(e),!e.userId&&!e.tipoRelacionId&&!e.fechaInicio},F=e=>s.some(t=>t.userId===e),V=[{accessorKey:"userId",header:"Residente",icon:User,cell:({row:e})=>{const t=e.original,a=`${t.firstName||""} ${t.lastName||""} ${t.secondLastName||""}`.trim();return jsxRuntimeExports.jsxs("div",{className:"flex flex-col",children:[jsxRuntimeExports.jsx("span",{className:"font-medium text-gray-900",children:a||t.userName||`Usuario ID: ${t.userId}`}),t.userName&&a&&jsxRuntimeExports.jsxs("span",{className:"text-sm text-gray-500",children:["@",t.userName]})]})}},{accessorKey:"tipoRelacionNombre",header:"Tipo de Relación",icon:Home,cell:({row:e})=>{const t=e.original;return jsxRuntimeExports.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:t.tipoRelacionNombre||"No definido"})}},{accessorKey:"fechaInicio",header:"Fecha de Inicio",icon:Calendar,cell:({row:e})=>{const t=e.original;return t.fechaInicio?new Date(t.fechaInicio).toLocaleDateString("es-ES"):"No definida"}},{accessorKey:"isActive",header:"Estado",icon:UserCheck,cell:({row:e})=>{const t=e.original;return jsxRuntimeExports.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium "+(t.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:t.isActive?"Activo":"Inactivo"})}}];return jsxRuntimeExports.jsx(ModalUI,{isOpen:e,onClose:t,title:`Gestión de Residentes - Departamento ${a.number}`,size:"xl",footer:jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx(ButtonUI,{title:"Cerrar",icon:X$1,onClick:t,theme:"modalCancel"})}),children:jsxRuntimeExports.jsxs("div",{className:"p-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-green-50 p-4 rounded-lg mb-6",children:[jsxRuntimeExports.jsx("h3",{className:"text-green-800 text-lg font-medium mb-2",children:"Información del Departamento"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-gray-600 font-medium",children:"Número:"}),jsxRuntimeExports.jsx("p",{className:"text-gray-800",children:a.number})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-gray-600 font-medium",children:"Edificio:"}),jsxRuntimeExports.jsx("p",{className:"text-gray-800",children:a.buildingName||"No asignado"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-gray-600 font-medium",children:"Condominio:"}),jsxRuntimeExports.jsx("p",{className:"text-gray-800",children:a.condoName||"No asignado"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl mb-6 border border-green-200 overflow-hidden",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer hover:bg-green-100 transition-colors",onClick:()=>R(!j),children:[jsxRuntimeExports.jsxs("h3",{className:"text-green-800 text-xl font-semibold flex items-center",children:[jsxRuntimeExports.jsx(Plus,{className:"mr-3 h-6 w-6 text-green-600"}),x?"Editar Residente":"Agregar Nuevo Residente"]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[x&&jsxRuntimeExports.jsx(ButtonUI,{title:"Cancelar",icon:X$1,onClick:e=>{e.stopPropagation(),L()},theme:"cancel",className:"text-sm"}),j?jsxRuntimeExports.jsx(ChevronUp,{className:"h-5 w-5 text-green-600"}):jsxRuntimeExports.jsx(ChevronDown,{className:"h-5 w-5 text-green-600"})]})]}),j&&jsxRuntimeExports.jsx("div",{className:"p-6 pt-0 border-t border-green-200",children:jsxRuntimeExports.jsxs("form",{autoComplete:"off",onSubmit:e=>e.preventDefault(),className:"space-y-6",children:[jsxRuntimeExports.jsx("input",{type:"text",style:{display:"none"},name:"prevent-autofill"}),jsxRuntimeExports.jsx("input",{type:"password",style:{display:"none"},name:"prevent-autofill-password"}),jsxRuntimeExports.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[jsxRuntimeExports.jsxs("h4",{className:"text-gray-700 font-medium mb-3 flex items-center",children:[jsxRuntimeExports.jsx(Search,{className:"mr-2 h-4 w-4 text-gray-500"}),"Seleccionar Residente"]}),jsxRuntimeExports.jsxs("div",{className:"relative",ref:P,children:[jsxRuntimeExports.jsx(InputUI,{id:"user-search",type:"text",label:"Buscar Residente *",value:l,onChange:c,icon:Search,required:!0,placeholder:"Ingrese nombre o apellido del residente",error:_.userId?"El campo buscar residente es obligatorio":void 0,onFocus:()=>{l&&l.includes(" ")&&l.split(" ").length>=2&&c(""),_.userId&&N(e=>__spreadProps(__spreadValues({},e),{userId:!1}))}}),i.length>0&&jsxRuntimeExports.jsxs("div",{ref:w,className:"absolute z-50 w-full mt-1 bg-white shadow-xl rounded-lg border border-gray-300 max-h-60 overflow-y-auto",children:[jsxRuntimeExports.jsxs("div",{className:"p-3 bg-gray-50 text-sm text-gray-700 font-medium border-b",children:[i.length," resultado(s) encontrado(s)"]}),i.map(e=>jsxRuntimeExports.jsxs("div",{className:"p-3 hover:bg-blue-50 cursor-pointer flex items-center border-b border-gray-100 transition-colors",onClick:t=>{t.preventDefault(),t.stopPropagation(),(e=>{try{if(!e||!e.userId)return;o([]);const t=`${e.firstName} ${e.lastName}${e.secondLastName?" "+e.secondLastName:""}`;u(e.userId),p(e),c(t),S(t=>__spreadProps(__spreadValues({},t),{userId:e.userId})),setTimeout(()=>{const e=document.getElementById("tipoRelacionId");e&&e.focus()},50)}catch(t){}})(e);const a=document.getElementById("user-search");a&&a.blur()},children:[jsxRuntimeExports.jsx(UserCheck,{className:"text-blue-500 w-5 h-5 mr-3 flex-shrink-0"}),jsxRuntimeExports.jsxs("div",{className:"w-full",children:[jsxRuntimeExports.jsxs("div",{className:"font-medium text-blue-700",children:[e.firstName," ",e.lastName," ",e.secondLastName||""]}),jsxRuntimeExports.jsxs("div",{className:"text-sm text-gray-500",children:["@",e.username]})]})]},e.userId))]})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[jsxRuntimeExports.jsxs("h4",{className:"text-gray-700 font-medium mb-3 flex items-center",children:[jsxRuntimeExports.jsx(Home,{className:"mr-2 h-4 w-4 text-gray-500"}),"Información de la Relación"]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsx("div",{className:"w-full",children:jsxRuntimeExports.jsx(SelectUI$1,{id:"tipoRelacionId",label:"Tipo de Relación *",value:(null==(r=I.tipoRelacionId)?void 0:r.toString())||"",onChange:e=>{e&&e.target&&void 0!==e.target.value?($("tipoRelacionId",e.target.value),_.tipoRelacionId&&N(e=>__spreadProps(__spreadValues({},e),{tipoRelacionId:!1}))):"string"!=typeof e&&"number"!=typeof e||($("tipoRelacionId",e),_.tipoRelacionId&&N(e=>__spreadProps(__spreadValues({},e),{tipoRelacionId:!1})))},options:[{value:"",label:"--Seleccione tipo de relación--"},...M],icon:Home,required:!0})}),jsxRuntimeExports.jsx("div",{className:"flex items-center justify-start",children:jsxRuntimeExports.jsxs("label",{className:"inline-flex items-center cursor-pointer",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",className:"form-checkbox h-5 w-5 text-emerald-600 rounded transition-all duration-200 ease-in-out",checked:void 0===I.isActive||I.isActive,onChange:e=>$("isActive",e.target.checked)}),jsxRuntimeExports.jsx("span",{className:"ml-2 text-gray-700 font-medium",children:"Estado Activo"})]})})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[jsxRuntimeExports.jsxs("h4",{className:"text-gray-700 font-medium mb-3 flex items-center",children:[jsxRuntimeExports.jsx(Calendar,{className:"mr-2 h-4 w-4 text-gray-500"}),"Período de Vigencia"]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx(DatepickerUI,{id:"fechaInicio",label:"Fecha de Inicio *",value:I.fechaInicio||null,onChange:e=>{U("fechaInicio",e),_.fechaInicio&&N(e=>__spreadProps(__spreadValues({},e),{fechaInicio:!1}))},type:"date",formatString:"yyyy-MM-dd",placeholder:"DD/MM/AAAA",icon:Calendar,className:"autocomplete-off",error:_.fechaInicio?"El campo fecha de inicio es obligatorio":void 0}),jsxRuntimeExports.jsx("div",{style:{width:"0",height:"0",overflow:"hidden"},"aria-hidden":"true",children:jsxRuntimeExports.jsx("input",{type:"text",name:"hidden-fecha-inicio"})})]}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx(DatepickerUI,{id:"fechaFin",label:"Fecha de Fin (Opcional)",value:I.fechaFin||null,onChange:e=>U("fechaFin",e),type:"date",formatString:"yyyy-MM-dd",placeholder:"DD/MM/AAAA",icon:Calendar,className:"autocomplete-off"}),jsxRuntimeExports.jsx("div",{style:{width:"0",height:"0",overflow:"hidden"},"aria-hidden":"true",children:jsxRuntimeExports.jsx("input",{type:"text",name:"hidden-fecha-fin"})}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Dejar vacío si la relación no tiene fecha de fin"})]})]})]}),jsxRuntimeExports.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-200",children:jsxRuntimeExports.jsx("div",{className:"flex space-x-3",children:x?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx(ButtonUI,{title:"Actualizar Residente",icon:Save,onClick:()=>__async(void 0,null,function*(){try{if(!B())return void C("error","Por favor complete todos los campos obligatorios");if(I.userId!==I.routeUserId&&F(I.userId))return void C("warning","Este usuario ya ha sido asignado a este departamento");const e={departmentId:I.departmentId,userId:I.userId,tipoRelacionId:Number(I.tipoRelacionId),fechaInicio:I.fechaInicio,fechaFin:I.fechaFin,isActive:void 0===I.isActive||I.isActive,routeDepartmentId:I.departmentId,routeUserId:I.userId},t=yield D.update(I.routeDepartmentId,I.routeUserId,e);t.isSuccess?(C("success","Residente actualizado exitosamente"),L(),k()):C("error",t.error||"Error al actualizar residente")}catch(e){C("error","Error al actualizar residente")}}),className:"bg-emerald-600 hover:bg-emerald-700 text-white px-6 py-2"})}):jsxRuntimeExports.jsx(ButtonUI,{title:"Agregar Residente",icon:Plus,onClick:()=>__async(void 0,null,function*(){try{if(!B())return void C("error","Por favor complete todos los campos obligatorios");if(F(I.userId))return void C("warning","Este usuario ya ha sido asignado a este departamento");const e={departmentId:a.departmentId,userId:I.userId,tipoRelacionId:Number(I.tipoRelacionId),fechaInicio:I.fechaInicio,fechaFin:I.fechaFin||null,isActive:void 0===I.isActive||I.isActive},t=yield D.create(e);t.isSuccess?(C("success","Residente agregado exitosamente"),L(),k()):C("error",t.error||"Error al agregar residente")}catch(e){C("error","Error al agregar residente")}}),className:"bg-emerald-600 hover:bg-emerald-700 text-white px-6 py-2"})})})]})})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[jsxRuntimeExports.jsx("h3",{className:"text-gray-800 text-lg font-medium mb-4",children:"Residentes Asignados"}),jsxRuntimeExports.jsx(DataGrid,{data:s,columns:V,actions:[{icon:SquarePen,label:"Editar",onClick:e=>{h(!0),R(!0),S({departmentId:e.departmentId,userId:e.userId,tipoRelacionId:e.tipoRelacionId,fechaInicio:e.fechaInicio?e.fechaInicio.split("T")[0]:"",fechaFin:e.fechaFin?e.fechaFin.split("T")[0]:null,isActive:e.isActive,routeDepartmentId:e.departmentId,routeUserId:e.userId}),c(`Usuario ID: ${e.userId}`),A.getById(e.userId).then(e=>{e.isSuccess&&e.data&&(p(e.data),c(`${e.data.firstName} ${e.data.lastName} ${e.data.secondLastName||""}`))})}},{icon:Trash2,label:"Eliminar",onClick:e=>{T("Confirmar eliminación",`¿Está seguro que desea eliminar la relación con el usuario ID ${e.userId}?`,()=>__async(void 0,null,function*(){try{const t=yield D.delete(e.departmentId,e.userId);t.isSuccess?(C("success","Relación eliminada exitosamente"),k()):C("error",t.error||"Error al eliminar relación")}catch(t){C("error","Error al eliminar relación")}}))}}],initialPage:g,initialPageSize:v,onPageChange:y,onPageSizeChange:E,totalRecords:f})]})]})})},DepartmentListAdvancedContent=reactExports.memo(()=>{const{showToast:e,showConfirm:t}=useAlerts(),a=useNavigate(),r=useParams(),{hierarchy:s,hasBuilding:n}=useUserData(),{user:i}=useAuth(),o=new DepartmentService,l=new ManagementCompanyService,c=new CondominiumService,d=new BuildingService,[u,m]=reactExports.useState([]),[p,x]=reactExports.useState([]),[h,g]=reactExports.useState([]),[y,v]=reactExports.useState([]),[E,f]=reactExports.useState([]),[b,j]=reactExports.useState(-1),[R,I]=reactExports.useState(-1),[S,_]=reactExports.useState(-1),[N,C]=reactExports.useState(!0),[T,D]=reactExports.useState(!1),[A,P]=reactExports.useState(),[w,M]=reactExports.useState(null),[k,O]=reactExports.useState(!1),[$,U]=reactExports.useState(!1),[L,B]=reactExports.useState(null),F=e=>__async(void 0,null,function*(){try{O(!0),M(null);const t={CompanyId:e,Page:1,PageSize:100},a=yield c.getPagedCondominiums(t);if(a.isSuccess&&a.data){const e=a.data;e.items&&Array.isArray(e.items)?x(e.items):e.data&&Array.isArray(e.data)?x(e.data):Array.isArray(e)?x(e):x([])}else M(a.error||"Error al cargar los condominios")}catch(t){M("Error al cargar los condominios")}finally{O(!1)}}),V=e=>__async(void 0,null,function*(){try{O(!0),M(null);const t=yield d.getByCondominium(e);if(t.isSuccess&&t.data){const e=t.data;e.items&&Array.isArray(e.items)?g(e.items):e.data&&Array.isArray(e.data)?g(e.data):Array.isArray(e)?g(e):g([])}else M(t.error||"Error al cargar los edificios")}catch(t){M("Error al cargar los edificios")}finally{O(!1)}}),W=e=>__async(void 0,null,function*(){try{O(!0),M(null);const t=yield o.getDepartmentsByBuilding(e);if(t.isSuccess&&t.data){const e=t.data;Array.isArray(e)?v(e):e&&"object"==typeof e&&"items"in e&&Array.isArray(e.items)?v(e.items):e&&"object"==typeof e&&"data"in e&&Array.isArray(e.data)?v(e.data):v([])}else M(t.error||"Error al cargar los departamentos"),401===t.statusCode&&a("/login")}catch(t){const e=t instanceof Error?t.message:"Error desconocido";M(`Error al conectar con el servidor: ${e}`)}finally{O(!1)}});reactExports.useEffect(()=>{let e=!0;return __async(void 0,null,function*(){var t,a,i;if(e)try{if(yield __async(void 0,null,function*(){try{const e=yield o.getStatuses();e.isSuccess&&e.data?f(e.data):M(e.error||"Error al cargar los tipos de estado")}catch(e){M("Error al cargar los tipos de estado")}}),!e)return;if(yield __async(void 0,null,function*(){try{O(!0),M(null);const e=yield l.getPagedCompanies();if(e.isSuccess&&e.data){const t=e.data;t.items&&Array.isArray(t.items)?m(t.items):m([])}else M(e.error||"Error al cargar las empresas")}catch(e){M("Error al cargar las empresas")}finally{O(!1)}}),!e)return;const c=r.companyId?Number(r.companyId):null,d=r.condoId?Number(r.condoId):null,u=r.buildingId?Number(r.buildingId):null;if(c){if(j(c),yield F(c),!e)return;if(d){if(I(d),yield V(d),!e)return;u&&(_(u),yield W(u))}}else if(null==(t=null==s?void 0:s.company)?void 0:t.id){if(j(s.company.id),yield F(s.company.id),!e)return;if(null==(a=s.condo)?void 0:a.id){if(I(s.condo.id),yield V(s.condo.id),!e)return;(null==(i=s.building)?void 0:i.id)&&n&&(_(s.building.id),yield W(s.building.id))}}e&&C(!1)}catch(c){e&&C(!1)}}),()=>{e=!1}},[]);const z=e=>{P(e||void 0),D(!0)},H=()=>{D(!1),P(void 0)},G=[{accessorKey:"departmentNumber",header:"Número"},{accessorKey:"floorNumber",header:"Piso"},{accessorKey:"squareMeters",header:"Área (m²)"},{accessorKey:"bedrooms",header:"Dormitorios"},{accessorKey:"bathrooms",header:"Baños"},{accessorKey:"balcony",header:"Balcón",cell:({getValue:e})=>e()?"Sí":"No"},{accessorKey:"participationPercentage",header:"% Cobranza",cell:({getValue:e})=>`${e()}%`},{accessorKey:"petsAllowed",header:"Mascotas",cell:({getValue:e})=>e()?"Permitido":"No permitido"},{accessorKey:"statusTypeId",header:"Estado",cell:({row:e})=>{const t=e.original.statusTypeId,a=E.find(e=>e.statusTypeId===t),r=a?a.statusName:"Desconocido";let s="bg-gray-100 text-gray-800";switch(t){case 1:s="bg-green-100 text-green-800";break;case 2:s="bg-blue-100 text-blue-800";break;case 3:s="bg-yellow-100 text-yellow-800";break;case 4:s="bg-purple-100 text-purple-800";break;case 5:s="bg-red-100 text-red-800"}return jsxRuntimeExports.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s}`,children:r})}}],q=[{icon:SquarePen,label:"Editar",onClick:e=>z(e)},{icon:Trash2,label:"Eliminar",onClick:a=>(a=>__async(void 0,null,function*(){t("Eliminar departamento",`¿Está seguro que desea eliminar el departamento ${a.departmentNumber}?`,()=>__async(void 0,null,function*(){try{O(!0);const t=yield o.deleteDepartment(a.departmentId);t.isSuccess?(e("success",`Departamento ${a.departmentNumber} eliminado correctamente`),yield W(S)):e("error",t.error||"Error al eliminar el departamento")}catch(t){e("error","Ocurrió un error al eliminar el departamento")}finally{O(!1)}}),()=>{})}))(a)},{icon:Users,label:"Residentes",onClick:e=>{var t,a;const r=__spreadProps(__spreadValues({},e),{number:e.departmentNumber,buildingName:(null==(t=h.find(t=>t.buildingId===e.buildingId))?void 0:t.name)||"No asignado",condoName:(null==(a=p.find(t=>t.condoId===e.condoId))?void 0:a.name)||"No asignado",companyId:b,condoId:e.condoId||R});B(r),U(!0)}}],Y=u.map(e=>({value:e.companyId||0,label:e.name||"Sin nombre"})),K=p.map(e=>({value:e.condoId||0,label:e.name||"Sin nombre"})),J=h.map(e=>({value:e.buildingId||0,label:e.name||`Edificio ${e.buildingId||0}`}));return jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6 p-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Gestión de Departamentos"}),jsxRuntimeExports.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Administra los departamentos de los edificios"})]}),jsxRuntimeExports.jsx(ButtonUI,{icon:Plus,title:"Nuevo Departamento",textColor:"#ffffff",className:"bg-primary hover:bg-primary/90",onClick:()=>-1!==S?z():e("warning","Seleccione un edificio primero"),disabled:-1===S})]}),jsxRuntimeExports.jsx(Expandex,{title:"Filtros de búsqueda",initialExpanded:!0,expandIcon:Filter,backgroundColor:"#f9fafb",className:"mb-6",children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(SelectUI$1,{id:"company",label:"Empresa",value:b,onChange:e=>__async(void 0,null,function*(){const t=Number(e);j(t),I(-1),_(-1),v([]),-1!==t?yield F(t):x([])}),icon:Building,options:Y,placeholder:"Seleccione una empresa",required:!0,includeAll:!0,disabled:N||2===(null==i?void 0:i.profileTypeId)})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(SelectUI$1,{id:"condominium",label:"Condominio",value:R,onChange:e=>__async(void 0,null,function*(){const t=Number(e);I(t),_(-1),v([]),-1!==t?yield V(t):g([])}),icon:Building2,options:K,placeholder:"Seleccione un condominio",required:!0,includeAll:!0,disabled:-1===b||0===p.length||N||2===(null==i?void 0:i.profileTypeId)})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(SelectUI$1,{id:"building",label:"Edificio",value:S,onChange:e=>{const t=Number(e);_(t),-1!==t?W(t):v([])},icon:Home,options:J,placeholder:"Seleccione un edificio",required:!0,includeAll:!0,disabled:-1===R||0===h.length||N})})]})}),w&&jsxRuntimeExports.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-6",children:w}),k?jsxRuntimeExports.jsxs("div",{className:"text-center py-8",children:[jsxRuntimeExports.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),jsxRuntimeExports.jsx("p",{className:"mt-2 text-gray-600",children:"Cargando departamentos..."})]}):jsxRuntimeExports.jsx(DataGrid,{data:y,columns:G,actions:q}),jsxRuntimeExports.jsx(ModalUI,{isOpen:T,onClose:H,title:A?"Editar Departamento":"Nuevo Departamento",footer:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ButtonUI,{icon:X$1,title:"Cancelar",onClick:H,theme:"modalCancel"}),jsxRuntimeExports.jsx(ButtonUI,{icon:Save,title:"Guardar",onClick:()=>document.forms[0].requestSubmit(),theme:"modalSave"})]}),children:jsxRuntimeExports.jsx(DepartmentForm,{department:A,buildingId:-1!==S?S:void 0,onSubmit:t=>__async(void 0,null,function*(){try{if(O(!0),A){const r={departmentId:A.departmentId,buildingId:-1!==S?S:void 0,departmentNumber:t.departmentNumber,floorNumber:t.floorNumber,squareMeters:t.squareMeters,bedrooms:t.bedrooms,bathrooms:t.bathrooms,balcony:t.balcony,participationPercentage:t.participationPercentage,statusTypeId:t.statusTypeId,petsAllowed:t.petsAllowed,routeId:1,updatedBy:"current-user",updatedAt:(new Date).toISOString()},s=yield o.update(A.departmentId,r);s.isSuccess?(e("success",`Departamento ${t.departmentNumber} actualizado correctamente`),-1!==S&&(yield W(S)),H()):(e("error",s.error||"Error al actualizar el departamento"),401===s.statusCode&&a("/login"))}else if(-1!==S){const r={buildingId:S,departmentNumber:t.departmentNumber||"",floorNumber:t.floorNumber||1,squareMeters:t.squareMeters||0,bedrooms:t.bedrooms||0,bathrooms:t.bathrooms||0,balcony:!!t.balcony,participationPercentage:t.participationPercentage||0,statusTypeId:t.statusTypeId||1,petsAllowed:!!t.petsAllowed,createdBy:"current-user"},s=yield o.create(r);s.isSuccess?(e("success",`Departamento ${t.departmentNumber} creado correctamente`),yield W(S),H()):(e("error",s.error||"Error al crear el departamento"),401===s.statusCode&&a("/login"))}}catch(r){const t=r instanceof Error?r.message:"Error desconocido";e("error",`Ocurrió un error al guardar los datos: ${t}`)}finally{O(!1)}})})}),L&&jsxRuntimeExports.jsx(DepartmentResidentsModal,{isOpen:$,onClose:()=>{U(!1),B(null)},department:L})]})});DepartmentListAdvancedContent.displayName="DepartmentListAdvancedContent";const DepartmentListAdvanced=()=>jsxRuntimeExports.jsx(AlertProvider,{children:jsxRuntimeExports.jsx(DepartmentListAdvancedContent,{})});class CommonAreaService extends ApiBaseService{constructor(){super("/CommonArea")}getCommonAreaById(e){return __async(this,null,function*(){return __superGet(CommonAreaService.prototype,this,"getById").call(this,e)})}getPagedCommonAreas(e){return __async(this,null,function*(){const t=e?__spreadProps(__spreadValues({},e),{Name:e.Name||void 0}):void 0;return __superGet(CommonAreaService.prototype,this,"getPaged").call(this,"paged",t)})}create(e){return __async(this,null,function*(){return this.post("",e)})}update(e,t){return __async(this,null,function*(){return this.put(`/${e}`,t)})}deleteCommonArea(e){return __async(this,null,function*(){return __superGet(CommonAreaService.prototype,this,"deleteById").call(this,e)})}getByCondoId(e){return __async(this,null,function*(){return this.get(`by-condo/${e}`)})}getByBuildingId(e){return __async(this,null,function*(){return this.get(`by-building/${e}`)})}getByCondominium(e,t=1,a=10){return __async(this,null,function*(){const r={page:t,pageSize:a,CondoId:e};return this.getPagedCommonAreas(r)})}searchByName(e,t=1,a=10){return __async(this,null,function*(){const r={page:t,pageSize:a,Name:e};return this.getPagedCommonAreas(r)})}getByReservationRequired(e,t=1,a=10){return __async(this,null,function*(){const r={page:t,pageSize:a,ReservationRequired:e};return this.getPagedCommonAreas(r)})}getByBuilding(e,t=1,a=10){return __async(this,null,function*(){const r={page:t,pageSize:a,BuildingId:e};return this.getPagedCommonAreas(r)})}getActiveAreas(e=1,t=10){return __async(this,null,function*(){const a={page:e,pageSize:t,IsDeleted:!1};return this.getPagedCommonAreas(a)})}getByMinCapacity(e,t=1,a=10){return __async(this,null,function*(){const r={page:t,pageSize:a,MinCapacity:e};return this.getPagedCommonAreas(r)})}setAvailability(e,t){return __async(this,null,function*(){const a={isAvailable:t};return this.patch(`/${e}/availability`,a)})}}const commonArea_service=Object.freeze(Object.defineProperty({__proto__:null,CommonAreaService:CommonAreaService},Symbol.toStringTag,{value:"Module"}));function CommonAreaForm({area:e,buildingId:t,onSubmit:a}){var r,s;const[n,i]=reactExports.useState({buildingId:t,name:"",description:"",capacity:void 0,operatingHours:"",amenities:"",reservationRequired:!1,usageFee:void 0,rules:""});reactExports.useEffect(()=>{e&&i(__spreadProps(__spreadValues({},e),{buildingId:t}))},[e,t]);return jsxRuntimeExports.jsxs("form",{onSubmit:e=>{e.preventDefault(),a(n)},className:"space-y-6",children:[jsxRuntimeExports.jsx(InputUI,{id:"name",label:"Nombre",icon:Building2,value:n.name||"",onChange:e=>i(__spreadProps(__spreadValues({},n),{name:e})),placeholder:"Nombre del área común",required:!0,maxLength:100}),jsxRuntimeExports.jsx(TextAreaUI,{id:"description",label:"Descripción",icon:Building2,value:n.description||"",onChange:e=>i(__spreadProps(__spreadValues({},n),{description:e})),placeholder:"Descripción del área común",maxLength:500}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[jsxRuntimeExports.jsx(InputUI,{id:"capacity",label:"Capacidad",type:"number",icon:Users,value:(null==(r=n.capacity)?void 0:r.toString())||"",onChange:e=>i(__spreadProps(__spreadValues({},n),{capacity:parseInt(e)||void 0})),placeholder:"Capacidad máxima"}),jsxRuntimeExports.jsx(InputUI,{id:"operatingHours",label:"Horario",icon:Clock,value:n.operatingHours||"",onChange:e=>i(__spreadProps(__spreadValues({},n),{operatingHours:e})),placeholder:"Ej: 9:00 - 22:00"}),jsxRuntimeExports.jsx(TextAreaUI,{id:"amenities",label:"Amenidades",icon:Dumbbell,value:n.amenities||"",onChange:e=>i(__spreadProps(__spreadValues({},n),{amenities:e})),placeholder:"Lista de amenidades disponibles"}),jsxRuntimeExports.jsx(SelectUI$1,{id:"reservationRequired",label:"Requiere Reserva",icon:Clock,value:n.reservationRequired?"1":"0",onChange:e=>i(__spreadProps(__spreadValues({},n),{reservationRequired:"1"===e})),options:[{value:"1",label:"Sí"},{value:"0",label:"No"}],required:!0}),jsxRuntimeExports.jsx(InputUI,{id:"usageFee",label:"Costo de Uso (S/.)",type:"number",icon:DollarSign,value:(null==(s=n.usageFee)?void 0:s.toString())||"",onChange:e=>i(__spreadProps(__spreadValues({},n),{usageFee:parseFloat(e)||void 0})),placeholder:"Ej: 150.00"}),jsxRuntimeExports.jsx(TextAreaUI,{id:"rules",label:"Reglas",icon:ScrollText,value:n.rules||"",onChange:e=>i(__spreadProps(__spreadValues({},n),{rules:e})),placeholder:"Reglas de uso del área"})]})]})}const CommonAreaListAdvancedContent=reactExports.memo(()=>{const e=reactExports.useMemo(()=>new CommonAreaService,[]),t=reactExports.useMemo(()=>new ManagementCompanyService,[]),a=reactExports.useMemo(()=>new CondominiumService,[]),r=reactExports.useMemo(()=>new BuildingService,[]),[s,n]=reactExports.useState([]),[i,o]=reactExports.useState([]),[l,c]=reactExports.useState([]),[d,u]=reactExports.useState([]),[m,p]=reactExports.useState(-1),[x,h]=reactExports.useState(-1),[g,y]=reactExports.useState(-1),[v,E]=reactExports.useState(!0),[f,b]=reactExports.useState(!1),[j,R]=reactExports.useState(),[I,S]=reactExports.useState(null),[_,N]=reactExports.useState(!1),{showToast:C,showConfirm:T}=useAlerts(),D=useNavigate(),A=useParams(),{hierarchy:P,hasBuilding:w}=useUserData(),{user:M}=useAuth(),k=e=>__async(void 0,null,function*(){try{N(!0),S(null);const t={CompanyId:e,Page:1,PageSize:100},r=yield a.getPagedCondominiums(t);if(r.isSuccess&&r.data){const e=r.data;e.items&&Array.isArray(e.items)?o(e.items):e.data&&Array.isArray(e.data)?o(e.data):Array.isArray(e)?o(e):o([])}else S(r.error||"Error al cargar los condominios")}catch(t){S("Error al cargar los condominios")}finally{N(!1)}}),O=e=>__async(void 0,null,function*(){try{N(!0),S(null);const t=yield r.getByCondominium(e);if(t.isSuccess&&t.data){const e=t.data;e.items&&Array.isArray(e.items)?c(e.items):e.data&&Array.isArray(e.data)?c(e.data):Array.isArray(e)?c(e):c([])}else S(t.error||"Error al cargar los edificios")}catch(t){S("Error al cargar los edificios")}finally{N(!1)}}),$=t=>__async(void 0,null,function*(){const a=t||g;if(a>0)try{N(!0);const t=yield e.getByBuildingId(a),r=Array.isArray(t)?t:t.data||[];u(r)}catch(r){S("Error al cargar áreas comunes")}finally{N(!1)}});reactExports.useEffect(()=>{let e=!0;return __async(void 0,null,function*(){var a,r,s;if(e)try{if(yield __async(void 0,null,function*(){try{N(!0),S(null);const e=yield t.getPagedCompanies();if(e.isSuccess&&e.data){const t=e.data;t.items&&Array.isArray(t.items)?n(t.items):n([])}else S(e.error||"Error al cargar las empresas")}catch(e){S("Error al cargar las empresas")}finally{N(!1)}}),!e)return;const i=A.companyId?Number(A.companyId):null,o=A.condoId?Number(A.condoId):null,l=A.buildingId?Number(A.buildingId):null;if(i){if(p(i),yield k(i),!e)return;if(o){if(h(o),yield O(o),!e)return;l&&(y(l),yield $(l))}}else if(null==(a=null==P?void 0:P.company)?void 0:a.id){if(p(P.company.id),yield k(P.company.id),!e)return;if(null==(r=P.condo)?void 0:r.id){if(h(P.condo.id),yield O(P.condo.id),!e)return;(null==(s=P.building)?void 0:s.id)&&w&&(y(P.building.id),yield $(P.building.id))}}e&&E(!1)}catch(i){e&&E(!1)}}),()=>{e=!1}},[]);const U=reactExports.useCallback(e=>{e?L(e.areaId):(R(void 0),b(!0))},[]),L=reactExports.useCallback(t=>__async(void 0,null,function*(){try{N(!0);const a=yield e.getCommonAreaById(t);a.isSuccess&&a.data?(R(a.data),b(!0)):C("error",a.error||"Error al cargar los detalles del área común")}catch(a){const e=a instanceof Error?a.message:"Error desconocido";C("error",`Error al cargar los detalles: ${e}`)}finally{N(!1)}}),[e,C]),B=reactExports.useCallback(()=>{b(!1),R(void 0)},[]),F=reactExports.useCallback(t=>__async(void 0,null,function*(){try{if(N(!0),j){const a={areaId:j.areaId,condoId:-1!==x?x:void 0,buildingId:-1!==g?g:void 0,name:t.name,description:t.description,capacity:t.capacity,operatingHours:t.operatingHours,amenities:t.amenities,reservationRequired:t.reservationRequired,usageFee:t.usageFee,rules:t.rules,routeId:1,updatedBy:"current-user",updatedAt:(new Date).toISOString()},r=yield e.update(j.areaId,a);r.isSuccess?(C("success",`Área común ${t.name} actualizada correctamente`),yield $(),B()):(C("error",r.error||"Error al actualizar el área común"),401===r.statusCode&&D("/login"))}else if(-1!==x&&-1!==g){const a={condoId:x,buildingId:g,name:t.name,description:t.description,capacity:t.capacity,operatingHours:t.operatingHours,amenities:t.amenities,reservationRequired:!!t.reservationRequired,usageFee:t.usageFee,rules:t.rules,createdBy:"current-user"},r=yield e.create(a);r.isSuccess?(C("success",`Área común ${t.name} creada correctamente`),yield $(),B()):(C("error",r.error||"Error al crear el área común"),401===r.statusCode&&D("/login"))}else C("error","Debe seleccionar empresa, condominio y edificio para crear un área común")}catch(a){const e=a instanceof Error?a.message:"Error desconocido";C("error",`Ocurrió un error al guardar los datos: ${e}`)}finally{N(!1)}}),[j,x,g,e,C,D,$,B]),V=reactExports.useCallback(t=>__async(void 0,null,function*(){T("Eliminar área común",`¿Está seguro que desea eliminar el área común "${t.name}"?`,()=>__async(void 0,null,function*(){try{N(!0);const a=yield e.deleteCommonArea(t.areaId);a.isSuccess?(C("success",`Área común ${t.name} eliminada correctamente`),yield $()):C("error",a.error||"Error al eliminar el área común")}catch(a){C("error","Ocurrió un error al eliminar el área común")}finally{N(!1)}}),()=>{})}),[e,C,T,$]),W=[{icon:SquarePen,label:"Editar",onClick:e=>U(e)},{icon:Trash2,label:"Eliminar",onClick:e=>V(e)}],z=s.map(e=>({value:e.companyId||0,label:e.name||"Sin nombre"})),H=i.map(e=>({value:e.condoId||0,label:e.name||"Sin nombre"})),G=l.map(e=>({value:e.buildingId||0,label:e.name||`Edificio ${e.buildingId||0}`})),q=-1!==m&&-1!==x&&-1!==g,Y=I;return jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6 p-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Gestión de Áreas Comunes"}),jsxRuntimeExports.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Administra las áreas comunes de los edificios"})]}),jsxRuntimeExports.jsx(ButtonUI,{icon:Plus,title:"Nueva Área Común",onClick:()=>b(!0),borderColor:"var(--color-primary-admin)",textColor:"#ffffff",className:"bg-primary hover:bg-primary/90",disabled:!q})]}),jsxRuntimeExports.jsx(Expandex,{title:"Filtros de búsqueda",initialExpanded:!0,expandIcon:Filter,backgroundColor:"#f9fafb",className:"mb-6",children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(SelectUI$1,{id:"company",label:"Empresa",value:m,onChange:e=>__async(void 0,null,function*(){const t=Number(e);p(t),h(-1),y(-1),u([]),-1!==t?yield k(t):o([])}),icon:Building2,options:z,placeholder:"Seleccione una empresa",required:!0,includeAll:!0,disabled:v||_||2===(null==M?void 0:M.profileTypeId)})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(SelectUI$1,{id:"condominium",label:"Condominio",value:x,onChange:e=>__async(void 0,null,function*(){const t=Number(e);h(t),y(-1),u([]),-1!==t?yield O(t):c([])}),icon:Building2,options:H,placeholder:"Seleccione un condominio",required:!0,includeAll:!0,disabled:-1===m||0===i.length||v||_||2===(null==M?void 0:M.profileTypeId)})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(SelectUI$1,{id:"building",label:"Edificio",value:g,onChange:e=>{const t=Number(e);y(t),-1!==t?$(t):u([])},icon:Home,options:G,placeholder:"Seleccione un edificio (opcional)",includeAll:!0,disabled:-1===x||0===l.length||v||_})})]})}),Y&&jsxRuntimeExports.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-6",children:Y}),_?jsxRuntimeExports.jsxs("div",{className:"text-center py-8",children:[jsxRuntimeExports.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),jsxRuntimeExports.jsx("p",{className:"mt-2 text-gray-600",children:"Cargando áreas comunes..."})]}):jsxRuntimeExports.jsx(DataGrid,{data:d,columns:[{accessorKey:"name",header:"Nombre"},{accessorKey:"description",header:"Descripción",cell:({getValue:e})=>{const t=e();return t&&t.length>70?`${t.substring(0,70)}...`:t}},{accessorKey:"capacity",header:"Capacidad"},{accessorKey:"operatingHours",header:"Horario"},{accessorKey:"reservationRequired",header:"Requiere Reserva",cell:({getValue:e})=>e()?"Sí":"No"},{accessorKey:"usageFee",header:"Costo (S/.)",cell:({getValue:e})=>{const t=e();return t?`S/ ${t.toFixed(2)}`:"Gratis"}}],actions:W}),jsxRuntimeExports.jsx(ModalUI,{isOpen:f,onClose:B,title:j?"Editar Área Común":"Nueva Área Común",footer:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ButtonUI,{icon:X$1,title:"Cancelar",onClick:B,theme:"modalCancel"}),jsxRuntimeExports.jsx(ButtonUI,{icon:Save,title:"Guardar",onClick:()=>document.forms[0].requestSubmit(),theme:"modalSave"})]}),children:jsxRuntimeExports.jsx(CommonAreaForm,{area:j,buildingId:-1!==g?g:1,onSubmit:F})})]})});CommonAreaListAdvancedContent.displayName="CommonAreaListAdvancedContent";const CommonAreaListAdvanced=()=>jsxRuntimeExports.jsx(AlertProvider,{children:jsxRuntimeExports.jsx(CommonAreaListAdvancedContent,{})});function cn$1(...e){return e.flat().filter(Boolean).join(" ").trim()}const TabsContext=reactExports.createContext({value:"",onValueChange:()=>{},variant:"default",orientation:"horizontal"}),Tabs=({defaultValue:e,value:t,onValueChange:a,children:r,className:s="",variant:n="default",orientation:i="horizontal"})=>{const[o,l]=reactExports.useState(e||""),c=void 0!==t,d=c?t:o,u=reactExports.useCallback(e=>{c||l(e),null==a||a(e)},[c,a]);return jsxRuntimeExports.jsx(TabsContext.Provider,{value:{value:d,onValueChange:u,variant:n,orientation:i},children:jsxRuntimeExports.jsx("div",{className:cn$1("tabs-container","vertical"===i?"flex gap-6":"w-full",s),children:r})})},TabsList=({children:e,className:t=""})=>{const{variant:a,orientation:r}=reactExports.useContext(TabsContext);return jsxRuntimeExports.jsx("div",{role:"tablist",className:cn$1("tabs-list flex",{default:"bg-gray-100 rounded-lg p-1 gap-1",pills:"gap-2",underline:"border-b border-gray-200 gap-0",cards:"gap-2 mb-6"}[a],{horizontal:"",vertical:"flex-col min-w-[200px]"}[r],t),style:{backgroundColor:"default"===a?"var(--color-surface-card)":void 0,borderColor:"underline"===a?"var(--color-border-light)":void 0},children:e})},TabsTrigger=({value:e,children:t,className:a="",onClick:r,disabled:s=!1,icon:n,badge:i})=>{const{value:o,onValueChange:l,variant:c,orientation:d}=reactExports.useContext(TabsContext),u=o===e,m={default:cn$1("px-4 py-2 rounded-md text-sm",u?"shadow-sm":"hover:bg-white/60"),pills:cn$1("px-4 py-2 rounded-full text-sm border",u?"shadow-sm":"border-transparent hover:border-gray-300"),underline:cn$1("px-4 py-3 text-sm border-b-2 border-transparent",u?"":"hover:border-gray-300"),cards:cn$1("px-6 py-3 rounded-lg border text-sm shadow-sm",u?"shadow-md":"hover:shadow-md")};return jsxRuntimeExports.jsxs(motion.button,{type:"button",role:"tab","aria-selected":u,"data-state":u?"active":"inactive",disabled:s,className:cn$1("tabs-trigger relative font-medium transition-all duration-200 focus:outline-none",m[c],s&&"opacity-50 cursor-not-allowed",a),style:u?{default:{backgroundColor:"var(--color-primary-admin)",color:"var(--color-text-inverse)"},pills:{backgroundColor:"var(--color-primary-admin)",color:"var(--color-text-inverse)",borderColor:"var(--color-primary-admin)"},underline:{color:"var(--color-primary-admin)",borderBottomColor:"var(--color-primary-admin)"},cards:{backgroundColor:"var(--color-primary-admin)",color:"var(--color-text-inverse)",borderColor:"var(--color-primary-admin)"}}[c]:{default:{color:"var(--color-text-secondary)"},pills:{color:"var(--color-text-secondary)",backgroundColor:"transparent"},underline:{color:"var(--color-text-secondary)"},cards:{color:"var(--color-text-secondary)",backgroundColor:"var(--color-surface-card)",borderColor:"var(--color-border-light)"}}[c],onClick:()=>{s||(l(e),null==r||r())},whileHover:s?{}:{scale:1.02},whileTap:s?{}:{scale:.98},initial:!1,animate:{scale:1},children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-2",children:[n&&jsxRuntimeExports.jsx(n,{className:"w-4 h-4",style:{color:u?"var(--color-text-inverse)":"var(--color-text-secondary)"}}),jsxRuntimeExports.jsx("span",{children:t}),i&&jsxRuntimeExports.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full font-semibold",style:{backgroundColor:u?"rgba(255,255,255,0.2)":"var(--color-primary-admin)",color:"var(--color-text-inverse)"},children:i})]}),"underline"===c&&u&&jsxRuntimeExports.jsx(motion.div,{className:"absolute bottom-0 left-0 right-0 h-0.5",style:{backgroundColor:"var(--color-primary-admin)"},layoutId:"underline",initial:!1,transition:{type:"spring",stiffness:500,damping:30}})]})},TabsContent=({value:e,children:t,className:a=""})=>{const{value:r,orientation:s}=reactExports.useContext(TabsContext),n=r===e;return jsxRuntimeExports.jsx(AnimatePresence,{mode:"wait",children:n&&jsxRuntimeExports.jsx(motion.div,{role:"tabpanel",initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2,ease:"easeInOut"},className:cn$1("tabs-content","vertical"===s?"flex-1":"w-full",a),"data-state":n?"active":"inactive",children:t},e)})},getCellStateColors=e=>{const t=e.toLowerCase();return t.includes("ocupado")?{background:THEME_COLORS.states.success[100],text:THEME_COLORS.states.success[700]}:t.includes("alquilado")?{background:THEME_COLORS.states.info[100],text:THEME_COLORS.states.info[700]}:{background:THEME_COLORS.surfaces.gray[100],text:THEME_COLORS.surfaces.gray[700]}};function ExcelDataGrid({data:e,isLoading:t=!1}){const[a,r]=reactExports.useState("departamentos"),s=reactExports.useMemo(()=>[{accessorKey:"numeroDepartamento",header:"Número de departamento",icon:Hash},{accessorKey:"numeroPiso",header:"Número de piso",icon:Building},{accessorKey:"metrosCuadrados",header:"Metros cuadrados",icon:Ruler},{accessorKey:"habitaciones",header:"Habitaciones",icon:Bed},{accessorKey:"banos",header:"Baños",icon:Bath},{accessorKey:"balcon",header:"Balcón"},{accessorKey:"porcentajeCobranza",header:"Porcentaje de cobranza",icon:Percent},{accessorKey:"estado",header:"Estado",cell:({getValue:e})=>{const t=e(),a=getCellStateColors(t);return jsxRuntimeExports.jsx("span",{className:"px-2 py-1 rounded-full text-xs",style:{backgroundColor:a.background,color:a.text},children:t})}},{accessorKey:"mascotasPermitidas",header:"Mascotas permitidas"},{accessorKey:"bloque",header:"Bloque"},{accessorKey:"descripcion",header:"Descripción",icon:Scroll}],[]),n=reactExports.useMemo(()=>[{accessorKey:"nombre",header:"Nombre",icon:Building},{accessorKey:"descripcion",header:"Descripción",icon:Scroll},{accessorKey:"totalPisos",header:"Total de pisos"},{accessorKey:"totalUnidades",header:"Total de unidades",icon:Home},{accessorKey:"direccion",header:"Dirección",icon:MapPin}],[]),i=reactExports.useMemo(()=>[{accessorKey:"totalEdificios",header:"Total de edificios",icon:Building},{accessorKey:"totalPisos",header:"Total de pisos"},{accessorKey:"servicios",header:"Servicios"},{accessorKey:"totalEstacionamientos",header:"Total de estacionamientos"},{accessorKey:"caracteristicasSeguridad",header:"Características de seguridad"},{accessorKey:"correoElectronico",header:"Correo electrónico de contacto",icon:Mail},{accessorKey:"telefono",header:"Teléfono de contacto",icon:Phone},{accessorKey:"urlSitioWeb",header:"URL del sitio web"}],[]),o=reactExports.useMemo(()=>[{accessorKey:"nombre",header:"Nombre"},{accessorKey:"correoElectronico",header:"Correo electrónico de contacto",icon:Mail},{accessorKey:"telefono",header:"Teléfono de contacto",icon:Phone},{accessorKey:"direccion",header:"Dirección",icon:MapPin}],[]),l=reactExports.useMemo(()=>[{accessorKey:"nombres",header:"Nombres"},{accessorKey:"apellidoPaterno",header:"Apellido Paterno"},{accessorKey:"apellidoMaterno",header:"Apellido Materno"},{accessorKey:"email",header:"Email",icon:Mail},{accessorKey:"telefonoContacto",header:"Teléfono",icon:Phone},{accessorKey:"edificio",header:"Edificio",icon:Building},{accessorKey:"departamento",header:"Departamento",icon:Home}],[]),c=reactExports.useMemo(()=>(null==e?void 0:e.departamentos)||[],[null==e?void 0:e.departamentos]),d=reactExports.useMemo(()=>(null==e?void 0:e.edificios)||[],[null==e?void 0:e.edificios]),u=reactExports.useMemo(()=>(null==e?void 0:e.condominios)||[],[null==e?void 0:e.condominios]),m=reactExports.useMemo(()=>(null==e?void 0:e.empresas)||[],[null==e?void 0:e.empresas]),p=reactExports.useMemo(()=>(null==e?void 0:e.departamentos)?e.departamentos.filter(e=>e.nombres&&e.nombres.trim()).map(e=>{var t;return{nombres:e.nombres||"",apellidoPaterno:e.apellidoPaterno||"",apellidoMaterno:e.apellidoMaterno||"",email:e.email||"aa@aa.com",telefonoContacto:e.telefonoContacto||"",edificio:e.bloque||"",departamento:e.numeroDepartamento||"",tipoResidente:(null==(t=e.estado)?void 0:t.toLowerCase().includes("alquil"))?"Inquilino":"Propietario"}}):[],[null==e?void 0:e.departamentos]);return t?jsxRuntimeExports.jsxs("div",{className:"py-10 text-center",children:[jsxRuntimeExports.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-2 border-primary border-t-transparent"}),jsxRuntimeExports.jsx("p",{className:"mt-2 text-gray-500",children:"Procesando datos del Excel..."})]}):!e||Object.values(e).every(e=>!e||0===e.length)?jsxRuntimeExports.jsxs("div",{className:"p-6 text-center bg-white rounded-lg shadow-md",children:[jsxRuntimeExports.jsx("div",{className:"mx-auto w-16 h-16 mb-4 flex items-center justify-center rounded-full bg-primary/10",children:jsxRuntimeExports.jsx(CheckCircle,{className:"w-8 h-8 text-primary"})}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay datos para mostrar"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500",children:"Por favor selecciona un archivo Excel para visualizar los datos"})]}):jsxRuntimeExports.jsx("div",{className:"space-y-4",children:jsxRuntimeExports.jsxs(Tabs,{value:a,onValueChange:r,children:[jsxRuntimeExports.jsxs(TabsList,{className:"bg-gray-100 flex flex-wrap gap-2 p-2 rounded-lg",children:[jsxRuntimeExports.jsxs(TabsTrigger,{value:"departamentos",className:"flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-all duration-200 hover:bg-gray-200 data-[state=active]:bg-primary data-[state=active]:text-white data-[state=active]:shadow-sm",children:[jsxRuntimeExports.jsx(Home,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{children:"Departamentos"}),jsxRuntimeExports.jsx("span",{className:"ml-1 px-1.5 py-0.5 bg-gray-200 text-gray-700 rounded-full text-xs data-[state=active]:bg-white data-[state=active]:text-primary",children:c.length})]}),jsxRuntimeExports.jsxs(TabsTrigger,{value:"edificios",className:"flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-all duration-200 hover:bg-gray-200 data-[state=active]:bg-primary data-[state=active]:text-white data-[state=active]:shadow-sm",children:[jsxRuntimeExports.jsx(Building,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{children:"Edificios"}),jsxRuntimeExports.jsx("span",{className:"ml-1 px-1.5 py-0.5 bg-gray-200 text-gray-700 rounded-full text-xs data-[state=active]:bg-white data-[state=active]:text-primary",children:d.length})]}),jsxRuntimeExports.jsxs(TabsTrigger,{value:"condominios",className:"flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-all duration-200 hover:bg-gray-200 data-[state=active]:bg-primary data-[state=active]:text-white data-[state=active]:shadow-sm",children:[jsxRuntimeExports.jsx(DoorClosed,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{children:"Condominios"}),jsxRuntimeExports.jsx("span",{className:"ml-1 px-1.5 py-0.5 bg-gray-200 text-gray-700 rounded-full text-xs data-[state=active]:bg-white data-[state=active]:text-primary",children:u.length})]}),jsxRuntimeExports.jsxs(TabsTrigger,{value:"empresas",className:"flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-all duration-200 hover:bg-gray-200 data-[state=active]:bg-primary data-[state=active]:text-white data-[state=active]:shadow-sm",children:[jsxRuntimeExports.jsx(Users,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{children:"Empresas"}),jsxRuntimeExports.jsx("span",{className:"ml-1 px-1.5 py-0.5 bg-gray-200 text-gray-700 rounded-full text-xs data-[state=active]:bg-white data-[state=active]:text-primary",children:m.length})]}),jsxRuntimeExports.jsxs(TabsTrigger,{value:"usuarios",className:"flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-all duration-200 hover:bg-gray-200 data-[state=active]:bg-primary data-[state=active]:text-white data-[state=active]:shadow-sm",children:[jsxRuntimeExports.jsx(User,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{children:"Usuarios"}),jsxRuntimeExports.jsx("span",{className:"ml-1 px-1.5 py-0.5 bg-gray-200 text-gray-700 rounded-full text-xs data-[state=active]:bg-white data-[state=active]:text-primary",children:p.length})]})]}),jsxRuntimeExports.jsx(TabsContent,{value:"departamentos",children:jsxRuntimeExports.jsx(DataGrid,{data:c,columns:s,manualPagination:!1})}),jsxRuntimeExports.jsx(TabsContent,{value:"edificios",children:jsxRuntimeExports.jsx(DataGrid,{data:d,columns:n,manualPagination:!1})}),jsxRuntimeExports.jsx(TabsContent,{value:"condominios",children:jsxRuntimeExports.jsx(DataGrid,{data:u,columns:i,manualPagination:!1})}),jsxRuntimeExports.jsx(TabsContent,{value:"empresas",children:jsxRuntimeExports.jsx(DataGrid,{data:m,columns:o,manualPagination:!1})}),jsxRuntimeExports.jsx(TabsContent,{value:"usuarios",children:jsxRuntimeExports.jsx(DataGrid,{data:p,columns:l,manualPagination:!1})})]})})}class ExcelProcessorService{constructor(){}isValidExcelFile(e){const t=e.name.toLowerCase().substring(e.name.lastIndexOf("."));return["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"].includes(e.type)||[".xlsx",".xls"].includes(t)}processExcelFile(e){return __async(this,null,function*(){return new Promise((t,a)=>{const r=new FileReader;r.onload=e=>{var r;try{const a=null==(r=e.target)?void 0:r.result;if(!a)throw new Error("No se pudo leer el archivo");const s=readSync(a,{type:"array"}),n=["Empresas","Condominios","Edificios","Departamentos"].filter(e=>!s.SheetNames.includes(e));if(n.length>0)throw new Error(`Faltan las siguientes pestañas en el Excel: ${n.join(", ")}`);const i=s.Sheets.Empresas,o=s.Sheets.Condominios,l=s.Sheets.Edificios,c=s.Sheets.Departamentos,d=utils.sheet_to_json(i,{header:1}),u=utils.sheet_to_json(o,{header:1}),m=utils.sheet_to_json(l,{header:1}),p=utils.sheet_to_json(c,{header:1}),x=d.slice(1).filter(e=>e&&e.length>0&&e.some(e=>e&&e.toString().trim())),h=u.slice(1).filter(e=>e&&e.length>0&&e.some(e=>e&&e.toString().trim())),g=m.slice(1).filter(e=>e&&e.length>0&&e.some(e=>e&&e.toString().trim())),y=p.slice(1).filter(e=>e&&e.length>0&&e.some(e=>e&&e.toString().trim())),v={empresas:this.mapEmpresasData(x),condominios:this.mapCondominiosData(h),edificios:this.mapEdificiosData(g),departamentos:this.mapDepartamentosData(y)};t(v)}catch(s){a(new Error("Error al procesar el archivo Excel: "+s.message))}},r.onerror=()=>{a(new Error("Error al leer el archivo"))},r.readAsArrayBuffer(e)})})}mapEmpresasData(e){return e.map(e=>({nombre:e[0]||"",correoElectronico:e[1]||"",telefono:e[2]||"",direccion:e[3]||""})).filter(e=>{const t=e.nombre.toString().toLowerCase().trim();return!["nombre","name","empresa","company","correo electrónico de contacto","correo electronico de contacto","teléfono de contacto","telefono de contacto","dirección","direccion","address"].includes(t)&&t})}mapCondominiosData(e){return e.map(e=>({empresa:e[0]||"",nombre:e[1]||"",direccion:e[2]||"",totalEdificios:e[3]||0,totalPisos:e[4]||0,servicios:e[5]||"",totalEstacionamientos:e[6]||0,caracteristicasSeguridad:e[7]||"",correoElectronico:e[8]||"",telefono:e[9]||"",urlSitioWeb:e[10]||""})).filter(e=>{const t=e.nombre.toString().toLowerCase().trim();return!["condominios","condominio","nombre","empresa","direccion","dirección","total de edificios","total de pisos","servicios","total de estacionamientos","características de seguridad","correo electrónico de contacto","teléfono de contacto","url del sitio web"].includes(t)&&t})}mapEdificiosData(e){return e.map(e=>({condominio:e[0]||"",nombre:e[1]||"",descripcion:e[2]||"",totalPisos:e[3]||0,totalUnidades:e[4]||0})).filter(e=>{const t=e.nombre.toString().toLowerCase().trim();return!["condominios","condominio","nombre","descripción","descripcion","total de pisos","total de unidades","dirección"].includes(t)&&t})}mapDepartamentosData(e){return e.map(e=>({bloque:e[0]||"",numeroDepartamento:e[1]||"",numeroPiso:e[2]||1,metrosCuadrados:e[3]||0,habitaciones:e[4]||0,banos:e[5]||0,balcon:e[6]||"NO",porcentajeCobranza:e[7]||0,estado:e[8]||"",mascotasPermitidas:e[9]||"NO",nombres:e[10]||"",apellidoPaterno:e[11]||"",apellidoMaterno:e[12]||"",email:e[13]||"",telefonoContacto:e[14]||""})).filter(e=>{const t=e.numeroDepartamento.toString().toLowerCase().trim(),a=e.bloque.toString().toLowerCase().trim(),r=["número de departamento","numero de departamento","departamento","edificio","bloque","building","número de piso","numero de piso","metros cuadrados","habitaciones","baños","balcón","porcentaje de cobranza","estado","mascotas permitidas","nombres","apellido paterno","apellido materno","email","teléfono de contacto"];return!(r.includes(t)||r.includes(a))&&t})}}class SystemParameterService extends ApiBaseService{constructor(){super("/SystemParameter")}getSystemParameterById(e){return __async(this,null,function*(){return __superGet(SystemParameterService.prototype,this,"getById").call(this,e)})}getPagedSystemParameters(e){return __async(this,null,function*(){const t=e?__spreadValues({},e):void 0;return __superGet(SystemParameterService.prototype,this,"getPaged").call(this,"paged",t)})}create(e){return __async(this,null,function*(){return this.post("",e)})}update(e,t){return __async(this,null,function*(){return this.put(`/${e}`,t)})}deleteSystemParameter(e){return __async(this,null,function*(){return __superGet(SystemParameterService.prototype,this,"deleteById").call(this,e)})}getByParameterName(e){return __async(this,null,function*(){return this.get(`by-name/${e}`)})}getParameterValue(e){return __async(this,null,function*(){return this.get(`value/${e}`)})}getByCategory(e,t=1,a=10){return __async(this,null,function*(){const r={page:t,pageSize:a,category:e};return this.getPagedSystemParameters(r)})}searchByName(e,t=1,a=10){return __async(this,null,function*(){const r={page:t,pageSize:a,parameterName:e};return this.getPagedSystemParameters(r)})}getActiveParameters(e=1,t=10){return __async(this,null,function*(){const a={page:e,pageSize:t,isActive:!0};return this.getPagedSystemParameters(a)})}getByDataType(e,t=1,a=10){return __async(this,null,function*(){const r={page:t,pageSize:a,dataType:e};return this.getPagedSystemParameters(r)})}updateParameterValue(e,t,a){return __async(this,null,function*(){const r={parameterValue:t,updatedBy:a,updatedAt:(new Date).toISOString()};return this.patch(`update-value/${e}`,r)})}activateParameter(e){return __async(this,null,function*(){const t={isActive:!0,updatedAt:(new Date).toISOString()};return this.patch(`/${e}/activate`,t)})}deactivateParameter(e){return __async(this,null,function*(){const t={isActive:!1,updatedAt:(new Date).toISOString()};return this.patch(`/${e}/deactivate`,t)})}getCategories(){return __async(this,null,function*(){return this.get("categories")})}resetToDefault(e){return __async(this,null,function*(){const t={resetToDefault:!0,updatedAt:(new Date).toISOString()};return this.post(`/${e}/reset`,t)})}importParameters(e){return __async(this,null,function*(){const t=new FormData;return t.append("configFile",e),this.post("import",t)})}exportParameters(e){return __async(this,null,function*(){const t=e?{category:e}:void 0;return this.get("export",t)})}dataBulk(e){return __async(this,null,function*(){return this.post("data-bulk",e)})}}function DataBulkUpload(){return jsxRuntimeExports.jsx(AlertProvider,{children:jsxRuntimeExports.jsx(DataBulkUploadContent,{})})}function DataBulkUploadContent(){const e=useNavigate(),{showToast:t,showConfirm:a}=useAlerts(),r=new SystemParameterService,s=new ExcelProcessorService,[n,i]=reactExports.useState(!1),[o,l]=reactExports.useState(null),[c,d]=reactExports.useState(null),[u,m]=reactExports.useState([]),[p,x]=reactExports.useState([]),[h,g]=reactExports.useState(!1),[y,v]=reactExports.useState(!1),E=reactExports.useRef(null);reactExports.useEffect(()=>{const e=console.warn;return console.warn=function(t,...a){if(e.apply(console,[t,...a]),"string"==typeof t&&t.includes("condominios con referencias a empresas inexistentes")){const e=a[0];if(Array.isArray(e)){const t=e.map(e=>{const[t,a]=e.split(" -> ");return{entity:"Condominio",sourceField:t,targetEntity:"Empresa",value:a}});x(e=>[...e,...t])}}if("string"==typeof t&&t.includes("edificios con referencias a condominios inexistentes")){const e=a[0];if(Array.isArray(e)){const t=e.map(e=>{const[t,a]=e.split(" -> ");return{entity:"Edificio",sourceField:t,targetEntity:"Condominio",value:a}});x(e=>[...e,...t])}}if("string"==typeof t&&t.includes("departamentos con referencias a edificios inexistentes")){const e=a[0];if(Array.isArray(e)){const t=e.map(e=>{const[t,a]=e.split(" -> ");return{entity:"Departamento",sourceField:t,targetEntity:"Edificio",value:a}});x(e=>[...e,...t])}}},()=>{console.warn=e}},[]);const f=e=>__async(this,null,function*(){if(s.isValidExcelFile(e)){m([]),x([]),l(e),i(!0);try{const a=yield s.processExcelFile(e);d(a);const r=R(a);m(r);r.length>0||p.length>0?(t("warning",`Se encontraron ${r.length+p.length} errores en los datos. Verifique y corrija antes de procesar.`),v(!0)):t("success","Archivo cargado correctamente y sin errores")}catch(a){t("error",a instanceof Error?a.message:"Error al procesar el archivo")}finally{i(!1)}}else t("error","Por favor seleccione un archivo Excel válido (.xlsx o .xls)")}),b=e=>__async(this,null,function*(){var t;const a=(null==(t=e.target.files)?void 0:t[0])||null;a&&(yield f(a))}),j=()=>{E.current&&E.current.click()},R=e=>{const t=[];return e.departamentos.forEach((e,a)=>{e.numeroDepartamento||t.push({entity:"Departamento",index:a+1,field:"Número de departamento",message:"El número de departamento es requerido"}),e.estado||t.push({entity:"Departamento",index:a+1,field:"Estado",message:"El estado es requerido"}),e.bloque||t.push({entity:"Departamento",index:a+1,field:"Edificio/Bloque",message:"La referencia al edificio es requerida"})}),e.edificios.forEach((e,a)=>{e.nombre||t.push({entity:"Edificio",index:a+1,field:"Nombre",message:"El nombre del edificio es requerido"}),e.condominio||t.push({entity:"Edificio",index:a+1,field:"Condominio",message:"La referencia al condominio es requerida"})}),e.condominios.forEach((e,a)=>{e.nombre||t.push({entity:"Condominio",index:a+1,field:"Nombre",message:"El nombre del condominio es requerido"}),e.empresa||t.push({entity:"Condominio",index:a+1,field:"Empresa",message:"La referencia a la empresa es requerida"})}),e.empresas.forEach((e,a)=>{e.nombre||t.push({entity:"Empresa",index:a+1,field:"Nombre",message:"El nombre de la empresa es requerido"})}),t},I=()=>__async(this,null,function*(){if(i(!0),c)try{const e={Companies:c.empresas.map(e=>{const t=c.condominios.filter(t=>t.empresa===e.nombre).map(e=>{const t=c.edificios.filter(t=>t.condominio===e.nombre).map(e=>{const t=c.departamentos.filter(t=>t.bloque===e.nombre).map(t=>{var a,r;let s=1;(null==(a=t.estado)?void 0:a.toLowerCase().includes("alquil"))?s=2:(null==(r=t.estado)?void 0:r.toLowerCase().includes("disponible"))&&(s=3);let n=null;if(t.nombres&&t.nombres.toString().trim()){const a=`${e.nombre.charAt(0).toUpperCase()}${t.numeroDepartamento}`,r=t.email&&t.email.toString().trim()?t.email.toString().trim():"aa@aa.com";n={firstName:t.nombres.toString().trim(),lastName:t.apellidoPaterno?t.apellidoPaterno.toString().trim():"",secondLastName:t.apellidoMaterno&&t.apellidoMaterno.toString().trim()?t.apellidoMaterno.toString().trim():null,email:r,contactNumber:t.telefonoContacto&&t.telefonoContacto.toString().trim()?t.telefonoContacto.toString().trim():null,address:null,dateOfBirth:null,genderId:null,profilePicture:null,documentTypeId:null,documentNumber:null,profileTypeId:3,companyId:null,condoId:null,username:a,password:a,statusTypeId:1,isInternalUser:!1}}return{departmentNumber:t.numeroDepartamento.toString(),floorNumber:t.numeroPiso,squareMeters:t.metrosCuadrados,bedrooms:t.habitaciones,bathrooms:t.banos,balcony:"SI"===t.balcon,participationPercentage:t.porcentajeCobranza,statusTypeId:s,petsAllowed:"SI"===t.mascotasPermitidas,usuarios:n}});return{name:e.nombre,description:e.descripcion,totalFloors:e.totalPisos,totalUnits:e.totalUnidades,departments:t}});return{name:e.nombre,address:e.direccion,totalUnits:e.totalEdificios,totalFloors:e.totalPisos,amenities:e.servicios,parkingSpaces:e.totalEstacionamientos,securityFeatures:e.caracteristicasSeguridad,contactEmail:e.correoElectronico,contactPhone:e.telefono?e.telefono.toString():"",websiteUrl:e.urlSitioWeb,buildings:t}});return{name:e.nombre,contactEmail:e.correoElectronico||"",contactPhone:e.telefono?e.telefono.toString():"",address:e.direccion||"",condominiums:t}})},a=yield r.dataBulk(e);a.isSuccess?t("success","Datos procesados correctamente"):t("error",`Error al procesar los datos: ${a.error}`)}catch(e){const a=e instanceof Error?e.message:"Error desconocido";t("error",`Error al procesar los datos: ${a}`)}finally{i(!1)}else t("error","No hay datos para procesar"),i(!1)});return jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6 p-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx(ButtonUI,{icon:ArrowLeft,onClick:()=>{e("/condominiums/list")},theme:"view"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Carga Masiva de Datos"}),jsxRuntimeExports.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Carga masiva de datos desde un archivo Excel"})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex space-x-3",children:[jsxRuntimeExports.jsx(ButtonUI,{icon:File,title:"Descargar Plantilla",theme:"info",onClick:()=>__async(this,null,function*(){try{i(!0);const e=yield r.getSystemParameterById(1);if(e.isSuccess&&e.data){const a=e.data.value2;if(a){const e="data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,",r=document.createElement("a");r.href=e+a,r.download="plantilla-condominio.xlsx",r.target="_blank",document.body.appendChild(r),r.click(),document.body.removeChild(r),t("success","Plantilla descargada correctamente")}else t("error","No se encontró la plantilla en el sistema")}else t("error",e.error||"Error al descargar la plantilla")}catch(e){const a=e instanceof Error?e.message:"Error desconocido";t("error",`Error al descargar la plantilla: ${a}`)}finally{i(!1)}})}),c&&jsxRuntimeExports.jsx(ButtonUI,{icon:Save,title:"Procesar Datos",theme:"primary",onClick:()=>{u.length>0||p.length>0?a("Hay errores en los datos","Existen registros con errores. ¿Desea continuar con el procesamiento de los registros válidos?",()=>I(),()=>{}):I()},disabled:n})]})]}),jsxRuntimeExports.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:o?jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4 pb-4 border-b border-gray-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx(Database,{className:"w-5 h-5 text-primary mr-2"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-md font-medium text-gray-900",children:o.name}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-gray-500",children:[(o.size/1024).toFixed(2)," KB - Excel con múltiples pestañas"]})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("input",{type:"file",ref:E,className:"hidden",accept:".xlsx,.xls",onChange:b}),jsxRuntimeExports.jsx(ButtonUI,{icon:Upload,title:"Cambiar Archivo",theme:"cancel",onClick:j})]})]}),u.length>0||p.length>0?jsxRuntimeExports.jsx("div",{className:"bg-orange-50 border-l-4 border-orange-400 p-4 mb-4",children:jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("div",{className:"flex-shrink-0",children:jsxRuntimeExports.jsx(AlertTriangle,{className:"h-5 w-5 text-orange-400"})}),jsxRuntimeExports.jsx("div",{className:"ml-3",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-orange-700",children:"Se encontraron errores en los datos. Verifica que el Excel contenga las pestañas correctas y que los datos tengan el formato esperado."})})]})}):c&&jsxRuntimeExports.jsx("div",{className:"bg-green-50 border-l-4 border-green-400 p-4 mb-4",children:jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("div",{className:"flex-shrink-0",children:jsxRuntimeExports.jsx(CheckCircle,{className:"h-5 w-5 text-green-400"})}),jsxRuntimeExports.jsx("div",{className:"ml-3",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-green-700",children:"Excel procesado correctamente. Todos los datos cumplen con el formato esperado."})})]})}),0===u.length&&0===p.length?null:jsxRuntimeExports.jsxs("div",{className:"mt-4 p-4 border border-orange-200 rounded-md bg-orange-50 text-sm",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-2",children:[jsxRuntimeExports.jsxs("h4",{className:"font-medium text-orange-800 flex items-center",children:[jsxRuntimeExports.jsx(AlertTriangle,{className:"h-4 w-4 mr-1"}),"Errores detectados (",u.length+p.length,")"]}),jsxRuntimeExports.jsx("button",{onClick:()=>v(!y),className:"text-orange-700 hover:text-orange-900 text-xs font-medium",children:y?"Ocultar":"Mostrar"})]}),y&&jsxRuntimeExports.jsxs("div",{className:"max-h-64 overflow-y-auto",children:[u.length>0&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("h5",{className:"font-medium text-orange-700 mt-2 mb-1",children:"Errores de validación:"}),jsxRuntimeExports.jsx("ul",{className:"space-y-1 pl-5 list-disc text-orange-700",children:u.map((e,t)=>jsxRuntimeExports.jsxs("li",{children:[e.entity," #",e.index,": ",e.field," - ",e.message]},`val-${t}`))})]}),p.length>0&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("h5",{className:"font-medium text-orange-700 mt-4 mb-1",children:"Errores de relación:"}),jsxRuntimeExports.jsx("ul",{className:"space-y-1 pl-5 list-disc text-orange-700",children:p.map((e,t)=>jsxRuntimeExports.jsxs("li",{children:[e.entity,' "',e.sourceField,'" hace referencia a ',e.targetEntity,' inexistente: "',e.value,'"']},`rel-${t}`))})]}),jsxRuntimeExports.jsx("div",{className:"mt-3 p-2 bg-orange-100 rounded text-xs text-orange-800",children:jsxRuntimeExports.jsxs("p",{className:"flex items-start",children:[jsxRuntimeExports.jsx(Info,{className:"h-3 w-3 mr-1 mt-0.5 flex-shrink-0"}),jsxRuntimeExports.jsx("span",{children:"Estos errores deben corregirse en el archivo Excel antes de procesarlo. Verifique que las referencias entre entidades sean correctas y que todos los campos obligatorios estén completos."})]})})]})]}),n?jsxRuntimeExports.jsxs("div",{className:"py-10 text-center",children:[jsxRuntimeExports.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-2 border-primary border-t-transparent"}),jsxRuntimeExports.jsx("p",{className:"mt-2 text-gray-500",children:"Procesando datos..."})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[c&&jsxRuntimeExports.jsxs("div",{className:"text-sm text-gray-500 mb-4 p-3 border rounded-md bg-primary/5",children:[jsxRuntimeExports.jsx("h4",{className:"font-medium mb-1 text-base text-gray-700",children:"Resumen del archivo:"}),jsxRuntimeExports.jsxs("ul",{className:"grid grid-cols-2 gap-2",children:[jsxRuntimeExports.jsxs("li",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"h-2 w-2 rounded-full mr-2 "+(c.empresas.length?"bg-green-500":"bg-red-500")}),"Empresas: ",jsxRuntimeExports.jsxs("span",{className:"font-medium ml-1",children:[c.empresas.length," registros"]})]}),jsxRuntimeExports.jsxs("li",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"h-2 w-2 rounded-full mr-2 "+(c.condominios.length?"bg-green-500":"bg-red-500")}),"Condominios: ",jsxRuntimeExports.jsxs("span",{className:"font-medium ml-1",children:[c.condominios.length," registros"]})]}),jsxRuntimeExports.jsxs("li",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"h-2 w-2 rounded-full mr-2 "+(c.edificios.length?"bg-green-500":"bg-red-500")}),"Edificios: ",jsxRuntimeExports.jsxs("span",{className:"font-medium ml-1",children:[c.edificios.length," registros"]})]}),jsxRuntimeExports.jsxs("li",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"h-2 w-2 rounded-full mr-2 "+(c.departamentos.length?"bg-green-500":"bg-red-500")}),"Departamentos: ",jsxRuntimeExports.jsxs("span",{className:"font-medium ml-1",children:[c.departamentos.length," registros"]})]}),jsxRuntimeExports.jsxs("li",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"h-2 w-2 rounded-full mr-2 "+(c.departamentos.filter(e=>e.nombres&&e.nombres.trim()).length?"bg-green-500":"bg-gray-500")}),"Usuarios Propietarios: ",jsxRuntimeExports.jsxs("span",{className:"font-medium ml-1",children:[c.departamentos.filter(e=>e.nombres&&e.nombres.trim()).length," registros"]})]})]})]}),jsxRuntimeExports.jsx(ExcelDataGrid,{data:c||void 0})]})]}):jsxRuntimeExports.jsxs("div",{className:"text-center py-12 border-2 border-dashed transition-all duration-200 rounded-lg \n              "+(h?"bg-primary/5 border-primary scale-[0.99]":"border-gray-300 hover:border-primary/50 hover:bg-gray-50"),onDragOver:e=>{e.preventDefault(),e.stopPropagation(),g(!0)},onDragLeave:e=>{e.preventDefault(),e.stopPropagation(),g(!1)},onDrop:e=>__async(this,null,function*(){if(e.preventDefault(),e.stopPropagation(),g(!1),e.dataTransfer.files&&e.dataTransfer.files.length>0){const t=e.dataTransfer.files[0];yield f(t)}}),children:[jsxRuntimeExports.jsx("div",{className:`mx-auto w-16 h-16 mb-4 flex items-center justify-center rounded-full \n              ${h?"bg-primary/20":"bg-primary/10"} \n              transition-all duration-200`,children:jsxRuntimeExports.jsx(Upload,{className:"w-8 h-8 text-primary "+(h?"animate-bounce":"")})}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:h?"Suelta el archivo aquí":"Selecciona un archivo Excel"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 mb-3",children:h?"Suelta el archivo para procesarlo":"Arrastra y suelta un archivo o haz clic para seleccionarlo"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-400 mb-6",children:"El Excel debe contener las pestañas: Empresas, Condominios, Edificios y Departamentos"}),jsxRuntimeExports.jsx("input",{type:"file",ref:E,className:"hidden",accept:".xlsx,.xls",onChange:b}),jsxRuntimeExports.jsx(ButtonUI,{icon:Upload,title:"Seleccionar Archivo",theme:"secondary",onClick:j})]})})]})}const useRoleBasedAccess=()=>{const{user:e,hasPermission:t,canView:a,canCreate:r,canEdit:s,canDelete:n,canManage:i,canExport:o,canApprove:l,canReject:c}=useAuthorization(),d={canViewDashboard:()=>a(Resource.DASHBOARD),canViewDashboardGeneral:()=>a(SubResource.DASHBOARD_GENERAL),canViewDashboardIndicators:()=>a(SubResource.DASHBOARD_INDICATORS),canViewDashboardCalendar:()=>a(SubResource.DASHBOARD_CALENDAR),canViewCondominiums:()=>a(Resource.CONDOMINIUMS),canCreateCondominiums:()=>r(Resource.CONDOMINIUMS),canEditCondominiums:()=>s(Resource.CONDOMINIUMS),canDeleteCondominiums:()=>n(Resource.CONDOMINIUMS),canManageCondominiums:()=>i(Resource.CONDOMINIUMS),canExportCondominiums:()=>o(Resource.CONDOMINIUMS),canViewCondominiumsList:()=>a(SubResource.CONDOMINIUMS_LIST),canViewCondominiumsDataBulk:()=>a(SubResource.CONDOMINIUMS_DATA_BULK),canViewCondominiumsDepartments:()=>a(SubResource.CONDOMINIUMS_DEPARTMENTS),canViewCondominiumsCommonAreas:()=>a(SubResource.CONDOMINIUMS_COMMON_AREAS),canViewPayments:()=>a(Resource.PAYMENTS),canCreatePayments:()=>r(Resource.PAYMENTS),canEditPayments:()=>s(Resource.PAYMENTS),canManagePayments:()=>i(Resource.PAYMENTS),canExportPayments:()=>o(Resource.PAYMENTS),canApprovePayments:()=>l(Resource.PAYMENTS),canViewPaymentsMonthly:()=>a(SubResource.PAYMENTS_MONTHLY),canViewPaymentsList:()=>a(SubResource.PAYMENTS_LIST),canViewPaymentsOverdue:()=>a(SubResource.PAYMENTS_OVERDUE),canViewCommonAreas:()=>a(Resource.COMMON_AREAS),canCreateCommonAreas:()=>r(Resource.COMMON_AREAS),canEditCommonAreas:()=>s(Resource.COMMON_AREAS),canManageCommonAreas:()=>i(Resource.COMMON_AREAS),canViewCommonAreasBookings:()=>a(SubResource.COMMON_AREAS_BOOKINGS),canCreateCommonAreasBookings:()=>r(SubResource.COMMON_AREAS_BOOKINGS),canApproveCommonAreasBookings:()=>l(SubResource.COMMON_AREAS_BOOKINGS),canRejectCommonAreasBookings:()=>c(SubResource.COMMON_AREAS_BOOKINGS),canViewCommonAreasSchedules:()=>a(SubResource.COMMON_AREAS_SCHEDULES),canViewVisits:()=>a(Resource.VISITS),canCreateVisits:()=>r(Resource.VISITS),canEditVisits:()=>s(Resource.VISITS),canManageVisits:()=>i(Resource.VISITS),canViewVisitsRegistry:()=>a(SubResource.VISITS_REGISTRY),canCreateVisitsRegistry:()=>r(SubResource.VISITS_REGISTRY),canViewIncidents:()=>a(Resource.INCIDENTS),canCreateIncidents:()=>r(Resource.INCIDENTS),canEditIncidents:()=>s(Resource.INCIDENTS),canDeleteIncidents:()=>n(Resource.INCIDENTS),canManageIncidents:()=>i(Resource.INCIDENTS),canExportIncidents:()=>o(Resource.INCIDENTS),canViewIncidentsReports:()=>a(SubResource.INCIDENTS_REPORTS),canCreateIncidentsReports:()=>r(SubResource.INCIDENTS_REPORTS),canEditIncidentsReports:()=>s(SubResource.INCIDENTS_REPORTS),canViewIncidentsLog:()=>a(SubResource.INCIDENTS_LOG),canViewIncidentsTypes:()=>a(SubResource.INCIDENTS_TYPES),canManageIncidentsTypes:()=>i(SubResource.INCIDENTS_TYPES),canViewMaintenance:()=>a(Resource.MAINTENANCE),canCreateMaintenance:()=>r(Resource.MAINTENANCE),canEditMaintenance:()=>s(Resource.MAINTENANCE),canManageMaintenance:()=>i(Resource.MAINTENANCE),canViewMaintenancePreventive:()=>a(SubResource.MAINTENANCE_PREVENTIVE),canViewMaintenanceCorrective:()=>a(SubResource.MAINTENANCE_CORRECTIVE),canViewInformation:()=>a(Resource.INFORMATION),canCreateInformation:()=>r(Resource.INFORMATION),canEditInformation:()=>s(Resource.INFORMATION),canDeleteInformation:()=>n(Resource.INFORMATION),canManageInformation:()=>i(Resource.INFORMATION),canViewInformationDocuments:()=>a(SubResource.INFORMATION_DOCUMENTS),canViewSettings:()=>a(Resource.SETTINGS),canManageSettings:()=>i(Resource.SETTINGS),canViewSettingsUsers:()=>a(SubResource.SETTINGS_USERS),canManageSettingsUsers:()=>i(SubResource.SETTINGS_USERS),canViewSettingsSystemParameters:()=>a(SubResource.SETTINGS_SYSTEM_PARAMETERS),canViewResidents:()=>a(Resource.RESIDENTS),canCreateResidents:()=>r(Resource.RESIDENTS),canEditResidents:()=>s(Resource.RESIDENTS),canManageResidents:()=>i(Resource.RESIDENTS),canViewResidentsManagement:()=>a(SubResource.RESIDENTS_MANAGEMENT)},u={canManageAny:()=>d.canManageCondominiums()||d.canManagePayments()||d.canManageCommonAreas()||d.canManageIncidents()||d.canManageMaintenance()||d.canManageSettings(),canCreateAny:()=>d.canCreateCondominiums()||d.canCreatePayments()||d.canCreateCommonAreas()||d.canCreateIncidents()||d.canCreateMaintenance()||d.canCreateInformation(),canExportAny:()=>d.canExportCondominiums()||d.canExportPayments()||d.canExportIncidents(),canApproveAny:()=>d.canApprovePayments()||d.canApproveCommonAreasBookings()};return{user:e,permissions:d,roles:{isSuperAdmin:()=>(null==e?void 0:e.role)===UserRole.SUPER_ADMIN,isAdminCompany:()=>(null==e?void 0:e.role)===UserRole.ADMIN_COMPANY,isAdminCondo:()=>(null==e?void 0:e.role)===UserRole.ADMIN_CONDO,isSecurity:()=>(null==e?void 0:e.role)===UserRole.SECURITY,isMaintenance:()=>(null==e?void 0:e.role)===UserRole.MAINTENANCE,isResident:()=>(null==e?void 0:e.role)===UserRole.RESIDENT,isTenant:()=>(null==e?void 0:e.role)===UserRole.TENANT,isAdmin:()=>(null==e?void 0:e.role)===UserRole.SUPER_ADMIN||(null==e?void 0:e.role)===UserRole.ADMIN_COMPANY||(null==e?void 0:e.role)===UserRole.ADMIN_CONDO,isStaff:()=>(null==e?void 0:e.role)===UserRole.SECURITY||(null==e?void 0:e.role)===UserRole.MAINTENANCE,isResidentOrTenant:()=>(null==e?void 0:e.role)===UserRole.RESIDENT||(null==e?void 0:e.role)===UserRole.TENANT},utils:u,hasPermission:t,canView:a,canCreate:r,canEdit:s,canDelete:n,canManage:i,canExport:o,canApprove:l,canReject:c}},ConditionalRender=({children:e,resource:t,action:a,conditions:r,fallback:s=null,roles:n=[]})=>{const{user:i,hasPermission:o}=useAuthorization();return i?n.length>0&&!n.includes(i.role)?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:s}):o(t,a,r)?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:e}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:s}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:s})},authService=new AuthService,preloadCompanyCondoFilters=(e,t,a,r="")=>__async(void 0,null,function*(){try{const r=authService.getUser();if(!r)return;r.companyId&&(e(r.companyId.toString()),yield t("companyId",r.companyId),yield a(r.companyId),r.condoId&&(yield t("condoId",r.condoId)))}catch(r){}}),getCompanyCondoFromLocalStorage=()=>{try{const e=authService.getUser();if(!e)return{companyId:null,condoId:null,shouldPreload:!1};const{profileTypeId:t,companyId:a,condoId:r}=e,s=[2,3,4,5].includes(t);return{companyId:s&&a?a:null,condoId:s&&r?r:null,shouldPreload:s}}catch(e){return{companyId:null,condoId:null,shouldPreload:!1}}},preloadCompanyCondoSelects=(e,t,a="Component")=>__async(void 0,null,function*(){try{const a=authService.getUser();if(!a||!a.companyId)return;e(e=>__spreadProps(__spreadValues({},e),{companyId:a.companyId})),yield t(a.companyId),a.condoId&&setTimeout(()=>{e(e=>__spreadProps(__spreadValues({},e),{condoId:a.condoId}))},100)}catch(a){}}),shouldDisableCompanyCondoSelects=()=>{try{const e=authService.getUser();return!!e&&(e.profileTypeId>=3&&void 0!==e.companyId&&void 0!==e.condoId)}catch(e){return!1}},FIXED_ACCESS_STATUSES=[{statusTypeId:1,statusName:"Activo",description:"Usuario activo en el sistema"},{statusTypeId:2,statusName:"Inactivo",description:"Usuario inactivo temporalmente"},{statusTypeId:3,statusName:"Bloqueado",description:"Usuario bloqueado por seguridad"},{statusTypeId:4,statusName:"Suspendido",description:"Usuario suspendido administrativamente"}],FIXED_DOCUMENT_TYPES=[{documentTypeId:1,documentName:"DNI",description:"Documento Nacional de Identidad"},{documentTypeId:2,documentName:"Pasaporte",description:"Pasaporte"},{documentTypeId:3,documentName:"Carné de Extranjería",description:"Carné de Extranjería"},{documentTypeId:4,documentName:"RUC",description:"Registro Único de Contribuyentes"}],SelectUI=({id:e,label:t,value:a,onChange:r,options:s,icon:n,required:i,placeholder:o,disabled:l,hasError:c,errorMessage:d})=>{const u=c;return jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsxs("label",{htmlFor:e,className:"block text-sm font-medium text-gray-700 mb-1",children:[t," ",i&&jsxRuntimeExports.jsx("span",{className:"text-warning",children:"*"})]}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[n&&jsxRuntimeExports.jsx(n,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 "+(u?"text-warning":"text-gray-400")}),jsxRuntimeExports.jsxs("select",{id:e,value:a,onChange:e=>r(e),className:`${n?"pl-10":"pl-4"} w-full px-4 py-3 bg-white border rounded-lg\n            transition-all duration-200 focus:outline-none focus:ring-2\n            ${u?"border-warning focus:ring-warning/20 focus:border-warning bg-red-50":"border-gray-300 focus:ring-primary focus:border-primary hover:border-primary"}\n            ${l?"bg-gray-100 cursor-not-allowed opacity-60":""}`,required:i,disabled:l,children:[o&&jsxRuntimeExports.jsx("option",{value:"",children:o}),s.map(e=>jsxRuntimeExports.jsx("option",{value:e.value,children:e.label},e.value))]})]}),u&&jsxRuntimeExports.jsx("div",{className:"mt-1",children:jsxRuntimeExports.jsx("span",{className:"text-sm text-warning font-medium",children:d||(i&&!a?`El campo ${t.toLowerCase()} es obligatorio`:"")})})]})};function SystemUserListContent(){const{permissions:e}=useRoleBasedAccess(),{user:t}=useAuth(),{setLoading:a}=useLoading(),[r,s]=reactExports.useState([]),[n,i]=reactExports.useState(!1),[o,l]=reactExports.useState(!1),[c,d]=reactExports.useState(),[u,m]=reactExports.useState(1),[p,x]=reactExports.useState(5),[h,g]=reactExports.useState(0),[y,v]=reactExports.useState(!1),E=reactExports.useRef(null),[f,b]=reactExports.useState({}),[j,R]=reactExports.useState(!1),[I,S]=reactExports.useState(""),[_,N]=reactExports.useState(""),[C,T]=reactExports.useState(""),[D,A]=reactExports.useState(),[P,w]=reactExports.useState({firstName:"",lastName:"",secondLastName:"",email:"",contactNumber:"",address:"",dateOfBirth:"",genderId:void 0,documentTypeId:void 0,documentNumber:"",profileTypeId:void 0,companyId:void 0,condoId:void 0,username:"",password:"",statusTypeId:1,profilePicture:null,isInternalUser:!0}),[M,k]=reactExports.useState([]),[O,$]=reactExports.useState([]),[U,L]=reactExports.useState([]),[B,F]=reactExports.useState([]),[V,W]=reactExports.useState([]),[z,H]=reactExports.useState(-1),[G,q]=reactExports.useState(-1),[Y,K]=reactExports.useState(!1),J=useNavigate(),X=useLocation(),{showToast:Z,showConfirm:Q}=useAlerts(),ee=new SystemUserService,te=new ManagementCompanyService,ae=new CondominiumService,re=new AuthService,se=X.pathname.includes("/settings/users"),ne=se?"Gestión de Usuarios del Sistema":"Gestión de Residentes",[ie,oe]=reactExports.useState(!1);reactExports.useEffect(()=>{w(e=>__spreadProps(__spreadValues({},e),{isInternalUser:se}))},[se]),reactExports.useEffect(()=>((()=>{__async(this,null,function*(){try{yield ce(),yield de(),oe(!0)}catch(e){}})})(),()=>{E.current&&(clearTimeout(E.current),E.current=null),a(!1)}),[]),reactExports.useEffect(()=>{ie&&de()},[u,p,ie]),reactExports.useEffect(()=>{ie&&(m(1),de())},[se,ie]),reactExports.useEffect(()=>{if(!ie)return;const e=setTimeout(()=>{(I.length>2||0===I.length||_.length>2||0===_.length||C.length>2||0===C.length||void 0!==D)&&(m(1),de())},300);return()=>clearTimeout(e)},[I,_,C,D,ie]);const le=()=>__async(this,null,function*(){try{const e=!se,t=yield ee.getProfiles(e);t.isSuccess&&t.data?k(t.data):k([])}catch(e){k([])}}),ce=()=>__async(this,null,function*(){try{yield le(),$(FIXED_ACCESS_STATUSES),L(FIXED_DOCUMENT_TYPES);const e=yield te.getPagedCompanies();e.isSuccess&&e.data?Array.isArray(e.data)?F(e.data):e.data.items&&F(e.data.items):F([]);const t=yield ae.getPagedCondominiums();t.isSuccess&&t.data?Array.isArray(t.data)?W(t.data):t.data.items&&W(t.data.items):W([])}catch(e){Z("error","Error al cargar catálogos")}}),de=()=>__async(this,null,function*(){if(y)return;Date.now();try{v(!0),a(!0),E.current=setTimeout(()=>{v(!1),a(!1)},3e4);const e={Page:u,PageSize:p,IsInternalUser:se},t=re.getUser();t&&(1===t.profileTypeId&&t.companyId?e.CompanyId=t.companyId:(2===t.profileTypeId&&t.condoId||t.profileTypeId>=3&&t.condoId)&&(e.CondoId=t.condoId)),I.trim()&&(e.FirstName=I.trim()),_.trim()&&(e.LastName=_.trim()),C.trim()&&(e.Email=C.trim()),D&&(e.ProfileTypeId=D);const r=yield ee.getPagedSystemUsers(e);if(r.isSuccess&&r.data){let e=[],t=0;const a=r,n=a.data;Array.isArray(n)?(e=n,t=n.length):n.data&&Array.isArray(n.data)?(e=n.data,t=n.metadata&&void 0!==n.metadata.totalRecords?n.metadata.totalRecords:n.totalCount||n.totalRecords||n.total||a.totalCount||a.totalRecords||n.data.length):n.items&&Array.isArray(n.items)&&(e=n.items,t=n.totalCount||n.items.length),s(e),g(t)}else s([]),g(0),401!==r.statusCode&&Z("error",r.error||"Error al cargar los datos"),401===r.statusCode&&J("/login")}catch(e){s([]),g(0);const t=e instanceof Error?e.message:"Error desconocido";Z("error",`Error al conectar con el servidor: ${t}`)}finally{E.current&&(clearTimeout(E.current),E.current=null),v(!1),a(!1)}}),ue=[{accessorKey:"firstName",header:"Nombre",icon:User,cell:({row:e})=>{const t=e.original;return`${t.firstName||""} ${t.lastName||""} ${t.secondLastName||""}`}},{accessorKey:"email",header:"Email",icon:Mail},{accessorKey:"contactNumber",header:"Teléfono",icon:Phone},{accessorKey:"profileName",header:"Perfil",icon:User},{accessorKey:"companyName",header:"Empresa",icon:Briefcase},{accessorKey:"condoName",header:"Condominio",icon:Building},{accessorKey:"lastPasswordChange",header:"Fecha Creación",icon:Calendar,cell:({getValue:e})=>{const t=e();return t?new Date(t).toLocaleDateString():"N/A"}}],me=()=>{i(!1),l(!1),d(void 0),b({}),R(!1)},pe=e=>{const{name:t,value:a}=e.target;_e(t),["companyId","condoId","profileTypeId","statusTypeId","genderId","documentTypeId"].includes(t)&&""!==a?w(e=>__spreadProps(__spreadValues({},e),{[t]:Number(a)})):w(e=>__spreadProps(__spreadValues({},e),{[t]:a}))},xe=(e,t)=>{_e(e),w(a=>__spreadProps(__spreadValues({},a),{[e]:t}))},he=(e,t)=>{if(_e(e),""===t)w(t=>__spreadProps(__spreadValues({},t),{[e]:void 0}));else{const a=Number(t);if(isNaN(a))return;w(t=>__spreadProps(__spreadValues({},t),{[e]:a}))}},ge=e=>__async(this,null,function*(){const t=Number(e);H(t),q(-1),w(e=>__spreadProps(__spreadValues({},e),{companyId:-1===t?void 0:t,condoId:void 0})),-1!==t?yield ve(t):W([])}),ye=e=>__async(this,null,function*(){const t=Number(e);q(t),w(e=>__spreadProps(__spreadValues({},e),{condoId:-1===t?void 0:t}))}),ve=e=>__async(this,null,function*(){try{const t={CompanyId:e},a=yield ae.getPagedCondominiums(t);if(a.isSuccess&&a.data){const e=a.data;e.data&&Array.isArray(e.data)?W(e.data):e.items&&Array.isArray(e.items)?W(e.items):W([])}else Z("error","Error al cargar los condominios"),W([])}catch(t){Z("error","Error al cargar los condominios"),W([])}}),Ee=B.map(e=>({value:e.companyId||0,label:e.name||"Sin nombre"})),fe=V.map(e=>({value:e.condoId||0,label:e.name||"Sin nombre"})),be=()=>__async(this,null,function*(){yield preloadCompanyCondoSelects(w,ve,"SystemUserList")}),je=()=>2===(null==t?void 0:t.profileTypeId)||shouldDisableCompanyCondoSelects(),Re=e=>{w(t=>__spreadProps(__spreadValues({},t),{profilePicture:e}))},Ie=()=>{K(!Y)},Se=(e=!1)=>{var t,a,r,s,n,i,o;const l={};if((null==(t=P.firstName)?void 0:t.trim())||(l.firstName="El nombre es obligatorio"),(null==(a=P.lastName)?void 0:a.trim())||(l.lastName="El apellido paterno es obligatorio"),(null==(r=P.email)?void 0:r.trim())||(l.email="El email es obligatorio"),void 0===P.profileTypeId&&(l.profileTypeId="El perfil es obligatorio"),void 0===P.companyId&&(l.companyId="La empresa es obligatoria"),void 0===P.condoId&&(l.condoId="El condominio es obligatorio"),void 0===P.statusTypeId&&(l.statusTypeId="El estado es obligatorio"),void 0===P.documentTypeId&&(l.documentTypeId="El tipo de documento es obligatorio"),(null==(s=P.documentNumber)?void 0:s.trim())||(l.documentNumber="El número de documento es obligatorio"),e||((null==(n=P.username)?void 0:n.trim())||(l.username="El usuario es obligatorio"),(null==(i=P.password)?void 0:i.trim())||(l.password="La contraseña es obligatoria")),null==(o=P.email)?void 0:o.trim()){/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(P.email)||(l.email="El formato del email no es válido")}return b(l),0===Object.keys(l).length},_e=e=>{f[e]&&b(t=>{const a=__spreadValues({},t);return delete a[e],a})};return jsxRuntimeExports.jsxs("div",{className:"p-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:ne}),jsxRuntimeExports.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Gestione usuarios internos del sistema y sus permisos de acceso"})]}),jsxRuntimeExports.jsx(ConditionalRender,{resource:se?SubResource.SETTINGS_USERS:SubResource.RESIDENTS_MANAGEMENT,action:Action.CREATE,fallback:null,children:jsxRuntimeExports.jsx(ButtonUI,{title:se?"Nuevo Usuario":"Nuevo Residente",icon:Plus,onClick:()=>__async(this,null,function*(){w({firstName:"",lastName:"",secondLastName:"",email:"",contactNumber:"",address:"",dateOfBirth:"",genderId:void 0,documentTypeId:void 0,documentNumber:"",profileTypeId:void 0,companyId:void 0,condoId:void 0,username:"",password:"",statusTypeId:1,isInternalUser:se}),W([]),H(-1),q(-1);try{yield ce(),2===(null==t?void 0:t.profileTypeId)&&(null==t?void 0:t.companyId)&&(null==t?void 0:t.condoId)&&(H(t.companyId),yield ve(t.companyId),q(t.condoId),w(e=>__spreadProps(__spreadValues({},e),{companyId:t.companyId,condoId:t.condoId})));let e=1;const a=1;let r=1,s=1;if(M.length>0){const t=M[0];e=t.profileTypeId}O.length>0&&(r=O[0].statusTypeId),U.length>0&&(s=U[0].documentTypeId),w(t=>__spreadProps(__spreadValues({},t),{profileTypeId:e,genderId:a,statusTypeId:r,documentTypeId:s})),yield be()}catch(e){}i(!0)}),className:"bg-emerald-600 hover:bg-emerald-700 text-white"})})]}),jsxRuntimeExports.jsx(Expandex,{title:"Filtros de búsqueda",expandIcon:Filter,collapseIcon:ChevronUp,initialExpanded:!0,children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[jsxRuntimeExports.jsx(InputUI,{id:"firstName-filter",type:"text",label:"Nombre",value:I,onChange:e=>S(e),icon:User}),jsxRuntimeExports.jsx(InputUI,{id:"lastName-filter",type:"text",label:"Apellido",value:_,onChange:e=>N(e),icon:User}),jsxRuntimeExports.jsx(InputUI,{id:"email-filter",type:"text",label:"Email",value:C,onChange:e=>T(e),icon:Mail}),jsxRuntimeExports.jsx(SelectUI,{id:"profileType-filter",label:"Perfil",value:(null==D?void 0:D.toString())||"",onChange:e=>A(e.target.value?Number(e.target.value):void 0),options:[{value:"",label:"Todos los perfiles"},...M.map(e=>({value:e.profileTypeId.toString(),label:e.profileName}))],icon:User})]})}),jsxRuntimeExports.jsxs("div",{className:"mt-6",children:[r&&r.length>0?jsxRuntimeExports.jsxs("div",{className:"mb-2 text-sm text-gray-500",children:["Mostrando ",r.length," usuarios (Total: ",h,")"]}):jsxRuntimeExports.jsxs("div",{className:"mb-2 text-sm text-gray-500",children:["No se encontraron usuarios (",r?r.length:0,")"]}),jsxRuntimeExports.jsx(DataGrid,{data:r,columns:ue,actions:[{icon:SquarePen,label:"Editar",onClick:e=>__async(this,null,function*(){try{d(e);const a=yield ee.getSystemUserById(e.userId);if(a.isSuccess&&a.data){const e=a.data;if(2===(null==t?void 0:t.profileTypeId)&&(e.companyId!==t.companyId||e.condoId!==t.condoId))return void Z("error","No tienes permisos para editar usuarios de otras empresas o condominios");H(e.companyId||-1),q(e.condoId||-1),w({userId:e.userId,firstName:e.firstName||"",lastName:e.lastName||"",secondLastName:e.secondLastName||"",email:e.email||"",contactNumber:e.contactNumber||"",address:e.address||"",dateOfBirth:e.dateOfBirth||"",genderId:e.genderId,documentTypeId:e.documentTypeId,documentNumber:e.documentNumber||"",profileTypeId:e.profileTypeId,companyId:e.companyId,condoId:e.condoId,username:e.username||"",statusTypeId:e.statusTypeId,profilePicture:e.profilePicture||null,isInternalUser:void 0!==e.isInternalUser?e.isInternalUser:se}),e.companyId&&(yield ve(e.companyId)),l(!0)}else Z("error",a.error||"Error al obtener datos del usuario")}catch(a){Z("error","Error al obtener datos del usuario")}})},{icon:Trash2,label:"Eliminar",onClick:e=>{Q("Confirmar eliminación",`¿Está seguro que desea eliminar al usuario ${e.firstName} ${e.lastName}?`,()=>__async(this,null,function*(){try{const t=yield ee.deleteSystemUser(e.userId);t.isSuccess?(Z("success","Usuario eliminado exitosamente"),de()):Z("error",t.error||"Error al eliminar usuario")}catch(t){Z("error","Error al eliminar usuario")}}))}}].filter(t=>"Editar"===t.label?se?e.canManageSettingsUsers():e.canEditResidents():"Eliminar"!==t.label||(se?e.canManageSettingsUsers():e.canManageResidents())),initialPage:u,initialPageSize:p,onPageChange:(e,t)=>{m(e),x(t)},onPageSizeChange:(e,t)=>{x(e),m(t)},totalRecords:h})]}),jsxRuntimeExports.jsx(ModalUI,{isOpen:n,onClose:me,title:se?"Crear Usuario":"Crear Residente",footer:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ButtonUI,{title:"Cancelar",icon:X$1,onClick:me,theme:"delete"}),jsxRuntimeExports.jsx(ButtonUI,{title:"Guardar",icon:Save,onClick:()=>__async(this,null,function*(){try{if(R(!0),w(e=>__spreadProps(__spreadValues({},e),{companyId:-1===z?void 0:z,condoId:-1===G?void 0:G})),!Se(!1))return void Z("error","Por favor corrija los errores en el formulario");const e={firstName:P.firstName||"",lastName:P.lastName||"",secondLastName:P.secondLastName||null,email:P.email||"",contactNumber:P.contactNumber||null,address:P.address||null,dateOfBirth:P.dateOfBirth||null,genderId:P.genderId||null,documentTypeId:P.documentTypeId||null,documentNumber:P.documentNumber||null,profileTypeId:Number(P.profileTypeId),username:P.username||"",password:P.password||"",statusTypeId:Number(P.statusTypeId||1),companyId:P.companyId||null,condoId:P.condoId||null,profilePicture:P.profilePicture||null,isInternalUser:void 0!==P.isInternalUser?P.isInternalUser:se},t=yield ee.create(e);t.isSuccess?(Z("success","Usuario creado exitosamente"),me(),de()):Z("error",t.error||"Error al crear usuario")}catch(e){Z("error","Error al crear usuario")}}),theme:"modalSave"})]}),children:jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center mb-6",children:[jsxRuntimeExports.jsx(ProfilePictureUpload,{value:P.profilePicture||null,onChange:Re,size:"lg"}),P.profilePicture&&jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>Re(null),className:"mt-2 text-sm text-red-600 hover:text-red-800",children:"Eliminar foto de perfil"})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(SelectUI,{id:"companyId-create",label:"Empresa *",value:-1===z?"":z.toString(),onChange:e=>!je()&&ge(e.target.value),options:[{value:"",label:"--Seleccione una empresa--"},...Ee.map(e=>({value:e.value.toString(),label:e.label}))],icon:Building,required:!0,disabled:je(),hasError:j&&!!f.companyId,errorMessage:f.companyId}),jsxRuntimeExports.jsx(SelectUI,{id:"condoId-create",label:"Condominio *",value:-1===G?"":G.toString(),onChange:e=>!je()&&ye(e.target.value),options:[{value:"",label:"--Seleccione un condominio--"},...fe.map(e=>({value:e.value.toString(),label:e.label}))],icon:Building,required:!0,disabled:je()||-1===z||0===V.length,hasError:j&&!!f.condoId,errorMessage:f.condoId}),jsxRuntimeExports.jsx(InputUI,{id:"firstName-create",type:"text",label:"Nombre *",value:P.firstName||"",onChange:e=>pe({target:{name:"firstName",value:e}}),required:!0,icon:User,hasError:j&&!!f.firstName,errorMessage:f.firstName}),jsxRuntimeExports.jsx(InputUI,{id:"lastName-create",type:"text",label:"Apellido Paterno *",value:P.lastName||"",onChange:e=>pe({target:{name:"lastName",value:e}}),required:!0,icon:User,hasError:j&&!!f.lastName,errorMessage:f.lastName}),jsxRuntimeExports.jsx(InputUI,{id:"secondLastName-create",type:"text",label:"Apellido Materno",value:P.secondLastName||"",onChange:e=>pe({target:{name:"secondLastName",value:e}}),icon:User}),jsxRuntimeExports.jsx(InputUI,{id:"email-create",type:"email",label:"Email *",value:P.email||"",onChange:e=>pe({target:{name:"email",value:e}}),required:!0,icon:Mail,hasError:j&&!!f.email,errorMessage:f.email}),jsxRuntimeExports.jsx(InputUI,{id:"contactNumber-create",type:"text",label:"Teléfono",value:P.contactNumber||"",onChange:e=>pe({target:{name:"contactNumber",value:e}}),icon:Phone}),jsxRuntimeExports.jsx(InputUI,{id:"address-create",type:"text",label:"Dirección",value:P.address||"",onChange:e=>pe({target:{name:"address",value:e}}),icon:MapPin}),jsxRuntimeExports.jsx(DatepickerUI,{id:"dateOfBirth-create",label:"Fecha de Nacimiento",value:P.dateOfBirth||null,onChange:e=>xe("dateOfBirth",e),type:"date",formatString:"yyyy-MM-dd",placeholder:"DD/MM/AAAA",icon:Calendar}),jsxRuntimeExports.jsx(SelectUI,{id:"genderId-create",label:"Género",value:(null==(Ne=P.genderId)?void 0:Ne.toString())||"",onChange:e=>he("genderId",e.target.value),options:[{value:"1",label:"Masculino"},{value:"2",label:"Femenino"},{value:"3",label:"Otro"}],icon:Users}),jsxRuntimeExports.jsx(SelectUI,{id:"documentTypeId-create",label:"Tipo de Documento *",value:(null==(Ce=P.documentTypeId)?void 0:Ce.toString())||"",onChange:e=>he("documentTypeId",e.target.value),options:[{value:"",label:"--Seleccione un tipo de documento--"},...U.map(e=>({value:e.documentTypeId.toString(),label:e.documentName||""}))],icon:FileText,required:!0,hasError:j&&!!f.documentTypeId,errorMessage:f.documentTypeId}),jsxRuntimeExports.jsx(InputUI,{id:"documentNumber-create",type:"text",label:"Número de Documento *",value:P.documentNumber||"",onChange:e=>pe({target:{name:"documentNumber",value:e}}),icon:FileText,required:!0,hasError:j&&!!f.documentNumber,errorMessage:f.documentNumber}),jsxRuntimeExports.jsx(SelectUI,{id:"profileTypeId-create",label:"Perfil *",value:(null==(Te=P.profileTypeId)?void 0:Te.toString())||"",onChange:e=>he("profileTypeId",e.target.value),options:[{value:"",label:"--Seleccione un perfil--"},...M.map(e=>({value:e.profileTypeId.toString(),label:e.profileName}))],required:!0,icon:Briefcase,hasError:j&&!!f.profileTypeId,errorMessage:f.profileTypeId}),jsxRuntimeExports.jsx(InputUI,{id:"username-create",type:"text",label:"Usuario *",value:P.username||"",onChange:e=>pe({target:{name:"username",value:e}}),required:!0,icon:UserCheck,hasError:j&&!!f.username,errorMessage:f.username}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsxs("label",{htmlFor:"password-create",className:"block text-sm font-medium text-gray-700 mb-1",children:["Contraseña * ",j&&f.password&&jsxRuntimeExports.jsxs("span",{className:"text-warning font-medium",children:[" - ",f.password]})]}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx(Lock,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 "+(j&&f.password?"text-warning":"text-gray-400")}),jsxRuntimeExports.jsx("input",{id:"password-create",name:"password",type:Y?"text":"password",required:!0,className:`pl-10 w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 transition-all duration-200 ${j&&f.password?"border-warning focus:ring-warning/20 focus:border-warning bg-red-50":"border-gray-300 focus:ring-primary focus:border-primary hover:border-primary"} placeholder-gray-500 text-gray-900`,placeholder:"Contraseña",value:P.password||"",onChange:e=>pe(e)}),jsxRuntimeExports.jsx("button",{type:"button",onClick:Ie,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 focus:outline-none",children:Y?jsxRuntimeExports.jsx(EyeOff,{size:20}):jsxRuntimeExports.jsx(Eye,{size:20})})]})]}),jsxRuntimeExports.jsx(SelectUI,{id:"statusTypeId-create",label:"Estado *",value:(null==(De=P.statusTypeId)?void 0:De.toString())||"1",onChange:e=>he("statusTypeId",e.target.value),options:[{value:"",label:"--Seleccione un estado--"},...O.map(e=>({value:e.statusTypeId.toString(),label:e.statusName}))],required:!0,icon:CheckCircle,hasError:j&&!!f.statusTypeId,errorMessage:f.statusTypeId})]})]})}),jsxRuntimeExports.jsx(ModalUI,{isOpen:o,onClose:me,title:se?"Editar Usuario":"Editar Residente",footer:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ButtonUI,{title:"Cancelar",icon:X$1,onClick:me,theme:"delete"}),jsxRuntimeExports.jsx(ButtonUI,{title:"Guardar",icon:Save,onClick:()=>__async(this,null,function*(){try{if(!c)return void Z("error","No se ha seleccionado ningún usuario para editar");if(R(!0),w(e=>__spreadProps(__spreadValues({},e),{companyId:-1===z?void 0:z,condoId:-1===G?void 0:G})),!Se(!0))return void Z("error","Por favor corrija los errores en el formulario");const e={userId:c.userId,firstName:P.firstName||"",lastName:P.lastName||"",secondLastName:P.secondLastName||null,email:P.email||"",contactNumber:P.contactNumber||null,address:P.address||null,dateOfBirth:P.dateOfBirth||null,genderId:P.genderId||null,documentTypeId:P.documentTypeId||null,documentNumber:P.documentNumber||null,profileTypeId:Number(P.profileTypeId),companyId:P.companyId||null,condoId:P.condoId||null,username:P.username||null,password:P.password||null,statusTypeId:Number(P.statusTypeId||1),profilePicture:P.profilePicture||null,isInternalUser:void 0!==P.isInternalUser?P.isInternalUser:se},t=c.userId,a=yield ee.update(t,e);a.isSuccess?(Z("success","Usuario actualizado exitosamente"),me(),de()):Z("error",a.error||"Error al actualizar usuario")}catch(e){Z("error","Error al actualizar usuario")}}),theme:"modalSave"})]}),children:(()=>{var e,t,a,r;return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center mb-6",children:[jsxRuntimeExports.jsx(ProfilePictureUpload,{value:P.profilePicture||null,onChange:Re,size:"lg"}),P.profilePicture&&jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>Re(null),className:"mt-2 text-sm text-red-600 hover:text-red-800",children:"Eliminar foto de perfil"})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(SelectUI,{id:"companyId-edit",label:"Empresa *",value:-1===z?"":z.toString(),onChange:e=>!je()&&ge(e.target.value),options:[{value:"",label:"--Seleccione una empresa--"},...Ee.map(e=>({value:e.value.toString(),label:e.label}))],icon:Building,required:!0,disabled:je(),hasError:j&&!!f.companyId,errorMessage:f.companyId}),jsxRuntimeExports.jsx(SelectUI,{id:"condoId-edit",label:"Condominio *",value:-1===G?"":G.toString(),onChange:e=>!je()&&ye(e.target.value),options:[{value:"",label:"--Seleccione un condominio--"},...fe.map(e=>({value:e.value.toString(),label:e.label}))],icon:Building,required:!0,disabled:je()||-1===z||0===V.length,hasError:j&&!!f.condoId,errorMessage:f.condoId}),jsxRuntimeExports.jsx(InputUI,{id:"firstName-edit",type:"text",label:"Nombre *",value:P.firstName||"",onChange:e=>pe({target:{name:"firstName",value:e}}),required:!0,icon:User,hasError:j&&!!f.firstName,errorMessage:f.firstName}),jsxRuntimeExports.jsx(InputUI,{id:"lastName-edit",type:"text",label:"Apellido Paterno *",value:P.lastName||"",onChange:e=>pe({target:{name:"lastName",value:e}}),required:!0,icon:User,hasError:j&&!!f.lastName,errorMessage:f.lastName}),jsxRuntimeExports.jsx(InputUI,{id:"secondLastName-edit",type:"text",label:"Apellido Materno",value:P.secondLastName||"",onChange:e=>pe({target:{name:"secondLastName",value:e}}),icon:User}),jsxRuntimeExports.jsx(InputUI,{id:"email-edit",type:"email",label:"Email *",value:P.email||"",onChange:e=>pe({target:{name:"email",value:e}}),required:!0,icon:Mail,hasError:j&&!!f.email,errorMessage:f.email}),jsxRuntimeExports.jsx(InputUI,{id:"contactNumber-edit",type:"text",label:"Teléfono",value:P.contactNumber||"",onChange:e=>pe({target:{name:"contactNumber",value:e}}),icon:Phone}),jsxRuntimeExports.jsx(InputUI,{id:"address-edit",type:"text",label:"Dirección",value:P.address||"",onChange:e=>pe({target:{name:"address",value:e}}),icon:MapPin}),jsxRuntimeExports.jsx(DatepickerUI,{id:"dateOfBirth-edit",label:"Fecha de Nacimiento",value:P.dateOfBirth||null,onChange:e=>xe("dateOfBirth",e),type:"date",formatString:"yyyy-MM-dd",placeholder:"DD-MM-AAAA",icon:Calendar}),jsxRuntimeExports.jsx(SelectUI,{id:"genderId-edit",label:"Género",value:(null==(e=P.genderId)?void 0:e.toString())||"",onChange:e=>he("genderId",e.target.value),options:[{value:"1",label:"Masculino"},{value:"2",label:"Femenino"},{value:"3",label:"Otro"}],icon:Users}),jsxRuntimeExports.jsx(SelectUI,{id:"documentTypeId-edit",label:"Tipo de Documento *",value:(null==(t=P.documentTypeId)?void 0:t.toString())||"",onChange:e=>he("documentTypeId",e.target.value),options:[{value:"",label:"--Seleccione un tipo de documento--"},...U.map(e=>({value:e.documentTypeId.toString(),label:e.documentName||""}))],icon:FileText,required:!0,hasError:j&&!!f.documentTypeId,errorMessage:f.documentTypeId}),jsxRuntimeExports.jsx(InputUI,{id:"documentNumber-edit",type:"text",label:"Número de Documento *",value:P.documentNumber||"",onChange:e=>pe({target:{name:"documentNumber",value:e}}),icon:FileText,required:!0,hasError:j&&!!f.documentNumber,errorMessage:f.documentNumber}),jsxRuntimeExports.jsx(SelectUI,{id:"profileTypeId-edit",label:"Perfil *",value:(null==(a=P.profileTypeId)?void 0:a.toString())||"",onChange:e=>he("profileTypeId",e.target.value),options:M.map(e=>({value:e.profileTypeId.toString(),label:e.profileName})),required:!0,icon:Briefcase,hasError:j&&!!f.profileTypeId,errorMessage:f.profileTypeId}),jsxRuntimeExports.jsx(InputUI,{id:"username-edit",type:"text",label:"Usuario",value:P.username||"",onChange:e=>pe({target:{name:"username",value:e}}),placeholder:"Dejar en blanco para mantener actual",icon:UserCheck}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("label",{htmlFor:"password-edit",className:"block text-sm font-medium text-gray-700 mb-1",children:"Contraseña"}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx(Lock,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),jsxRuntimeExports.jsx("input",{id:"password-edit",name:"password",type:Y?"text":"password",className:"pl-10 w-full px-4 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-200",placeholder:"Dejar en blanco para mantener actual",value:P.password||"",onChange:e=>pe(e)}),jsxRuntimeExports.jsx("button",{type:"button",onClick:Ie,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 focus:outline-none",children:Y?jsxRuntimeExports.jsx(EyeOff,{size:20}):jsxRuntimeExports.jsx(Eye,{size:20})})]})]}),jsxRuntimeExports.jsx(SelectUI,{id:"statusTypeId-edit",label:"Estado *",value:(null==(r=P.statusTypeId)?void 0:r.toString())||"1",onChange:e=>he("statusTypeId",e.target.value),options:[{value:"",label:"--Seleccione un estado--"},...O.map(e=>({value:e.statusTypeId.toString(),label:e.statusName}))],required:!0,icon:CheckCircle,hasError:j&&!!f.statusTypeId,errorMessage:f.statusTypeId})]})]})})()})]});var Ne,Ce,Te,De}function SystemUserList(){return jsxRuntimeExports.jsx(AlertProvider,{children:jsxRuntimeExports.jsx(SystemUserListContent,{})})}class ExpenseTypeService extends ApiBaseService{constructor(){super("/ExpenseType")}getExpenseTypeById(e){return __async(this,null,function*(){return __superGet(ExpenseTypeService.prototype,this,"getById").call(this,e)})}getPagedExpenseTypes(e){return __async(this,null,function*(){const t=e?__spreadProps(__spreadValues({},e),{Name:e.Name||void 0,Description:e.Description||void 0}):void 0;return __superGet(ExpenseTypeService.prototype,this,"getPaged").call(this,"paged",t)})}create(e){return __async(this,null,function*(){return this.post("",e)})}update(e,t){return __async(this,null,function*(){return this.put(`/${e}`,t)})}deleteExpenseType(e){return __async(this,null,function*(){return __superGet(ExpenseTypeService.prototype,this,"deleteById").call(this,e)})}searchByName(e,t=1,a=10){return __async(this,null,function*(){const r={Page:t,PageSize:a,Name:e};return this.getPagedExpenseTypes(r)})}searchByDescription(e,t=1,a=10){return __async(this,null,function*(){const r={Page:t,PageSize:a,Description:e};return this.getPagedExpenseTypes(r)})}getActiveTypes(e=1,t=10){return __async(this,null,function*(){const a={Page:e,PageSize:t};return this.getPaged("active",a)})}}const EXPENSE_CATEGORIES=[{value:1,label:"Mantenimiento"},{value:2,label:"Servicios Públicos"},{value:3,label:"Administración"},{value:4,label:"Reparaciones"},{value:5,label:"Otros"}];function ExpenseTypesTab(){const{setLoading:e}=useLoading(),[t,a]=reactExports.useState([]),[r,s]=reactExports.useState(""),[n,i]=reactExports.useState(!1),[o,l]=reactExports.useState(!1),[c,d]=reactExports.useState(1),[u,m]=reactExports.useState(10),[p,x]=reactExports.useState(0),[h,g]=reactExports.useState(null),[y,v]=reactExports.useState({name:"",description:""}),[E,f]=reactExports.useState(!1),b=reactExports.useRef(null),j=new ExpenseTypeService;reactExports.useEffect(()=>((()=>{__async(this,null,function*(){try{yield R(),f(!0)}catch(e){}})})(),()=>{b.current&&(clearTimeout(b.current),b.current=null),e(!1)}),[]),reactExports.useEffect(()=>{E&&R()},[c,u,E]),reactExports.useEffect(()=>{if(!E)return;const e=setTimeout(()=>{d(1),R()},300);return()=>clearTimeout(e)},[r,E]),reactExports.useEffect(()=>{t.length},[t]);const R=()=>__async(this,null,function*(){if(n)return;Date.now();try{i(!0),e(!0),b.current=setTimeout(()=>{i(!1),e(!1)},3e4);const t=yield j.getPaged({Page:c||1,PageSize:u||10,Name:r||void 0});if(t.isSuccess&&t.data)if(t.data.items)a(t.data.items.map(e=>({expenseTypeId:e.expenseTypeId,name:e.name,description:e.description}))),x(t.data.totalCount||0);else{let e=[];if(Array.isArray(t.data))e=t.data;else if("object"==typeof t.data&&null!==t.data){const a=Object.values(t.data).find(e=>Array.isArray(e));a&&(e=a)}e.length>0?(a(e.map(e=>({expenseTypeId:e.expenseTypeId,name:e.name,description:e.description}))),x(e.length)):(a([]),x(0))}else a([]),x(0)}catch(t){a([]),x(0)}finally{b.current&&(clearTimeout(b.current),b.current=null),i(!1),e(!1)}}),I=e=>__async(this,null,function*(){if(window.confirm("¿Está seguro que desea eliminar este tipo de gasto?"))try{(yield j.delete(e)).isSuccess&&R()}catch(t){}}),S=()=>{g(null),v({name:"",description:""}),l(!1)};return jsxRuntimeExports.jsxs("div",{className:"h-full flex flex-col overflow-hidden",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-4 mb-6 flex-shrink-0",children:[jsxRuntimeExports.jsx("div",{className:"w-full md:w-1/3",children:jsxRuntimeExports.jsx(InputUI,{id:"search-expense-type",label:"Buscar tipo de gasto",icon:Search,value:r,onChange:s,placeholder:"Buscar por nombre..."})}),jsxRuntimeExports.jsx("div",{className:"flex justify-end",children:jsxRuntimeExports.jsx(ButtonUI,{icon:PlusCircle,title:"Nuevo Tipo de Gasto",onClick:()=>l(!0),borderColor:"#629E3E",textColor:"white",className:"bg-primary"})})]}),o&&jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 mb-6 shadow-sm flex-shrink-0",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold mb-4",children:h?"Editar Tipo de Gasto":"Nuevo Tipo de Gasto"}),jsxRuntimeExports.jsxs("form",{onSubmit:e=>__async(this,null,function*(){e.preventDefault();try{let e;if(h){const t=__spreadProps(__spreadValues({},y),{expenseTypeId:h.expenseTypeId,routeId:h.expenseTypeId});e=yield j.update(h.expenseTypeId,t)}else e=yield j.create(y);e.isSuccess&&(S(),R())}catch(t){}}),className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[jsxRuntimeExports.jsx(InputUI,{id:"expense-type-name",label:"Nombre del Tipo de Gasto",value:y.name||"",onChange:e=>v(__spreadProps(__spreadValues({},y),{name:e})),placeholder:"Ej: Mantenimiento Ascensores",required:!0,maxLength:50}),jsxRuntimeExports.jsx(SelectUI$1,{id:"expense-type-category",label:"Categoría",options:EXPENSE_CATEGORIES,value:1,onChange:e=>{}}),jsxRuntimeExports.jsx("div",{className:"md:col-span-2",children:jsxRuntimeExports.jsx(TextAreaUI,{id:"expense-type-description",label:"Descripción",value:y.description||"",onChange:e=>v(__spreadProps(__spreadValues({},y),{description:e})),placeholder:"Breve descripción del tipo de gasto...",rows:3,maxLength:200})}),jsxRuntimeExports.jsxs("div",{className:"md:col-span-2 flex justify-end gap-3 mt-4",children:[jsxRuntimeExports.jsx(ButtonUI,{title:"Cancelar",onClick:S,theme:"cancel"}),jsxRuntimeExports.jsx(ButtonUI,{title:"Guardar",type:"submit",borderColor:"#629E3E",textColor:"white",className:"bg-primary"})]})]})]}),n&&jsxRuntimeExports.jsx("div",{className:"flex justify-center py-4 flex-shrink-0",children:jsxRuntimeExports.jsx("p",{children:"Cargando datos..."})}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-auto min-h-0",children:jsxRuntimeExports.jsx(DataGrid,{data:t,columns:[{accessorKey:"name",header:"Nombre"},{accessorKey:"description",header:"Descripción"}],initialPage:c,initialPageSize:u,totalRecords:p,onPageChange:e=>d(e),onPageSizeChange:e=>m(e),actions:[{icon:Pencil,label:"Editar",onClick:e=>{g(e),v({name:e.name||"",description:e.description||""}),l(!0)}},{icon:Trash2,label:"Eliminar",onClick:e=>I(e.expenseTypeId)}]})})]})}function ExpensesTab(){const{setLoading:e}=useLoading(),[t,a]=reactExports.useState([]),[r,s]=reactExports.useState([]),[n,i]=reactExports.useState([]),[o,l]=reactExports.useState(!1),[c,d]=reactExports.useState(1),[u,m]=reactExports.useState(10),[p,x]=reactExports.useState(0),[h,g]=reactExports.useState(""),[y,v]=reactExports.useState(!1),[E,f]=reactExports.useState(null),[b,j]=reactExports.useState(!1),[R,I]=reactExports.useState(""),[S,_]=reactExports.useState(""),[N,C]=reactExports.useState({condoId:0,description:"",amount:0,dateIncurred:(new Date).toISOString(),expenseTypeId:0}),T=new ExpenseService,D=new ExpenseTypeService,A=new CondominiumService,P=[{accessorKey:"dateIncurred",header:"Fecha",cell:({row:e})=>format(new Date(e.original.dateIncurred),"dd/MM/yyyy",{locale:es})},{accessorKey:"condoName",header:"Condominio",cell:({row:e})=>{if(e.original.condoName)return e.original.condoName;const t=n.find(t=>t.condoId===e.original.condoId);return(null==t?void 0:t.name)||"No especificado"}},{accessorKey:"expenseTypeId",header:"Tipo de Gasto",cell:({row:e})=>{if(e.original.expenseTypeName)return e.original.expenseTypeName;const t=r.find(t=>t.expenseTypeId===e.original.expenseTypeId);return(null==t?void 0:t.name)||"No especificado"}},{accessorKey:"description",header:"Descripción"},{accessorKey:"amount",header:"Monto",cell:({row:e})=>`S/.${e.original.amount.toLocaleString("es-ES",{minimumFractionDigits:2})}`}];reactExports.useEffect(()=>{(()=>{__async(this,null,function*(){try{yield M(),yield w(),yield O(),j(!0)}catch(e){j(!0)}})})()},[]),reactExports.useEffect(()=>{b&&k()},[b,c,u,h,R,S]);const w=()=>__async(this,null,function*(){try{const e=yield A.getPaged({PageSize:100});if(e.isSuccess&&e.data){let t=[];if(e.data.items)t=e.data.items||[];else{const a=e.data.data&&Array.isArray(e.data.data)?e.data.data:Array.isArray(e.data)?e.data:[];t=a}i(t),t.length>0&&0===N.condoId&&C(e=>__spreadProps(__spreadValues({},e),{condoId:t[0].condoId}))}}catch(e){}}),M=()=>__async(this,null,function*(){try{const e=yield D.getPaged({PageSize:100});if(e.isSuccess&&e.data){let t=[];if(e.data.items)t=e.data.items||[];else{const a=e.data.data&&Array.isArray(e.data.data)?e.data.data:Array.isArray(e.data)?e.data:[];t=a}s(t),t.length>0&&0===N.expenseTypeId&&C(e=>__spreadProps(__spreadValues({},e),{expenseTypeId:t[0].expenseTypeId}))}}catch(e){}}),k=()=>__async(this,null,function*(){l(!0),e(!0);try{const e=yield T.getPaged({Page:c,PageSize:u,Description:h||void 0,ExpenseTypeId:R?Number(R):void 0,CondoId:S?Number(S):void 0});if(e.isSuccess&&e.data)if(e.data.data&&Array.isArray(e.data.data)){const t=e.data.data;if(a(t),e.data.metadata){const a=e.data.metadata.totalRecords||t.length;x(a)}else x(t.length)}else e.data.items?(a(e.data.items),x(e.data.totalCount||0)):Array.isArray(e.data)?(a(e.data),x(e.data.length)):(a([]),x(0));else a([]),x(0)}catch(t){a([]),x(0)}finally{l(!1),e(!1)}}),O=()=>__async(this,null,function*(){try{yield preloadCompanyCondoFilters(()=>{},(e,t)=>__async(this,null,function*(){"condoId"===e&&"number"==typeof t&&-1!==t&&_(t)}),()=>__async(this,null,function*(){}),"ExpensesTab-Filters")}catch(e){}}),$=()=>__async(this,null,function*(){try{const{condoId:e,shouldPreload:t}=getCompanyCondoFromLocalStorage();if(t&&e){n.find(t=>t.condoId===e)&&C(t=>__spreadProps(__spreadValues({},t),{condoId:e}))}}catch(e){}}),U=e=>__async(this,null,function*(){if(window.confirm("¿Está seguro que desea eliminar este gasto?"))try{(yield T.delete(e)).isSuccess&&k()}catch(t){}}),L=()=>{f(null),C({condoId:n.length>0?n[0].condoId:0,description:"",amount:0,dateIncurred:(new Date).toISOString(),expenseTypeId:r.length>0?r[0].expenseTypeId:0}),v(!1)},B=(e,t)=>{let a=t;"condoId"===e||"expenseTypeId"===e||"amount"===e?a=Number(t):"dateIncurred"===e&&(a=t instanceof Date?t.toISOString():t),C(t=>__spreadProps(__spreadValues({},t),{[e]:a}))},F=r.map(e=>({value:e.expenseTypeId,label:e.name||"Sin nombre"})),V=n.map(e=>({value:e.condoId,label:e.name})),W=[{value:"",label:"Todos los tipos"},...F],z=[{value:"",label:"Todos los condominios"},...V],H=V.length>0,G=F.length>0,q=H&&G;return jsxRuntimeExports.jsxs("div",{className:"h-full flex flex-col overflow-hidden",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col space-y-6 mb-6 flex-shrink-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-4",children:[jsxRuntimeExports.jsx("div",{className:"w-full md:w-1/3",children:jsxRuntimeExports.jsx(InputUI,{id:"search-expense",label:"Buscar gasto",icon:Search,value:h,onChange:g,placeholder:"Buscar por descripción..."})}),jsxRuntimeExports.jsx("div",{className:"flex justify-end",children:jsxRuntimeExports.jsx(ButtonUI,{icon:PlusCircle,title:"Nuevo Gasto",onClick:()=>__async(this,null,function*(){v(!0),setTimeout(()=>__async(this,null,function*(){yield $()}),100)}),borderColor:"#629E3E",textColor:"white",className:"bg-primary",disabled:!q})})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[jsxRuntimeExports.jsx(SelectUI$1,{id:"filter-condominium",label:"Condominio",options:z,value:S,onChange:_,icon:Building}),jsxRuntimeExports.jsx(SelectUI$1,{id:"filter-expense-type",label:"Tipo de Gasto",options:W,value:R,onChange:I,icon:Tag})]})]}),y&&jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 mb-6 shadow-sm flex-shrink-0",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold mb-4",children:E?"Editar Gasto":"Nuevo Gasto"}),jsxRuntimeExports.jsxs("form",{onSubmit:e=>__async(this,null,function*(){e.preventDefault();try{let e;if(E){const t={expenseId:E.expenseId,condoId:N.condoId,description:N.description||"",amount:N.amount,dateIncurred:N.dateIncurred,expenseTypeId:N.expenseTypeId,routeId:E.expenseId};e=yield T.update(E.expenseId,t)}else{if(!N.condoId||!N.expenseTypeId||!N.dateIncurred||void 0===N.amount)return void alert("Por favor complete todos los campos obligatorios");const t={condoId:Number(N.condoId),description:N.description||"",amount:Number(N.amount),dateIncurred:N.dateIncurred,expenseTypeId:Number(N.expenseTypeId)};e=yield T.create(t)}e.isSuccess?(L(),k()):alert(`Error: ${e.error||"No se pudo guardar el gasto"}`)}catch(t){alert("Ocurrió un error al guardar el gasto")}}),className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[jsxRuntimeExports.jsx(SelectUI$1,{id:"expense-condo",label:"Condominio",icon:Building,options:V,value:N.condoId||(n.length>0?n[0].condoId:0),onChange:e=>B("condoId",e),required:!0,disabled:null!==E||shouldDisableCompanyCondoSelects()}),jsxRuntimeExports.jsx(SelectUI$1,{id:"expense-type",label:"Tipo de Gasto",icon:Tag,options:F,value:N.expenseTypeId||(r.length>0?r[0].expenseTypeId:0),onChange:e=>B("expenseTypeId",e),required:!0}),jsxRuntimeExports.jsx(DatepickerUI,{id:"expense-date",label:"Fecha del Gasto",icon:Calendar,value:N.dateIncurred||(new Date).toISOString(),onChange:e=>B("dateIncurred",e),required:!0}),jsxRuntimeExports.jsx(InputUI,{id:"expense-amount",label:"Monto",icon:DollarSign,type:"number",value:"number"==typeof N.amount?N.amount.toString():"0",onChange:e=>B("amount",e),placeholder:"Monto del gasto",required:!0}),jsxRuntimeExports.jsx("div",{className:"md:col-span-2",children:jsxRuntimeExports.jsx(TextAreaUI,{id:"expense-description",label:"Descripción",value:N.description||"",onChange:e=>B("description",e),placeholder:"Descripción detallada del gasto...",rows:3,maxLength:200})}),jsxRuntimeExports.jsxs("div",{className:"md:col-span-2 flex justify-end gap-3 mt-4",children:[jsxRuntimeExports.jsx(ButtonUI,{title:"Cancelar",onClick:L,theme:"cancel"}),jsxRuntimeExports.jsx(ButtonUI,{title:"Guardar",type:"submit",borderColor:"#629E3E",textColor:"white",className:"bg-primary"})]})]})]}),o&&jsxRuntimeExports.jsx("div",{className:"flex justify-center py-4 flex-shrink-0",children:jsxRuntimeExports.jsx("p",{children:"Cargando datos..."})}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-auto min-h-0",children:jsxRuntimeExports.jsx(DataGrid,{data:t,columns:P,initialPage:c,initialPageSize:u,totalRecords:p,onPageChange:e=>d(e),onPageSizeChange:e=>m(e),actions:[{icon:Pencil,label:"Editar",onClick:e=>{f(e),C({condoId:e.condoId,description:e.description,amount:e.amount,dateIncurred:e.dateIncurred,expenseTypeId:e.expenseTypeId}),v(!0)}},{icon:Trash2,label:"Eliminar",onClick:e=>U(e.expenseId)}]})})]})}class FeeTypeService extends ApiBaseService{constructor(){super("/FeeType")}getFeeTypeById(e){return __async(this,null,function*(){return __superGet(FeeTypeService.prototype,this,"getById").call(this,e)})}getPagedFeeTypes(e){return __async(this,null,function*(){const t=e?__spreadProps(__spreadValues({},e),{FeeName:e.FeeName||void 0,CalculationType:e.CalculationType||void 0,ApplicationLevel:e.ApplicationLevel||void 0}):void 0;return __superGet(FeeTypeService.prototype,this,"getPaged").call(this,"paged",t)})}create(e){return __async(this,null,function*(){return this.post("",e)})}update(e,t){return __async(this,null,function*(){return this.put(`/${e}`,t)})}deleteFeeType(e){return __async(this,null,function*(){return __superGet(FeeTypeService.prototype,this,"deleteById").call(this,e)})}getByCalculationType(e,t=1,a=10){return __async(this,null,function*(){const r={Page:t,PageSize:a,CalculationType:e};return this.getPagedFeeTypes(r)})}getRecurringTypes(e=1,t=10){return __async(this,null,function*(){const a={Page:e,PageSize:t,IsRecurring:!0};return this.getPaged("recurring",a)})}searchByName(e,t=1,a=10){return __async(this,null,function*(){const r={Page:t,PageSize:a,FeeName:e};return this.getPagedFeeTypes(r)})}getByApplicationLevel(e,t=1,a=10){return __async(this,null,function*(){const r={Page:t,PageSize:a,ApplicationLevel:e};return this.getPagedFeeTypes(r)})}}const CALCULATION_TYPES=[{value:"fixed",label:"Monto Fijo"},{value:"consumption",label:"Por Consumo"},{value:"formula",label:"Fórmula Personalizada"}];function FeeTypesTab(){var _a;const{setLoading:setLoading}=useLoading(),[feeTypes,setFeeTypes]=reactExports.useState([]),[expenseTypes,setExpenseTypes]=reactExports.useState([]),[searchTerm,setSearchTerm]=reactExports.useState(""),[showForm,setShowForm]=reactExports.useState(!1),[editingFeeType,setEditingFeeType]=reactExports.useState(null),[isFormulaPreviewVisible,setIsFormulaPreviewVisible]=reactExports.useState(!1),[formulaPreviewResult,setFormulaPreviewResult]=reactExports.useState(0),[currentPage,setCurrentPage]=reactExports.useState(1),[pageSize,setPageSize]=reactExports.useState(10),[totalRecords,setTotalRecords]=reactExports.useState(0),[isLoadingData,setIsLoadingData]=reactExports.useState(!1),[formData,setFormData]=reactExports.useState({feeName:"",description:"",calculationType:"fixed",formulaExpression:"",isProportional:!1,isRecurring:!0,actualAmount:0,applicableExpenseTypes:""}),expenseTypeService=new ExpenseTypeService,feeTypeService=new FeeTypeService;reactExports.useEffect(()=>{fetchExpenseTypes(),fetchFeeTypes()},[]),reactExports.useEffect(()=>{fetchFeeTypes()},[currentPage,pageSize,searchTerm]);const fetchExpenseTypes=()=>__async(this,null,function*(){try{const e=yield expenseTypeService.getPaged({PageSize:100});if(e.isSuccess&&e.data)if(e.data.items)setExpenseTypes(e.data.items||[]);else{const t=e.data.data&&Array.isArray(e.data.data)?e.data.data:Array.isArray(e.data)?e.data:[];setExpenseTypes(t)}}catch(e){}}),fetchFeeTypes=()=>__async(this,null,function*(){setIsLoadingData(!0),setLoading(!0);try{const e=yield feeTypeService.getPagedList({Page:currentPage,PageSize:pageSize,FeeName:searchTerm||void 0});if(e.isSuccess&&e.data)if(e.data.data&&Array.isArray(e.data.data)){const t=e.data.data,a=t.map(e=>{var t;return __spreadProps(__spreadValues({},e),{calculationType:(null==(t=e.calculationType)?void 0:t.toLowerCase())||""})});if(setFeeTypes(a),e.data.metadata){const a=e.data.metadata.totalRecords||t.length;setTotalRecords(a)}else setTotalRecords(t.length)}else if(e.data.items){const t=e.data.items.map(e=>{var t;return __spreadProps(__spreadValues({},e),{calculationType:(null==(t=e.calculationType)?void 0:t.toLowerCase())||""})});setFeeTypes(t),setTotalRecords(e.data.totalCount||0)}else if(Array.isArray(e.data)){const t=e.data.map(e=>{var t;return __spreadProps(__spreadValues({},e),{calculationType:(null==(t=e.calculationType)?void 0:t.toLowerCase())||""})});setFeeTypes(t),setTotalRecords(e.data.length)}else setFeeTypes([]),setTotalRecords(0);else setFeeTypes([]),setTotalRecords(0)}catch(e){setFeeTypes([]),setTotalRecords(0)}finally{setIsLoadingData(!1),setLoading(!1)}}),columns=[{accessorKey:"feeName",header:"Nombre"},{accessorKey:"calculationType",header:"Tipo de Cálculo",cell:({row:e})=>{var t;const a=(null==(t=e.original.calculationType)?void 0:t.toLowerCase())||"";return"fixed"===a?"Monto Fijo":"consumption"===a?"Por Consumo":"Fórmula"}},{accessorKey:"actualAmount",header:"Monto",cell:({row:e})=>{var t;return"fixed"===((null==(t=e.original.calculationType)?void 0:t.toLowerCase())||"")&&e.original.actualAmount?`S/.${e.original.actualAmount.toLocaleString("es-ES",{minimumFractionDigits:2})}`:e.original.formulaExpression?e.original.formulaExpression:"-"}},{accessorKey:"isRecurring",header:"Recurrente",cell:({row:e})=>e.original.isRecurring?"Sí":"No"}],handleEdit=e=>{setEditingFeeType(e),setFormData(__spreadValues({},e)),setShowForm(!0)},handleDelete=e=>__async(this,null,function*(){if(window.confirm("¿Está seguro que desea eliminar este tipo de cargo?"))try{(yield feeTypeService.deleteById(e)).isSuccess&&fetchFeeTypes()}catch(t){}}),handleFormChange=(e,t)=>{setFormData(a=>__spreadProps(__spreadValues({},a),{[e]:t})),"calculationType"===e&&"formula"!==t&&(setFormulaPreviewResult(0),setIsFormulaPreviewVisible(!1))},handleFormulaPreview=()=>{if(formData.formulaExpression){let result=0;try{const formula=formData.formulaExpression.replace(/\[Total_Gastos\]/g,"1000").replace(/\[Metros_Cuadrados\]/g,"100").replace(/\[consumption\]/g,"50").replace(/\[amount\]/g,"3.125").replace(/\[CONSUMPTION\]/g,"50").replace(/\[AMOUNT\]/g,"10");result=eval(formula),setFormulaPreviewResult(result),setIsFormulaPreviewVisible(!0)}catch(error){alert(`Error al evaluar la fórmula: ${error instanceof Error?error.message:"Error desconocido"}`),setFormulaPreviewResult(0)}}},handleSubmit=e=>__async(this,null,function*(){e.preventDefault();try{let e;if(editingFeeType){const t=__spreadProps(__spreadValues({},formData),{feeTypeId:editingFeeType.feeTypeId,routeId:editingFeeType.feeTypeId});e=yield feeTypeService.update(editingFeeType.feeTypeId,t)}else e=yield feeTypeService.create(formData);e.isSuccess&&(resetForm(),fetchFeeTypes())}catch(t){}}),resetForm=()=>{setEditingFeeType(null),setFormData({feeName:"",description:"",calculationType:"fixed",formulaExpression:"",isProportional:!1,isRecurring:!0,actualAmount:0,applicableExpenseTypes:""}),setShowForm(!1),setIsFormulaPreviewVisible(!1)};return jsxRuntimeExports.jsxs("div",{className:"h-full flex flex-col overflow-hidden",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-4 mb-6 flex-shrink-0",children:[jsxRuntimeExports.jsx("div",{className:"w-full md:w-1/3",children:jsxRuntimeExports.jsx(InputUI,{id:"search-fee-type",label:"Buscar tipo de cargo",icon:Search,value:searchTerm,onChange:setSearchTerm,placeholder:"Buscar por nombre..."})}),jsxRuntimeExports.jsx("div",{className:"flex justify-end",children:jsxRuntimeExports.jsx(ButtonUI,{icon:PlusCircle,title:"Nuevo Tipo de Cargo",onClick:()=>setShowForm(!0),borderColor:"#629E3E",textColor:"white",className:"bg-primary"})})]}),showForm&&jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 mb-6 shadow-sm flex-shrink-0",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold mb-4",children:editingFeeType?"Editar Tipo de Cargo":"Nuevo Tipo de Cargo"}),jsxRuntimeExports.jsxs("form",{onSubmit:handleSubmit,className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[jsxRuntimeExports.jsx(InputUI,{id:"fee-type-name",label:"Nombre del Cargo",value:formData.feeName||"",onChange:e=>handleFormChange("feeName",e),placeholder:"Ej: Cuota de Mantenimiento",required:!0,maxLength:50}),jsxRuntimeExports.jsx(SelectUI$1,{id:"fee-calculation-type",label:"Tipo de Cálculo",icon:Calculator,options:CALCULATION_TYPES,value:formData.calculationType||"fixed",onChange:e=>handleFormChange("calculationType",e),required:!0}),"fixed"===formData.calculationType&&jsxRuntimeExports.jsx(InputUI,{id:"fee-amount",label:"Monto Fijo",icon:DollarSign,type:"number",value:(null==(_a=formData.actualAmount)?void 0:_a.toString())||"0",onChange:e=>handleFormChange("actualAmount",parseFloat(e)),placeholder:"Monto del cargo",required:!0}),"formula"===formData.calculationType&&jsxRuntimeExports.jsxs("div",{className:"md:col-span-2",children:[jsxRuntimeExports.jsxs("div",{className:"mb-2",children:[jsxRuntimeExports.jsx(TextAreaUI,{id:"fee-formula",label:"Fórmula",icon:Calculator,value:formData.formulaExpression||"",onChange:e=>handleFormChange("formulaExpression",e),placeholder:"Ej: [Total_Gastos] * 0.10",rows:2,maxLength:200}),jsxRuntimeExports.jsx("div",{className:"mt-2 text-sm text-gray-500",children:jsxRuntimeExports.jsx("p",{children:"Variables disponibles: [Total_Gastos], [Metros_Cuadrados], etc."})})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center mt-2 mb-4",children:[jsxRuntimeExports.jsx(ButtonUI,{icon:Calculator,title:"Vista Previa",onClick:handleFormulaPreview,borderColor:"#0E7490",textColor:"#0E7490",className:"bg-cyan-50",type:"button"}),isFormulaPreviewVisible&&jsxRuntimeExports.jsxs("div",{className:"ml-4 p-2 bg-emerald-50 border border-emerald-200 rounded",children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Resultado:"})," S/.",formulaPreviewResult.toLocaleString("es-ES",{minimumFractionDigits:2})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsxs("label",{className:"inline-flex items-center cursor-pointer",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",className:"sr-only peer",checked:formData.isProportional||!1,onChange:e=>handleFormChange("isProportional",e.target.checked)}),jsxRuntimeExports.jsx("div",{className:"relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-emerald-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-emerald-600"}),jsxRuntimeExports.jsx("span",{className:"ml-3 text-sm font-medium text-gray-900",children:"Proporcional"})]}),jsxRuntimeExports.jsxs("label",{className:"inline-flex items-center cursor-pointer",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",className:"sr-only peer",checked:formData.isRecurring||!1,onChange:e=>handleFormChange("isRecurring",e.target.checked)}),jsxRuntimeExports.jsx("div",{className:"relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-emerald-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-emerald-600"}),jsxRuntimeExports.jsx("span",{className:"ml-3 text-sm font-medium text-gray-900",children:"Recurrente"})]})]}),jsxRuntimeExports.jsx("div",{className:"md:col-span-2",children:jsxRuntimeExports.jsx(TextAreaUI,{id:"fee-description",label:"Descripción",value:formData.description||"",onChange:e=>handleFormChange("description",e),placeholder:"Descripción del tipo de cargo...",rows:3,maxLength:200})}),"formula"===formData.calculationType&&jsxRuntimeExports.jsx("div",{className:"md:col-span-2",children:jsxRuntimeExports.jsx(SelectUI$1,{id:"applicable-expense-types",label:"Tipos de Gastos Aplicables",options:expenseTypes.map(e=>({value:e.expenseTypeId.toString(),label:e.name||"Sin nombre"})),value:formData.applicableExpenseTypes||"",onChange:e=>handleFormChange("applicableExpenseTypes",e),includeAll:!0,allLabel:"Todos los tipos de gastos"})}),jsxRuntimeExports.jsxs("div",{className:"md:col-span-2 flex justify-end gap-3 mt-4",children:[jsxRuntimeExports.jsx(ButtonUI,{title:"Cancelar",onClick:resetForm,theme:"cancel"}),jsxRuntimeExports.jsx(ButtonUI,{title:"Guardar",type:"submit",borderColor:"#629E3E",textColor:"white",className:"bg-primary"})]})]})]}),isLoadingData&&jsxRuntimeExports.jsx("div",{className:"flex justify-center py-4 flex-shrink-0",children:jsxRuntimeExports.jsx("p",{children:"Cargando datos..."})}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-auto min-h-0",children:jsxRuntimeExports.jsx(DataGrid,{data:feeTypes,columns:columns,initialPage:currentPage,initialPageSize:pageSize,totalRecords:totalRecords,onPageChange:e=>setCurrentPage(e),onPageSizeChange:e=>setPageSize(e),actions:[{icon:Pencil,label:"Editar",onClick:handleEdit},{icon:Trash2,label:"Eliminar",onClick:e=>handleDelete(e.feeTypeId)}]})})]})}const tabs=[{id:"expense-types",label:"Tipos de Gastos",icon:Tag},{id:"expenses",label:"Gastos",icon:Receipt},{id:"fee-types",label:"Tipos de Cargos",icon:CreditCard}];function SystemParametersPage(){const[e,t]=reactExports.useState("expense-types");return jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},transition:{duration:.3},className:"container mx-auto h-full flex flex-col",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Parámetros del Sistema"}),jsxRuntimeExports.jsx("p",{className:"text-gray-500 mt-1",children:"Configure los tipos de gastos, gastos y tipos de cargos para la generación automática de cobros"})]}),jsxRuntimeExports.jsx("div",{className:"space-x-2",children:jsxRuntimeExports.jsx(ButtonUI,{icon:ArrowRight,title:"Flujo de Configuración",borderColor:"#629E3E",textColor:"#629E3E",className:"bg-emerald-50"})})]}),jsxRuntimeExports.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden flex-1 flex flex-col min-h-[1366px]",children:jsxRuntimeExports.jsxs(Tabs,{defaultValue:"expense-types",onValueChange:t,value:e,className:"flex flex-col h-full",children:[jsxRuntimeExports.jsx("div",{className:"bg-[#1a2234] p-4 flex-shrink-0",children:jsxRuntimeExports.jsx(TabsList,{className:"grid grid-cols-3 w-full rounded-lg bg-[#1a2234]/50 p-1",children:tabs.map(e=>jsxRuntimeExports.jsxs(TabsTrigger,{value:e.id,className:"rounded-md py-3 text-white data-[state=active]:bg-[#629E3E] data-[state=active]:text-white flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx(e.icon,{className:"h-4 w-4"}),jsxRuntimeExports.jsx("span",{className:"hidden md:inline",children:e.label})]},e.id))})}),jsxRuntimeExports.jsxs("div",{className:"p-6 flex-1 overflow-auto",children:[jsxRuntimeExports.jsx(TabsContent,{value:"expense-types",className:"h-full min-h-[500px]",children:jsxRuntimeExports.jsx(ExpenseTypesTab,{})}),jsxRuntimeExports.jsx(TabsContent,{value:"expenses",className:"h-full min-h-[500px]",children:jsxRuntimeExports.jsx(ExpensesTab,{})}),jsxRuntimeExports.jsx(TabsContent,{value:"fee-types",className:"h-full min-h-[500px]",children:jsxRuntimeExports.jsx(FeeTypesTab,{})})]})]})})]})}class FeeService extends ApiBaseService{constructor(){super("/Fee")}getFeeById(e){return __async(this,null,function*(){return __superGet(FeeService.prototype,this,"getById").call(this,e)})}getFeeDetails(e){return __async(this,null,function*(){return this.get(`/${e}/details`)})}getPagedFees(e){return __async(this,null,function*(){const t=e?__spreadProps(__spreadValues({},e),{FeeId:e.FeeId||void 0,DepartmentId:e.DepartmentId||void 0,FeeTypeId:e.FeeTypeId||void 0,PayingUserId:e.PayingUserId||void 0,StatusTypeId:e.StatusTypeId||void 0,StartDueDate:e.StartDueDate||void 0,EndDueDate:e.EndDueDate||void 0}):void 0;return __superGet(FeeService.prototype,this,"getPaged").call(this,"paged",t)})}create(e){return __async(this,null,function*(){return this.post("",e)})}update(e,t){return __async(this,null,function*(){return this.put(`/${e}`,t)})}deleteFee(e){return __async(this,null,function*(){return __superGet(FeeService.prototype,this,"deleteById").call(this,e)})}registerPayment(e,t){return __async(this,null,function*(){return this.post(`/${e}/register-payment`,t)})}getByDepartment(e,t=1,a=10){return __async(this,null,function*(){const r={Page:t,PageSize:a,DepartmentId:e};return this.getPagedFees(r)})}getByFeeType(e,t=1,a=10){return __async(this,null,function*(){const r={Page:t,PageSize:a,FeeTypeId:e};return this.getPagedFees(r)})}getByStatus(e,t=1,a=10){return __async(this,null,function*(){const r={Page:t,PageSize:a,StatusTypeId:e};return this.getPagedFees(r)})}getPendingFees(){return __async(this,null,function*(){return this.get("pending")})}getByDueDateRange(e,t,a=1,r=10){return __async(this,null,function*(){const s={Page:a,PageSize:r,StartDate:e,EndDate:t};return this.getPaged("by-due-date-range",s)})}getByPayingUser(e,t=1,a=10){return __async(this,null,function*(){const r={Page:t,PageSize:a,UserId:e};return this.getPaged(`by-paying-user/${e}`,r)})}}function MonthlyFeeList(){return jsxRuntimeExports.jsx(AlertProvider,{children:jsxRuntimeExports.jsx(MonthlyFeeListContent,{})})}function MonthlyFeeListContent(){var e;const{setLoading:t}=useLoading(),[a,r]=reactExports.useState([]),[s,n]=reactExports.useState([]),[i,o]=reactExports.useState([]),[l,c]=reactExports.useState([]),[d,u]=reactExports.useState([]),[m,p]=reactExports.useState([]),[x,h]=reactExports.useState(-1),[g,y]=reactExports.useState(-1),[v,E]=reactExports.useState(-1),[f,b]=reactExports.useState(-1),[j,R]=reactExports.useState(!0),[I,S]=reactExports.useState(!1),[_,N]=reactExports.useState(),[C,T]=reactExports.useState(null),[D,A]=reactExports.useState({departmentId:void 0,feeTypeId:void 0,amount:0,dueDate:(new Date).toISOString().split("T")[0],statusTypeId:1,feeDetails:[]}),P=new ManagementCompanyService,w=new CondominiumService,M=new BuildingService,k=new DepartmentService,O=new FeeService,$=new FeeTypeService,{showToast:U,showConfirm:L}=useAlerts(),B=useNavigate();reactExports.useEffect(()=>{(()=>{__async(this,null,function*(){try{t(!0),yield z(),yield W(),yield F(),R(!1)}catch(e){T("Error al cargar los datos iniciales")}finally{t(!1)}})})()},[]);const F=()=>__async(this,null,function*(){try{(new AuthService).getUser();yield preloadCompanyCondoFilters(e=>{h(Number(e))},(e,t)=>__async(this,null,function*(){"companyId"===e&&"number"==typeof t&&-1!==t&&(yield H(t)),"condoId"===e&&"number"==typeof t&&-1!==t&&(y(t),yield G(t))}),H,"MonthlyFeeList")}catch(e){}}),V=()=>shouldDisableCompanyCondoSelects(),W=()=>__async(this,null,function*(){try{t(!0);const e=yield $.getPaged();if(e.isSuccess&&e.data){const t=e.data;t.items&&Array.isArray(t.items)?p(t.items):p([])}}catch(e){}finally{t(!1)}}),z=()=>__async(this,null,function*(){try{T(null);const e=yield P.getPaged();if(e.isSuccess&&e.data){const t=e.data;t.items&&Array.isArray(t.items)?r(t.items):r([])}else T(e.error||"Error al cargar las empresas")}catch(e){T("Error al cargar las empresas")}}),H=e=>__async(this,null,function*(){try{T(null);const t={CompanyId:e,Page:1,PageSize:100},a=yield w.getPaged(t);if(a.isSuccess&&a.data){const e=a.data;e.items&&Array.isArray(e.items)?n(e.items):e.data&&Array.isArray(e.data)?n(e.data):Array.isArray(e)?n(e):n([])}else T(a.error||"Error al cargar los condominios")}catch(t){T("Error al cargar los condominios")}}),G=e=>__async(this,null,function*(){try{t(!0),T(null);const a=yield M.getByCondoId(e);if(a.isSuccess&&a.data){const e=a.data;e.items&&Array.isArray(e.items)?o(e.items):e.data&&Array.isArray(e.data)?o(e.data):Array.isArray(e)?o(e):o([])}else T(a.error||"Error al cargar los edificios")}catch(a){T("Error al cargar los edificios")}finally{t(!1)}}),q=e=>__async(this,null,function*(){try{t(!0),T(null);const a=yield k.getByBuildingId(e);if(a.isSuccess&&a.data){const e=a.data;e.items&&Array.isArray(e.items)?c(e.items):e.data&&Array.isArray(e.data)?c(e.data):Array.isArray(e)?c(e):c([])}else T(a.error||"Error al cargar los departamentos")}catch(a){T("Error al cargar los departamentos")}finally{t(!1)}}),Y=e=>__async(this,null,function*(){try{t(!0),T(null);const a=yield O.getByDepartment(e);if(a.isSuccess&&a.data){const e=a.data;e.items&&Array.isArray(e.items)?u(e.items):u([])}else T(a.error||"Error al cargar las cuotas"),401===a.statusCode&&B("/login")}catch(a){T("Error al cargar las cuotas")}finally{t(!1)}}),K=[{accessorKey:"feeId",header:"ID",cell:({row:e})=>{const t=m.find(t=>t.feeTypeId===e.original.feeTypeId);return jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsxs("span",{className:"font-semibold",children:["#",e.original.feeId]}),jsxRuntimeExports.jsx("span",{className:"ml-2 text-sm text-gray-500",children:(null==t?void 0:t.feeName)||"Desconocido"})]})}},{accessorKey:"feeMonth",header:"Periodo",cell:({row:e})=>{const{feeMonth:t,feeYear:a}=e.original;return jsxRuntimeExports.jsxs("span",{className:"font-medium",children:[t?t.charAt(0).toUpperCase()+t.slice(1):"N/A"," ",a||""]})}},{accessorKey:"amount",header:"Monto",cell:({getValue:e})=>{const t=e();return jsxRuntimeExports.jsxs("span",{className:"font-medium text-gray-800",children:["S/.",t.toFixed(2)]})}},{accessorKey:"dueDate",header:"Fecha Vencimiento",cell:({getValue:e})=>{const t=e();return new Date(t).toLocaleDateString("es-ES")}},{accessorKey:"paymentDate",header:"Fecha Pago",cell:({getValue:e})=>{const t=e();return t?new Date(t).toLocaleDateString("es-ES"):"—"}},{accessorKey:"payingUserId",header:"Pagado por",cell:({row:e})=>e.original.payingUserName?jsxRuntimeExports.jsxs("span",{className:"font-medium",children:[e.original.payingUserName," ",e.original.payingUserLastName]}):"—"},{accessorKey:"statusTypeId",header:"Estado",cell:({getValue:e})=>{let t="Desconocido",a="bg-gray-100 text-gray-800";switch(e()){case 1:t="Pendiente",a="bg-yellow-100 text-yellow-800";break;case 2:t="Pagada",a="bg-green-100 text-green-800";break;case 3:t="Vencida",a="bg-red-100 text-red-800";break;case 4:t="Anulada",a="bg-gray-100 text-gray-800";break;case 5:t="Parcial",a="bg-blue-100 text-blue-800"}return jsxRuntimeExports.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${a}`,children:t})}}],J=e=>{e?(N(e),A({departmentId:e.departmentId,feeTypeId:e.feeTypeId,amount:e.amount,dueDate:e.dueDate?e.dueDate.split("T")[0]:"",paymentDate:e.paymentDate?e.paymentDate.split("T")[0]:null,statusTypeId:e.statusTypeId,notes:e.notes,invoiceNumber:e.invoiceNumber})):(N(void 0),A({departmentId:-1!==f?f:void 0,feeTypeId:void 0,amount:0,dueDate:(new Date).toISOString().split("T")[0],statusTypeId:1,feeDetails:[]})),S(!0)},X=()=>{S(!1),N(void 0),A({departmentId:void 0,feeTypeId:void 0,amount:0,dueDate:(new Date).toISOString().split("T")[0],statusTypeId:1,feeDetails:[]})},Z=(e,t)=>{const a=void 0===t?null:t;A(t=>__spreadProps(__spreadValues({},t),{[e]:a}))},Q=e=>__async(this,null,function*(){L("Eliminar cuota",`¿Está seguro que desea eliminar la cuota #${e.feeId}?`,()=>__async(this,null,function*(){try{t(!0);const a=yield O.delete(e.feeId);a.isSuccess?(U("success","Cuota eliminada correctamente"),yield Y(f)):U("error",a.error||"Error al eliminar la cuota")}catch(a){U("error","Ocurrió un error al eliminar la cuota")}finally{t(!1)}}))}),ee=[{icon:SquarePen,label:"Editar",onClick:e=>J(e)},{icon:Trash2,label:"Eliminar",onClick:e=>Q(e)},{icon:CreditCard,label:"Registrar Pago",onClick:e=>(e=>{B(`/payments/${e.feeId}/register?companyId=${x}&condoId=${g}&buildingId=${v}&departmentId=${e.departmentId}`)})(e),hidden:e=>2===e.statusTypeId||4===e.statusTypeId}],te=a.filter(e=>void 0!==e.companyId).map(e=>({value:e.companyId,label:e.name})),ae=s.map(e=>({value:e.condoId,label:e.name})),re=i.map(e=>({value:e.buildingId,label:e.name||`Edificio ${e.buildingId}`})),se=l.map(e=>({value:e.departmentId,label:e.departmentNumber||`Departamento ${e.departmentId}`})),ne=m.map(e=>({value:e.feeTypeId,label:e.feeName||`Tipo ${e.feeTypeId}`}));return jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6 p-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Cuotas Mensuales"}),jsxRuntimeExports.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Administra las cuotas mensuales de los departamentos"})]}),jsxRuntimeExports.jsx(ButtonUI,{icon:Plus,title:"Nueva Cuota",borderColor:"#629E3E",textColor:"#ffffff",className:"bg-primary hover:bg-primary/90",onClick:()=>-1!==f?J():U("warning","Seleccione un departamento primero"),disabled:-1===f})]}),jsxRuntimeExports.jsx(Expandex,{title:"Filtros de búsqueda",initialExpanded:!0,expandIcon:Filter,backgroundColor:"#f9fafb",className:"mb-6",children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(SelectUI$1,{id:"company",label:"Empresa",value:x,onChange:V()?()=>{}:e=>__async(this,null,function*(){const t=Number(e);h(t),y(-1),E(-1),b(-1),o([]),c([]),u([]),-1!==t?yield H(t):n([])}),icon:Building,options:te,placeholder:"Seleccione una empresa",required:!0,includeAll:!0,disabled:V()||j})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(SelectUI$1,{id:"condominium",label:"Condominio",value:g,onChange:V()?()=>{}:e=>__async(this,null,function*(){const t=Number(e);y(t),E(-1),b(-1),c([]),u([]),-1!==t?yield G(t):o([])}),icon:Building2,options:ae,placeholder:"Seleccione un condominio",required:!0,includeAll:!0,disabled:V()||-1===x})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(SelectUI$1,{id:"building",label:"Edificio",value:v,onChange:e=>__async(this,null,function*(){const t=Number(e);E(t),b(-1),u([]),-1!==t?yield q(t):c([])}),icon:Building2,options:re,placeholder:"Seleccione un edificio",required:!0,includeAll:!0,disabled:-1===g})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(SelectUI$1,{id:"department",label:"Departamento",value:f,onChange:e=>{const t=Number(e);b(t),-1!==t?Y(t):u([])},icon:Home,options:se,placeholder:"Seleccione un departamento",required:!0,includeAll:!0,disabled:-1===v})})]})}),C&&jsxRuntimeExports.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-6",children:C}),jsxRuntimeExports.jsx(DataGrid,{data:d,columns:K,actions:ee}),jsxRuntimeExports.jsx(ModalUI,{isOpen:I,onClose:X,title:_?"Editar Cuota":"Nueva Cuota",footer:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ButtonUI,{icon:X$1,title:"Cancelar",onClick:X,theme:"modalCancel"}),jsxRuntimeExports.jsx(ButtonUI,{icon:Save,title:"Guardar",onClick:()=>__async(this,null,function*(){try{if(t(!0),_){const e={feeId:_.feeId,departmentId:D.departmentId,feeTypeId:D.feeTypeId,amount:D.amount,dueDate:D.dueDate,paymentDate:D.paymentDate,statusTypeId:D.statusTypeId,notes:D.notes,invoiceNumber:D.invoiceNumber,routeId:_.feeId,updatedBy:"current-user",updatedAt:(new Date).toISOString()},t=yield O.update(_.feeId,e);t.isSuccess?(U("success","Cuota actualizada correctamente"),-1!==f&&(yield Y(f)),X()):U("error",t.error||"Error al actualizar la cuota")}else{const e={departmentId:D.departmentId,feeTypeId:D.feeTypeId,amount:D.amount,dueDate:D.dueDate,paymentDate:D.paymentDate,statusTypeId:D.statusTypeId,payingUserId:null,paymentMethodId:null,invoiceNumber:D.invoiceNumber,notes:D.notes,createdBy:"current-user",createdAt:(new Date).toISOString(),feeDetails:D.feeDetails},t=yield O.create(e);t.isSuccess?(U("success","Cuota creada correctamente"),-1!==f&&(yield Y(f)),X()):U("error",t.error||"Error al crear la cuota")}}catch(e){U("error","Ocurrió un error al guardar los datos")}finally{t(!1)}}),theme:"modalSave"})]}),children:jsxRuntimeExports.jsxs("div",{className:"space-y-4 p-4",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(SelectUI$1,{id:"feeTypeId",label:"Tipo de Cuota",value:D.feeTypeId,onChange:e=>Z("feeTypeId",Number(e)),options:ne,placeholder:"Seleccione tipo de cuota",required:!0}),jsxRuntimeExports.jsx(InputUI,{id:"amount",label:"Monto",type:"number",value:(null==(e=D.amount)?void 0:e.toString())||"0",onChange:e=>Z("amount",Number(e)),icon:DollarSign,required:!0})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(DatepickerUI,{id:"dueDate",label:"Fecha de Vencimiento",value:D.dueDate||"",onChange:e=>Z("dueDate",e),icon:CalendarRange,required:!0}),jsxRuntimeExports.jsx(SelectUI$1,{id:"statusTypeId",label:"Estado",value:D.statusTypeId,onChange:e=>Z("statusTypeId",Number(e)),options:[{value:1,label:"Pendiente"},{value:2,label:"Pagada"},{value:3,label:"Vencida"},{value:4,label:"Anulada"},{value:5,label:"Parcial"}],required:!0})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[jsxRuntimeExports.jsx(InputUI,{id:"invoiceNumber",label:"Número de Factura",value:D.invoiceNumber||"",onChange:e=>Z("invoiceNumber",e)}),jsxRuntimeExports.jsx(InputUI,{id:"notes",label:"Notas",value:D.notes||"",onChange:e=>Z("notes",e)})]})]})})]})}function PaymentList(){return jsxRuntimeExports.jsx(AlertProvider,{children:jsxRuntimeExports.jsx(PaymentListContent,{})})}function PaymentListContent(){const{setLoading:e}=useLoading(),[t,a]=reactExports.useState([]),[r,s]=reactExports.useState([]),[n,i]=reactExports.useState([]),[o,l]=reactExports.useState([]),[c,d]=reactExports.useState([]),[u,m]=reactExports.useState([]),[p,x]=reactExports.useState([]),[h,g]=reactExports.useState(-1),[y,v]=reactExports.useState(-1),[E,f]=reactExports.useState(-1),[b,j]=reactExports.useState(-1),[R,I]=reactExports.useState(!0),[S,_]=reactExports.useState(!1),[N,C]=reactExports.useState(),[T,D]=reactExports.useState(null),[A,P]=reactExports.useState({feeId:void 0,payingUserId:void 0,paymentDate:(new Date).toISOString().split("T")[0],paymentMethodId:void 0,invoiceNumber:"",notes:""}),w=new ManagementCompanyService,M=new CondominiumService,k=new BuildingService,O=new DepartmentService,$=new FeeService,U=new SystemUserService,{showToast:L,showConfirm:B}=useAlerts(),F=useNavigate(),V=useParams(),W=V.feeId?parseInt(V.feeId):void 0,z=V.action,H=new URLSearchParams(window.location.search),G=H.get("companyId")?parseInt(H.get("companyId")):void 0,q=H.get("condoId")?parseInt(H.get("condoId")):void 0,Y=H.get("buildingId")?parseInt(H.get("buildingId")):void 0,K=H.get("departmentId")?parseInt(H.get("departmentId")):void 0;reactExports.useEffect(()=>{(()=>{__async(this,null,function*(){try{e(!0),yield ee(),yield Q(),yield J(),G&&G>0&&(g(G),yield te(G),q&&q>0&&(v(q),yield ae(q),Y&&Y>0&&(f(Y),yield re(Y),K&&K>0&&(j(K),yield se(K))))),W&&"register"===z&&(yield Z(W)),I(!1)}catch(t){D("Error al cargar los datos iniciales")}finally{e(!1)}})})()},[W]);const J=()=>__async(this,null,function*(){try{(new AuthService).getUser();yield preloadCompanyCondoFilters(e=>{g(Number(e))},(e,t)=>__async(this,null,function*(){"companyId"===e&&"number"==typeof t&&-1!==t&&(yield te(t)),"condoId"===e&&"number"==typeof t&&-1!==t&&(v(t),yield ae(t))}),te,"PaymentList")}catch(e){}}),X=()=>shouldDisableCompanyCondoSelects(),Z=t=>__async(this,null,function*(){try{e(!0);const a=yield $.getById(t);if(a.isSuccess&&a.data){const e=a.data;if(C(e),e.departmentId){const t=yield O.getById(e.departmentId);if(t.isSuccess&&t.data){const e=t.data;if(j(e.departmentId),e.buildingId){f(e.buildingId),yield re(e.buildingId);const t=yield k.getById(e.buildingId);if(t.isSuccess&&t.data){const e=t.data;if(e.condoId){v(e.condoId),yield ae(e.condoId);const t=yield M.getById(e.condoId);if(t.isSuccess&&t.data){const e=t.data;e.companyId&&(g(e.companyId),yield te(e.companyId))}}}}}}P({feeId:e.feeId,paymentDate:(new Date).toISOString().split("T")[0],paymentMethodId:void 0,invoiceNumber:"",notes:""}),_(!0)}else L("error",a.error||"Error al cargar los detalles de la cuota")}catch(a){L("error","Error al cargar los detalles de la cuota")}finally{e(!1)}}),Q=()=>__async(this,null,function*(){}),ee=()=>__async(this,null,function*(){try{e(!0),D(null);const t=yield w.getPaged();if(t.isSuccess&&t.data){const e=t.data;e.items&&Array.isArray(e.items)?a(e.items):a([])}else D(t.error||"Error al cargar las empresas")}catch(t){D("Error al cargar las empresas")}finally{e(!1)}}),te=t=>__async(this,null,function*(){try{let a;if(e(!0),D(null),-1===t){const e={Page:1,PageSize:100};a=yield M.getPaged(e)}else{const e={CompanyId:t,Page:1,PageSize:100};a=yield M.getPaged(e)}if(a.isSuccess&&a.data){const e=a.data;e.items&&Array.isArray(e.items)?s(e.items):e.data&&Array.isArray(e.data)?s(e.data):Array.isArray(e)?s(e):s([])}else D(a.error||"Error al cargar los condominios")}catch(a){D("Error al cargar los condominios")}finally{e(!1)}}),ae=t=>__async(this,null,function*(){try{e(!0),D(null);const a=yield k.getByCondoId(t);if(a.isSuccess&&a.data){const e=a.data;e.items&&Array.isArray(e.items)?i(e.items):e.data&&Array.isArray(e.data)?i(e.data):Array.isArray(e)?i(e):i([])}else D(a.error||"Error al cargar los edificios")}catch(a){D("Error al cargar los edificios")}finally{e(!1)}}),re=t=>__async(this,null,function*(){try{e(!0),D(null);const a=yield O.getByBuildingId(t);if(a.isSuccess&&a.data){const e=a.data;e.items&&Array.isArray(e.items)?l(e.items):e.data&&Array.isArray(e.data)?l(e.data):Array.isArray(e)?l(e):l([])}else D(a.error||"Error al cargar los departamentos")}catch(a){D("Error al cargar los departamentos")}finally{e(!1)}}),se=t=>__async(this,null,function*(){try{e(!0),D(null);const a=yield $.getByDepartment(t);if(a.isSuccess&&a.data){const e=a.data;if(e.items&&Array.isArray(e.items)){const t=e.items.filter(e=>2===e.statusTypeId);d(t)}else d([])}else D(a.error||"Error al cargar las cuotas"),401===a.statusCode&&F("/login")}catch(a){D("Error al cargar las cuotas")}finally{e(!1)}}),ne=[{accessorKey:"feeId",header:"ID",cell:({row:e})=>jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsxs("span",{className:"font-semibold",children:["#",e.original.feeId]}),jsxRuntimeExports.jsx("span",{className:"ml-2 text-sm text-gray-500",children:e.original.feeTypeName||"Cuota"})]})},{accessorKey:"feeMonth",header:"Periodo",cell:({row:e})=>{const{feeMonth:t,feeYear:a}=e.original;return jsxRuntimeExports.jsxs("span",{className:"font-medium",children:[t?t.charAt(0).toUpperCase()+t.slice(1):"N/A"," ",a||""]})}},{accessorKey:"amount",header:"Monto",cell:({getValue:e})=>{const t=e();return jsxRuntimeExports.jsxs("span",{className:"font-medium text-gray-800",children:["S/.",t.toFixed(2)]})}},{accessorKey:"dueDate",header:"Fecha Vencimiento",cell:({getValue:e})=>{const t=e();return new Date(t).toLocaleDateString("es-ES")}},{accessorKey:"paymentDate",header:"Fecha Pago",cell:({getValue:e})=>{const t=e();return t?jsxRuntimeExports.jsx("span",{className:"text-green-700 font-medium",children:new Date(t).toLocaleDateString("es-ES")}):"—"}},{accessorKey:"payingUserId",header:"Pagado por",cell:({row:e})=>e.original.payingUserName?jsxRuntimeExports.jsxs("span",{className:"font-medium",children:[e.original.payingUserName," ",e.original.payingUserLastName]}):"—"},{accessorKey:"paymentMethodId",header:"Método de Pago",cell:({row:e})=>(e.original.paymentMethodId,e.original.paymentMethodName||"—")},{accessorKey:"invoiceNumber",header:"Factura",cell:({getValue:e})=>e()||"—"}],ie=t=>__async(this,null,function*(){try{e(!0);const a=yield $.getByDepartment(t);if(a.isSuccess&&a.data){const e=a.data;if(e.items&&Array.isArray(e.items)){const t=e.items.filter(e=>1===e.statusTypeId||3===e.statusTypeId);if(0===t.length)return L("info","No hay cuotas pendientes para este departamento"),void _(!1);x(t.map(e=>({value:e.feeId,label:`${e.feeTypeName||"Cuota"} - ${e.feeMonth?e.feeMonth.charAt(0).toUpperCase()+e.feeMonth.slice(1):""} ${e.feeYear||""} - S/.${e.amount.toFixed(2)}`}))),1===t.length&&P(e=>__spreadProps(__spreadValues({},e),{feeId:t[0].feeId}))}}else L("error",a.error||"Error al cargar cuotas pendientes")}catch(a){}finally{e(!1)}}),oe=()=>{_(!1),C(void 0),P({feeId:void 0,payingUserId:void 0,paymentDate:(new Date).toISOString().split("T")[0],paymentMethodId:void 0,invoiceNumber:"",notes:""})},le=(e,t)=>{P(a=>__spreadProps(__spreadValues({},a),{[e]:t}))},ce=[{icon:Receipt,label:"Ver Recibo",onClick:e=>(e=>{L("info",`Generando recibo para el pago #${e.feeId}`)})(e)}],de=t.map(e=>({value:e.companyId,label:e.name})),ue=r.map(e=>({value:e.condoId,label:e.name})),me=n.map(e=>({value:e.buildingId,label:e.name||`Edificio ${e.buildingId}`})),pe=o.map(e=>({value:e.departmentId,label:e.departmentNumber||`Departamento ${e.departmentId}`})),xe=u.map(e=>({value:e.userId,label:`${e.firstName} ${e.lastName}`}));return jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6 p-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Pagos Registrados"}),jsxRuntimeExports.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Gestione los pagos de cuotas de los departamentos"})]}),jsxRuntimeExports.jsx(ButtonUI,{icon:Plus,title:"Registrar Pago",borderColor:"var(--color-primary-admin)",textColor:"#ffffff",className:"bg-primary hover:bg-primary/90",onClick:()=>-1!==b?(C(void 0),P({feeId:void 0,payingUserId:void 0,paymentDate:(new Date).toISOString().split("T")[0],paymentMethodId:void 0,invoiceNumber:"",notes:""}),-1!==b&&ie(b),void _(!0)):L("warning","Seleccione un departamento primero"),disabled:-1===b})]}),jsxRuntimeExports.jsx(Expandex,{title:"Filtros de búsqueda",initialExpanded:!0,expandIcon:Filter,backgroundColor:"#f9fafb",className:"mb-6",children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(SelectUI$1,{id:"company",label:"Empresa",value:h,onChange:X()?()=>{}:e=>__async(this,null,function*(){const t=Number(e);g(t),v(-1),f(-1),j(-1),i([]),l([]),d([]),-1!==t?yield te(t):s([])}),icon:Building,options:de,placeholder:"Seleccione una empresa",required:!0,includeAll:!0,disabled:X()||R})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(SelectUI$1,{id:"condominium",label:"Condominio",value:y,onChange:X()?()=>{}:e=>__async(this,null,function*(){const t=Number(e);v(t),f(-1),j(-1),l([]),d([]),-1!==t?yield ae(t):i([])}),icon:Building2,options:ue,placeholder:"Seleccione un condominio",required:!0,includeAll:!0,disabled:X()||-1===h})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(SelectUI$1,{id:"building",label:"Edificio",value:E,onChange:e=>__async(this,null,function*(){const t=Number(e);f(t),j(-1),d([]),-1!==t?yield re(t):l([])}),icon:Building2,options:me,placeholder:"Seleccione un edificio",required:!0,includeAll:!0,disabled:-1===y})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(SelectUI$1,{id:"department",label:"Departamento",value:b,onChange:e=>{const t=Number(e);j(t),-1!==t?se(t):d([])},icon:Home,options:pe,placeholder:"Seleccione un departamento",required:!0,includeAll:!0,disabled:-1===E})})]})}),T&&jsxRuntimeExports.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-6",children:T}),jsxRuntimeExports.jsx(DataGrid,{data:c,columns:ne,actions:ce}),jsxRuntimeExports.jsx(ModalUI,{isOpen:S,onClose:oe,title:N?"Detalles del Pago":"Registrar Pago",footer:N?jsxRuntimeExports.jsx(ButtonUI,{icon:X$1,title:"Cerrar",onClick:oe,theme:"cancel"}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ButtonUI,{icon:X$1,title:"Cancelar",onClick:oe,borderColor:"var(--color-action-delete)",textColor:"var(--color-action-delete)",className:"hover:bg-red-50"}),jsxRuntimeExports.jsx(ButtonUI,{icon:Check,title:"Registrar Pago",onClick:()=>__async(this,null,function*(){try{if(!A.feeId)return void L("error","Debe seleccionar una cuota para registrar el pago");if(!A.paymentMethodId)return void L("error","Debe seleccionar un método de pago");B("Confirmar Pago",`¿Está seguro que desea registrar este pago por el monto de S/.${(null==N?void 0:N.amount.toFixed(2))||"0.00"}?`,()=>__async(this,null,function*(){try{e(!0);const t={feeId:A.feeId,payingUserId:A.payingUserId||0,paymentDate:A.paymentDate,paymentMethodId:A.paymentMethodId,invoiceNumber:A.invoiceNumber||null,notes:A.notes||null,updatedBy:"current-user",updatedAt:(new Date).toISOString()},a=yield $.registerPayment(A.feeId,t);if(a.isSuccess){L("success","Pago registrado correctamente");const e=`REC-${Math.floor(1e4*Math.random())}`;B("Pago Exitoso",`El pago ha sido registrado correctamente.\nNúmero de recibo: ${e}\n\n¿Desea imprimir el recibo?`,()=>{L("info","Generando recibo para imprimir..."),oe(),-1!==b?se(b):W&&F("/payments")},()=>{oe(),-1!==b?se(b):W&&F("/payments")},"Imprimir","No Imprimir")}else L("error",a.error||"Error al registrar el pago")}catch(t){L("error","Ocurrió un error al registrar el pago")}finally{e(!1)}}))}catch(t){L("error","Ocurrió un error al procesar el pago")}}),borderColor:"var(--color-primary-admin)",textColor:"#ffffff",className:"bg-primary hover:bg-primary/90"})]}),children:jsxRuntimeExports.jsxs("div",{className:"space-y-4 p-4",children:[!N&&jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 gap-4",children:jsxRuntimeExports.jsx(SelectUI$1,{id:"feeId",label:"Cuota a Pagar",value:A.feeId,onChange:e=>le("feeId",Number(e)),options:p.length>0?p:[{value:"",label:"Seleccione una cuota"}],placeholder:"Seleccione la cuota a pagar",required:!0,disabled:!!N})}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(SelectUI$1,{id:"payingUserId",label:"Usuario Pagador",value:A.payingUserId,onChange:e=>le("payingUserId",Number(e)),options:xe,placeholder:"Seleccione usuario pagador",onSearch:e=>__async(this,null,function*(){try{if(!e||e.length<3)return;const t={SearchTerm:e,Page:1,PageSize:10},a=yield U.getPaged(t);if(a.isSuccess&&a.data){const e=a.data;e.items&&Array.isArray(e.items)?m(e.items):m([])}}catch(t){}}),disabled:!!N}),jsxRuntimeExports.jsx(DatepickerUI,{id:"paymentDate",label:"Fecha de Pago",value:A.paymentDate||"",onChange:e=>le("paymentDate",e),icon:CalendarRange,required:!0,disabled:!!N})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(SelectUI$1,{id:"paymentMethodId",label:"Método de Pago",value:A.paymentMethodId,onChange:e=>le("paymentMethodId",Number(e)),options:[{value:1,label:"Efectivo"},{value:2,label:"Transferencia"},{value:3,label:"Tarjeta de Crédito"},{value:4,label:"Tarjeta de Débito"},{value:5,label:"Cheque"}],placeholder:"Seleccione método de pago",required:!0,disabled:!!N}),jsxRuntimeExports.jsx(InputUI,{id:"invoiceNumber",label:"Número de Factura",value:A.invoiceNumber||"",onChange:e=>le("invoiceNumber",e),disabled:!!N})]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 gap-4",children:jsxRuntimeExports.jsx(InputUI,{id:"notes",label:"Notas",value:A.notes||"",onChange:e=>le("notes",e),multiline:!0,disabled:!!N})})]})})]})}function DelinquencyList(){return jsxRuntimeExports.jsx(AlertProvider,{children:jsxRuntimeExports.jsx(DelinquencyListContent,{})})}function DelinquencyListContent(){const{setLoading:e}=useLoading(),[t,a]=reactExports.useState([]),[r,s]=reactExports.useState([]),[n,i]=reactExports.useState([]),[o,l]=reactExports.useState([]),[c,d]=reactExports.useState([]),[u,m]=reactExports.useState(),[p,x]=reactExports.useState([]),[h,g]=reactExports.useState(-1),[y,v]=reactExports.useState(-1),[E,f]=reactExports.useState(-1),[b,j]=reactExports.useState(-1),[R,I]=reactExports.useState(!0),[S,_]=reactExports.useState(!1),[N,C]=reactExports.useState(!1),[T,D]=reactExports.useState(""),[A,P]=reactExports.useState(null),w=new ManagementCompanyService,M=new CondominiumService,k=new BuildingService,O=new DepartmentService,$=new FeeService;new SystemUserService;const{showToast:U,showConfirm:L}=useAlerts(),B=useNavigate();reactExports.useEffect(()=>{(()=>{__async(this,null,function*(){try{e(!0),yield W(),yield F(),I(!1)}catch(t){P("Error al cargar los datos iniciales")}finally{e(!1)}})})()},[]);const F=()=>__async(this,null,function*(){try{(new AuthService).getUser();yield preloadCompanyCondoFilters(e=>{g(Number(e))},(e,t)=>__async(this,null,function*(){"companyId"===e&&"number"==typeof t&&-1!==t&&(yield z(t)),"condoId"===e&&"number"==typeof t&&-1!==t&&(v(t),yield H(t))}),z,"DelinquencyList")}catch(e){}}),V=()=>shouldDisableCompanyCondoSelects(),W=()=>__async(this,null,function*(){try{e(!0),P(null);const t=yield w.getPaged();if(t.isSuccess&&t.data){const e=t.data;e.items&&Array.isArray(e.items)?a(e.items):a([])}else P(t.error||"Error al cargar las empresas")}catch(t){P("Error al cargar las empresas")}finally{e(!1)}}),z=t=>__async(this,null,function*(){try{e(!0),P(null);const a={CompanyId:t,Page:1,PageSize:100},r=yield M.getPaged(a);if(r.isSuccess&&r.data){const e=r.data;e.items&&Array.isArray(e.items)?s(e.items):e.data&&Array.isArray(e.data)?s(e.data):Array.isArray(e)?s(e):s([])}else P(r.error||"Error al cargar los condominios")}catch(a){P("Error al cargar los condominios")}finally{e(!1)}}),H=t=>__async(this,null,function*(){try{e(!0),P(null);const a=yield k.getByCondoId(t);if(a.isSuccess&&a.data){const e=a.data;e.items&&Array.isArray(e.items)?i(e.items):e.data&&Array.isArray(e.data)?i(e.data):Array.isArray(e)?i(e):i([])}else P(a.error||"Error al cargar los edificios")}catch(a){P("Error al cargar los edificios")}finally{e(!1)}}),G=t=>__async(this,null,function*(){try{e(!0),P(null);const a=yield O.getByBuildingId(t);if(a.isSuccess&&a.data){const e=a.data;e.items&&Array.isArray(e.items)?l(e.items):e.data&&Array.isArray(e.data)?l(e.data):Array.isArray(e)?l(e):l([])}else P(a.error||"Error al cargar los departamentos")}catch(a){P("Error al cargar los departamentos")}finally{e(!1)}}),q=t=>__async(this,null,function*(){try{e(!0),P(null);const a=yield $.getByDepartment(t);if(a.isSuccess&&a.data){const e=a.data;if(e.items&&Array.isArray(e.items)){const t=new Date,a=e.items.filter(e=>{const a=new Date(e.dueDate);return 3===e.statusTypeId||1===e.statusTypeId&&a<t});a.sort((e,t)=>new Date(e.dueDate).getTime()-new Date(t.dueDate).getTime()),d(a)}else d([])}else P(a.error||"Error al cargar las cuotas"),401===a.statusCode&&B("/login")}catch(a){P("Error al cargar las cuotas morosas")}finally{e(!1)}}),Y=[{accessorKey:"feeId",header:"ID",cell:({row:e})=>jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsxs("span",{className:"font-semibold",children:["#",e.original.feeId]}),jsxRuntimeExports.jsx("span",{className:"ml-2 text-sm text-gray-500",children:e.original.feeTypeName||"Cuota"})]})},{accessorKey:"feeMonth",header:"Periodo",cell:({row:e})=>{const{feeMonth:t,feeYear:a}=e.original;return jsxRuntimeExports.jsxs("span",{className:"font-medium",children:[t?t.charAt(0).toUpperCase()+t.slice(1):"N/A"," ",a||""]})}},{accessorKey:"amount",header:"Monto",cell:({getValue:e})=>{const t=e();return jsxRuntimeExports.jsxs("span",{className:"font-medium text-gray-800",children:["S/.",t.toFixed(2)]})}},{accessorKey:"dueDate",header:"Fecha Vencimiento",cell:({getValue:e})=>{const t=e(),a=new Date(t),r=new Date,s=Math.abs(r.getTime()-a.getTime()),n=Math.ceil(s/864e5);return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-red-600 font-medium",children:a.toLocaleDateString("es-ES")}),jsxRuntimeExports.jsx("div",{className:"text-xs text-red-500",children:a<r?`Vencido hace ${n} días`:""})]})}},{accessorKey:"statusTypeId",header:"Estado",cell:({getValue:e})=>{let t="Desconocido",a="bg-gray-100 text-gray-800";switch(e()){case 1:t="Pendiente",a="bg-yellow-100 text-yellow-800";break;case 2:t="Pagada",a="bg-green-100 text-green-800";break;case 3:t="Vencida",a="bg-red-100 text-red-800";break;case 4:t="Anulada",a="bg-gray-100 text-gray-800";break;case 5:t="Parcial",a="bg-blue-100 text-blue-800"}return jsxRuntimeExports.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${a}`,children:t})}},{accessorKey:"daysOverdue",header:"Días de Mora",cell:({row:e})=>{const t=new Date(e.original.dueDate),a=new Date;if(t>a)return 0;const r=Math.abs(a.getTime()-t.getTime()),s=Math.ceil(r/864e5);return jsxRuntimeExports.jsx("span",{className:"font-medium text-red-600",children:s})}},{accessorKey:"lateFee",header:"Recargo",cell:({row:e})=>{if(void 0!==e.original.lateFee)return jsxRuntimeExports.jsxs("span",{className:"font-medium text-red-600",children:["S/.",e.original.lateFee.toFixed(2)]});const t=e.original.amount,a=new Date(e.original.dueDate),r=new Date;if(a>r)return"S/.0.00";const s=Math.abs(r.getTime()-a.getTime()),n=.002*t*Math.ceil(s/864e5);return jsxRuntimeExports.jsxs("span",{className:"font-medium text-red-600",children:["S/.",n.toFixed(2)]})}}],K=()=>{C(!1),D("")},J=[{icon:Send,label:"Enviar Notificación",onClick:e=>{u&&(D(`Estimado residente,\n\nLe informamos que tiene una cuota pendiente con fecha de vencimiento ${new Date(u.dueDate).toLocaleDateString("es-ES")} por un monto de S/.${u.amount.toFixed(2)}.\n\nPor favor, realice el pago lo antes posible para evitar recargos adicionales.\n\nAtentamente,\nAdministración`),C(!0))}},{icon:CreditCard,label:"Registrar Pago",onClick:e=>(e=>{B(`/payments/${e.feeId}/register?companyId=${h}&condoId=${y}&buildingId=${E}&departmentId=${e.departmentId}`)})(e)}],X=t.map(e=>({value:e.companyId,label:e.name})),Z=r.map(e=>({value:e.condoId,label:e.name})),Q=n.map(e=>({value:e.buildingId,label:e.name||`Edificio ${e.buildingId}`})),ee=o.map(e=>({value:e.departmentId,label:e.departmentNumber||`Departamento ${e.departmentId}`}));return jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6 p-6",children:[jsxRuntimeExports.jsx("div",{className:"flex justify-between items-center mb-6",children:jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Morosidad"}),jsxRuntimeExports.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Gestione las cuotas vencidas y morosas de los departamentos"})]})}),jsxRuntimeExports.jsx(Expandex,{title:"Filtros de búsqueda",initialExpanded:!0,expandIcon:Filter,backgroundColor:"#f9fafb",className:"mb-6",children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(SelectUI$1,{id:"company",label:"Empresa",value:h,onChange:V()?()=>{}:e=>__async(this,null,function*(){const t=Number(e);g(t),v(-1),f(-1),j(-1),i([]),l([]),d([]),-1!==t?yield z(t):s([])}),icon:Building,options:X,placeholder:"Seleccione una empresa",required:!0,includeAll:!0,disabled:V()||R})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(SelectUI$1,{id:"condominium",label:"Condominio",value:y,onChange:V()?()=>{}:e=>__async(this,null,function*(){const t=Number(e);v(t),f(-1),j(-1),l([]),d([]),-1!==t?yield H(t):i([])}),icon:Building2,options:Z,placeholder:"Seleccione un condominio",required:!0,includeAll:!0,disabled:V()||-1===h})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(SelectUI$1,{id:"building",label:"Edificio",value:E,onChange:e=>__async(this,null,function*(){const t=Number(e);f(t),j(-1),d([]),-1!==t?yield G(t):l([])}),icon:Building2,options:Q,placeholder:"Seleccione un edificio",required:!0,includeAll:!0,disabled:-1===y})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(SelectUI$1,{id:"department",label:"Departamento",value:b,onChange:e=>{const t=Number(e);j(t),-1!==t?q(t):d([])},icon:Home,options:ee,placeholder:"Seleccione un departamento",required:!0,includeAll:!0,disabled:-1===E})})]})}),A&&jsxRuntimeExports.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-6",children:A}),c.length>0&&jsxRuntimeExports.jsx("div",{className:"bg-red-50 border border-red-100 rounded-lg p-4 mb-6",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start",children:[jsxRuntimeExports.jsx(AlertCircle,{className:"w-6 h-6 text-red-600 mr-3 flex-shrink-0 mt-0.5"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-red-800",children:"Resumen de morosidad"}),jsxRuntimeExports.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-3 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-white p-3 rounded-md shadow-sm",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500",children:"Total cuotas vencidas"}),jsxRuntimeExports.jsx("p",{className:"text-lg font-semibold text-red-700",children:c.length})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white p-3 rounded-md shadow-sm",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500",children:"Monto total pendiente"}),jsxRuntimeExports.jsxs("p",{className:"text-lg font-semibold text-red-700",children:["S/.",c.reduce((e,t)=>e+t.amount,0).toFixed(2)]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white p-3 rounded-md shadow-sm",children:[jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500",children:"Cuota más antigua"}),jsxRuntimeExports.jsx("p",{className:"text-lg font-semibold text-red-700",children:c.length>0?new Date(c[0].dueDate).toLocaleDateString("es-ES"):"-"})]})]})]})]})}),jsxRuntimeExports.jsx(DataGrid,{data:c,columns:Y,actions:J}),jsxRuntimeExports.jsx(ModalUI,{isOpen:N,onClose:K,title:"Enviar notificación de morosidad",footer:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ButtonUI,{icon:X$1,title:"Cancelar",onClick:K,theme:"modalCancel"}),jsxRuntimeExports.jsx(ButtonUI,{icon:Send,title:"Enviar Notificación",onClick:()=>__async(this,null,function*(){try{e(!0),setTimeout(()=>{U("success","Notificación enviada correctamente"),K()},1e3)}catch(t){U("error","Error al enviar la notificación")}finally{e(!1)}}),theme:"modalSave"})]}),children:jsxRuntimeExports.jsx("div",{className:"space-y-4 p-4",children:jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 gap-4",children:jsxRuntimeExports.jsx("textarea",{value:T,onChange:e=>D(e.target.value),className:"w-full h-60 border border-gray-300 rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-emerald-500",placeholder:"Escriba el mensaje de notificación..."})})})})]})}const TimePickerUI=({id:e,label:t,value:a,onChange:r,icon:s=Clock,required:n=!1,disabled:i=!1,placeholder:o="Seleccione una hora",error:l,minuteStep:c=15})=>{const[d,u]=reactExports.useState(!1),[m,p]=reactExports.useState("08"),[x,h]=reactExports.useState("00"),[g,y]=reactExports.useState("08"),[v,E]=reactExports.useState("00"),f=reactExports.useRef(null),b=reactExports.useRef(null),j={borderColor:l?"var(--color-error-main)":"var(--color-border-light)","--focus-border-color":l?"var(--color-error-main)":"var(--color-primary-admin)","--focus-ring-color":l?"rgba(239, 68, 68, 0.2)":"rgba(98, 158, 62, 0.2)"};reactExports.useEffect(()=>{if(a&&a.includes(":")){const[e,t]=a.split(":"),r=e.padStart(2,"0"),s=t.padStart(2,"0");p(r),h(s),y(r),E(s)}},[a]),reactExports.useEffect(()=>{d&&(y(m),E(x))},[d,m,x]),reactExports.useEffect(()=>{const e=e=>{f.current&&!f.current.contains(e.target)&&b.current&&!b.current.contains(e.target)&&u(!1)};if(d)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[d]);const R=Array.from({length:24},(e,t)=>t.toString().padStart(2,"0")),I=Array.from({length:60/c},(e,t)=>(t*c).toString().padStart(2,"0")),S=(e,t,a)=>{a&&a.stopPropagation(),void 0!==e&&y(e),void 0!==t&&E(t)},_=a||`${m}:${x}`;return jsxRuntimeExports.jsxs("div",{className:"space-y-1 relative",children:[jsxRuntimeExports.jsxs("label",{htmlFor:e,className:"block text-sm font-medium",style:{color:"var(--color-text-primary)"},children:[t,n&&jsxRuntimeExports.jsx("span",{className:"ml-1",style:{color:"var(--color-error-main)"},children:"*"})]}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsxs("button",{ref:b,type:"button",id:e,onClick:()=>!i&&u(!d),disabled:i,className:`relative w-full rounded-md py-2 ${s?"pl-10":"pl-3"} pr-10 text-left border \n            ${i?"cursor-not-allowed":"cursor-pointer"}\n            sm:text-sm transition-colors duration-200 focus:outline-none focus:ring-2`,style:__spreadValues({backgroundColor:i?"var(--color-surface-disabled)":"var(--color-surface-input)",color:i?"var(--color-text-muted)":l?"var(--color-error-main)":"var(--color-text-primary)"},i?{borderColor:"var(--color-border-light)"}:j),onMouseEnter:e=>{i||l||(e.currentTarget.style.borderColor="var(--color-primary-admin)")},onMouseLeave:e=>{i||l||(e.currentTarget.style.borderColor="var(--color-border-light)")},children:[s&&jsxRuntimeExports.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:jsxRuntimeExports.jsx(s,{className:"h-5 w-5",style:{color:l?"var(--color-error-main)":"var(--color-text-muted)"}})}),jsxRuntimeExports.jsx("span",{style:{color:_?"var(--color-text-primary)":"var(--color-text-muted)"},children:_||o}),jsxRuntimeExports.jsx("div",{className:"absolute inset-y-0 right-0 pr-2 flex items-center pointer-events-none",children:jsxRuntimeExports.jsx(ChevronDown,{className:"h-4 w-4 transition-transform duration-200 "+(d?"rotate-180":""),style:{color:"var(--color-text-muted)"}})})]}),d&&jsxRuntimeExports.jsx("div",{ref:f,onClick:e=>e.stopPropagation(),className:"absolute z-50 mt-1 w-full rounded-md shadow-lg",style:{backgroundColor:"var(--color-surface-modal)",borderColor:"var(--color-border-light)",borderWidth:"1px",borderStyle:"solid"},children:jsxRuntimeExports.jsxs("div",{className:"p-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex space-x-1 mb-3",children:[jsxRuntimeExports.jsx("div",{className:"text-center text-sm font-medium flex-1",style:{color:"var(--color-text-secondary)"},children:"Horas"}),jsxRuntimeExports.jsx("div",{className:"text-center text-sm font-medium flex-1",style:{color:"var(--color-text-secondary)"},children:"Minutos"})]}),jsxRuntimeExports.jsxs("div",{className:"flex space-x-1",children:[jsxRuntimeExports.jsx("div",{className:"flex-1 max-h-48 overflow-y-auto rounded",style:{borderColor:"var(--color-border-light)",borderWidth:"1px",borderStyle:"solid"},children:R.map(e=>jsxRuntimeExports.jsx("button",{type:"button",onClick:t=>S(e,void 0,t),className:"w-full px-3 py-2 text-sm text-left transition-colors",style:{backgroundColor:g===e?"var(--color-primary-admin)":"transparent",color:g===e?"white":"var(--color-text-primary)"},onMouseEnter:t=>{g!==e&&(t.currentTarget.style.backgroundColor="var(--color-surface-hover)")},onMouseLeave:t=>{t.currentTarget.style.backgroundColor=g!==e?"transparent":"var(--color-primary-admin)"},children:e},e))}),jsxRuntimeExports.jsx("div",{className:"flex-1 max-h-48 overflow-y-auto rounded",style:{borderColor:"var(--color-border-light)",borderWidth:"1px",borderStyle:"solid"},children:I.map(e=>jsxRuntimeExports.jsx("button",{type:"button",onClick:t=>S(void 0,e,t),className:"w-full px-3 py-2 text-sm text-left transition-colors",style:{backgroundColor:v===e?"var(--color-primary-admin)":"transparent",color:v===e?"white":"var(--color-text-primary)"},onMouseEnter:t=>{v!==e&&(t.currentTarget.style.backgroundColor="var(--color-surface-hover)")},onMouseLeave:t=>{t.currentTarget.style.backgroundColor=v!==e?"transparent":"var(--color-primary-admin)"},children:e},e))})]}),jsxRuntimeExports.jsxs("div",{className:"mt-3 flex justify-end space-x-2",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:e=>{e.stopPropagation(),y(m),E(x),u(!1)},className:"px-3 py-1 text-sm transition-colors",style:{color:"var(--color-text-secondary)"},onMouseEnter:e=>{e.currentTarget.style.color="var(--color-text-primary)"},onMouseLeave:e=>{e.currentTarget.style.color="var(--color-text-secondary)"},children:"Cancelar"}),jsxRuntimeExports.jsxs("button",{type:"button",onClick:e=>{e.stopPropagation();const t=`${g}:${v}`;p(g),h(v),r(t),u(!1)},className:"flex items-center space-x-1 px-3 py-1 rounded text-sm transition-colors",style:{backgroundColor:"var(--color-primary-admin)",color:"white"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="var(--color-primary-admin-dark)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="var(--color-primary-admin)"},children:[jsxRuntimeExports.jsx(Check,{className:"w-3 h-3"}),jsxRuntimeExports.jsx("span",{children:"Aplicar"})]})]})]})})]}),l&&jsxRuntimeExports.jsx("p",{className:"mt-1 text-sm",style:{color:"var(--color-error-main)"},children:l})]})};var n$2,l$3,u$4,t$3,i$3,r$3,o$3,e$3,f$3,c$2,s$2,a$2,h$3,p$3={},v$2=[],y$3=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,w$3=Array.isArray;function d$3(e,t){for(var a in t)e[a]=t[a];return e}function g$3(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function _$2(e,t,a){var r,s,n,i={};for(n in t)"key"==n?r=t[n]:"ref"==n?s=t[n]:i[n]=t[n];if(arguments.length>2&&(i.children=arguments.length>3?n$2.call(arguments,2):a),"function"==typeof e&&null!=e.defaultProps)for(n in e.defaultProps)void 0===i[n]&&(i[n]=e.defaultProps[n]);return m$2(e,i,r,s,null)}function m$2(e,t,a,r,s){var n={type:e,props:t,key:a,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:null==s?++u$4:s,__i:-1,__u:0};return null==s&&null!=l$3.vnode&&l$3.vnode(n),n}function k$2(e){return e.children}function x$1(e,t){this.props=e,this.context=t}function S(e,t){if(null==t)return e.__?S(e.__,e.__i+1):null;for(var a;t<e.__k.length;t++)if(null!=(a=e.__k[t])&&null!=a.__e)return a.__e;return"function"==typeof e.type?S(e):null}function C$1(e){var t,a;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(a=e.__k[t])&&null!=a.__e){e.__e=e.__c.base=a.__e;break}return C$1(e)}}function M(e){(!e.__d&&(e.__d=!0)&&i$3.push(e)&&!$$1.__r++||r$3!=l$3.debounceRendering)&&((r$3=l$3.debounceRendering)||o$3)($$1)}function $$1(){for(var e,t,a,r,s,n,i,o=1;i$3.length;)i$3.length>o&&i$3.sort(e$3),e=i$3.shift(),o=i$3.length,e.__d&&(a=void 0,s=(r=(t=e).__v).__e,n=[],i=[],t.__P&&((a=d$3({},r)).__v=r.__v+1,l$3.vnode&&l$3.vnode(a),O(t.__P,a,r,t.__n,t.__P.namespaceURI,32&r.__u?[s]:null,n,null==s?S(r):s,!!(32&r.__u),i),a.__v=r.__v,a.__.__k[a.__i]=a,z$1(n,a,i),a.__e!=s&&C$1(a)));$$1.__r=0}function I(e,t,a,r,s,n,i,o,l,c,d){var u,m,p,x,h,g,y=r&&r.__k||v$2,v=t.length;for(l=P$1(a,t,y,l,v),u=0;u<v;u++)null!=(p=a.__k[u])&&(m=-1==p.__i?p$3:y[p.__i]||p$3,p.__i=u,g=O(e,p,m,s,n,i,o,l,c,d),x=p.__e,p.ref&&m.ref!=p.ref&&(m.ref&&q$2(m.ref,null,p),d.push(p.ref,p.__c||x,p)),null==h&&null!=x&&(h=x),4&p.__u||m.__k===p.__k?l=A$2(p,l,e):"function"==typeof p.type&&void 0!==g?l=g:x&&(l=x.nextSibling),p.__u&=-7);return a.__e=h,l}function P$1(e,t,a,r,s){var n,i,o,l,c,d=a.length,u=d,m=0;for(e.__k=new Array(s),n=0;n<s;n++)null!=(i=t[n])&&"boolean"!=typeof i&&"function"!=typeof i?(l=n+m,(i=e.__k[n]="string"==typeof i||"number"==typeof i||"bigint"==typeof i||i.constructor==String?m$2(null,i,null,null,null):w$3(i)?m$2(k$2,{children:i},null,null,null):null==i.constructor&&i.__b>0?m$2(i.type,i.props,i.key,i.ref?i.ref:null,i.__v):i).__=e,i.__b=e.__b+1,o=null,-1!=(c=i.__i=L(i,a,l,u))&&(u--,(o=a[c])&&(o.__u|=2)),null==o||null==o.__v?(-1==c&&(s>d?m--:s<d&&m++),"function"!=typeof i.type&&(i.__u|=4)):c!=l&&(c==l-1?m--:c==l+1?m++:(c>l?m--:m++,i.__u|=4))):e.__k[n]=null;if(u)for(n=0;n<d;n++)null!=(o=a[n])&&!(2&o.__u)&&(o.__e==r&&(r=S(o)),B$2(o,o));return r}function A$2(e,t,a){var r,s;if("function"==typeof e.type){for(r=e.__k,s=0;r&&s<r.length;s++)r[s]&&(r[s].__=e,t=A$2(r[s],t,a));return t}e.__e!=t&&(t&&e.type&&!a.contains(t)&&(t=S(e)),a.insertBefore(e.__e,t||null),t=e.__e);do{t=t&&t.nextSibling}while(null!=t&&8==t.nodeType);return t}function H$1(e,t){return t=t||[],null==e||"boolean"==typeof e||(w$3(e)?e.some(function(e){H$1(e,t)}):t.push(e)),t}function L(e,t,a,r){var s,n,i=e.key,o=e.type,l=t[a];if(null===l&&null==e.key||l&&i==l.key&&o==l.type&&!(2&l.__u))return a;if(r>(null==l||2&l.__u?0:1))for(s=a-1,n=a+1;s>=0||n<t.length;){if(s>=0){if((l=t[s])&&!(2&l.__u)&&i==l.key&&o==l.type)return s;s--}if(n<t.length){if((l=t[n])&&!(2&l.__u)&&i==l.key&&o==l.type)return n;n++}}return-1}function T$3(e,t,a){"-"==t[0]?e.setProperty(t,null==a?"":a):e[t]=null==a?"":"number"!=typeof a||y$3.test(t)?a:a+"px"}function j$2(e,t,a,r,s){var n,i;e:if("style"==t)if("string"==typeof a)e.style.cssText=a;else{if("string"==typeof r&&(e.style.cssText=r=""),r)for(t in r)a&&t in a||T$3(e.style,t,"");if(a)for(t in a)r&&a[t]==r[t]||T$3(e.style,t,a[t])}else if("o"==t[0]&&"n"==t[1])n=t!=(t=t.replace(f$3,"$1")),i=t.toLowerCase(),t=i in e||"onFocusOut"==t||"onFocusIn"==t?i.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+n]=a,a?r?a.u=r.u:(a.u=c$2,e.addEventListener(t,n?a$2:s$2,n)):e.removeEventListener(t,n?a$2:s$2,n);else{if("http://www.w3.org/2000/svg"==s)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!=t&&"height"!=t&&"href"!=t&&"list"!=t&&"form"!=t&&"tabIndex"!=t&&"download"!=t&&"rowSpan"!=t&&"colSpan"!=t&&"role"!=t&&"popover"!=t&&t in e)try{e[t]=null==a?"":a;break e}catch(o){}"function"==typeof a||(null==a||!1===a&&"-"!=t[4]?e.removeAttribute(t):e.setAttribute(t,"popover"==t&&1==a?"":a))}}function F$2(e){return function(t){if(this.l){var a=this.l[t.type+e];if(null==t.t)t.t=c$2++;else if(t.t<a.u)return;return a(l$3.event?l$3.event(t):t)}}}function O(e,t,a,r,s,n,i,o,l,c){var d,u,m,p,x,h,g,y,v,E,f,b,j,R,S,_,N,C=t.type;if(null!=t.constructor)return null;128&a.__u&&(l=!!(32&a.__u),n=[o=t.__e=a.__e]),(d=l$3.__b)&&d(t);e:if("function"==typeof C)try{if(y=t.props,v="prototype"in C&&C.prototype.render,E=(d=C.contextType)&&r[d.__c],f=d?E?E.props.value:d.__:r,a.__c?g=(u=t.__c=a.__c).__=u.__E:(v?t.__c=u=new C(y,f):(t.__c=u=new x$1(y,f),u.constructor=C,u.render=D$1),E&&E.sub(u),u.props=y,u.state||(u.state={}),u.context=f,u.__n=r,m=u.__d=!0,u.__h=[],u._sb=[]),v&&null==u.__s&&(u.__s=u.state),v&&null!=C.getDerivedStateFromProps&&(u.__s==u.state&&(u.__s=d$3({},u.__s)),d$3(u.__s,C.getDerivedStateFromProps(y,u.__s))),p=u.props,x=u.state,u.__v=t,m)v&&null==C.getDerivedStateFromProps&&null!=u.componentWillMount&&u.componentWillMount(),v&&null!=u.componentDidMount&&u.__h.push(u.componentDidMount);else{if(v&&null==C.getDerivedStateFromProps&&y!==p&&null!=u.componentWillReceiveProps&&u.componentWillReceiveProps(y,f),!u.__e&&null!=u.shouldComponentUpdate&&!1===u.shouldComponentUpdate(y,u.__s,f)||t.__v==a.__v){for(t.__v!=a.__v&&(u.props=y,u.state=u.__s,u.__d=!1),t.__e=a.__e,t.__k=a.__k,t.__k.some(function(e){e&&(e.__=t)}),b=0;b<u._sb.length;b++)u.__h.push(u._sb[b]);u._sb=[],u.__h.length&&i.push(u);break e}null!=u.componentWillUpdate&&u.componentWillUpdate(y,u.__s,f),v&&null!=u.componentDidUpdate&&u.__h.push(function(){u.componentDidUpdate(p,x,h)})}if(u.context=f,u.props=y,u.__P=e,u.__e=!1,j=l$3.__r,R=0,v){for(u.state=u.__s,u.__d=!1,j&&j(t),d=u.render(u.props,u.state,u.context),S=0;S<u._sb.length;S++)u.__h.push(u._sb[S]);u._sb=[]}else do{u.__d=!1,j&&j(t),d=u.render(u.props,u.state,u.context),u.state=u.__s}while(u.__d&&++R<25);u.state=u.__s,null!=u.getChildContext&&(r=d$3(d$3({},r),u.getChildContext())),v&&!m&&null!=u.getSnapshotBeforeUpdate&&(h=u.getSnapshotBeforeUpdate(p,x)),_=d,null!=d&&d.type===k$2&&null==d.key&&(_=N$1(d.props.children)),o=I(e,w$3(_)?_:[_],t,a,r,s,n,i,o,l,c),u.base=t.__e,t.__u&=-161,u.__h.length&&i.push(u),g&&(u.__E=u.__=null)}catch(T){if(t.__v=null,l||null!=n)if(T.then){for(t.__u|=l?160:128;o&&8==o.nodeType&&o.nextSibling;)o=o.nextSibling;n[n.indexOf(o)]=null,t.__e=o}else for(N=n.length;N--;)g$3(n[N]);else t.__e=a.__e,t.__k=a.__k;l$3.__e(T,t,a)}else null==n&&t.__v==a.__v?(t.__k=a.__k,t.__e=a.__e):o=t.__e=V$1(a.__e,t,a,r,s,n,i,l,c);return(d=l$3.diffed)&&d(t),128&t.__u?void 0:o}function z$1(e,t,a){for(var r=0;r<a.length;r++)q$2(a[r],a[++r],a[++r]);l$3.__c&&l$3.__c(t,e),e.some(function(t){try{e=t.__h,t.__h=[],e.some(function(e){e.call(t)})}catch(a){l$3.__e(a,t.__v)}})}function N$1(e){return"object"!=typeof e||null==e||e.__b&&e.__b>0?e:w$3(e)?e.map(N$1):d$3({},e)}function V$1(e,t,a,r,s,n,i,o,l){var c,d,u,m,p,x,h,g=a.props,y=t.props,v=t.type;if("svg"==v?s="http://www.w3.org/2000/svg":"math"==v?s="http://www.w3.org/1998/Math/MathML":s||(s="http://www.w3.org/1999/xhtml"),null!=n)for(c=0;c<n.length;c++)if((p=n[c])&&"setAttribute"in p==!!v&&(v?p.localName==v:3==p.nodeType)){e=p,n[c]=null;break}if(null==e){if(null==v)return document.createTextNode(y);e=document.createElementNS(s,v,y.is&&y),o&&(l$3.__m&&l$3.__m(t,n),o=!1),n=null}if(null==v)g===y||o&&e.data==y||(e.data=y);else{if(n=n&&n$2.call(e.childNodes),g=a.props||p$3,!o&&null!=n)for(g={},c=0;c<e.attributes.length;c++)g[(p=e.attributes[c]).name]=p.value;for(c in g)if(p=g[c],"children"==c);else if("dangerouslySetInnerHTML"==c)u=p;else if(!(c in y)){if("value"==c&&"defaultValue"in y||"checked"==c&&"defaultChecked"in y)continue;j$2(e,c,null,p,s)}for(c in y)p=y[c],"children"==c?m=p:"dangerouslySetInnerHTML"==c?d=p:"value"==c?x=p:"checked"==c?h=p:o&&"function"!=typeof p||g[c]===p||j$2(e,c,p,g[c],s);if(d)o||u&&(d.__html==u.__html||d.__html==e.innerHTML)||(e.innerHTML=d.__html),t.__k=[];else if(u&&(e.innerHTML=""),I("template"==t.type?e.content:e,w$3(m)?m:[m],t,a,r,"foreignObject"==v?"http://www.w3.org/1999/xhtml":s,n,i,n?n[0]:a.__k&&S(a,0),o,l),null!=n)for(c=n.length;c--;)g$3(n[c]);o||(c="value","progress"==v&&null==x?e.removeAttribute("value"):null!=x&&(x!==e[c]||"progress"==v&&!x||"option"==v&&x!=g[c])&&j$2(e,c,x,g[c],s),c="checked",null!=h&&h!=e[c]&&j$2(e,c,h,g[c],s))}return e}function q$2(e,t,a){try{if("function"==typeof e){var r="function"==typeof e.__u;r&&e.__u(),r&&null==t||(e.__u=e(t))}else e.current=t}catch(s){l$3.__e(s,a)}}function B$2(e,t,a){var r,s;if(l$3.unmount&&l$3.unmount(e),(r=e.ref)&&(r.current&&r.current!=e.__e||q$2(r,null,t)),null!=(r=e.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(n){l$3.__e(n,t)}r.base=r.__P=null}if(r=e.__k)for(s=0;s<r.length;s++)r[s]&&B$2(r[s],t,a||"function"!=typeof e.type);a||g$3(e.__e),e.__c=e.__=e.__e=void 0}function D$1(e,t,a){return this.constructor(e,a)}function E$2(e,t,a){var r,s,n;t==document&&(t=document.documentElement),l$3.__&&l$3.__(e,t),r=!1?null:t.__k,s=[],n=[],O(t,e=t.__k=_$2(k$2,null,[e]),r||p$3,p$3,t.namespaceURI,r?null:t.firstChild?n$2.call(t.childNodes):null,s,r?r.__e:t.firstChild,false,n),z$1(s,e,n)}function K$1(e){function t(e){var a,r;return this.getChildContext||(a=new Set,(r={})[t.__c]=this,this.getChildContext=function(){return r},this.componentWillUnmount=function(){a=null},this.shouldComponentUpdate=function(e){this.props.value!=e.value&&a.forEach(function(e){e.__e=!0,M(e)})},this.sub=function(e){a.add(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){a&&a.delete(e),t&&t.call(e)}}),e.children}return t.__c="__cC"+h$3++,t.__=e,t.Provider=t.__l=(t.Consumer=function(e,t){return e.children(t)}).contextType=t,t}n$2=v$2.slice,l$3={__e:function(e,t,a,r){for(var s,n,i;t=t.__;)if((s=t.__c)&&!s.__)try{if((n=s.constructor)&&null!=n.getDerivedStateFromError&&(s.setState(n.getDerivedStateFromError(e)),i=s.__d),null!=s.componentDidCatch&&(s.componentDidCatch(e,r||{}),i=s.__d),i)return s.__E=s}catch(o){e=o}throw e}},u$4=0,t$3=function(e){return null!=e&&null==e.constructor},x$1.prototype.setState=function(e,t){var a;a=null!=this.__s&&this.__s!=this.state?this.__s:this.__s=d$3({},this.state),"function"==typeof e&&(e=e(d$3({},a),this.props)),e&&d$3(a,e),null!=e&&this.__v&&(t&&this._sb.push(t),M(this))},x$1.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),M(this))},x$1.prototype.render=k$2,i$3=[],o$3="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,e$3=function(e,t){return e.__v.__b-t.__v.__b},$$1.__r=0,f$3=/(PointerCapture)$|Capture$/i,c$2=0,s$2=F$2(!1),a$2=F$2(!0),h$3=0;var f$2=0;function u$3(e,t,a,r,s,n){t||(t={});var i,o,l=t;if("ref"in l)for(o in l={},t)"ref"==o?i=t[o]:l[o]=t[o];var c={type:e,props:l,key:a,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--f$2,__i:-1,__u:0,__source:s,__self:n};if("function"==typeof e&&(i=e.defaultProps))for(o in i)void 0===l[o]&&(l[o]=i[o]);return l$3.vnode&&l$3.vnode(c),c}var t$2,r$2,u$2,i$2,o$2=0,f$1=[],c$1=l$3,e$2=c$1.__b,a$1=c$1.__r,v$1=c$1.diffed,l$2=c$1.__c,m$1=c$1.unmount,s$1=c$1.__;function p$2(e,t){c$1.__h&&c$1.__h(r$2,e,o$2||t),o$2=0;var a=r$2.__H||(r$2.__H={__:[],__h:[]});return e>=a.__.length&&a.__.push({}),a.__[e]}function d$2(e){return o$2=1,h$2(D,e)}function h$2(e,t,a){var r=p$2(t$2++,2);if(r.t=e,!r.__c&&(r.__=[a?a(t):D(void 0,t),function(e){var t=r.__N?r.__N[0]:r.__[0],a=r.t(t,e);t!==a&&(r.__N=[a,r.__[1]],r.__c.setState({}))}],r.__c=r$2,!r$2.__f)){var s=function(e,t,a){if(!r.__c.__H)return!0;var s=r.__c.__H.__.filter(function(e){return!!e.__c});if(s.every(function(e){return!e.__N}))return!n||n.call(this,e,t,a);var i=r.__c.props!==e;return s.forEach(function(e){if(e.__N){var t=e.__[0];e.__=e.__N,e.__N=void 0,t!==e.__[0]&&(i=!0)}}),n&&n.call(this,e,t,a)||i};r$2.__f=!0;var n=r$2.shouldComponentUpdate,i=r$2.componentWillUpdate;r$2.componentWillUpdate=function(e,t,a){if(this.__e){var r=n;n=void 0,s(e,t,a),n=r}i&&i.call(this,e,t,a)},r$2.shouldComponentUpdate=s}return r.__N||r.__}function y$2(e,t){var a=p$2(t$2++,3);!c$1.__s&&C(a.__H,t)&&(a.__=e,a.u=t,r$2.__H.__h.push(a))}function A$1(e){return o$2=5,T$2(function(){return{current:e}},[])}function T$2(e,t){var a=p$2(t$2++,7);return C(a.__H,t)&&(a.__=e(),a.__H=t,a.__h=e),a.__}function x(e){var t=r$2.context[e.__c],a=p$2(t$2++,9);return a.c=e,t?(null==a.__&&(a.__=!0,t.sub(r$2)),t.props.value):e.__}function j$1(){for(var e;e=f$1.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(z),e.__H.__h.forEach(B$1),e.__H.__h=[]}catch(t){e.__H.__h=[],c$1.__e(t,e.__v)}}c$1.__b=function(e){r$2=null,e$2&&e$2(e)},c$1.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),s$1&&s$1(e,t)},c$1.__r=function(e){a$1&&a$1(e),t$2=0;var t=(r$2=e.__c).__H;t&&(u$2===r$2?(t.__h=[],r$2.__h=[],t.__.forEach(function(e){e.__N&&(e.__=e.__N),e.u=e.__N=void 0})):(t.__h.forEach(z),t.__h.forEach(B$1),t.__h=[],t$2=0)),u$2=r$2},c$1.diffed=function(e){v$1&&v$1(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==f$1.push(t)&&i$2===c$1.requestAnimationFrame||((i$2=c$1.requestAnimationFrame)||w$2)(j$1)),t.__H.__.forEach(function(e){e.u&&(e.__H=e.u),e.u=void 0})),u$2=r$2=null},c$1.__c=function(e,t){t.some(function(e){try{e.__h.forEach(z),e.__h=e.__h.filter(function(e){return!e.__||B$1(e)})}catch(a){t.some(function(e){e.__h&&(e.__h=[])}),t=[],c$1.__e(a,e.__v)}}),l$2&&l$2(e,t)},c$1.unmount=function(e){m$1&&m$1(e);var t,a=e.__c;a&&a.__H&&(a.__H.__.forEach(function(e){try{z(e)}catch(a){t=a}}),a.__H=void 0,t&&c$1.__e(t,a.__v))};var k$1="function"==typeof requestAnimationFrame;function w$2(e){var t,a=function(){clearTimeout(r),k$1&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(a,35);k$1&&(t=requestAnimationFrame(a))}function z(e){var t=r$2,a=e.__c;"function"==typeof a&&(e.__c=void 0,a()),r$2=t}function B$1(e){var t=r$2;e.__c=e.__(),r$2=t}function C(e,t){return!e||e.length!==t.length||t.some(function(t,a){return t!==e[a]})}function D(e,t){return"function"==typeof t?t(e):t}function g$2(e,t){for(var a in t)e[a]=t[a];return e}function E$1(e,t){for(var a in e)if("__source"!==a&&!(a in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function N(e,t){this.props=e,this.context=t}(N.prototype=new x$1).isPureReactComponent=!0,N.prototype.shouldComponentUpdate=function(e,t){return E$1(this.props,e)||E$1(this.state,t)};var T$1=l$3.__b;l$3.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),T$1&&T$1(e)};var F$1=l$3.__e;l$3.__e=function(e,t,a,r){if(e.then)for(var s,n=t;n=n.__;)if((s=n.__c)&&s.__c)return null==t.__e&&(t.__e=a.__e,t.__k=a.__k),s.__c(e,t);F$1(e,t,a,r)};var U=l$3.unmount;function V(e,t,a){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach(function(e){"function"==typeof e.__c&&e.__c()}),e.__c.__H=null),null!=(e=g$2({},e)).__c&&(e.__c.__P===a&&(e.__c.__P=t),e.__c.__e=!0,e.__c=null),e.__k=e.__k&&e.__k.map(function(e){return V(e,t,a)})),e}function W(e,t,a){return e&&a&&(e.__v=null,e.__k=e.__k&&e.__k.map(function(e){return W(e,t,a)}),e.__c&&e.__c.__P===t&&(e.__e&&a.appendChild(e.__e),e.__c.__e=!0,e.__c.__P=a)),e}function P(){this.__u=0,this.o=null,this.__b=null}function j(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function B(){this.i=null,this.l=null}l$3.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&32&e.__u&&(e.type=null),U&&U(e)},(P.prototype=new x$1).__c=function(e,t){var a=t.__c,r=this;null==r.o&&(r.o=[]),r.o.push(a);var s=j(r.__v),n=!1,i=function(){n||(n=!0,a.__R=null,s?s(o):o())};a.__R=i;var o=function(){if(! --r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=W(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.o.pop();)t.forceUpdate()}};r.__u++||32&t.__u||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(i,i)},P.prototype.componentWillUnmount=function(){this.o=[]},P.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var a=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=V(this.__b,a,r.__O=r.__P)}this.__b=null}var s=t.__a&&_$2(k$2,null,e.fallback);return s&&(s.__u&=-33),[_$2(k$2,null,t.__a?null:e.children),s]};var H=function(e,t,a){if(++a[1]===a[0]&&e.l.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.l.size))for(a=e.i;a;){for(;a.length>3;)a.pop()();if(a[1]<a[0])break;e.i=a=a[2]}};function Z(e){return this.getChildContext=function(){return e.context},e.children}function Y(e){var t=this,a=e.h;if(t.componentWillUnmount=function(){E$2(null,t.v),t.v=null,t.h=null},t.h&&t.h!==a&&t.componentWillUnmount(),!t.v){for(var r=t.__v;null!==r&&!r.__m&&null!==r.__;)r=r.__;t.h=a,t.v={nodeType:1,parentNode:a,childNodes:[],__k:{__m:r.__m},contains:function(){return!0},insertBefore:function(e,a){this.childNodes.push(e),t.h.insertBefore(e,a)},removeChild:function(e){this.childNodes.splice(this.childNodes.indexOf(e)>>>1,1),t.h.removeChild(e)}}}E$2(_$2(Z,{context:t.context},e.__v),t.v)}function $(e,t){var a=_$2(Y,{__v:e,h:t});return a.containerInfo=t,a}(B.prototype=new x$1).__a=function(e){var t=this,a=j(t.__v),r=t.l.get(e);return r[0]++,function(s){var n=function(){t.props.revealOrder?(r.push(s),H(t,e,r)):s()};a?a(n):n()}},B.prototype.render=function(e){this.i=null,this.l=new Map;var t=H$1(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var a=t.length;a--;)this.l.set(t[a],this.i=[1,0,this.i]);return e.children},B.prototype.componentDidUpdate=B.prototype.componentDidMount=function(){var e=this;this.l.forEach(function(t,a){H(e,a,t)})};var q$1="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,G=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,J=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,K=/[A-Z0-9]/g,Q="undefined"!=typeof document,X=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/:/fil|che|ra/).test(e)};x$1.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(x$1.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var en=l$3.event;function rn(){}function un(){return this.cancelBubble}function on(){return this.defaultPrevented}l$3.event=function(e){return en&&(e=en(e)),e.persist=rn,e.isPropagationStopped=un,e.isDefaultPrevented=on,e.nativeEvent=e};var cn={enumerable:!1,configurable:!0,get:function(){return this.class}},fn=l$3.vnode;l$3.vnode=function(e){"string"==typeof e.type&&function(e){var t=e.props,a=e.type,r={},s=-1===a.indexOf("-");for(var n in t){var i=t[n];if(!("value"===n&&"defaultValue"in t&&null==i||Q&&"children"===n&&"noscript"===a||"class"===n||"className"===n)){var o=n.toLowerCase();"defaultValue"===n&&"value"in t&&null==t.value?n="value":"download"===n&&!0===i?i="":"translate"===o&&"no"===i?i=!1:"o"===o[0]&&"n"===o[1]?"ondoubleclick"===o?n="ondblclick":"onchange"!==o||"input"!==a&&"textarea"!==a||X(t.type)?"onfocus"===o?n="onfocusin":"onblur"===o?n="onfocusout":J.test(n)&&(n=o):o=n="oninput":s&&G.test(n)?n=n.replace(K,"-$&").toLowerCase():null===i&&(i=void 0),"oninput"===o&&r[n=o]&&(n="oninputCapture"),r[n]=i}}"select"==a&&r.multiple&&Array.isArray(r.value)&&(r.value=H$1(t.children).forEach(function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)})),"select"==a&&null!=r.defaultValue&&(r.value=H$1(t.children).forEach(function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value})),t.class&&!t.className?(r.class=t.class,Object.defineProperty(r,"className",cn)):(t.className&&!t.class||t.class&&t.className)&&(r.class=r.className=t.className),e.props=r}(e),e.$$typeof=q$1,fn&&fn(e)};var an=l$3.__r;l$3.__r=function(e){an&&an(e),e.__c};var sn=l$3.diffed;l$3.diffed=function(e){sn&&sn(e);var t=e.props,a=e.__e;null!=a&&"textarea"===e.type&&"value"in t&&t.value!==a.value&&(a.value=null==t.value?"":t.value)};var i$1=Symbol.for("preact-signals");function t$1(){if(s>1)s--;else{for(var e,t=!1;void 0!==h$1;){var a=h$1;for(h$1=void 0,f++;void 0!==a;){var r=a.o;if(a.o=void 0,a.f&=-3,!(8&a.f)&&c(a))try{a.c()}catch(n){t||(e=n,t=!0)}a=r}}if(f=0,s--,t)throw e}}function r$1(e){if(s>0)return e();s++;try{return e()}finally{t$1()}}var o$1=void 0;function n$1(e){var t=o$1;o$1=void 0;try{return e()}finally{o$1=t}}var h$1=void 0,s=0,f=0,v=0;function e$1(e){if(void 0!==o$1){var t=e.n;if(void 0===t||t.t!==o$1)return t={i:0,S:e,p:o$1.s,n:void 0,t:o$1,e:void 0,x:void 0,r:t},void 0!==o$1.s&&(o$1.s.n=t),o$1.s=t,e.n=t,32&o$1.f&&e.S(t),t;if(-1===t.i)return t.i=0,void 0!==t.n&&(t.n.p=t.p,void 0!==t.p&&(t.p.n=t.n),t.p=o$1.s,t.n=void 0,o$1.s.n=t,o$1.s=t),t}}function u$1(e,t){this.v=e,this.i=0,this.n=void 0,this.t=void 0,this.W=null==t?void 0:t.watched,this.Z=null==t?void 0:t.unwatched}function d$1(e,t){return new u$1(e,t)}function c(e){for(var t=e.s;void 0!==t;t=t.n)if(t.S.i!==t.i||!t.S.h()||t.S.i!==t.i)return!0;return!1}function a(e){for(var t=e.s;void 0!==t;t=t.n){var a=t.S.n;if(void 0!==a&&(t.r=a),t.S.n=t,t.i=-1,void 0===t.n){e.s=t;break}}}function l$1(e){for(var t=e.s,a=void 0;void 0!==t;){var r=t.p;-1===t.i?(t.S.U(t),void 0!==r&&(r.n=t.n),void 0!==t.n&&(t.n.p=r)):a=t,t.S.n=t.r,void 0!==t.r&&(t.r=void 0),t=r}e.s=a}function y$1(e,t){u$1.call(this,void 0),this.x=e,this.s=void 0,this.g=v-1,this.f=4,this.W=null==t?void 0:t.watched,this.Z=null==t?void 0:t.unwatched}function w$1(e,t){return new y$1(e,t)}function _$1(e){var t=e.u;if(e.u=void 0,"function"==typeof t){s++;var a=o$1;o$1=void 0;try{t()}catch(r){throw e.f&=-2,e.f|=8,b$1(e),r}finally{o$1=a,t$1()}}}function b$1(e){for(var t=e.s;void 0!==t;t=t.n)t.S.U(t);e.x=void 0,e.s=void 0,_$1(e)}function g$1(e){if(o$1!==this)throw new Error("Out-of-order effect");l$1(this),o$1=e,this.f&=-2,8&this.f&&b$1(this),t$1()}function p$1(e){this.x=e,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32}function E(e){var t=new p$1(e);try{t.c()}catch(r){throw t.d(),r}var a=t.d.bind(t);return a[Symbol.dispose]=a,a}u$1.prototype.brand=i$1,u$1.prototype.h=function(){return!0},u$1.prototype.S=function(e){var t=this,a=this.t;a!==e&&void 0===e.e&&(e.x=a,this.t=e,void 0!==a?a.e=e:n$1(function(){var e;null==(e=t.W)||e.call(t)}))},u$1.prototype.U=function(e){var t=this;if(void 0!==this.t){var a=e.e,r=e.x;void 0!==a&&(a.x=r,e.e=void 0),void 0!==r&&(r.e=a,e.x=void 0),e===this.t&&(this.t=r,void 0===r&&n$1(function(){var e;null==(e=t.Z)||e.call(t)}))}},u$1.prototype.subscribe=function(e){var t=this;return E(function(){var a=t.value,r=o$1;o$1=void 0;try{e(a)}finally{o$1=r}})},u$1.prototype.valueOf=function(){return this.value},u$1.prototype.toString=function(){return this.value+""},u$1.prototype.toJSON=function(){return this.value},u$1.prototype.peek=function(){var e=o$1;o$1=void 0;try{return this.value}finally{o$1=e}},Object.defineProperty(u$1.prototype,"value",{get:function(){var e=e$1(this);return void 0!==e&&(e.i=this.i),this.v},set:function(e){if(e!==this.v){if(f>100)throw new Error("Cycle detected");this.v=e,this.i++,v++,s++;try{for(var t=this.t;void 0!==t;t=t.x)t.t.N()}finally{t$1()}}}}),y$1.prototype=new u$1,y$1.prototype.h=function(){if(this.f&=-3,1&this.f)return!1;if(32==(36&this.f))return!0;if(this.f&=-5,this.g===v)return!0;if(this.g=v,this.f|=1,this.i>0&&!c(this))return this.f&=-2,!0;var e=o$1;try{a(this),o$1=this;var t=this.x();(16&this.f||this.v!==t||0===this.i)&&(this.v=t,this.f&=-17,this.i++)}catch(r){this.v=r,this.f|=16,this.i++}return o$1=e,l$1(this),this.f&=-2,!0},y$1.prototype.S=function(e){if(void 0===this.t){this.f|=36;for(var t=this.s;void 0!==t;t=t.n)t.S.S(t)}u$1.prototype.S.call(this,e)},y$1.prototype.U=function(e){if(void 0!==this.t&&(u$1.prototype.U.call(this,e),void 0===this.t)){this.f&=-33;for(var t=this.s;void 0!==t;t=t.n)t.S.U(t)}},y$1.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var e=this.t;void 0!==e;e=e.x)e.t.N()}},Object.defineProperty(y$1.prototype,"value",{get:function(){if(1&this.f)throw new Error("Cycle detected");var e=e$1(this);if(this.h(),void 0!==e&&(e.i=this.i),16&this.f)throw this.v;return this.v}}),p$1.prototype.c=function(){var e=this.S();try{if(8&this.f)return;if(void 0===this.x)return;var t=this.x();"function"==typeof t&&(this.u=t)}finally{e()}},p$1.prototype.S=function(){if(1&this.f)throw new Error("Cycle detected");this.f|=1,this.f&=-9,_$1(this),a(this),s++;var e=o$1;return o$1=this,g$1.bind(this,e)},p$1.prototype.N=function(){2&this.f||(this.f|=2,this.o=h$1,h$1=this)},p$1.prototype.d=function(){this.f|=8,1&this.f||b$1(this)},p$1.prototype.dispose=function(){this.d()};var h,l,d,p=[],m=[];function _(e,t){l$3[e]=t.bind(null,l$3[e]||function(){})}function g(e){d&&d(),d=e&&e.S()}function b(e){var t=this,a=e.data,r=useSignal(a);r.value=a;var s=T$2(function(){for(var e=t,a=t.__v;a=a.__;)if(a.__c){a.__c.__$f|=4;break}var s=w$1(function(){var e=r.value.value;return 0===e?0:!0===e?"":e||""}),n=w$1(function(){return!Array.isArray(s.value)&&!t$3(s.value)}),i=E(function(){if(this.N=T,n.value){var t=s.value;e.__v&&e.__v.__e&&3===e.__v.__e.nodeType&&(e.__v.__e.data=t)}}),o=t.__$u.d;return t.__$u.d=function(){i(),o.call(this)},[n,s]},[]),n=s[0],i=s[1];return n.value?i.peek():i.value}function y(e,t,a,r){var s=t in e&&void 0===e.ownerSVGElement,n=d$1(a);return{o:function(e,t){n.value=e,r=t},d:E(function(){this.N=T;var a=n.value.value;r[t]!==a&&(r[t]=a,s?e[t]=a:a?e.setAttribute(t,a):e.removeAttribute(t))})}}function useSignal(e,t){return T$2(function(){return d$1(e,t)},[])}function useComputed(e,t){var a=A$1(e);return a.current=e,l.__$f|=4,T$2(function(){return w$1(function(){return a.current()},t)},[])}E(function(){h=this.N})(),b.displayName="_st",Object.defineProperties(u$1.prototype,{constructor:{configurable:!0,value:void 0},type:{configurable:!0,value:b},props:{configurable:!0,get:function(){return{data:this}}},__b:{configurable:!0,value:1}}),_("__b",function(e,t){if("string"==typeof t.type){var a,r=t.props;for(var s in r)if("children"!==s){var n=r[s];n instanceof u$1&&(a||(t.__np=a={}),a[s]=n,r[s]=n.peek())}}e(t)}),_("__r",function(e,t){if(t.type!==k$2){g();var a,r=t.__c;r&&(r.__$f&=-2,void 0===(a=r.__$u)&&(r.__$u=(E(function(){s=this}),s.c=function(){r.__$f|=1,r.setState({})},a=s))),l=r,g(a)}var s;e(t)}),_("__e",function(e,t,a,r){g(),l=void 0,e(t,a,r)}),_("diffed",function(e,t){var a;if(g(),l=void 0,"string"==typeof t.type&&(a=t.__e)){var r=t.__np,s=t.props;if(r){var n=a.U;if(n)for(var i in n){var o=n[i];void 0===o||i in r||(o.d(),n[i]=void 0)}else n={},a.U=n;for(var c in r){var d=n[c],u=r[c];void 0===d?(d=y(a,c,u,s),n[c]=d):d.o(u,s)}}}e(t)}),_("unmount",function(e,t){if("string"==typeof t.type){var a=t.__e;if(a){var r=a.U;if(r)for(var s in a.U=void 0,r){var n=r[s];n&&n.d()}}}else{var i=t.__c;if(i){var o=i.__$u;o&&(i.__$u=void 0,o.d())}}e(t)}),_("__h",function(e,t,a,r){(r<3||9===r)&&(t.__$f|=2),e(t,a,r)}),x$1.prototype.shouldComponentUpdate=function(e,t){var a=this.__$u,r=a&&void 0!==a.s;for(var s in t)return!0;if(this.__f||"boolean"==typeof this.u&&!0===this.u){var n=2&this.__$f;if(!(r||n||4&this.__$f))return!0;if(1&this.__$f)return!0}else{if(!(r||4&this.__$f))return!0;if(3&this.__$f)return!0}for(var i in e)if("__source"!==i&&e[i]!==this.props[i])return!0;for(var o in this.props)if(!(o in e))return!0;return!1};var k="undefined"==typeof requestAnimationFrame?setTimeout:function(e){var t=function(){clearTimeout(a),cancelAnimationFrame(r),e()},a=setTimeout(t,35),r=requestAnimationFrame(t)},q=function(e){queueMicrotask(function(){queueMicrotask(e)})};function A(){r$1(function(){for(var e;e=p.shift();)h.call(e)})}function w(){1===p.push(this)&&(l$3.requestAnimationFrame||k)(A)}function F(){r$1(function(){for(var e;e=m.shift();)h.call(e)})}function T(){1===m.push(this)&&(l$3.requestAnimationFrame||q)(F)}function useSignalEffect(e){var t=A$1(e);t.current=e,y$2(function(){return E(function(){return this.N=w,t.current()})},[])}const AppContext$1=K$1({}),DateFormats={DATE_STRING:/^\d{4}-\d{2}-\d{2}$/,DATE_TIME_STRING:/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}$/};class InvalidDateTimeError extends Error{constructor(e){super(`Invalid date time specification: ${e}`)}}const toJSDate=e=>{if(!DateFormats.DATE_TIME_STRING.test(e)&&!DateFormats.DATE_STRING.test(e))throw new InvalidDateTimeError(e);return new Date(Number(e.slice(0,4)),Number(e.slice(5,7))-1,Number(e.slice(8,10)),Number(e.slice(11,13)),Number(e.slice(14,16)))},toIntegers=e=>{const t=e.slice(11,13),a=e.slice(14,16);return{year:Number(e.slice(0,4)),month:Number(e.slice(5,7))-1,date:Number(e.slice(8,10)),hours:""!==t?Number(t):void 0,minutes:""!==a?Number(a):void 0}},toLocalizedMonth=(e,t)=>e.toLocaleString(t,{month:"long"}),toLocalizedDateString=(e,t)=>e.toLocaleString(t,{month:"numeric",day:"numeric",year:"numeric"}),getOneLetterDayNames=(e,t)=>e.map(e=>e.toLocaleString(t,{weekday:"short"}).charAt(0)),getDayNameShort=(e,t)=>"he-IL"===t?e.toLocaleString(t,{weekday:"narrow"}):e.toLocaleString(t,{weekday:"short"}),getDayNamesShort=(e,t)=>e.map(e=>getDayNameShort(e,t)),getOneLetterOrShortDayNames=(e,t)=>["zh-cn","zh-tw","ca-es","he-il"].includes(t.toLowerCase())?getDayNamesShort(e,t):getOneLetterDayNames(e,t);var img="data:image/svg+xml,%3c%3fxml version='1.0' encoding='utf-8'%3f%3e%3c!-- Uploaded to: SVG Repo%2c www.svgrepo.com%2c Generator: SVG Repo Mixer Tools --%3e%3csvg width='800px' height='800px' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M6 9L12 15L18 9' stroke='%23DED8E1' stroke-width='4' stroke-linecap='round' stroke-linejoin='round'/%3e%3c/svg%3e";const randomStringId=()=>"s"+Math.random().toString(36).substring(2,11),isKeyEnterOrSpace=e=>"Enter"===e.key||" "===e.key;function AppInput(){const e=randomStringId(),t=randomStringId(),a=randomStringId(),r=x(AppContext$1);y$2(()=>{var e;r.datePickerState.inputDisplayedValue.value=""===(e=r.datePickerState.selectedDate.value)?r.translate("MM/DD/YYYY"):toLocalizedDateString(toJSDate(e),r.config.locale.value)},[r.datePickerState.selectedDate.value,r.config.locale.value]);const[s,n]=d$2([]);y$2(()=>{r.config.teleportTo&&(()=>{const e=document.getElementById(a);r.datePickerState.inputWrapperElement.value=e instanceof HTMLDivElement?e:void 0})();const e=["sx__date-input-wrapper"];r.datePickerState.isOpen.value&&e.push("sx__date-input--active"),n(e)},[r.datePickerState.isOpen.value]);const i=e=>{e.stopPropagation();try{r.datePickerState.inputDisplayedValue.value=e.target.value,r.datePickerState.close()}catch(t){}};y$2(()=>{const t=document.getElementById(e);if(null!==t)return t.addEventListener("change",i),()=>t.removeEventListener("change",i)});return u$3(k$2,{children:u$3("div",{className:s.join(" "),id:a,children:[u$3("label",{for:e,id:t,className:"sx__date-input-label",children:r.config.label||r.translate("Date")}),u$3("input",{id:e,tabIndex:r.datePickerState.isDisabled.value?-1:0,name:r.config.name||"date","aria-describedby":t,value:r.datePickerState.inputDisplayedValue.value,"data-testid":"date-picker-input",className:"sx__date-input",onClick:e=>{i(e),r.datePickerState.open()},onKeyUp:e=>{"Enter"===e.key&&i(e)},type:"text"}),u$3("button",{type:"button",tabIndex:r.datePickerState.isDisabled.value?-1:0,"aria-label":r.translate("Choose Date"),onKeyDown:e=>{isKeyEnterOrSpace(e)&&(e.preventDefault(),r.datePickerState.open(),setTimeout(()=>{const e=document.querySelector('[data-focus="true"]');e instanceof HTMLElement&&e.focus()},50))},onClick:()=>r.datePickerState.open(),className:"sx__date-input-chevron-wrapper",children:u$3("img",{className:"sx__date-input-chevron",src:img,alt:""})})]})})}var DatePickerView,DatePickerView2;DatePickerView2=DatePickerView||(DatePickerView={}),DatePickerView2.MONTH_DAYS="month-days",DatePickerView2.YEARS="years";const YEARS_VIEW="years-view",MONTH_VIEW="months-view",DATE_PICKER_WEEK="date-picker-week";class NumberRangeError extends Error{constructor(e,t){super(`Number must be between ${e} and ${t}.`),Object.defineProperty(this,"min",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"max",{enumerable:!0,configurable:!0,writable:!0,value:t})}}const doubleDigit=e=>{if(e<0||e>99)throw new NumberRangeError(0,99);return String(e).padStart(2,"0")},toDateString$1=e=>`${e.getFullYear()}-${doubleDigit(e.getMonth()+1)}-${doubleDigit(e.getDate())}`,toTimeString=e=>`${doubleDigit(e.getHours())}:${doubleDigit(e.getMinutes())}`,toDateTimeString=e=>`${toDateString$1(e)} ${toTimeString(e)}`,addMonths=(e,t)=>{const{year:a,month:r,date:s,hours:n,minutes:i}=toIntegers(e),o=void 0!==n&&void 0!==i,l=new Date(a,r,s,null!=n?n:0,null!=i?i:0);let c=(l.getMonth()+t)%12;return c<0&&(c+=12),l.setMonth(l.getMonth()+t),l.getMonth()>c?l.setDate(0):l.getMonth()<c&&(l.setMonth(l.getMonth()+1),l.setDate(0)),o?toDateTimeString(l):toDateString$1(l)},addDays=(e,t)=>{const{year:a,month:r,date:s,hours:n,minutes:i}=toIntegers(e),o=void 0!==n&&void 0!==i,l=new Date(a,r,s,null!=n?n:0,null!=i?i:0);return l.setDate(l.getDate()+t),o?toDateTimeString(l):toDateString$1(l)},dateFromDateTime=e=>e.slice(0,10),timeFromDateTime=e=>e.slice(11),setDateOfMonth=(e,t)=>e=e.slice(0,8)+doubleDigit(t)+e.slice(10),getFirstDayOPreviousMonth=e=>(e=addMonths(e,-1),setDateOfMonth(e,1)),getFirstDayOfNextMonth=e=>(e=addMonths(e,1),setDateOfMonth(e,1)),setTimeInDateTimeString=(e,t)=>`${toDateString$1(toJSDate(e))} ${t}`;function Chevron({direction:e,onClick:t,buttonText:a,disabled:r=!1}){return u$3("button",{type:"button",disabled:r,className:"sx__chevron-wrapper sx__ripple",onMouseUp:t,onKeyDown:e=>{isKeyEnterOrSpace(e)&&t()},tabIndex:0,children:u$3("i",{className:`sx__chevron sx__chevron--${e}`,children:a})})}function MonthViewHeader({setYearsView:e}){const t=x(AppContext$1),a=e=>{const a=toJSDate(e);return toLocalizedMonth(a,t.config.locale.value)},r=e=>toIntegers(e).year,[s,n]=d$2(a(t.datePickerState.datePickerDate.value)),[i,o]=d$2(r(t.datePickerState.datePickerDate.value));y$2(()=>{n(a(t.datePickerState.datePickerDate.value)),o(r(t.datePickerState.datePickerDate.value))},[t.datePickerState.datePickerDate.value]);return u$3(k$2,{children:u$3("header",{className:"sx__date-picker__month-view-header",children:[u$3(Chevron,{direction:"previous",onClick:()=>{t.datePickerState.datePickerDate.value=getFirstDayOPreviousMonth(t.datePickerState.datePickerDate.value)},buttonText:t.translate("Previous month")}),u$3("button",{type:"button",className:"sx__date-picker__month-view-header__month-year",onClick:t=>(t.stopPropagation(),void e()),children:s+" "+i}),u$3(Chevron,{direction:"next",onClick:()=>{t.datePickerState.datePickerDate.value=getFirstDayOfNextMonth(t.datePickerState.datePickerDate.value)},buttonText:t.translate("Next month")})]})})}function DayNames(){const e=x(AppContext$1),t=e.timeUnitsImpl.getWeekFor(toJSDate(e.datePickerState.datePickerDate.value));return u$3("div",{className:"sx__date-picker__day-names",children:getOneLetterOrShortDayNames(t,e.config.locale.value).map(e=>u$3("span",{"data-testid":"day-name",className:"sx__date-picker__day-name",children:e}))})}const isToday=e=>{const t=new Date;return e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()},isSameMonth=(e,t)=>e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear();function TimeIcon({strokeColor:e}){return u$3(k$2,{children:u$3("svg",{className:"sx__event-icon",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u$3("g",{id:"SVGRepo_bgCarrier","stroke-width":"0"}),u$3("g",{id:"SVGRepo_tracerCarrier","stroke-linecap":"round","stroke-linejoin":"round"}),u$3("g",{id:"SVGRepo_iconCarrier",children:[u$3("path",{d:"M12 8V12L15 15",stroke:e,"stroke-width":"2","stroke-linecap":"round"}),u$3("circle",{cx:"12",cy:"12",r:"9",stroke:e,"stroke-width":"2"})]})]})})}function UserIcon({strokeColor:e}){return u$3(k$2,{children:u$3("svg",{className:"sx__event-icon",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u$3("g",{id:"SVGRepo_bgCarrier","stroke-width":"0"}),u$3("g",{id:"SVGRepo_tracerCarrier","stroke-linecap":"round","stroke-linejoin":"round"}),u$3("g",{id:"SVGRepo_iconCarrier",children:[u$3("path",{d:"M15 7C15 8.65685 13.6569 10 12 10C10.3431 10 9 8.65685 9 7C9 5.34315 10.3431 4 12 4C13.6569 4 15 5.34315 15 7Z",stroke:e,"stroke-width":"2"}),u$3("path",{d:"M5 19.5C5 15.9101 7.91015 13 11.5 13H12.5C16.0899 13 19 15.9101 19 19.5V20C19 20.5523 18.5523 21 18 21H6C5.44772 21 5 20.5523 5 20V19.5Z",stroke:e,"stroke-width":"2"})]})]})})}function LocationPinIcon({strokeColor:e}){return u$3(k$2,{children:u$3("svg",{className:"sx__event-icon",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u$3("g",{id:"SVGRepo_bgCarrier","stroke-width":"0"}),u$3("g",{id:"SVGRepo_tracerCarrier","stroke-linecap":"round","stroke-linejoin":"round"}),u$3("g",{id:"SVGRepo_iconCarrier",children:[u$3("g",{"clip-path":"url(#clip0_429_11046)",children:[u$3("rect",{x:"12",y:"11",width:"0.01",height:"0.01",stroke:e,"stroke-width":"2","stroke-linejoin":"round"}),u$3("path",{d:"M12 22L17.5 16.5C20.5376 13.4624 20.5376 8.53757 17.5 5.5C14.4624 2.46244 9.53757 2.46244 6.5 5.5C3.46244 8.53757 3.46244 13.4624 6.5 16.5L12 22Z",stroke:e,"stroke-width":"2","stroke-linejoin":"round"})]}),u$3("defs",{children:u$3("clipPath",{id:"clip0_429_11046",children:u$3("rect",{width:"24",height:"24",fill:"white"})})})]})]})})}const timeStringRegex=/^(0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$/,dateTimeStringRegex=/^(\d{4})-(\d{2})-(\d{2}) (0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$/,dateStringRegex=/^(\d{4})-(\d{2})-(\d{2})$/;class InvalidTimeStringError extends Error{constructor(e){super(`Invalid time string: ${e}`)}}const minuteTimePointMultiplier=1.6666666666666667,timePointsFromString=e=>{if(!timeStringRegex.test(e)&&"24:00"!==e)throw new InvalidTimeStringError(e);const[t,a]=e.split(":").map(e=>parseInt(e,10));let r=(a*minuteTimePointMultiplier).toString();return r.split(".")[0].length<2&&(r=`0${r}`),Number(t+r)},timeStringFromTimePoints=e=>{const t=Math.floor(e/100),a=Math.round(e%100/minuteTimePointMultiplier);return`${doubleDigit(t)}:${doubleDigit(a)}`},addTimePointsToDateTime=(e,t)=>{const a=t/minuteTimePointMultiplier,r=toJSDate(e);return r.setMinutes(r.getMinutes()+a),toDateTimeString(r)};var WeekDay,WeekDay2;WeekDay2=WeekDay||(WeekDay={}),WeekDay2[WeekDay2.SUNDAY=0]="SUNDAY",WeekDay2[WeekDay2.MONDAY=1]="MONDAY",WeekDay2[WeekDay2.TUESDAY=2]="TUESDAY",WeekDay2[WeekDay2.WEDNESDAY=3]="WEDNESDAY",WeekDay2[WeekDay2.THURSDAY=4]="THURSDAY",WeekDay2[WeekDay2.FRIDAY=5]="FRIDAY",WeekDay2[WeekDay2.SATURDAY=6]="SATURDAY";const DEFAULT_LOCALE="en-US",DEFAULT_FIRST_DAY_OF_WEEK=WeekDay.MONDAY,DEFAULT_EVENT_COLOR_NAME="primary";class CalendarEventImpl{constructor(e,t,a,r,s,n,i,o,l,c=void 0,d={},u={}){Object.defineProperty(this,"_config",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"start",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"end",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"title",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"people",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"location",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"calendarId",{enumerable:!0,configurable:!0,writable:!0,value:l}),Object.defineProperty(this,"_options",{enumerable:!0,configurable:!0,writable:!0,value:c}),Object.defineProperty(this,"_customContent",{enumerable:!0,configurable:!0,writable:!0,value:d}),Object.defineProperty(this,"_foreignProperties",{enumerable:!0,configurable:!0,writable:!0,value:u}),Object.defineProperty(this,"_previousConcurrentEvents",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_totalConcurrentEvents",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_maxConcurrentEvents",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nDaysInGrid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_createdAt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_eventFragments",{enumerable:!0,configurable:!0,writable:!0,value:{}})}get _isSingleDayTimed(){return dateTimeStringRegex.test(this.start)&&dateTimeStringRegex.test(this.end)&&dateFromDateTime(this.start)===dateFromDateTime(this.end)}get _isSingleDayFullDay(){return dateStringRegex.test(this.start)&&dateStringRegex.test(this.end)&&this.start===this.end}get _isMultiDayTimed(){return dateTimeStringRegex.test(this.start)&&dateTimeStringRegex.test(this.end)&&dateFromDateTime(this.start)!==dateFromDateTime(this.end)}get _isMultiDayFullDay(){return dateStringRegex.test(this.start)&&dateStringRegex.test(this.end)&&this.start!==this.end}get _isSingleHybridDayTimed(){if(!this._config.isHybridDay)return!1;if(!dateTimeStringRegex.test(this.start)||!dateTimeStringRegex.test(this.end))return!1;const e=dateFromDateTime(this.start),t=dateFromDateTime(this.end),a=toDateString$1(new Date(toJSDate(t).getTime()-864e5));if(e!==t&&e!==a)return!1;const r=this._config.dayBoundaries.value,s=timePointsFromString(timeFromDateTime(this.start)),n=timePointsFromString(timeFromDateTime(this.end));return s>=r.start&&(n<=r.end||n>s)||s<r.end&&n<=r.end}get _color(){return this.calendarId&&this._config.calendars.value&&this.calendarId in this._config.calendars.value?this._config.calendars.value[this.calendarId].colorName:DEFAULT_EVENT_COLOR_NAME}_getForeignProperties(){return this._foreignProperties}_getExternalEvent(){return __spreadValues({id:this.id,start:this.start,end:this.end,title:this.title,people:this.people,location:this.location,description:this.description,calendarId:this.calendarId,_options:this._options},this._getForeignProperties())}}class CalendarEventBuilder{constructor(e,t,a,r){Object.defineProperty(this,"_config",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"start",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"end",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"people",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"location",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"title",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"calendarId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_foreignProperties",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_options",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_customContent",{enumerable:!0,configurable:!0,writable:!0,value:{}})}build(){return new CalendarEventImpl(this._config,this.id,this.start,this.end,this.title,this.people,this.location,this.description,this.calendarId,this._options,this._customContent,this._foreignProperties)}withTitle(e){return this.title=e,this}withPeople(e){return this.people=e,this}withLocation(e){return this.location=e,this}withDescription(e){return this.description=e,this}withForeignProperties(e){return this._foreignProperties=e,this}withCalendarId(e){return this.calendarId=e,this}withOptions(e){return this._options=e,this}withCustomContent(e){return this._customContent=e,this}}const deepCloneEvent=(e,t)=>{const a=new CalendarEventBuilder(t.config,e.id,e.start,e.end).withTitle(e.title).withPeople(e.people).withCalendarId(e.calendarId).withForeignProperties(JSON.parse(JSON.stringify(e._getForeignProperties()))).withLocation(e.location).withDescription(e.description).withOptions(e._options).withCustomContent(e._customContent).build();return a._nDaysInGrid=e._nDaysInGrid,a},concatenatePeople=e=>e.reduce((t,a,r)=>0===r?a:r===e.length-1?`${t} & ${a}`:`${t}, ${a}`,""),dateFn=(e,t)=>{const{year:a,month:r,date:s}=toIntegers(e);return new Date(a,r,s).toLocaleDateString(t,{day:"numeric",month:"long",year:"numeric"})},getLocalizedDate=dateFn,timeFn=(e,t)=>{const{year:a,month:r,date:s,hours:n,minutes:i}=toIntegers(e);return new Date(a,r,s,n,i).toLocaleTimeString(t,{hour:"numeric",minute:"numeric"})},getTimeStamp=(e,t,a="–")=>{const r={start:e.start,end:e.end};return e._isSingleDayFullDay?dateFn(r.start,t):e._isMultiDayFullDay?`${dateFn(r.start,t)} ${a} ${dateFn(r.end,t)}`:e._isSingleDayTimed&&r.start!==r.end?`${dateFn(r.start,t)} <span aria-hidden="true">⋅</span> ${timeFn(r.start,t)} ${a} ${timeFn(r.end,t)}`:e._isSingleDayTimed&&e.start===e.end?`${dateFn(r.start,t)}, ${timeFn(r.start,t)}`:`${dateFn(r.start,t)}, ${timeFn(r.start,t)} ${a} ${dateFn(r.end,t)}, ${timeFn(r.end,t)}`};function MonthViewWeek({week:e}){const t=x(AppContext$1),a=e.map(e=>{const a=["sx__date-picker__day"];return isToday(e)&&a.push("sx__date-picker__day--today"),toDateString$1(e)===t.datePickerState.selectedDate.value&&a.push("sx__date-picker__day--selected"),isSameMonth(e,toJSDate(t.datePickerState.datePickerDate.value))||a.push("is-leading-or-trailing"),{day:e,classes:a}}),r=e=>{const a=toDateString$1(e);return a>=t.config.min&&a<=t.config.max},s=e=>toDateString$1(e.day)===t.datePickerState.datePickerDate.value,n=e=>{if("Enter"===e.key)return t.datePickerState.selectedDate.value=t.datePickerState.datePickerDate.value,void t.datePickerState.close();const a=new Map([["ArrowDown",7],["ArrowUp",-7],["ArrowLeft",-1],["ArrowRight",1]]);t.datePickerState.datePickerDate.value=addDays(t.datePickerState.datePickerDate.value,a.get(e.key)||0)};return u$3(k$2,{children:u$3("div",{"data-testid":DATE_PICKER_WEEK,className:"sx__date-picker__week",children:a.map(e=>u$3("button",{type:"button",tabIndex:s(e)?0:-1,disabled:!r(e.day),"aria-label":getLocalizedDate(t.datePickerState.datePickerDate.value,t.config.locale.value),className:e.classes.join(" "),"data-focus":s(e)?"true":void 0,onClick:()=>{return a=e.day,t.datePickerState.selectedDate.value=toDateString$1(a),void t.datePickerState.close();var a},onKeyDown:n,children:e.day.getDate()}))})})}function MonthView({seatYearsView:e}){const t=randomStringId(),a=x(AppContext$1),[r,s]=d$2([]);return y$2(()=>{(()=>{const e=toJSDate(a.datePickerState.datePickerDate.value);s(a.timeUnitsImpl.getMonthWithTrailingAndLeadingDays(e.getFullYear(),e.getMonth()))})()},[a.datePickerState.datePickerDate.value]),y$2(()=>{const e=new MutationObserver(e=>{e.forEach(e=>{const t=e.target;"true"===t.dataset.focus&&t.focus()})}),a=document.getElementById(t);return e.observe(a,{childList:!0,subtree:!0,attributes:!0}),()=>e.disconnect()},[]),u$3(k$2,{children:u$3("div",{id:t,"data-testid":MONTH_VIEW,className:"sx__date-picker__month-view",children:[u$3(MonthViewHeader,{setYearsView:e}),u$3(DayNames,{}),r.map(e=>u$3(MonthViewWeek,{week:e}))]})})}function YearsViewAccordion({year:e,setYearAndMonth:t,isExpanded:a,expand:r}){const s=x(AppContext$1),n=s.timeUnitsImpl.getMonthsFor(e);return u$3(k$2,{children:u$3("li",{className:a?"sx__is-expanded":"",children:[u$3("button",{type:"button",className:"sx__date-picker__years-accordion__expand-button sx__ripple--wide",onClick:()=>r(e),children:e}),a&&u$3("div",{className:"sx__date-picker__years-view-accordion__panel",children:n.map(a=>u$3("button",{type:"button",className:"sx__date-picker__years-view-accordion__month",onClick:r=>((a,r)=>{a.stopPropagation(),t(e,r.getMonth())})(r,a),children:toLocalizedMonth(a,s.config.locale.value)}))})]})})}function YearsView({setMonthView:e}){const t=x(AppContext$1),a=toJSDate(t.config.min).getFullYear(),r=toJSDate(t.config.max).getFullYear(),s=Array.from({length:r-a+1},(e,t)=>a+t),{year:n}=toIntegers(t.datePickerState.selectedDate.value),[i,o]=d$2(n);return y$2(()=>{var e;const t=null===(e=document.querySelector(".sx__date-picker__years-view"))||void 0===e?void 0:e.querySelector(".sx__is-expanded");t&&t.scrollIntoView({block:"center"})},[]),u$3(k$2,{children:u$3("ul",{className:"sx__date-picker__years-view","data-testid":YEARS_VIEW,children:s.map(a=>u$3(YearsViewAccordion,{year:a,setYearAndMonth:(a,r)=>((a,r)=>{t.datePickerState.datePickerDate.value=toDateString$1(new Date(a,r,1)),e()})(a,r),isExpanded:i===a,expand:e=>o(e)}))})})}const isScrollable=e=>{if(e){const t=e.scrollHeight>e.clientHeight,a=-1!==window.getComputedStyle(e).overflowY.indexOf("hidden");return t&&!a}return!0},getScrollableParents=(e,t=[])=>e&&e!==document.body&&e.nodeType!==Node.DOCUMENT_FRAGMENT_NODE?(isScrollable(e)&&t.push(e),getScrollableParents(e.assignedSlot?e.assignedSlot.parentNode:e.parentNode,t)):(t.push(window),t),POPUP_CLASS_NAME="sx__date-picker-popup";function AppPopup(){const e=x(AppContext$1),[t,a]=d$2(DatePickerView.MONTH_DAYS),r=T$2(()=>{const t=[POPUP_CLASS_NAME,e.datePickerState.isDark.value?"is-dark":"",e.config.teleportTo?"is-teleported":""];return e.config.placement&&!e.config.teleportTo&&t.push(e.config.placement),t},[e.datePickerState.isDark.value,e.config.placement,e.config.teleportTo]),s=t=>{t.target.closest(`.${POPUP_CLASS_NAME}`)||e.datePickerState.close()},n=t=>{"Escape"===t.key&&(e.config.listeners.onEscapeKeyDown?e.config.listeners.onEscapeKeyDown(e):e.datePickerState.close())};y$2(()=>(document.addEventListener("click",s),document.addEventListener("keydown",n),()=>{document.removeEventListener("click",s),document.removeEventListener("keydown",n)}),[]);const i=Number(getComputedStyle(document.documentElement).fontSize.split("px")[0]),o=()=>{const t=e.datePickerState.inputWrapperElement.value,a=null==t?void 0:t.getBoundingClientRect();if(void 0!==t&&a instanceof DOMRect)return{top:e.config.placement.includes("bottom")?a.height+a.y+1:a.y-i-362,left:e.config.placement.includes("start")?a.x:a.x+a.width-332,width:332,position:"fixed"}},[l,c]=d$2(o());return y$2(()=>{const t=e.datePickerState.inputWrapperElement.value;if(void 0===t)return;const a=getScrollableParents(t),r=()=>c(o());return a.forEach(e=>e.addEventListener("scroll",r)),()=>a.forEach(e=>e.removeEventListener("scroll",r))},[]),u$3(k$2,{children:u$3("div",{style:e.config.teleportTo?l:void 0,"data-testid":"date-picker-popup",className:r.join(" "),children:t===DatePickerView.MONTH_DAYS?u$3(MonthView,{seatYearsView:()=>a(DatePickerView.YEARS)}):u$3(YearsView,{setMonthView:()=>a(DatePickerView.MONTH_DAYS)})})})}function AppWrapper({$app:e}){const t=["sx__date-picker-wrapper"],[a,r]=d$2(t);y$2(()=>{var a;const s=[...t];e.datePickerState.isDark.value&&s.push("is-dark"),(null===(a=e.config.style)||void 0===a?void 0:a.fullWidth)&&s.push("has-full-width"),e.datePickerState.isDisabled.value&&s.push("is-disabled"),r(s)},[e.datePickerState.isDark.value,e.datePickerState.isDisabled.value]);let s=u$3(AppPopup,{});return e.config.teleportTo&&(s=$(s,e.config.teleportTo)),u$3(k$2,{children:u$3("div",{className:a.join(" "),children:u$3(AppContext$1.Provider,{value:e,children:[u$3(AppInput,{}),e.datePickerState.isOpen.value&&s]})})})}const AppContext=K$1({});class DatePickerAppSingletonImpl{constructor(e,t,a,r){Object.defineProperty(this,"datePickerState",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"timeUnitsImpl",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"translate",{enumerable:!0,configurable:!0,writable:!0,value:r})}}class DatePickerAppSingletonBuilder{constructor(){Object.defineProperty(this,"datePickerState",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeUnitsImpl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"translate",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}build(){return new DatePickerAppSingletonImpl(this.datePickerState,this.config,this.timeUnitsImpl,this.translate)}withDatePickerState(e){return this.datePickerState=e,this}withConfig(e){return this.config=e,this}withTimeUnitsImpl(e){return this.timeUnitsImpl=e,this}withTranslate(e){return this.translate=e,this}}var InternalViewName,InternalViewName2;InternalViewName2=InternalViewName||(InternalViewName={}),InternalViewName2.Day="day",InternalViewName2.Week="week",InternalViewName2.MonthGrid="month-grid",InternalViewName2.MonthAgenda="month-agenda",InternalViewName2.List="list";const getLocaleStringMonthArgs=e=>[e.config.locale.value,{month:"long"}],getLocaleStringYearArgs=e=>[e.config.locale.value,{year:"numeric"}],getMonthAndYearForDateRange=(e,t,a)=>{const r=toJSDate(t).toLocaleString(...getLocaleStringMonthArgs(e)),s=toJSDate(t).toLocaleString(...getLocaleStringYearArgs(e)),n=toJSDate(a).toLocaleString(...getLocaleStringMonthArgs(e)),i=toJSDate(a).toLocaleString(...getLocaleStringYearArgs(e));return r===n&&s===i?`${r} ${s}`:r!==n&&s===i?`${r} – ${n} ${s}`:`${r} ${s} – ${n} ${i}`},getMonthAndYearForSelectedDate=e=>`${toJSDate(e.datePickerState.selectedDate.value).toLocaleString(...getLocaleStringMonthArgs(e))} ${toJSDate(e.datePickerState.selectedDate.value).toLocaleString(...getLocaleStringYearArgs(e))}`;function RangeHeading(){const e=x(AppContext),[t,a]=d$2("");return useSignalEffect(()=>{e.calendarState.view.value===InternalViewName.Week&&a(getMonthAndYearForDateRange(e,e.calendarState.range.value.start,e.calendarState.range.value.end)),e.calendarState.view.value!==InternalViewName.MonthGrid&&e.calendarState.view.value!==InternalViewName.Day&&e.calendarState.view.value!==InternalViewName.MonthAgenda||a(getMonthAndYearForSelectedDate(e))}),u$3("span",{className:"sx__range-heading",children:t})}function TodayButton(){const e=x(AppContext);return u$3("button",{type:"button",className:"sx__today-button sx__ripple",onClick:()=>{e.datePickerState.selectedDate.value=toDateString$1(new Date)},children:e.translate("Today")})}function ViewSelection(){const e=x(AppContext),[t,a]=d$2([]);useSignalEffect(()=>{e.calendarState.isCalendarSmall.value?a(e.config.views.value.filter(e=>e.hasSmallScreenCompat)):a(e.config.views.value.filter(e=>e.hasWideScreenCompat))});const[r,s]=d$2("");useSignalEffect(()=>{const t=e.config.views.value.find(t=>t.name===e.calendarState.view.value);t&&s(e.translate(t.label))});const[n,i]=d$2(!1),o=e=>{const t=e.target;t instanceof HTMLElement&&!t.closest(".sx__view-selection")&&i(!1)};y$2(()=>(document.addEventListener("click",o),()=>document.removeEventListener("click",o)),[]);const l=t=>{i(!1),e.calendarState.setView(t,e.datePickerState.selectedDate.value)},[c,d]=d$2(),[u,m]=d$2(0);return u$3("div",{className:"sx__view-selection",children:[u$3("div",{tabIndex:0,role:"button","aria-label":e.translate("Select View"),className:"sx__view-selection-selected-item sx__ripple",onClick:()=>i(!n),onKeyDown:t=>{isKeyEnterOrSpace(t)&&i(!n),setTimeout(()=>{var t;const a=null===(t=e.elements.calendarWrapper)||void 0===t?void 0:t.querySelectorAll(".sx__view-selection-item");if(!a)return;d(a);const r=a[0];r instanceof HTMLElement&&(m(0),r.focus())},50)},children:r}),n&&u$3("ul",{"data-testid":"view-selection-items",className:"sx__view-selection-items",children:t.map(t=>u$3("li",{"aria-label":e.translate("Select View")+" "+e.translate(t.label),tabIndex:-1,role:"button",onKeyDown:e=>((e,t)=>{if(c)if("ArrowDown"===e.key){const e=c[u+1];e instanceof HTMLElement&&(m(u+1),e.focus())}else if("ArrowUp"===e.key){const e=c[u-1];e instanceof HTMLElement&&(m(u-1),e.focus())}else isKeyEnterOrSpace(e)&&l(t)})(e,t.name),onClick:()=>l(t.name),className:"sx__view-selection-item"+(t.name===e.calendarState.view.value?" is-selected":""),children:e.translate(t.label)}))})]})}function ForwardBackwardNavigation(){const e=x(AppContext),t=t=>{const a=e.config.views.value.find(t=>t.name===e.calendarState.view.value);a&&(e.datePickerState.selectedDate.value=a.backwardForwardFn(e.datePickerState.selectedDate.value,"forwards"===t?a.backwardForwardUnits:-a.backwardForwardUnits))},[a,r]=d$2("");useSignalEffect(()=>{r(`${getLocalizedDate(e.calendarState.range.value.start,e.config.locale.value)} ${e.translate("to")} ${getLocalizedDate(e.calendarState.range.value.end,e.config.locale.value)}`)});const[s,n]=d$2(""),[i,o]=d$2("");return y$2(()=>{const t=e.config.views.value.find(t=>t.name===e.calendarState.view.value);t&&(n(t.setDateRange({range:e.calendarState.range,calendarConfig:e.config,timeUnitsImpl:e.timeUnitsImpl,date:t.backwardForwardFn(e.datePickerState.selectedDate.value,-t.backwardForwardUnits)}).end),o(t.setDateRange({range:e.calendarState.range,calendarConfig:e.config,timeUnitsImpl:e.timeUnitsImpl,date:t.backwardForwardFn(e.datePickerState.selectedDate.value,t.backwardForwardUnits)}).start))},[e.datePickerState.selectedDate.value,e.calendarState.view.value]),u$3(k$2,{children:u$3("div",{className:"sx__forward-backward-navigation","aria-label":a,"aria-live":"polite",children:[u$3(Chevron,{disabled:!!(e.config.minDate.value&&dateFromDateTime(s)<e.config.minDate.value),onClick:()=>t("backwards"),direction:"previous",buttonText:e.translate("Previous period")}),u$3(Chevron,{disabled:!!(e.config.maxDate.value&&dateFromDateTime(i)>e.config.maxDate.value),onClick:()=>t("forwards"),direction:"next",buttonText:e.translate("Next period")})]})})}const getElementByCCID=e=>document.querySelector(`[data-ccid="${e}"]`);class PreactView{constructor(e){Object.defineProperty(this,"randomId",{enumerable:!0,configurable:!0,writable:!0,value:randomStringId()}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"label",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"Component",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"setDateRange",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hasSmallScreenCompat",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hasWideScreenCompat",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"backwardForwardFn",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"backwardForwardUnits",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.label=e.label,this.Component=e.Component,this.setDateRange=e.setDateRange,this.hasSmallScreenCompat=e.hasSmallScreenCompat,this.hasWideScreenCompat=e.hasWideScreenCompat,this.backwardForwardFn=e.backwardForwardFn,this.backwardForwardUnits=e.backwardForwardUnits}render(e,t){E$2(_$2(this.Component,{$app:t,id:this.randomId}),e)}destroy(){const e=document.getElementById(this.randomId);e&&e.remove()}}const createPreactView=e=>new PreactView(e),timePointToPercentage=(e,t,a)=>{if(a<t.start){return(a+(2400-t.start))/e*100}return(a-t.start)/e*100},getEventHeight=(e,t,a,r)=>e===t?timePointToPercentage(r,a,timePointsFromString(timeFromDateTime(addTimePointsToDateTime(t,50))))-timePointToPercentage(r,a,timePointsFromString(timeFromDateTime(e))):timePointToPercentage(r,a,timePointsFromString(timeFromDateTime(t)))-timePointToPercentage(r,a,timePointsFromString(timeFromDateTime(e))),getInlineStartRule=(e,t)=>e._totalConcurrentEvents&&e._previousConcurrentEvents?(e._previousConcurrentEvents||0)/(e._totalConcurrentEvents||0)*t:0,getWidthRule=(e,t,a,r)=>r||!a?t-e:t/a,getBorderRule=e=>e._previousConcurrentEvents?"1px solid #fff":0,getTimeGridEventCopyElementId=e=>"time-grid-event-copy-"+e,isUIEventTouchEvent=e=>"touches"in e&&"object"==typeof e.touches;function useEventInteractions(e){const[t,a]=d$2(),[r,s]=d$2(),n=(t,a)=>{if(isUIEventTouchEvent(t)&&0===t.touches.length)return;if(!e.config.plugins.eventModal)return;const r=t.target;if(!(r instanceof HTMLElement))return;const s=r.classList.contains("sx__event")?r:r.closest(".sx__event");s instanceof HTMLElement&&(e.config.plugins.eventModal.calendarEventElement.value=s,e.config.plugins.eventModal.setCalendarEvent(a,s.getBoundingClientRect()))};return{eventCopy:t,updateCopy:t=>{if(!t)return a(void 0);a(deepCloneEvent(t,e))},createDragStartTimeout:(e,t)=>{s(setTimeout(()=>e(t),150))},setClickedEventIfNotDragging:(e,t)=>{r&&(clearTimeout(r),n(t,e)),s(void 0)},setClickedEvent:n}}const getCCID=(e,t)=>{let a=e?"custom-time-grid-event-"+randomStringId():void 0;return a&&t&&(a+="-copy"),a},invokeOnEventClickCallback=(e,t,a)=>{e.config.callbacks.onEventClick&&e.config.callbacks.onEventClick(t._getExternalEvent(),a)},invokeOnEventDoubleClickCallback=(e,t,a)=>{e.config.callbacks.onDoubleClickEvent&&e.config.callbacks.onDoubleClickEvent(t._getExternalEvent(),a)},getEventCoordinates=e=>{const t=isUIEventTouchEvent(e)?e.touches[0]:e;return{clientX:t.clientX,clientY:t.clientY}},getYCoordinateInTimeGrid=(e,t,a)=>timePointToPercentage(a,t,timePointsFromString(timeFromDateTime(e))),nextTick=e=>{setTimeout(()=>{e()})},focusModal=e=>{const t=e.elements.calendarWrapper;if(!(t instanceof HTMLElement))return;const a=t.querySelector(".sx__event-modal");a instanceof HTMLElement&&setTimeout(()=>{a.focus()},100)},wasEventAddedInLastSecond=e=>e._createdAt&&Date.now()-e._createdAt.getTime()<1e3;function TimeGridEvent({calendarEvent:e,dayBoundariesDateTime:t,isCopy:a,setMouseDown:r}){var s,n,i,o;const l=x(AppContext),{eventCopy:c,updateCopy:d,createDragStartTimeout:u,setClickedEventIfNotDragging:m,setClickedEvent:p}=useEventInteractions(l),h=[l.config.locale.value,{hour:"numeric",minute:"numeric"}],g={borderInlineStart:`4px solid var(--sx-color-${e._color})`,textColor:`var(--sx-color-on-${e._color}-container)`,backgroundColor:`var(--sx-color-${e._color}-container)`,iconStroke:`var(--sx-color-on-${e._color}-container)`},y=getInlineStartRule(e,l.config.weekOptions.value.eventWidth),v=r=>{var s;if(isUIEventTouchEvent(r)&&r.preventDefault(),a)return;if(!r.target)return;if(!l.config.plugins.dragAndDrop)return;if(null===(s=e._options)||void 0===s?void 0:s.disableDND)return;if(N)return;const n=deepCloneEvent(e,l);d(n),l.config.plugins.dragAndDrop.createTimeGridDragHandler({$app:l,eventCoordinates:getEventCoordinates(r),updateCopy:d,eventCopy:n},t)},E=l.config._customComponentFns.timeGridEvent,f=getCCID(E,a);y$2(()=>{E&&E(getElementByCCID(f),{calendarEvent:e._getExternalEvent()})},[e,c]);const b=s=>{if(r(!0),s.stopPropagation(),!a&&l.config.plugins.resize){const a=deepCloneEvent(e,l);d(a),l.config.plugins.resize.createTimeGridEventResizer(a,d,s,t)}},j=getBorderRule(e),R=["sx__time-grid-event","sx__event"];wasEventAddedInLastSecond(e)&&R.push("is-event-new"),a&&R.push("is-event-copy"),!l.config.weekOptions.value.eventOverlap&&e._maxConcurrentEvents&&e._maxConcurrentEvents>1&&R.push("is-event-overlap"),(null===(s=e._options)||void 0===s?void 0:s.additionalClasses)&&R.push(...e._options.additionalClasses);const I=e=>{r(!0),u(v,e)},S=t=>{nextTick(()=>r(!1)),m(e,t)},_=null===(n=e._customContent)||void 0===n?void 0:n.timeGrid,N=t&&e.start<t.start&&e.end>=t.start,C=N?null==t?void 0:t.start:e.start;return u$3(k$2,{children:[u$3("div",{id:a?getTimeGridEventCopyElementId(e.id):void 0,"data-event-id":e.id,onClick:t=>{t.stopPropagation(),invokeOnEventClickCallback(l,e,t)},onDblClick:t=>{t.stopPropagation(),invokeOnEventDoubleClickCallback(l,e,t)},onKeyDown:t=>{"Enter"!==t.key&&" "!==t.key||(t.stopPropagation(),p(t,e),invokeOnEventClickCallback(l,e,t),nextTick(()=>{focusModal(l)}))},onMouseDown:I,onMouseUp:S,onTouchStart:I,onTouchEnd:S,className:R.join(" "),tabIndex:0,role:"button",style:{top:`${getYCoordinateInTimeGrid(C,l.config.dayBoundaries.value,l.config.timePointsPerDay)}%`,height:`${getEventHeight(C,e.end,l.config.dayBoundaries.value,l.config.timePointsPerDay)}%`,insetInlineStart:`${y}%`,width:`${getWidthRule(y,a?100:l.config.weekOptions.value.eventWidth,e._maxConcurrentEvents,l.config.weekOptions.value.eventOverlap)}%`,backgroundColor:E?void 0:g.backgroundColor,color:E?void 0:g.textColor,borderTop:j,borderInlineEnd:j,borderBottom:j,borderInlineStart:E?void 0:g.borderInlineStart,padding:E?"0":void 0},children:u$3("div",{"data-ccid":f,className:"sx__time-grid-event-inner",children:[!E&&!_&&u$3(k$2,{children:[e.title&&u$3("div",{className:"sx__time-grid-event-title",children:e.title}),u$3("div",{className:"sx__time-grid-event-time",children:[u$3(TimeIcon,{strokeColor:g.iconStroke}),((e,t)=>{const a=toJSDate(e).toLocaleTimeString(...h);if(e===t)return a;return`${a} – ${toJSDate(t).toLocaleTimeString(...h)}`})(e.start,e.end)]}),e.people&&e.people.length>0&&u$3("div",{className:"sx__time-grid-event-people",children:[u$3(UserIcon,{strokeColor:g.iconStroke}),concatenatePeople(e.people)]}),e.location&&u$3("div",{className:"sx__time-grid-event-location",children:[u$3(LocationPinIcon,{strokeColor:g.iconStroke}),e.location]})]}),_&&u$3("div",{dangerouslySetInnerHTML:{__html:(null===(i=e._customContent)||void 0===i?void 0:i.timeGrid)||""}}),l.config.plugins.resize&&!(null===(o=e._options)||void 0===o?void 0:o.disableResize)&&u$3("div",{className:"sx__time-grid-event-resize-handle",onMouseDown:b,onTouchStart:b})]})}),c&&u$3(TimeGridEvent,{calendarEvent:c,isCopy:!0,setMouseDown:r,dayBoundariesDateTime:t})]})}const sortEventsByStartAndEnd=(e,t)=>e.start===t.start?e.end<t.end?1:e.end>t.end?-1:0:e.start<t.start?-1:e.start>t.start?1:0,sortEventsForMonthGrid=(e,t)=>{const a=dateFromDateTime(e.start),r=dateFromDateTime(t.start),s=dateFromDateTime(e.end),n=dateFromDateTime(t.end);return a===r&&s===n&&e.start<t.start?-1:a===r?s<n?1:s>n?-1:0:a<r?-1:a>r?1:0},isEvent0Minutes=e=>(null==e?void 0:e.start)===(null==e?void 0:e.end)&&DateFormats.DATE_TIME_STRING.test((null==e?void 0:e.start)||""),areEvents0MinutesAndConcurrent=(e,t)=>isEvent0Minutes(e)&&isEvent0Minutes(t)&&(null==e?void 0:e.start)===(null==t?void 0:t.start),handleEventConcurrency=(e,t=[],a=0)=>{for(let r=a;r<e.length;r++){const a=e[r],s=e[r+1],n=areEvents0MinutesAndConcurrent(a,s);if(t.length&&(!s||t.every(e=>e.end<=s.start)&&!n)){t.push(a);for(let e=0;e<t.length;e++){const a=t[e],r=t.filter((t,r)=>!(t===a||r>e)&&(!!areEvents0MinutesAndConcurrent(t,a)||t.start<=a.start&&t.end>a.start)).length,s=t.filter((t,r)=>!(t===a||r<e)&&(!!areEvents0MinutesAndConcurrent(t,a)||t.start<a.end&&t.end>=a.start)).length;a._totalConcurrentEvents=r+s+1,a._previousConcurrentEvents=r;let n=0;const i=[];t.forEach(e=>{(e.end>a.start&&e.start<a.end||areEvents0MinutesAndConcurrent(e,a))&&(i.push({time:e.start,type:"start"}),i.push({time:e.end,type:"end"}))}),i.sort((e,t)=>e.time.localeCompare(t.time)||("end"===e.type?-1:1));let o=0;i.forEach(e=>{"start"===e.type?(o++,n=Math.max(n,o)):o--}),a._maxConcurrentEvents=n}return handleEventConcurrency(e,t=[],r+1)}if(s&&a.end>s.start||t.some(e=>e.end>a.start)||n)return t.push(a),handleEventConcurrency(e,t,r+1);a._totalConcurrentEvents=1,a._previousConcurrentEvents=0,a._maxConcurrentEvents=1}return e},getClickDateTime=(e,t,a)=>{if(!(e.target instanceof HTMLElement))return;const r="sx__time-grid-day",s=e.target.classList.contains(r)?e.target:e.target.closest("."+r),n=(e.clientY-s.getBoundingClientRect().top)/s.getBoundingClientRect().height*100,i=Math.round(t.config.timePointsPerDay/100*n);return addTimePointsToDateTime(a,i)},getClassNameForWeekday=e=>{switch(e){case 0:return"sx__sunday";case 1:return"sx__monday";case 2:return"sx__tuesday";case 3:return"sx__wednesday";case 4:return"sx__thursday";case 5:return"sx__friday";case 6:return"sx__saturday";default:throw new Error("Invalid weekday")}};function TimeGridBackgroundEvent({backgroundEvent:e,date:t}){const a=x(AppContext);let r=e.start,s=e.end;const n=dateFromDateTime(r)!==t,i=dateFromDateTime(s)!==t;(dateStringRegex.test(r)||n)&&(r=r.substring(0,10)+" 00:00"),(dateStringRegex.test(s)||i)&&(s=s.substring(0,10)+" 23:59"),n&&(r=t+" "+r.split(" ")[1]),i&&(s=t+" "+s.split(" ")[1]);return timePointsFromString(r.split(" ")[1])<a.config.dayBoundaries.value.start&&(r=t+" "+timeStringFromTimePoints(a.config.dayBoundaries.value.start)),r===s?null:u$3(k$2,{children:u$3("div",{class:"sx__time-grid-background-event",title:e.title,style:__spreadProps(__spreadValues({},e.style),{position:"absolute",zIndex:0,top:`${getYCoordinateInTimeGrid(r,a.config.dayBoundaries.value,a.config.timePointsPerDay)}%`,height:`${getEventHeight(r,s,a.config.dayBoundaries.value,a.config.timePointsPerDay)}%`,width:"100%"})})})}function TimeGridDay({calendarEvents:e,date:t,backgroundEvents:a}){const[r,s]=d$2(!1),n=x(AppContext),i=timeStringFromTimePoints(n.config.dayBoundaries.value.start),o=timeStringFromTimePoints(n.config.dayBoundaries.value.end),l=setTimeInDateTimeString(t,i),c=n.config.isHybridDay?addDays(setTimeInDateTimeString(t,o),1):setTimeInDateTimeString(t,o),d={start:l,end:c},u=T$2(()=>{const t=e.sort(sortEventsByStartAndEnd);return handleEventConcurrency(t)},[e]),m=(e,t)=>{if(!t||r)return;const a=getClickDateTime(e,n,l);a&&t(a,e)},p=()=>{setTimeout(()=>{s(!1)},10)},h=["sx__time-grid-day",getClassNameForWeekday(toJSDate(t).getDay())];return u$3("div",{className:useComputed(()=>{const e=[...h];return n.datePickerState.selectedDate.value===t&&e.push("is-selected"),e}).value.join(" "),"data-time-grid-date":t,onClick:e=>m(e,n.config.callbacks.onClickDateTime),onDblClick:e=>m(e,n.config.callbacks.onDoubleClickDateTime),"aria-label":getLocalizedDate(t,n.config.locale.value),onMouseLeave:()=>s(!1),onMouseUp:p,onTouchEnd:p,onMouseDown:e=>{const t=n.config.callbacks.onMouseDownDateTime;if(!t||r)return;const a=getClickDateTime(e,n,l);a&&t(a,e)},children:[a.map(e=>u$3(k$2,{children:u$3(TimeGridBackgroundEvent,{backgroundEvent:e,date:t})})),u.map(e=>u$3(TimeGridEvent,{calendarEvent:e,dayBoundariesDateTime:d,setMouseDown:s},e.id))]})}const getTimeAxisHours=({start:e,end:t},a)=>{const r=[];let s=Math.floor(e/100);if(a){for(;s<24;)r.push(s),s+=1;s=0}const n=0===t?24:Math.ceil(t/100);for(;s<n;)r.push(s),s+=1;return r};function TimeAxis(){const e=x(AppContext),[t,a]=d$2([]);useSignalEffect(()=>{a(getTimeAxisHours(e.config.dayBoundaries.value,e.config.isHybridDay));const t=e.config.timePointsPerDay/100,r=e.config.weekOptions.value.gridHeight/t;document.documentElement.style.setProperty("--sx-week-grid-hour-height",`${r}px`)});const r=new Intl.DateTimeFormat(e.config.locale.value,e.config.weekOptions.value.timeAxisFormatOptions),s=e.config._customComponentFns.weekGridHour,n=T$2(()=>s?t.map(()=>`custom-week-grid-hour-${randomStringId()}`):[],[t]);return y$2(()=>{s&&n.length&&t.forEach((e,t)=>{const a=document.querySelector(`[data-ccid="${n[t]}"]`);a instanceof HTMLElement&&s(a,{hour:e})})},[t,n]),u$3(k$2,{children:u$3("div",{className:"sx__week-grid__time-axis",children:t.map((e,t)=>u$3("div",{className:"sx__week-grid__hour",children:[s&&n.length&&u$3("div",{"data-ccid":n[t]}),!s&&u$3("span",{className:"sx__week-grid__hour-text",children:r.format(new Date(0,0,0,e))})]}))})})}function DateAxis({week:e}){const t=x(AppContext),a=e=>{const t=["sx__week-grid__date",getClassNameForWeekday(e.getDay())];return isToday(e)&&t.push("sx__week-grid__date--is-today"),t.join(" ")},r=t.config._customComponentFns.weekGridDate,s=d$2(()=>Array.from({length:7},()=>`custom-week-grid-date-${randomStringId()}`));return y$2(()=>{r&&e.forEach((e,t)=>{const a=document.querySelector(`[data-ccid="${s[0][t]}"]`);a instanceof HTMLElement&&r(a,{date:toDateString$1(e)})})},[e]),u$3(k$2,{children:u$3("div",{className:"sx__week-grid__date-axis",children:e.map((e,n)=>u$3("div",{className:a(e),"data-date":toDateString$1(e),children:[r&&u$3("div",{"data-ccid":s[0][n]}),!r&&u$3(k$2,{children:[u$3("div",{className:"sx__week-grid__day-name",children:getDayNameShort(e,t.config.locale.value)}),u$3("div",{className:"sx__week-grid__date-number",children:e.getDate()})]})]}))})})}const sortEventsForWeekView=e=>{const t=[],a=[];for(const r of e)r._isSingleDayTimed||r._isSingleHybridDayTimed?a.push(r):(r._isSingleDayFullDay||r._isMultiDayFullDay||r._isMultiDayTimed)&&t.push(r);return{timeGridEvents:a,dateGridEvents:t}},createOneDay=(e,t)=>{const a=toDateString$1(t);return e[a]={date:a,timeGridEvents:[],dateGridEvents:{},backgroundEvents:[]},e},createWeek=e=>e.calendarState.view.value===InternalViewName.Day?createOneDay({},toJSDate(e.calendarState.range.value.start)):e.timeUnitsImpl.getWeekFor(toJSDate(e.datePickerState.selectedDate.value)).slice(0,e.config.weekOptions.value.nDays).reduce(createOneDay,{}),positionInTimeGrid=(e,t,a)=>{var r;for(const s of e){const e=a.calendarState.range.value;if(s.start>=e.start&&s.end<=e.end){let e=dateFromDateTime(s.start);if(a.config.isHybridDay){const t=`${addDays(e,-1)} ${timeStringFromTimePoints(a.config.dayBoundaries.value.start)}`,r=`${e} ${timeStringFromTimePoints(a.config.dayBoundaries.value.end)}`,n=`${e} ${timeStringFromTimePoints(a.config.dayBoundaries.value.start)}`;s.start>t&&s.start<r&&s.start<n&&(e=addDays(e,-1))}null===(r=t[e])||void 0===r||r.timeGridEvents.push(s)}}return t};InternalViewName.Week;const DEFAULT_DAY_BOUNDARIES={start:0,end:2400},DEFAULT_WEEK_GRID_HEIGHT=1600,DATE_GRID_BLOCKER="blocker",positionInDateGrid=(e,t)=>{const a=Object.keys(t).sort(),r=a[0],s=a[a.length-1],n=new Set;for(const i of e){const e=dateFromDateTime(i.start),a=dateFromDateTime(i.end),o=!!t[e];let l=o;if(!o&&e<r&&a>=r&&(l=!0),!l)continue;const c=o?e:r,d=a<=s?a:s,u=Object.values(t).filter(e=>e.date>=c&&e.date<=d);let m,p=0;for(;void 0===m;){u.every(e=>!e.dateGridEvents[p])?(m=p,n.add(p)):p++}for(const[t,r]of u.entries())0===t?(i._nDaysInGrid=u.length,r.dateGridEvents[m]=i):r.dateGridEvents[m]=DATE_GRID_BLOCKER}for(const i of Array.from(n))for(const[,e]of Object.entries(t))e.dateGridEvents[i]||(e.dateGridEvents[i]=void 0);return t},getWidthToSubtract=(e,t,a)=>{let r=2;return e&&a&&(r+=10),t&&a&&(r+=10),r},getBorderRadius=(e,t,a)=>({borderBottomLeftRadius:e||a?0:void 0,borderTopLeftRadius:e||a?0:void 0,borderBottomRightRadius:t||a?0:void 0,borderTopRightRadius:t||a?0:void 0});function DateGridEvent({calendarEvent:e,gridRow:t,isCopy:a}){var r,s,n,i;const o=x(AppContext),{eventCopy:l,updateCopy:c,createDragStartTimeout:d,setClickedEventIfNotDragging:u,setClickedEvent:m}=useEventInteractions(o),p={borderInlineStart:`4px solid var(--sx-color-${e._color})`,color:`var(--sx-color-on-${e._color}-container)`,backgroundColor:`var(--sx-color-${e._color}-container)`},h=t=>{var a;if(!o.config.plugins.dragAndDrop)return;if(null===(a=e._options)||void 0===a?void 0:a.disableDND)return;isUIEventTouchEvent(t)&&t.preventDefault();const r=deepCloneEvent(e,o);c(r),o.config.plugins.dragAndDrop.createDateGridDragHandler({eventCoordinates:getEventCoordinates(t),eventCopy:r,updateCopy:c,$app:o})},g=dateFromDateTime(e.start)<dateFromDateTime(o.calendarState.range.value.start),y=dateFromDateTime(e.end)>dateFromDateTime(o.calendarState.range.value.end),v=T$2(()=>"ltr"===o.config.direction?g:y,[g,y]),E=T$2(()=>"ltr"===o.config.direction?y:g,[g,y]),f={backgroundColor:p.backgroundColor},b=o.config._customComponentFns.dateGridEvent;let j=b?"custom-date-grid-event-"+randomStringId():void 0;a&&j&&(j+="-copy"),y$2(()=>{b&&b(getElementByCCID(j),{calendarEvent:e._getExternalEvent()})},[e,l]);const R=t=>{t.stopPropagation();const a=deepCloneEvent(e,o);c(a),o.config.plugins.resize.createDateGridEventResizer(a,c,t)},I=["sx__event","sx__date-grid-event","sx__date-grid-cell"];a&&I.push("sx__date-grid-event--copy"),wasEventAddedInLastSecond(e)&&I.push("is-event-new"),v&&I.push("sx__date-grid-event--overflow-left"),E&&I.push("sx__date-grid-event--overflow-right"),(null===(r=e._options)||void 0===r?void 0:r.additionalClasses)&&I.push(...e._options.additionalClasses);const S=g?"none":p.borderInlineStart,_=null===(s=e._customContent)||void 0===s?void 0:s.dateGrid;return u$3(k$2,{children:[u$3("div",{id:a?getTimeGridEventCopyElementId(e.id):void 0,tabIndex:0,"aria-label":e.title+" "+getTimeStamp(e,o.config.locale.value,o.translate("to")),role:"button","data-ccid":j,"data-event-id":e.id,onMouseDown:e=>d(h,e),onMouseUp:t=>u(e,t),onTouchStart:e=>d(h,e),onTouchEnd:t=>u(e,t),onClick:t=>invokeOnEventClickCallback(o,e,t),onDblClick:t=>invokeOnEventDoubleClickCallback(o,e,t),onKeyDown:t=>{"Enter"!==t.key&&" "!==t.key||(t.stopPropagation(),m(t,e),invokeOnEventClickCallback(o,e,t),nextTick(()=>{focusModal(o)}))},className:I.join(" "),style:__spreadValues({width:`calc(${100*e._nDaysInGrid}% - ${getWidthToSubtract(v,E,!b)}px)`,gridRow:t,display:l?"none":"flex",padding:b?"0px":void 0,borderInlineStart:b?void 0:S,color:b?void 0:p.color,backgroundColor:b?void 0:p.backgroundColor},getBorderRadius(v,E,!!b)),children:[!b&&!_&&u$3(k$2,{children:[v&&u$3("div",{className:"sx__date-grid-event--left-overflow",style:f}),u$3("span",{className:"sx__date-grid-event-text",children:[e.title,"  ",dateTimeStringRegex.test(e.start)&&u$3("span",{className:"sx__date-grid-event-time",children:timeFn(e.start,o.config.locale.value)})]}),E&&u$3("div",{className:"sx__date-grid-event--right-overflow",style:f})]}),_&&u$3("div",{dangerouslySetInnerHTML:{__html:(null===(n=e._customContent)||void 0===n?void 0:n.dateGrid)||""}}),o.config.plugins.resize&&!(null===(i=e._options)||void 0===i?void 0:i.disableResize)&&!y&&u$3("div",{className:"sx__date-grid-event-resize-handle",onMouseDown:R,onTouchStart:R})]}),l&&u$3(DateGridEvent,{calendarEvent:l,gridRow:t,isCopy:!0})]})}function DateGridDay({calendarEvents:e,date:t,backgroundEvents:a}){const r=x(AppContext),s=t+" 00:00",n=t+" 23:59",i=a.find(e=>{const t=dateStringRegex.test(e.start)?e.start+" 00:00":e.start,a=dateStringRegex.test(e.end)?e.end+" 23:59":e.end;return t<=s&&a>=n}),o=e=>{const a=r.config.callbacks.onMouseDownDateGridDate;a&&a(t,e)};return u$3("div",{className:"sx__date-grid-day","data-date-grid-date":t,children:[i&&u$3("div",{className:"sx__date-grid-background-event",title:i.title,style:__spreadValues({},i.style)}),Object.values(e).map((e,t)=>e!==DATE_GRID_BLOCKER&&e?u$3(DateGridEvent,{calendarEvent:e,gridRow:t+1},e.start+e.end):u$3("div",{className:"sx__date-grid-cell",style:{gridRow:t+1},onMouseDown:o})),u$3("div",{className:"sx__spacer",onMouseDown:o})]})}const filterByRange=(e,t)=>e.filter(e=>{let a=t.start,r=t.end;dateStringRegex.test(a)&&(a+=" 00:00"),dateStringRegex.test(r)&&(r+=" 23:59");let s=e.start,n=e.end;dateStringRegex.test(s)&&(s+=" 00:00"),dateStringRegex.test(n)&&(n+=" 23:59");return s>=a&&s<=r||n>=a&&n<=r||s<a&&n>r}),WeekWrapper=({$app:e,id:t})=>{document.documentElement.style.setProperty("--sx-week-grid-height",`${e.config.weekOptions.value.gridHeight}px`);const a=useComputed(()=>{var t,a;const r=null===(t=e.calendarState.range.value)||void 0===t?void 0:t.start,s=null===(a=e.calendarState.range.value)||void 0===a?void 0:a.end;if(!r||!s)return{};let n=createWeek(e);const i=e.calendarEvents.filterPredicate.value?e.calendarEvents.list.value.filter(e.calendarEvents.filterPredicate.value):e.calendarEvents.list.value,{dateGridEvents:o,timeGridEvents:l}=sortEventsForWeekView(i);return n=positionInDateGrid(o.sort(sortEventsByStartAndEnd),n),Object.entries(n).forEach(([t,a])=>{a.backgroundEvents=filterByRange(e.calendarEvents.backgroundEvents.value,{start:t,end:t})}),n=positionInTimeGrid(l,n,e),n});return u$3(k$2,{children:u$3(AppContext.Provider,{value:e,children:u$3("div",{className:"sx__week-wrapper",id:t,children:[u$3("div",{className:"sx__week-header",children:u$3("div",{className:"sx__week-header-content",children:[u$3(DateAxis,{week:Object.values(a.value).map(e=>toJSDate(e.date))}),u$3("div",{className:"sx__date-grid","aria-label":e.translate("Full day- and multiple day events"),children:Object.values(a.value).map(e=>u$3(DateGridDay,{date:e.date,calendarEvents:e.dateGridEvents,backgroundEvents:e.backgroundEvents},e.date))}),u$3("div",{className:"sx__week-header-border"})]})}),u$3("div",{className:"sx__week-grid",children:[u$3(TimeAxis,{}),Object.values(a.value).map(e=>u$3(TimeGridDay,{calendarEvents:e.timeGridEvents,backgroundEvents:e.backgroundEvents,date:e.date},e.date))]})]})})})},getRangeStartGivenDayBoundaries=(e,t)=>`${toDateString$1(t)} ${timeStringFromTimePoints(e.dayBoundaries.value.start)}`,getRangeEndGivenDayBoundaries=(e,t)=>{let a=timeStringFromTimePoints(e.dayBoundaries.value.end),r=toDateString$1(t);return e.isHybridDay&&(r=addDays(r,1)),2400===e.dayBoundaries.value.end&&(a="23:59"),`${r} ${a}`},setRangeForWeek=e=>{const t=e.timeUnitsImpl.getWeekFor(toJSDate(e.date)).slice(0,e.calendarConfig.weekOptions.value.nDays);return{start:getRangeStartGivenDayBoundaries(e.calendarConfig,t[0]),end:getRangeEndGivenDayBoundaries(e.calendarConfig,t[t.length-1])}},setRangeForMonth=e=>{const{year:t,month:a}=toIntegers(e.date),r=e.timeUnitsImpl.getMonthWithTrailingAndLeadingDays(t,a),s=toDateString$1(r[r.length-1][r[r.length-1].length-1]);return{start:toDateTimeString(r[0][0]),end:`${s} 23:59`}},setRangeForDay=e=>({start:getRangeStartGivenDayBoundaries(e.calendarConfig,toJSDate(e.date)),end:getRangeEndGivenDayBoundaries(e.calendarConfig,toJSDate(e.date))}),config$4={name:InternalViewName.Week,label:"Week",Component:WeekWrapper,setDateRange:setRangeForWeek,hasSmallScreenCompat:!1,hasWideScreenCompat:!0,backwardForwardFn:addDays,backwardForwardUnits:7},viewWeek=createPreactView(config$4),createViewWeek=()=>createPreactView(config$4),DayWrapper=({$app:e,id:t})=>u$3(WeekWrapper,{$app:e,id:t}),config$3={name:InternalViewName.Day,label:"Day",setDateRange:setRangeForDay,hasWideScreenCompat:!0,hasSmallScreenCompat:!0,Component:DayWrapper,backwardForwardFn:addDays,backwardForwardUnits:1},viewDay=createPreactView(config$3),createViewDay=()=>createPreactView(config$3),getWeekNumber=(e,t)=>{const a=((e=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))).getUTCDay()-t+7)%7;e.setUTCDate(e.getUTCDate()-a+3);const r=new Date(Date.UTC(e.getUTCFullYear(),0,1)),s=(r.getUTCDay()-t+7)%7;r.setUTCDate(r.getUTCDate()-s);const n=Math.ceil(((e.getTime()-r.getTime())/864e5+1)/7),i=new Date(Date.UTC(e.getUTCFullYear()+1,0,1)),o=(i.getUTCDay()-t+7)%7;return i.setUTCDate(i.getUTCDate()-o),e>=i?1:n};function WeekNumber(){const e=x(AppContext);return u$3("div",{className:"sx__calendar-header__week-number",children:e.translate("CW",{week:getWeekNumber(toJSDate(e.datePickerState.selectedDate.value),e.config.firstDayOfWeek.value)})})}function CalendarHeader(){const e=x(AppContext),t=(new DatePickerAppSingletonBuilder).withDatePickerState(e.datePickerState).withConfig(e.datePickerConfig).withTranslate(e.translate).withTimeUnitsImpl(e.timeUnitsImpl).build(),a=e.config._customComponentFns.headerContent,r=d$2(a?randomStringId():void 0)[0],s=e.config._customComponentFns.headerContentLeftPrepend,n=d$2(s?randomStringId():void 0)[0],i=e.config._customComponentFns.headerContentLeftAppend,o=d$2(i?randomStringId():void 0)[0],l=e.config._customComponentFns.headerContentRightPrepend,c=d$2(l?randomStringId():void 0)[0],d=e.config._customComponentFns.headerContentRightAppend,u=d$2(d?randomStringId():void 0)[0];y$2(()=>{a&&a(getElementByCCID(r),{$app:e}),s&&n&&s(getElementByCCID(n),{$app:e}),i&&i(getElementByCCID(o),{$app:e}),l&&l(getElementByCCID(c),{$app:e}),d&&d(getElementByCCID(u),{$app:e})},[e.datePickerState.selectedDate.value,e.calendarState.range.value,e.calendarState.isDark.value,e.calendarState.isCalendarSmall.value]);const m=e.config.locale.value,p=T$2(()=>[viewWeek.name,viewDay.name].includes(e.calendarState.view.value),[e.calendarState.view.value]);return u$3("header",{className:"sx__calendar-header","data-ccid":r,children:!a&&u$3(k$2,{children:[u$3("div",{className:"sx__calendar-header-content",children:[n&&u$3("div",{"data-ccid":n}),u$3(TodayButton,{}),u$3(ForwardBackwardNavigation,{}),u$3(RangeHeading,{},e.config.locale.value),e.config.showWeekNumbers.value&&p&&u$3(WeekNumber,{}),o&&u$3("div",{"data-ccid":o})]}),u$3("div",{className:"sx__calendar-header-content",children:[c&&u$3("div",{"data-ccid":c}),e.config.views.value.length>1&&u$3(ViewSelection,{},m+"-view-selection"),u$3(AppWrapper,{$app:t}),u&&u$3("div",{"data-ccid":u})]})]})})}const setWrapperElement=(e,t)=>{e.elements.calendarWrapper=document.getElementById(t)},setScreenSizeCompatibleView=(e,t)=>{const a=e.config.views.value.find(t=>t.name===e.calendarState.view.value);if(t){if(a.hasSmallScreenCompat)return;const t=e.config.views.value.find(e=>e.hasSmallScreenCompat);t&&e.calendarState.setView(t.name,e.datePickerState.selectedDate.value)}else{if(a.hasWideScreenCompat)return;const t=e.config.views.value.find(e=>e.hasWideScreenCompat);t&&e.calendarState.setView(t.name,e.datePickerState.selectedDate.value)}},handleWindowResize=e=>{const t=document.documentElement,a=e.elements.calendarWrapper,r=700/(16/+window.getComputedStyle(t).fontSize.split("p")[0]);if(!a)return;const s=e.config.callbacks.isCalendarSmall?e.config.callbacks.isCalendarSmall(e):a.clientWidth<r;s!==e.calendarState.isCalendarSmall.value&&(e.calendarState.isCalendarSmall.value=s,setScreenSizeCompatibleView(e,s))},getClassForView=e=>`is-${e.calendarState.view.value}-view`;function useWrapperClasses(e){const t="sx__calendar-wrapper",[a,r]=d$2([t,getClassForView(e)]);return useSignalEffect(()=>{const a=[t];e.calendarState.isCalendarSmall.value&&a.push("sx__is-calendar-small"),e.calendarState.isDark.value&&a.push("is-dark"),"shadcn"===e.config.theme&&a.push("is-shadcn"),a.push(getClassForView(e)),r(a)}),a}const initPlugins=e=>{Object.values(e.config.plugins).forEach(t=>{(null==t?void 0:t.onRender)&&t.onRender(e)})},destroyPlugins=e=>{Object.values(e.config.plugins).forEach(e=>{(null==e?void 0:e.destroy)&&e.destroy()})},invokePluginsBeforeRender=e=>{Object.values(e.config.plugins).forEach(t=>{(null==t?void 0:t.beforeRender)&&t.beforeRender(e)})};function CalendarWrapper({$app:e}){var t;const a=randomStringId(),r=randomStringId();y$2(()=>{var t;return setWrapperElement(e,a),initPlugins(e),(null===(t=e.config.callbacks)||void 0===t?void 0:t.onRender)&&e.config.callbacks.onRender(e),()=>destroyPlugins(e)},[]);const s=()=>{handleWindowResize(e)};y$2(()=>{if(e.config.isResponsive)return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]);const n=useWrapperClasses(e),[i,o]=d$2();useSignalEffect(()=>{const t=e.config.views.value.find(t=>t.name===e.calendarState.view.value),a=document.getElementById(r);t&&a&&t.name!==(null==i?void 0:i.name)&&(i&&i.destroy(),o(t),t.render(a,e))});const[l,c]=d$2(""),[d,u]=d$2("");return useSignalEffect(()=>{var t,a;if(e.calendarState.view.value===InternalViewName.List)return;const r=((null===(t=e.calendarState.range.value)||void 0===t?void 0:t.start)||"")>l;u(r?"sx__slide-left":"sx__slide-right"),setTimeout(()=>{u("")},300),c((null===(a=e.calendarState.range.value)||void 0===a?void 0:a.start)||"")}),useSignalEffect(()=>{e.datePickerConfig.locale.value=e.config.locale.value}),u$3(k$2,{children:u$3("div",{className:n.join(" "),id:a,children:u$3("div",{className:"sx__calendar",children:u$3(AppContext.Provider,{value:e,children:[u$3(CalendarHeader,{}),u$3("div",{className:["sx__view-container",d].join(" "),id:r}),e.config.plugins.eventModal&&e.config.plugins.eventModal.calendarEvent.value&&u$3(e.config.plugins.eventModal.ComponentFn,{$app:e},null===(t=e.config.plugins.eventModal.calendarEvent.value)||void 0===t?void 0:t.id)]})})})})}const externalEventToInternal=(e,t)=>{const a=e,{id:r,start:s,end:n,title:i,description:o,location:l,people:c,_options:d}=a,u=__objRest(a,["id","start","end","title","description","location","people","_options"]);return new CalendarEventBuilder(t,r,s,n).withTitle(i).withDescription(o).withLocation(l).withPeople(c).withCalendarId(e.calendarId).withOptions(d).withForeignProperties(u).withCustomContent(e._customContent).build()};class EventsFacadeImpl{constructor(e){Object.defineProperty(this,"$app",{enumerable:!0,configurable:!0,writable:!0,value:e})}set(e){this.$app.calendarEvents.list.value=e.map(e=>externalEventToInternal(e,this.$app.config))}add(e){const t=externalEventToInternal(e,this.$app.config);t._createdAt=new Date;const a=[...this.$app.calendarEvents.list.value];a.push(t),this.$app.calendarEvents.list.value=a}get(e){var t;return null===(t=this.$app.calendarEvents.list.value.find(t=>t.id===e))||void 0===t?void 0:t._getExternalEvent()}getAll(){return this.$app.calendarEvents.list.value.map(e=>e._getExternalEvent())}remove(e){const t=this.$app.calendarEvents.list.value.findIndex(t=>t.id===e),a=[...this.$app.calendarEvents.list.value];a.splice(t,1),this.$app.calendarEvents.list.value=a}update(e){const t=this.$app.calendarEvents.list.value.findIndex(t=>t.id===e.id),a=[...this.$app.calendarEvents.list.value];a.splice(t,1,externalEventToInternal(e,this.$app.config)),this.$app.calendarEvents.list.value=a}}class CalendarApp{constructor(e){var t;Object.defineProperty(this,"$app",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"calendarContainerEl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.events=new EventsFacadeImpl(this.$app),invokePluginsBeforeRender(this.$app),Object.values(this.$app.config.plugins).forEach(e=>{(null==e?void 0:e.name)&&(this[e.name]=e)}),(null===(t=e.config.callbacks)||void 0===t?void 0:t.beforeRender)&&e.config.callbacks.beforeRender(e)}render(e){this.calendarContainerEl=e,E$2(_$2(CalendarWrapper,{$app:this.$app}),e)}destroy(){Object.values(this.$app.config.plugins||{}).forEach(e=>{e&&e.destroy&&e.destroy()}),this.calendarContainerEl&&E$2(null,this.calendarContainerEl)}setTheme(e){this.$app.calendarState.isDark.value="dark"===e}getTheme(){return this.$app.calendarState.isDark.value?"dark":"light"}_setCustomComponentFn(e,t){this.$app.config._customComponentFns[e]=t}}class CalendarAppSingletonImpl{constructor(e,t,a,r,s,n,i,o={calendarWrapper:void 0}){Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"timeUnitsImpl",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"calendarState",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"datePickerState",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"translate",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"datePickerConfig",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"calendarEvents",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"elements",{enumerable:!0,configurable:!0,writable:!0,value:o})}}class CalendarAppSingletonBuilder{constructor(){Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeUnitsImpl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"datePickerState",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"calendarState",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"translate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"datePickerConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"calendarEvents",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}build(){return new CalendarAppSingletonImpl(this.config,this.timeUnitsImpl,this.calendarState,this.datePickerState,this.translate,this.datePickerConfig,this.calendarEvents)}withConfig(e){return this.config=e,this}withTimeUnitsImpl(e){return this.timeUnitsImpl=e,this}withDatePickerState(e){return this.datePickerState=e,this}withCalendarState(e){return this.calendarState=e,this}withTranslate(e){return this.translate=e,this}withDatePickerConfig(e){return this.datePickerConfig=e,this}withCalendarEvents(e){return this.calendarEvents=e,this}}var DateFormatDelimiter,DateFormatDelimiter2,DateFormatOrder,DateFormatOrder2;DateFormatDelimiter2=DateFormatDelimiter||(DateFormatDelimiter={}),DateFormatDelimiter2.SLASH="/",DateFormatDelimiter2.DASH="-",DateFormatDelimiter2.PERIOD=".",DateFormatOrder2=DateFormatOrder||(DateFormatOrder={}),DateFormatOrder2.DMY="DMY",DateFormatOrder2.MDY="MDY",DateFormatOrder2.YMD="YMD";const formatRules={slashMDY:{delimiter:DateFormatDelimiter.SLASH,order:DateFormatOrder.MDY},slashDMY:{delimiter:DateFormatDelimiter.SLASH,order:DateFormatOrder.DMY},slashYMD:{delimiter:DateFormatDelimiter.SLASH,order:DateFormatOrder.YMD},periodDMY:{delimiter:DateFormatDelimiter.PERIOD,order:DateFormatOrder.DMY},dashYMD:{delimiter:DateFormatDelimiter.DASH,order:DateFormatOrder.YMD},dashDMY:{delimiter:DateFormatDelimiter.DASH,order:DateFormatOrder.DMY}},dateFormatLocalizedRules=new Map([["ca-ES",formatRules.slashDMY],["cs-CZ",formatRules.periodDMY],["da-DK",formatRules.periodDMY],["de-DE",formatRules.periodDMY],["en-GB",formatRules.slashDMY],["en-US",formatRules.slashMDY],["es-ES",formatRules.slashDMY],["et-EE",formatRules.periodDMY],["fi-FI",formatRules.periodDMY],["fr-FR",formatRules.slashDMY],["fr-CH",formatRules.periodDMY],["hr-HR",formatRules.periodDMY],["id-ID",formatRules.slashDMY],["it-IT",formatRules.slashDMY],["ja-JP",formatRules.slashYMD],["ko-KR",formatRules.slashYMD],["ky-KG",formatRules.slashDMY],["lt-LT",formatRules.dashYMD],["mk-MK",formatRules.periodDMY],["nl-NL",formatRules.dashDMY],["pl-PL",formatRules.periodDMY],["pt-BR",formatRules.slashDMY],["ro-RO",formatRules.periodDMY],["ru-RU",formatRules.periodDMY],["sk-SK",formatRules.periodDMY],["sl-SI",formatRules.periodDMY],["sr-Latn-RS",formatRules.periodDMY],["sr-RS",formatRules.periodDMY],["sv-SE",formatRules.dashYMD],["tr-TR",formatRules.periodDMY],["uk-UA",formatRules.periodDMY],["zh-CN",formatRules.slashYMD],["zh-TW",formatRules.slashYMD]]);class LocaleNotSupportedError extends Error{constructor(e){super(`Locale not supported: ${e}`)}}class InvalidDateFormatError extends Error{constructor(e,t){super(`Invalid date format: ${e} for locale: ${t}`)}}const _getMatchesOrThrow=(e,t,a)=>{const r=e.match(t);if(!r)throw new InvalidDateFormatError(e,a);return r},toDateString=(e,t)=>{if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;const a=dateFormatLocalizedRules.get(t);if(!a)throw new LocaleNotSupportedError(t);const{order:r,delimiter:s}=a,n=/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/,i=/^(\d{1,2})\.(\d{1,2})\.(\d{4})$/,o=/^(\d{4})\/(\d{1,2})\/(\d{1,2})$/;if(r===DateFormatOrder.DMY&&s===DateFormatDelimiter.SLASH){const a=_getMatchesOrThrow(e,n,t),[,r,s,i]=a;return`${i}-${doubleDigit(+s)}-${doubleDigit(+r)}`}if(r===DateFormatOrder.MDY&&s===DateFormatDelimiter.SLASH){const a=_getMatchesOrThrow(e,n,t),[,r,s,i]=a;return`${i}-${doubleDigit(+r)}-${doubleDigit(+s)}`}if(r===DateFormatOrder.YMD&&s===DateFormatDelimiter.SLASH){const a=_getMatchesOrThrow(e,o,t),[,r,s,n]=a;return`${r}-${doubleDigit(+s)}-${doubleDigit(+n)}`}if(r===DateFormatOrder.DMY&&s===DateFormatDelimiter.PERIOD){const a=_getMatchesOrThrow(e,i,t),[,r,s,n]=a;return`${n}-${doubleDigit(+s)}-${doubleDigit(+r)}`}throw new InvalidDateFormatError(e,t)},createDatePickerState=(e,t)=>{var a;const r=toDateString$1(new Date),s="string"==typeof t?t:r,n=d$1(!1),i=d$1(e.disabled||!1),o=d$1(DatePickerView.MONTH_DAYS),l=d$1(s),c=d$1(s||r),d=d$1((null===(a=e.style)||void 0===a?void 0:a.dark)||!1),u=d$1(t?toLocalizedDateString(toJSDate(t),e.locale.value):""),m=d$1(u.value);E(()=>{try{const t=toDateString(u.value,e.locale.value);if(t<e.min||t>e.max)return void(u.value=m.value);l.value=t,c.value=t,m.value=u.value}catch(t){}});let p=!1;return E(()=>{var t;(null===(t=e.listeners)||void 0===t?void 0:t.onChange)&&(t=>{if(!p)return p=!0;e.listeners.onChange(t)})(l.value)}),{inputWrapperElement:d$1(void 0),isOpen:n,isDisabled:i,datePickerView:o,selectedDate:l,datePickerDate:c,inputDisplayedValue:u,isDark:d,open:()=>n.value=!0,close:()=>n.value=!1,toggle:()=>n.value=!n.value,setView:e=>o.value=e}},datePickerArEG={Date:"التاريخ","MM/DD/YYYY":"DD/MM/YYYY","Next month":"الشهر القادم","Previous month":"الشهر السابق","Choose Date":"اختر التاريخ"},timePickerArEG={Time:"الوقت",AM:"ص",PM:"م",Cancel:"إلغاء",OK:"موافق","Select time":"اختر الوقت"},calendarArEG={Today:"اليوم",Month:"الشهر",Week:"الأسبوع",Day:"اليوم",List:"القائمة","Select View":"اختر العرض","+ {{n}} events":"+ {{n}} الأحداث","+ 1 event":"+ 1 حدث","No events":"لا توجد أحداث","Next period":"الفترة التالية","Previous period":"الفترة السابقة",to:"إلى","Full day- and multiple day events":"أحداث ليوم كامل أو لعدة أيام","Link to {{n}} more events on {{date}}":"رابط إلى {{n}} أحداث أخرى في {{date}}","Link to 1 more event on {{date}}":"رابط إلى حدث آخر في {{date}}",CW:"الأسبوع {{week}}"},arEG=__spreadValues(__spreadValues(__spreadValues({},calendarArEG),datePickerArEG),timePickerArEG),datePickerDeDE={Date:"Datum","MM/DD/YYYY":"TT.MM.JJJJ","Next month":"Nächster Monat","Previous month":"Vorheriger Monat","Choose Date":"Datum auswählen"},calendarDeDE={Today:"Heute",Month:"Monat",Week:"Woche",Day:"Tag",List:"Liste","Select View":"Ansicht auswählen","+ {{n}} events":"+ {{n}} Ereignisse","+ 1 event":"+ 1 Ereignis","No events":"Keine Ereignisse","Next period":"Nächster Zeitraum","Previous period":"Vorheriger Zeitraum",to:"bis","Full day- and multiple day events":"Ganztägige und mehrtägige Termine","Link to {{n}} more events on {{date}}":"Link zu {{n}} weiteren Terminen am {{date}}","Link to 1 more event on {{date}}":"Link zu 1 weiterem Termin am {{date}}",CW:"KW {{week}}"},timePickerDeDE={Time:"Uhrzeit",AM:"AM",PM:"PM",Cancel:"Abbrechen",OK:"OK","Select time":"Uhrzeit auswählen"},deDE=__spreadValues(__spreadValues(__spreadValues({},datePickerDeDE),calendarDeDE),timePickerDeDE),datePickerEnUS={Date:"Date","MM/DD/YYYY":"MM/DD/YYYY","Next month":"Next month","Previous month":"Previous month","Choose Date":"Choose Date"},calendarEnUS={Today:"Today",Month:"Month",Week:"Week",Day:"Day",List:"List","Select View":"Select View","+ {{n}} events":"+ {{n}} events","+ 1 event":"+ 1 event","No events":"No events","Next period":"Next period","Previous period":"Previous period",to:"to","Full day- and multiple day events":"Full day- and multiple day events","Link to {{n}} more events on {{date}}":"Link to {{n}} more events on {{date}}","Link to 1 more event on {{date}}":"Link to 1 more event on {{date}}",CW:"Week {{week}}"},timePickerEnUS={Time:"Time",AM:"AM",PM:"PM",Cancel:"Cancel",OK:"OK","Select time":"Select time"},enUS=__spreadValues(__spreadValues(__spreadValues({},datePickerEnUS),calendarEnUS),timePickerEnUS),datePickerItIT={Date:"Data","MM/DD/YYYY":"DD/MM/YYYY","Next month":"Mese successivo","Previous month":"Mese precedente","Choose Date":"Scegli la data"},calendarItIT={Today:"Oggi",Month:"Mese",Week:"Settimana",Day:"Giorno",List:"Lista","Select View":"Seleziona la vista","+ {{n}} events":"+ {{n}} eventi","+ 1 event":"+ 1 evento","No events":"Nessun evento","Next period":"Periodo successivo","Previous period":"Periodo precedente",to:"a","Full day- and multiple day events":"Eventi della giornata e plurigiornalieri","Link to {{n}} more events on {{date}}":"Link a {{n}} eventi in più il {{date}}","Link to 1 more event on {{date}}":"Link a 1 evento in più il {{date}}",CW:"Settimana {{week}}"},timePickerItIT={Time:"Ora",AM:"AM",PM:"PM",Cancel:"Annulla",OK:"OK","Select time":"Seleziona ora"},itIT=__spreadValues(__spreadValues(__spreadValues({},datePickerItIT),calendarItIT),timePickerItIT),datePickerEnGB={Date:"Date","MM/DD/YYYY":"DD/MM/YYYY","Next month":"Next month","Previous month":"Previous month","Choose Date":"Choose Date"},calendarEnGB={Today:"Today",Month:"Month",Week:"Week",Day:"Day",List:"List","Select View":"Select View","+ {{n}} events":"+ {{n}} events","+ 1 event":"+ 1 event","No events":"No events","Next period":"Next period","Previous period":"Previous period",to:"to","Full day- and multiple day events":"Full day- and multiple day events","Link to {{n}} more events on {{date}}":"Link to {{n}} more events on {{date}}","Link to 1 more event on {{date}}":"Link to 1 more event on {{date}}",CW:"Week {{week}}"},timePickerEnGB={Time:"Time",AM:"AM",PM:"PM",Cancel:"Cancel",OK:"OK","Select time":"Select time"},enGB=__spreadValues(__spreadValues(__spreadValues({},datePickerEnGB),calendarEnGB),timePickerEnGB),datePickerSvSE={Date:"Datum","MM/DD/YYYY":"ÅÅÅÅ-MM-DD","Next month":"Nästa månad","Previous month":"Föregående månad","Choose Date":"Välj datum"},calendarSvSE={Today:"Idag",Month:"Månad",Week:"Vecka",Day:"Dag",List:"Lista","Select View":"Välj vy","+ {{n}} events":"+ {{n}} händelser","+ 1 event":"+ 1 händelse","No events":"Inga händelser","Next period":"Nästa period","Previous period":"Föregående period",to:"till","Full day- and multiple day events":"Heldags- och flerdagshändelser","Link to {{n}} more events on {{date}}":"Länk till {{n}} fler händelser den {{date}}","Link to 1 more event on {{date}}":"Länk till 1 händelse till den {{date}}",CW:"Vecka {{week}}"},timePickerSvSE={Time:"Tid",AM:"FM",PM:"EM",Cancel:"Avbryt",OK:"OK","Select time":"Välj tid"},svSE=__spreadValues(__spreadValues(__spreadValues({},datePickerSvSE),calendarSvSE),timePickerSvSE),datePickerZhCN={Date:"日期","MM/DD/YYYY":"年/月/日","Next month":"下个月","Previous month":"上个月","Choose Date":"选择日期"},calendarZhCN={Today:"今天",Month:"月",Week:"周",Day:"日",List:"列表","Select View":"选择视图","+ {{n}} events":"+ {{n}} 场活动","+ 1 event":"+ 1 活动","No events":"没有活动","Next period":"下一段时间","Previous period":"上一段时间",to:"至","Full day- and multiple day events":"全天和多天活动","Link to {{n}} more events on {{date}}":"链接到{{date}}上的{{n}}个更多活动","Link to 1 more event on {{date}}":"链接到{{date}}上的1个更多活动",CW:"第{{week}}周"},timePickerZhCN={Time:"时间",AM:"上午",PM:"下午",Cancel:"取消",OK:"确定","Select time":"选择时间"},zhCN=__spreadValues(__spreadValues(__spreadValues({},datePickerZhCN),calendarZhCN),timePickerZhCN),datePickerZhTW={Date:"日期","MM/DD/YYYY":"年/月/日","Next month":"下個月","Previous month":"上個月","Choose Date":"選擇日期"},calendarZhTW={Today:"今天",Month:"月",Week:"周",Day:"日",List:"列表","Select View":"選擇檢視模式","+ {{n}} events":"+ {{n}} 場活動","+ 1 event":"+ 1 活動","No events":"沒有活動","Next period":"下一段時間","Previous period":"上一段時間",to:"到","Full day- and multiple day events":"全天和多天活動","Link to {{n}} more events on {{date}}":"連接到{{date}}上的{{n}}個更多活動","Link to 1 more event on {{date}}":"連接到{{date}}上的1個更多活動",CW:"第{{week}}周"},timePickerZhTW={Time:"時間",AM:"上午",PM:"下午",Cancel:"取消",OK:"確定","Select time":"選擇時間"},zhTW=__spreadValues(__spreadValues(__spreadValues({},datePickerZhTW),calendarZhTW),timePickerZhTW),datePickerJaJP={Date:"日付","MM/DD/YYYY":"年/月/日","Next month":"次の月","Previous month":"前の月","Choose Date":"日付を選択"},calendarJaJP={Today:"今日",Month:"月",Week:"週",Day:"日",List:"リスト","Select View":"ビューを選択","+ {{n}} events":"+ {{n}} イベント","+ 1 event":"+ 1 イベント","No events":"イベントなし","Next period":"次の期間","Previous period":"前の期間",to:"から","Full day- and multiple day events":"終日および複数日イベント","Link to {{n}} more events on {{date}}":"{{date}} に{{n}}件のイベントへのリンク","Link to 1 more event on {{date}}":"{{date}} に1件のイベントへのリンク",CW:"週 {{week}}"},timePickerJaJP={Time:"時間",AM:"午前",PM:"午後",Cancel:"キャンセル",OK:"OK","Select time":"時間を選択"},jaJP=__spreadValues(__spreadValues(__spreadValues({},datePickerJaJP),calendarJaJP),timePickerJaJP),datePickerRuRU={Date:"Дата","MM/DD/YYYY":"ММ/ДД/ГГГГ","Next month":"Следующий месяц","Previous month":"Прошлый месяц","Choose Date":"Выберите дату"},calendarRuRU={Today:"Сегодня",Month:"Месяц",Week:"Неделя",Day:"День",List:"Список","Select View":"Выберите вид","+ {{n}} events":"+ {{n}} события","+ 1 event":"+ 1 событие","No events":"Нет событий","Next period":"Следующий период","Previous period":"Прошлый период",to:"по","Full day- and multiple day events":"События на целый день и несколько дней подряд","Link to {{n}} more events on {{date}}":"Ссылка на {{n}} дополнительных событий на {{date}}","Link to 1 more event on {{date}}":"Ссылка на 1 дополнительное событие на {{date}}",CW:"Неделя {{week}}"},timePickerRuRU={Time:"Время",AM:"AM",PM:"PM",Cancel:"Отмена",OK:"ОК","Select time":"Выберите время"},ruRU=__spreadValues(__spreadValues(__spreadValues({},datePickerRuRU),calendarRuRU),timePickerRuRU),datePickerKoKR={Date:"일자","MM/DD/YYYY":"년/월/일","Next month":"다음 달","Previous month":"이전 달","Choose Date":"날짜 선택"},calendarKoKR={Today:"오늘",Month:"월",Week:"주",Day:"일",List:"목록","Select View":"보기 선택","+ {{n}} events":"+ {{n}} 일정들","+ 1 event":"+ 1 일정","No events":"일정 없음","Next period":"다음","Previous period":"이전",to:"부터","Full day- and multiple day events":"종일 및 복수일 일정","Link to {{n}} more events on {{date}}":"{{date}}에 {{n}}개 이상의 이벤트로 이동","Link to 1 more event on {{date}}":"{{date}}에 1개 이상의 이벤트로 이동",CW:"{{week}}주"},timePickerKoKR={Time:"시간",AM:"오전",PM:"오후",Cancel:"취소",OK:"확인","Select time":"시간 선택"},koKR=__spreadValues(__spreadValues(__spreadValues({},datePickerKoKR),calendarKoKR),timePickerKoKR),datePickerFrFR={Date:"Date","MM/DD/YYYY":"JJ/MM/AAAA","Next month":"Mois suivant","Previous month":"Mois précédent","Choose Date":"Choisir une date"},calendarFrFR={Today:"Aujourd'hui",Month:"Mois",Week:"Semaine",Day:"Jour",List:"Liste","Select View":"Sélectionner la vue","+ {{n}} events":"+ {{n}} événements","+ 1 event":"+ 1 événement","No events":"Aucun événement","Next period":"Période suivante","Previous period":"Période précédente",to:"au","Full day- and multiple day events":"Événements sur une journée ou plusieurs jours","Link to {{n}} more events on {{date}}":"Lien vers {{n}} événements supplémentaires le {{date}}","Link to 1 more event on {{date}}":"Lien vers 1 événement supplémentaire le {{date}}",CW:"S{{week}}"},timePickerFrFR={Time:"Heure",AM:"AM",PM:"PM",Cancel:"Annuler",OK:"OK","Select time":"Sélectionner l'heure"},frFR=__spreadValues(__spreadValues(__spreadValues({},datePickerFrFR),calendarFrFR),timePickerFrFR),datePickerDaDK={Date:"Dato","MM/DD/YYYY":"ÅÅÅÅ-MM-DD","Next month":"Næste måned","Previous month":"Foregående måned","Choose Date":"Vælg dato"},calendarDaDK={Today:"I dag",Month:"Måned",Week:"Uge",Day:"Dag",List:"Liste","Select View":"Vælg visning","+ {{n}} events":"+ {{n}} begivenheder","+ 1 event":"+ 1 begivenhed","No events":"Ingen begivenheder","Next period":"Næste periode","Previous period":"Forgående periode",to:"til","Full day- and multiple day events":"Heldagsbegivenheder og flerdagsbegivenheder","Link to {{n}} more events on {{date}}":"Link til {{n}} flere begivenheder den {{date}}","Link to 1 more event on {{date}}":"Link til 1 mere begivenhed den {{date}}",CW:"Uge {{week}}"},timePickerDaDK={Time:"Tid",AM:"AM",PM:"PM",Cancel:"Annuller",OK:"OK","Select time":"Vælg tid"},daDK=__spreadValues(__spreadValues(__spreadValues({},datePickerDaDK),calendarDaDK),timePickerDaDK),datePickerPlPL={Date:"Data","MM/DD/YYYY":"DD/MM/YYYY","Next month":"Następny miesiąc","Previous month":"Poprzedni miesiąc","Choose Date":"Wybiewrz datę"},calendarPlPL={Today:"Dzisiaj",Month:"Miesiąc",Week:"Tydzień",Day:"Dzień",List:"Lista","Select View":"Wybierz widok","+ {{n}} events":"+ {{n}} wydarzenia","+ 1 event":"+ 1 wydarzenie","No events":"Brak wydarzeń","Next period":"Następny okres","Previous period":"Poprzedni okres",to:"do","Full day- and multiple day events":"Wydarzenia całodniowe i wielodniowe","Link to {{n}} more events on {{date}}":"Link do {{n}} kolejnych wydarzeń w dniu {{date}}","Link to 1 more event on {{date}}":"Link do 1 kolejnego wydarzenia w dniu {{date}}",CW:"Tydzień {{week}}"},timePickerPlPL={Time:"Godzina",AM:"AM",PM:"PM",Cancel:"Anuluj",OK:"OK","Select time":"Wybierz godzinę"},plPL=__spreadValues(__spreadValues(__spreadValues({},datePickerPlPL),calendarPlPL),timePickerPlPL),datePickerEsES={Date:"Fecha","MM/DD/YYYY":"DD/MM/YYYY","Next month":"Siguiente mes","Previous month":"Mes anterior","Choose Date":"Seleccione una fecha"},calendarEsES={Today:"Hoy",Month:"Mes",Week:"Semana",Day:"Día",List:"Lista","Select View":"Seleccionar vista","+ {{n}} events":"+ {{n}} eventos","+ 1 event":"+ 1 evento","No events":"No hay eventos","Next period":"Siguiente período","Previous period":"Período anterior",to:"a","Full day- and multiple day events":"Día completo y eventos de múltiples días","Link to {{n}} more events on {{date}}":"Enlace a {{n}} eventos más el {{date}}","Link to 1 more event on {{date}}":"Enlace a 1 evento más el {{date}}",CW:"Semana {{week}}"},timePickerEsES={Time:"Hora",AM:"AM",PM:"PM",Cancel:"Cancelar",OK:"Aceptar","Select time":"Seleccionar hora"},esES=__spreadValues(__spreadValues(__spreadValues({},datePickerEsES),calendarEsES),timePickerEsES),calendarNlNL={Today:"Vandaag",Month:"Maand",Week:"Week",Day:"Dag",List:"Lijst","Select View":"Kies weergave","+ {{n}} events":"+ {{n}} gebeurtenissen","+ 1 event":"+ 1 gebeurtenis","No events":"Geen gebeurtenissen","Next period":"Volgende periode","Previous period":"Vorige periode",to:"tot","Full day- and multiple day events":"Evenementen van een hele dag en meerdere dagen","Link to {{n}} more events on {{date}}":"Link naar {{n}} meer evenementen op {{date}}","Link to 1 more event on {{date}}":"Link naar 1 meer evenement op {{date}}",CW:"Week {{week}}"},datePickerNlNL={Date:"Datum","MM/DD/YYYY":"DD-MM-JJJJ","Next month":"Volgende maand","Previous month":"Vorige maand","Choose Date":"Kies datum"},timePickerNlNL={Time:"Tijd",AM:"AM",PM:"PM",Cancel:"Annuleren",OK:"OK","Select time":"Selecteer tijd"},nlNL=__spreadValues(__spreadValues(__spreadValues({},datePickerNlNL),calendarNlNL),timePickerNlNL),datePickerPtBR={Date:"Data","MM/DD/YYYY":"DD/MM/YYYY","Next month":"Mês seguinte","Previous month":"Mês anterior","Choose Date":"Escolha uma data"},calendarPtBR={Today:"Hoje",Month:"Mês",Week:"Semana",Day:"Dia",List:"Lista","Select View":"Selecione uma visualização","+ {{n}} events":"+ {{n}} eventos","+ 1 event":"+ 1 evento","No events":"Sem eventos","Next period":"Período seguinte","Previous period":"Período anterior",to:"a","Full day- and multiple day events":"Dia inteiro e eventos de vários dias","Link to {{n}} more events on {{date}}":"Link para mais {{n}} eventos em {{date}}","Link to 1 more event on {{date}}":"Link para mais 1 evento em {{date}}",CW:"Semana {{week}}"},timePickerPtBR={Time:"Hora",AM:"AM",PM:"PM",Cancel:"Cancelar",OK:"OK","Select time":"Selecionar hora"},ptBR=__spreadValues(__spreadValues(__spreadValues({},datePickerPtBR),calendarPtBR),timePickerPtBR),datePickerSkSK={Date:"Dátum","MM/DD/YYYY":"DD/MM/YYYY","Next month":"Ďalší mesiac","Previous month":"Predchádzajúci mesiac","Choose Date":"Vyberte dátum"},calendarSkSK={Today:"Dnes",Month:"Mesiac",Week:"Týždeň",Day:"Deň",List:"Zoznam","Select View":"Vyberte zobrazenie","+ {{n}} events":"+ {{n}} udalosti","+ 1 event":"+ 1 udalosť","No events":"Žiadne udalosti","Next period":"Ďalšie obdobie","Previous period":"Predchádzajúce obdobie",to:"do","Full day- and multiple day events":"Celodenné a viacdňové udalosti","Link to {{n}} more events on {{date}}":"Odkaz na {{n}} ďalších udalostí dňa {{date}}","Link to 1 more event on {{date}}":"Odkaz na 1 ďalšiu udalosť dňa {{date}}",CW:"{{week}}. týždeň"},timePickerSkSK={Time:"Čas",AM:"AM",PM:"PM",Cancel:"Zrušiť",OK:"OK","Select time":"Vybrať čas"},skSK=__spreadValues(__spreadValues(__spreadValues({},datePickerSkSK),calendarSkSK),timePickerSkSK),datePickerMkMK={Date:"Датум","MM/DD/YYYY":"DD/MM/YYYY","Next month":"Следен месец","Previous month":"Претходен месец","Choose Date":"Избери Датум"},calendarMkMK={Today:"Денес",Month:"Месец",Week:"Недела",Day:"Ден",List:"Листа","Select View":"Избери Преглед","+ {{n}} events":"+ {{n}} настани","+ 1 event":"+ 1 настан","No events":"Нема настани","Next period":"Следен период","Previous period":"Претходен период",to:"до","Full day- and multiple day events":"Целодневни и повеќедневни настани","Link to {{n}} more events on {{date}}":"Линк до {{n}} повеќе настани на {{date}}","Link to 1 more event on {{date}}":"Линк до 1 повеќе настан на {{date}}",CW:"Недела {{week}}"},timePickerMkMK={Time:"Време",AM:"AM",PM:"PM",Cancel:"Откажи",OK:"У реду","Select time":"Избери време"},mkMK=__spreadValues(__spreadValues(__spreadValues({},datePickerMkMK),calendarMkMK),timePickerMkMK),datePickerTrTR={Date:"Tarih","MM/DD/YYYY":"GG/AA/YYYY","Next month":"Sonraki ay","Previous month":"Önceki ay","Choose Date":"Tarih Seç"},calendarTrTR={Today:"Bugün",Month:"Aylık",Week:"Haftalık",Day:"Günlük",List:"Liste","Select View":"Görünüm Seç","+ {{n}} events":"+ {{n}} etkinlikler","+ 1 event":"+ 1 etkinlik","No events":"Etkinlik yok","Next period":"Sonraki dönem","Previous period":"Önceki dönem",to:"dan","Full day- and multiple day events":"Tüm gün ve çoklu gün etkinlikleri","Link to {{n}} more events on {{date}}":"{{date}} tarihinde {{n}} etkinliğe bağlantı","Link to 1 more event on {{date}}":"{{date}} tarihinde 1 etkinliğe bağlantı",CW:"{{week}}. Hafta"},timePickerTrTR={Time:"Zaman",AM:"ÖÖ",PM:"ÖS",Cancel:"İptal",OK:"Tamam","Select time":"Zamanı seç"},trTR=__spreadValues(__spreadValues(__spreadValues({},datePickerTrTR),calendarTrTR),timePickerTrTR),datePickerKyKG={Date:"Датасы","MM/DD/YYYY":"АА/КК/ЖЖЖЖ","Next month":"Кийинки ай","Previous month":"Өткөн ай","Choose Date":"Күндү тандаңыз"},calendarKyKG={Today:"Бүгүн",Month:"Ай",Week:"Апта",Day:"Күн",List:"Тизме","Select View":"Көрүнүштү тандаңыз","+ {{n}} events":"+ {{n}} Окуялар","+ 1 event":"+ 1 Окуя","No events":"Окуя жок","Next period":"Кийинки мезгил","Previous period":"Өткөн мезгил",to:"чейин","Full day- and multiple day events":"Күн бою жана бир нече күн катары менен болгон окуялар","Link to {{n}} more events on {{date}}":"{{date}} күнүндө {{n}} окуяга байланыш","Link to 1 more event on {{date}}":"{{date}} күнүндө 1 окуяга байланыш",CW:"Апта {{week}}"},timePickerKyKG={Time:"Убакты",AM:"AM",PM:"PM",Cancel:"Болбой",OK:"Ооба","Select time":"Убакты тандаңыз"},kyKG=__spreadValues(__spreadValues(__spreadValues({},datePickerKyKG),calendarKyKG),timePickerKyKG),datePickerIdID={Date:"Tanggal","MM/DD/YYYY":"DD.MM.YYYY","Next month":"Bulan depan","Previous month":"Bulan sebelumnya","Choose Date":"Pilih tanggal"},calendarIdID={Today:"Hari Ini",Month:"Bulan",Week:"Minggu",Day:"Hari",List:"Daftar","Select View":"Pilih tampilan","+ {{n}} events":"+ {{n}} Acara","+ 1 event":"+ 1 Acara","No events":"Tidak ada acara","Next period":"Periode selanjutnya","Previous period":"Periode sebelumnya",to:"sampai","Full day- and multiple day events":"Sepanjang hari dan acara beberapa hari ","Link to {{n}} more events on {{date}}":"Tautan ke {{n}} acara lainnya pada {{date}}","Link to 1 more event on {{date}}":"Tautan ke 1 acara lainnya pada {{date}}",CW:"Minggu {{week}}"},timePickerIdID={Time:"Waktu",AM:"AM",PM:"PM",Cancel:"Batalkan",OK:"OK","Select time":"Pilih waktu"},idID=__spreadValues(__spreadValues(__spreadValues({},datePickerIdID),calendarIdID),timePickerIdID),datePickerCsCZ={Date:"Datum","MM/DD/YYYY":"DD/MM/YYYY","Next month":"Další měsíc","Previous month":"Předchozí měsíc","Choose Date":"Vyberte datum"},calendarCsCZ={Today:"Dnes",Month:"Měsíc",Week:"Týden",Day:"Den",List:"Seznam","Select View":"Vyberte zobrazení","+ {{n}} events":"+ {{n}} události","+ 1 event":"+ 1 událost","No events":"Žádné události","Next period":"Příští období","Previous period":"Předchozí období",to:"do","Full day- and multiple day events":"Celodenní a vícedenní události","Link to {{n}} more events on {{date}}":"Odkaz na {{n}} dalších událostí dne {{date}}","Link to 1 more event on {{date}}":"Odkaz na 1 další událost dne {{date}}",CW:"Týden {{week}}"},timePickerCsCZ={Time:"Čas",AM:"Dopoledne",PM:"Odpoledne",Cancel:"Zrušit",OK:"OK","Select time":"Vyberte čas"},csCZ=__spreadValues(__spreadValues(__spreadValues({},datePickerCsCZ),calendarCsCZ),timePickerCsCZ),datePickerEtEE={Date:"Kuupäev","MM/DD/YYYY":"PP.KK.AAAA","Next month":"Järgmine kuu","Previous month":"Eelmine kuu","Choose Date":"Vali kuupäev"},calendarEtEE={Today:"Täna",Month:"Kuu",Week:"Nädal",Day:"Päev",List:"Nimekiri","Select View":"Vali vaade","+ {{n}} events":"+ {{n}} sündmused","+ 1 event":"+ 1 sündmus","No events":"Pole sündmusi","Next period":"Järgmine periood","Previous period":"Eelmine periood",to:"kuni","Full day- and multiple day events":"Täispäeva- ja mitmepäevasündmused","Link to {{n}} more events on {{date}}":"Link {{n}} rohkematele sündmustele kuupäeval {{date}}","Link to 1 more event on {{date}}":"Link ühele lisasündmusele kuupäeval {{date}}",CW:"Nädala number {{week}}"},timePickerEtEE={Time:"Aeg",AM:"AM",PM:"PM",Cancel:"Loobu",OK:"OK","Select time":"Vali aeg"},etEE=__spreadValues(__spreadValues(__spreadValues({},datePickerEtEE),calendarEtEE),timePickerEtEE),datePickerUkUA={Date:"Дата","MM/DD/YYYY":"ММ/ДД/РРРР","Next month":"Наступний місяць","Previous month":"Минулий місяць","Choose Date":"Виберіть дату"},calendarUkUA={Today:"Сьогодні",Month:"Місяць",Week:"Тиждень",Day:"День",List:"Список","Select View":"Виберіть вигляд","+ {{n}} events":"+ {{n}} події","+ 1 event":"+ 1 подія","No events":"Немає подій","Next period":"Наступний період","Previous period":"Минулий період",to:"по","Full day- and multiple day events":"Події на цілий день і кілька днів поспіль","Link to {{n}} more events on {{date}}":"Посилання на {{n}} додаткові події на {{date}}","Link to 1 more event on {{date}}":"Посилання на 1 додаткову подію на {{date}}",CW:"Тиждень {{week}}"},timePickerUkUA={Time:"Час",AM:"AM",PM:"PM",Cancel:"Скасувати",OK:"Гаразд","Select time":"Виберіть час"},ukUA=__spreadValues(__spreadValues(__spreadValues({},datePickerUkUA),calendarUkUA),timePickerUkUA),datePickerSrLatnRS={Date:"Datum","MM/DD/YYYY":"DD/MM/YYYY","Next month":"Sledeći mesec","Previous month":"Prethodni mesec","Choose Date":"Izaberite datum"},calendarSrLatnRS={Today:"Danas",Month:"Mesec",Week:"Nedelja",Day:"Dan",List:"Lista","Select View":"Odaberite pregled","+ {{n}} events":"+ {{n}} Događaji","+ 1 event":"+ 1 Događaj","No events":"Nema događaja","Next period":"Naredni period","Previous period":"Prethodni period",to:"do","Full day- and multiple day events":"Celodnevni i višednevni događaji","Link to {{n}} more events on {{date}}":"Link do još {{n}} događaja na {{date}}","Link to 1 more event on {{date}}":"Link do jednog događaja na {{date}}",CW:"Nedelja {{week}}"},timePickerSrLatnRS={Time:"Vrijeme",AM:"AM",PM:"PM",Cancel:"Otkaži",OK:"U redu","Select time":"Odaberi vrijeme"},srLatnRS=__spreadValues(__spreadValues(__spreadValues({},datePickerSrLatnRS),calendarSrLatnRS),timePickerSrLatnRS),datePickerCaES={Date:"Data","MM/DD/YYYY":"DD/MM/YYYY","Next month":"Següent mes","Previous month":"Mes anterior","Choose Date":"Selecciona una data"},calendarCaES={Today:"Avui",Month:"Mes",Week:"Setmana",Day:"Dia",List:"Llista","Select View":"Selecciona una vista","+ {{n}} events":"+ {{n}} Esdeveniments","+ 1 event":"+ 1 Esdeveniment","No events":"Sense esdeveniments","Next period":"Següent període","Previous period":"Període anterior",to:"a","Full day- and multiple day events":"Esdeveniments de dia complet i de múltiples dies","Link to {{n}} more events on {{date}}":"Enllaç a {{n}} esdeveniments més el {{date}}","Link to 1 more event on {{date}}":"Enllaç a 1 esdeveniment més el {{date}}",CW:"Setmana {{week}}"},timePickerCaES={Time:"Hora",AM:"AM",PM:"PM",Cancel:"Cancel·lar",OK:"Acceptar","Select time":"Selecciona una hora"},caES=__spreadValues(__spreadValues(__spreadValues({},datePickerCaES),calendarCaES),timePickerCaES),datePickerSrRS={Date:"Датум","MM/DD/YYYY":"DD/MM/YYYY","Next month":"Следећи месец","Previous month":"Претходни месец","Choose Date":"Изаберите Датум"},calendarSrRS={Today:"Данас",Month:"Месец",Week:"Недеља",Day:"Дан",List:"Листа","Select View":"Изаберите преглед","+ {{n}} events":"+ {{n}} Догађаји","+ 1 event":"+ 1 Догађај","No events":"Нема догађаја","Next period":"Следећи период","Previous period":"Претходни период",to:"да","Full day- and multiple day events":"Целодневни и вишедневни догађаји","Link to {{n}} more events on {{date}}":"Линк до још {{n}} догађаја на {{date}}","Link to 1 more event on {{date}}":"Линк до још 1 догађаја {{date}}",CW:"Недеља {{week}}"},timePickerSrRS={Time:"Време",AM:"AM",PM:"PM",Cancel:"Откажи",OK:"У реду","Select time":"Изабери време"},srRS=__spreadValues(__spreadValues(__spreadValues({},datePickerSrRS),calendarSrRS),timePickerSrRS),datePickerLtLT={Date:"Data","MM/DD/YYYY":"MMMM-MM-DD","Next month":"Kitas mėnuo","Previous month":"Ankstesnis mėnuo","Choose Date":"Pasirinkite datą"},calendarLtLT={Today:"Šiandien",Month:"Mėnuo",Week:"Savaitė",Day:"Diena",List:"Sąrašas","Select View":"Pasirinkite vaizdą","+ {{n}} events":"+ {{n}} įvykiai","+ 1 event":"+ 1 įvykis","No events":"Įvykių nėra","Next period":"Kitas laikotarpis","Previous period":"Ankstesnis laikotarpis",to:"iki","Full day- and multiple day events":"Visos dienos ir kelių dienų įvykiai","Link to {{n}} more events on {{date}}":"Nuoroda į dar {{n}} įvykius {{date}}","Link to 1 more event on {{date}}":"Nuoroda į dar 1 vieną įvykį {{date}}",CW:"{{week}} savaitė"},timePickerLtLT={Time:"Laikas",AM:"AM",PM:"PM",Cancel:"Atšaukti",OK:"Gerai","Select time":"Pasirinkite laiką"},ltLT=__spreadValues(__spreadValues(__spreadValues({},datePickerLtLT),calendarLtLT),timePickerLtLT),datePickerHrHR={Date:"Datum","MM/DD/YYYY":"DD/MM/YYYY","Next month":"Sljedeći mjesec","Previous month":"Prethodni mjesec","Choose Date":"Izaberite datum"},calendarHrHR={Today:"Danas",Month:"Mjesec",Week:"Nedjelja",Day:"Dan",List:"Lista","Select View":"Odaberite pregled","+ {{n}} events":"+ {{n}} Događaji","+ 1 event":"+ 1 Događaj","No events":"Nema događaja","Next period":"Sljedeći period","Previous period":"Prethodni period",to:"do","Full day- and multiple day events":"Cjelodnevni i višednevni događaji","Link to {{n}} more events on {{date}}":"Link do još {{n}} događaja na {{date}}","Link to 1 more event on {{date}}":"Link do još jednog događaja na {{date}}",CW:"{{week}}. tjedan"},timePickerHrHR={Time:"Vrijeme",AM:"AM",PM:"PM",Cancel:"Otkaži",OK:"U redu","Select time":"Odaberi vrijeme"},hrHR=__spreadValues(__spreadValues(__spreadValues({},datePickerHrHR),calendarHrHR),timePickerHrHR),datePickerSlSI={Date:"Datum","MM/DD/YYYY":"MM.DD.YYYY","Next month":"Naslednji mesec","Previous month":"Prejšnji mesec","Choose Date":"Izberi datum"},calendarSlSI={Today:"Danes",Month:"Mesec",Week:"Teden",Day:"Dan",List:"Seznam","Select View":"Izberi pogled","+ {{n}} events":"+ {{n}} dogodki","+ 1 event":"+ 1 dogodek","No events":"Ni dogodkov","Next period":"Naslednji dogodek","Previous period":"Prejšnji dogodek",to:"do","Full day- and multiple day events":"Celodnevni in večdnevni dogodki","Link to {{n}} more events on {{date}}":"Povezava do {{n}} drugih dogodkov dne {{date}}","Link to 1 more event on {{date}}":"Povezava do še enega dogodka dne {{date}}",CW:"Teden {{week}}"},timePickerSlSI={Time:"Čas",AM:"AM",PM:"PM",Cancel:"Prekliči",OK:"V redu","Select time":"Izberite čas"},slSI=__spreadValues(__spreadValues(__spreadValues({},datePickerSlSI),calendarSlSI),timePickerSlSI),datePickerFiFI={Date:"Päivämäärä","MM/DD/YYYY":"VVVV-KK-PP","Next month":"Seuraava kuukausi","Previous month":"Edellinen kuukausi","Choose Date":"Valitse päivämäärä"},calendarFiFI={Today:"Tänään",Month:"Kuukausi",Week:"Viikko",Day:"Päivä",List:"Lista","Select View":"Valitse näkymä","+ {{n}} events":"+ {{n}} tapahtumaa","+ 1 event":"+ 1 tapahtuma","No events":"Ei tapahtumia","Next period":"Seuraava ajanjakso","Previous period":"Edellinen ajanjakso",to:"-","Full day- and multiple day events":"Koko ja usean päivän tapahtumat","Link to {{n}} more events on {{date}}":"Linkki {{n}} lisätapahtumaan päivämäärällä {{date}}","Link to 1 more event on {{date}}":"Linkki 1 lisätapahtumaan päivämäärällä {{date}}",CW:"Viikko {{week}}"},timePickerFiFI={Time:"Aika",AM:"ap.",PM:"ip.",Cancel:"Peruuta",OK:"OK","Select time":"Valitse aika"},fiFI=__spreadValues(__spreadValues(__spreadValues({},datePickerFiFI),calendarFiFI),timePickerFiFI),datePickerRoRO={Date:"Data","MM/DD/YYYY":"LL/ZZ/AAAA","Next month":"Luna următoare","Previous month":"Luna anterioară","Choose Date":"Alege data"},calendarRoRO={Today:"Astăzi",Month:"Lună",Week:"Săptămână",Day:"Zi",List:"Listă","Select View":"Selectează vizualizarea","+ {{n}} events":"+ {{n}} evenimente","+ 1 event":"+ 1 eveniment","No events":"Fără evenimente","Next period":"Perioada următoare","Previous period":"Perioada anterioară",to:"până la","Full day- and multiple day events":"Evenimente pe durata întregii zile și pe durata mai multor zile","Link to {{n}} more events on {{date}}":"Link către {{n}} evenimente suplimentare pe {{date}}","Link to 1 more event on {{date}}":"Link către 1 eveniment suplimentar pe {{date}}",CW:"Săptămâna {{week}}"},timePickerRoRO={Time:"Timp",AM:"AM",PM:"PM",Cancel:"Anulează",OK:"OK","Select time":"Selectați ora"},roRO=__spreadValues(__spreadValues(__spreadValues({},datePickerRoRO),calendarRoRO),timePickerRoRO),datePickerFaIR={Date:"تاریخ","MM/DD/YYYY":"MM/DD/YYYY","Next month":"ماه بعد","Previous month":"ماه قبل","Choose Date":"انتخاب تاریخ"},calendarFaIR={Today:"امروز",Month:"ماه",Week:"هفته",Day:"روز",List:"لیست","Select View":"انتخاب نما","+ {{n}} events":"+ {{n}} رویدادها","+ 1 event":"+ 1 رویداد","No events":"رویدادی وجود ندارد","Next period":"دوره بعدی","Previous period":"دوره قبلی",to:"تا","Full day- and multiple day events":"رویدادهای تمام روز و چند روزه","Link to {{n}} more events on {{date}}":"لینک به {{n}} رویداد بیشتر در تاریخ {{date}}","Link to 1 more event on {{date}}":"لینک به 1 رویداد بیشتر در تاریخ {{date}}",CW:"هفته {{week}}"},timePickerFaIR={Time:"زمان",AM:"ق.ظ",PM:"ب.ظ",Cancel:"لغو",OK:"تایید","Select time":"انتخاب زمان"},faIR=__spreadValues(__spreadValues(__spreadValues({},datePickerFaIR),calendarFaIR),timePickerFaIR);class InvalidLocaleError extends Error{constructor(e){super(`Invalid locale: ${e}`)}}const translate=(e,t)=>(a,r)=>{if(!/^[a-z]{2}-[A-Z]{2}$/.test(e.value)&&"sr-Latn-RS"!==e.value)throw new InvalidLocaleError(e.value);const s=e.value.replaceAll("-",""),n=t.value[s];if(!n)return a;let i=n[a]||a;return Object.keys(r||{}).forEach(e=>{const t=String(null==r?void 0:r[e]);t&&(i=i.replace(`{{${e}}}`,t))}),i},datePickerHeIL={Date:"תַאֲרִיך","MM/DD/YYYY":"MM/DD/YYYY","Next month":"חודש הבא","Previous month":"חודש קודם","Choose Date":"בחר תאריך"},calendarHeIL={Today:"הַיוֹם",Month:"חוֹדֶשׁ",Week:"שָׁבוּעַ",Day:"יוֹם",List:"רשימה","Select View":"בחר תצוגה","+ {{n}} events":"+ {{n}} אירועים","+ 1 event":"+ 1 אירוע","No events":"אין אירועים","Next period":"תקופה הבאה","Previous period":"תקופה קודמת",to:"עד","Full day- and multiple day events":"אירועים לכל היום ולמספר ימים","Link to {{n}} more events on {{date}}":"קישור לעוד {{n}} אירועים ב-{{date}}","Link to 1 more event on {{date}}":"קישור לאירוע נוסף ב-{{date}}",CW:"{{week}} שָׁבוּעַ"},timePickerHeIL={Time:"שעה",AM:'לפנה"צ',PM:'אחה"צ',Cancel:"ביטול",OK:"אישור","Select time":"בחר שעה"},heIL=__spreadValues(__spreadValues(__spreadValues({},datePickerHeIL),calendarHeIL),timePickerHeIL),translations={deDE:deDE,enUS:enUS,itIT:itIT,enGB:enGB,svSE:svSE,zhCN:zhCN,zhTW:zhTW,jaJP:jaJP,ruRU:ruRU,koKR:koKR,frFR:frFR,daDK:daDK,mkMK:mkMK,plPL:plPL,heIL:heIL,esES:esES,nlNL:nlNL,ptBR:ptBR,skSK:skSK,trTR:trTR,kyKG:kyKG,idID:idID,csCZ:csCZ,etEE:etEE,ukUA:ukUA,caES:caES,srLatnRS:srLatnRS,srRS:srRS,ltLT:ltLT,hrHR:hrHR,slSI:slSI,fiFI:fiFI,roRO:roRO,faIR:faIR,arEG:arEG};class EventColors{constructor(e){Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:e})}setLight(){Object.entries(this.config.calendars.value||{}).forEach(([e,t])=>{t.lightColors&&this.setColors(t.colorName,t.lightColors)})}setDark(){Object.entries(this.config.calendars.value||{}).forEach(([e,t])=>{t.darkColors&&this.setColors(t.colorName,t.darkColors)})}setColors(e,t){document.documentElement.style.setProperty(`--sx-color-${e}`,t.main),document.documentElement.style.setProperty(`--sx-color-${e}-container`,t.container),document.documentElement.style.setProperty(`--sx-color-on-${e}-container`,t.onContainer)}}const createCalendarState=(e,t,a)=>{var r;const s=d$1((null===(r=e.views.value.find(t=>t.name===e.defaultView))||void 0===r?void 0:r.name)||e.views.value[0].name),n=w$1(()=>s.value),i=d$1(null);let o=!1,l=null;E(()=>{i.value&&(t=>{if(!o)return o=!0;e.callbacks.onRangeUpdate&&t.value&&e.callbacks.onRangeUpdate(t.value);const a=l;t.value&&((null==a?void 0:a.start)===t.value.start&&(null==a?void 0:a.end)===t.value.end||Object.values(e.plugins||{}).forEach(e=>{var a;null===(a=null==e?void 0:e.onRangeUpdate)||void 0===a||a.call(e,t.value),l=t.value}))})(i)});const c=a=>{var r,n;const o=e.views.value.find(e=>e.name===s.value).setDateRange({calendarConfig:e,date:a,range:i,timeUnitsImpl:t});o.start===(null===(r=i.value)||void 0===r?void 0:r.start)&&o.end===(null===(n=i.value)||void 0===n?void 0:n.end)||(i.value=o)};c(a||toDateString$1(new Date));const d=d$1(void 0),u=d$1(e.isDark.value||!1);return E(()=>{const t=new EventColors(e);u.value?t.setDark():t.setLight()}),{view:n,isDark:u,setRange:c,range:i,isCalendarSmall:d,setView:(e,t)=>{r$1(()=>{s.value=e,c(t)})}}},createCalendarEventsImpl=(e,t,a)=>({list:d$1(e.map(e=>externalEventToInternal(e,a))),filterPredicate:d$1(void 0),backgroundEvents:d$1(t)}),timePointsPerDay=(e,t,a)=>e===t?2400:a?2400-e+t:t-e,getDirection=()=>{const e=document.querySelector("html");if(!e)return"ltr";return"rtl"===e.getAttribute("dir")?"rtl":"ltr"};class CalendarConfigImpl{constructor(e=DEFAULT_LOCALE,t=DEFAULT_FIRST_DAY_OF_WEEK,a=InternalViewName.Week,r=[],s=DEFAULT_DAY_BOUNDARIES,n,i={},o={},l=!1,c=!0,d={},u={},m=void 0,p=void 0,x={nEventsPerDay:4},h=void 0,g={},y=!1){Object.defineProperty(this,"defaultView",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"plugins",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"isResponsive",{enumerable:!0,configurable:!0,writable:!0,value:c}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:d}),Object.defineProperty(this,"_customComponentFns",{enumerable:!0,configurable:!0,writable:!0,value:u}),Object.defineProperty(this,"firstDayOfWeek",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"views",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dayBoundaries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"weekOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"calendars",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"isDark",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"minDate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxDate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"monthGridOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"locale",{enumerable:!0,configurable:!0,writable:!0,value:d$1(DEFAULT_LOCALE)}),Object.defineProperty(this,"theme",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"translations",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"showWeekNumbers",{enumerable:!0,configurable:!0,writable:!0,value:d$1(!1)}),Object.defineProperty(this,"direction",{enumerable:!0,configurable:!0,writable:!0,value:"ltr"}),this.locale=d$1(e),this.firstDayOfWeek=d$1(t),this.views=d$1(r),this.dayBoundaries=d$1(s),this.weekOptions=d$1(n),this.calendars=d$1(i),this.isDark=d$1(l),this.minDate=d$1(m),this.maxDate=d$1(p),this.monthGridOptions=d$1(x),this.theme=h,this.translations=d$1(g),this.showWeekNumbers=d$1(y),this.direction=getDirection()}get isHybridDay(){return this.dayBoundaries.value.start>this.dayBoundaries.value.end||0!==this.dayBoundaries.value.start&&this.dayBoundaries.value.start===this.dayBoundaries.value.end}get timePointsPerDay(){return timePointsPerDay(this.dayBoundaries.value.start,this.dayBoundaries.value.end,this.isHybridDay)}}class CalendarConfigBuilder{constructor(){Object.defineProperty(this,"locale",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstDayOfWeek",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"defaultView",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"views",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dayBoundaries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"weekOptions",{enumerable:!0,configurable:!0,writable:!0,value:{gridHeight:DEFAULT_WEEK_GRID_HEIGHT,nDays:7,eventWidth:100,timeAxisFormatOptions:{hour:"numeric"},eventOverlap:!0}}),Object.defineProperty(this,"monthGridOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"calendars",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"plugins",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"isDark",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isResponsive",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"minDate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxDate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"backgroundEvents",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"theme",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"translations",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"showWeekNumbers",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}build(){return new CalendarConfigImpl(this.locale||DEFAULT_LOCALE,"number"==typeof this.firstDayOfWeek?this.firstDayOfWeek:DEFAULT_FIRST_DAY_OF_WEEK,this.defaultView||InternalViewName.Week,this.views||[],this.dayBoundaries||DEFAULT_DAY_BOUNDARIES,this.weekOptions,this.calendars,this.plugins,this.isDark,this.isResponsive,this.callbacks,{},this.minDate,this.maxDate,this.monthGridOptions,this.theme,this.translations,this.showWeekNumbers)}withLocale(e){return this.locale=e,this}withTranslations(e){return this.translations=e,this}withFirstDayOfWeek(e){return this.firstDayOfWeek=e,this}withDefaultView(e){return this.defaultView=e,this}withViews(e){return this.views=e,this}withDayBoundaries(e){return e?(this.dayBoundaries={start:timePointsFromString(e.start),end:timePointsFromString(e.end)},this):this}withWeekOptions(e){return this.weekOptions=__spreadValues(__spreadValues({},this.weekOptions),e),this}withCalendars(e){return this.calendars=e,this}withPlugins(e){return e?(e.forEach(e=>{this.plugins[e.name]=e}),this):this}withIsDark(e){return this.isDark=e,this}withIsResponsive(e){return this.isResponsive=e,this}withCallbacks(e){return this.callbacks=e,this}withMinDate(e){return this.minDate=e,this}withMaxDate(e){return this.maxDate=e,this}withMonthGridOptions(e){return this.monthGridOptions=e,this}withBackgroundEvents(e){return this.backgroundEvents=e,this}withTheme(e){return this.theme=e,this}withWeekNumbers(e){return this.showWeekNumbers=e,this}}const createInternalConfig=(e,t)=>(new CalendarConfigBuilder).withLocale(e.locale).withFirstDayOfWeek(e.firstDayOfWeek).withDefaultView(e.defaultView).withViews(e.views).withDayBoundaries(e.dayBoundaries).withWeekOptions(e.weekOptions).withCalendars(e.calendars).withPlugins(t).withIsDark(e.isDark).withIsResponsive(e.isResponsive).withCallbacks(e.callbacks).withMinDate(e.minDate).withMaxDate(e.maxDate).withMonthGridOptions(e.monthGridOptions).withBackgroundEvents(e.backgroundEvents).withTheme(e.theme).withTranslations(e.translations||translations).withWeekNumbers(e.showWeekNumbers).build();var Month,Month2;Month2=Month||(Month={}),Month2[Month2.JANUARY=0]="JANUARY",Month2[Month2.FEBRUARY=1]="FEBRUARY",Month2[Month2.MARCH=2]="MARCH",Month2[Month2.APRIL=3]="APRIL",Month2[Month2.MAY=4]="MAY",Month2[Month2.JUNE=5]="JUNE",Month2[Month2.JULY=6]="JULY",Month2[Month2.AUGUST=7]="AUGUST",Month2[Month2.SEPTEMBER=8]="SEPTEMBER",Month2[Month2.OCTOBER=9]="OCTOBER",Month2[Month2.NOVEMBER=10]="NOVEMBER",Month2[Month2.DECEMBER=11]="DECEMBER";class NoYearZeroError extends Error{constructor(){super("Year zero does not exist in the Gregorian calendar.")}}class ExtendedDateImpl extends Date{constructor(e,t,a){if(super(e,t,a),0===e)throw new NoYearZeroError;this.setFullYear(e)}get year(){return this.getFullYear()}get month(){return this.getMonth()}get date(){return this.getDate()}}class TimeUnitsImpl{constructor(e){Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:e})}get firstDayOfWeek(){return this.config.firstDayOfWeek.value}set firstDayOfWeek(e){this.config.firstDayOfWeek.value=e}getMonth(e,t){if(0===e)throw new NoYearZeroError;const a=new Date(e,t,1),r=new Date(e,t+1,0),s=[];for(let n=new Date(a);n<=r;n.setDate(n.getDate()+1))s.push(new Date(n));return s}getMonthWithTrailingAndLeadingDays(e,t){if(0===e)throw new NoYearZeroError;const a=new Date(e,t,1),r=[this.getWeekFor(a)];let s=!0,n=r[0][0];for(;s;){const e=new Date(n.getFullYear(),n.getMonth(),n.getDate()+7);e.getMonth()===t?(r.push(this.getWeekFor(e)),n=e):s=!1}return r}getWeekFor(e){const t=[this.getFirstDateOfWeek(e)];for(;t.length<7;){const e=t[t.length-1],a=new Date(e);a.setDate(e.getDate()+1),t.push(a)}return t}getMonthsFor(e){return Object.values(Month).filter(e=>!isNaN(Number(e))).map(t=>new ExtendedDateImpl(e,Number(t),1))}getFirstDateOfWeek(e){const t=e.getDay()-this.firstDayOfWeek,a=e;return 0===t||(t>0?a.setDate(e.getDate()-t):a.setDate(e.getDate()-(7+t))),a}}class TimeUnitsBuilder{constructor(){Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}build(){return new TimeUnitsImpl(this.config)}withConfig(e){return this.config=e,this}}const createTimeUnitsImpl=e=>(new TimeUnitsBuilder).withConfig(e).build();var Placement,Placement2;Placement2=Placement||(Placement={}),Placement2.TOP_START="top-start",Placement2.TOP_END="top-end",Placement2.BOTTOM_START="bottom-start",Placement2.BOTTOM_END="bottom-end";class ConfigImpl{constructor(e=DEFAULT_LOCALE,t=DEFAULT_FIRST_DAY_OF_WEEK,a=toDateString$1(new Date(1970,0,1)),r=toDateString$1(new Date((new Date).getFullYear()+50,11,31)),s=Placement.BOTTOM_START,n={},i={},o,l,c,d){Object.defineProperty(this,"min",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"max",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"placement",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"listeners",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"style",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"teleportTo",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"label",{enumerable:!0,configurable:!0,writable:!0,value:l}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:c}),Object.defineProperty(this,"disabled",{enumerable:!0,configurable:!0,writable:!0,value:d}),Object.defineProperty(this,"locale",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstDayOfWeek",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.locale=d$1(e),this.firstDayOfWeek=d$1(t)}}class ConfigBuilder{constructor(){Object.defineProperty(this,"locale",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstDayOfWeek",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"min",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"max",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"placement",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"listeners",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"style",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"teleportTo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"label",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"disabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}build(){return new ConfigImpl(this.locale,this.firstDayOfWeek,this.min,this.max,this.placement,this.listeners,this.style,this.teleportTo,this.label,this.name,this.disabled)}withLocale(e){return this.locale=e,this}withFirstDayOfWeek(e){return this.firstDayOfWeek=e,this}withMin(e){return this.min=e,this}withMax(e){return this.max=e,this}withPlacement(e){return this.placement=e,this}withListeners(e){return this.listeners=e,this}withStyle(e){return this.style=e,this}withTeleportTo(e){return this.teleportTo=e,this}withLabel(e){return this.label=e,this}withName(e){return this.name=e,this}withDisabled(e){return this.disabled=e,this}}const createDatePickerConfig=(e,t)=>{var a,r;const s="rtl"===getDirection();let n;(null===(a=e.datePicker)||void 0===a?void 0:a.teleportTo)?n=e.datePicker.teleportTo:s&&(n=document.body);let i=Placement.BOTTOM_END;return s&&(i=Placement.BOTTOM_START),(new ConfigBuilder).withLocale(e.locale).withFirstDayOfWeek(e.firstDayOfWeek).withMin(e.minDate).withMax(e.maxDate).withTeleportTo(n).withStyle(null===(r=e.datePicker)||void 0===r?void 0:r.style).withPlacement(i).withListeners({onChange:t}).build()},createDateSelectionCallback=(e,t)=>{let a=null;return r=>{var s;e.setRange(r),(null===(s=t.callbacks)||void 0===s?void 0:s.onSelectedDateUpdate)&&r!==a&&(a=r,t.callbacks.onSelectedDateUpdate(r))}},validatePlugins=(e,t)=>{if(e&&t)throw new Error("You cannot provide plugins over the config object and as an argument to createCalendar.")},validateConfig=e=>{var t,a,r,s;if(e.selectedDate&&!DateFormats.DATE_STRING.test(e.selectedDate))throw new Error("[Schedule-X error]: selectedDate must have the format YYYY-MM-DD");if(e.minDate&&!DateFormats.DATE_STRING.test(e.minDate))throw new Error("[Schedule-X error]: minDate must have the format YYYY-MM-DD");if(e.maxDate&&!DateFormats.DATE_STRING.test(e.maxDate))throw new Error("[Schedule-X error]: maxDate must have the format YYYY-MM-DD");if(void 0!==e.firstDayOfWeek&&(e.firstDayOfWeek<0||e.firstDayOfWeek>6))throw new Error("[Schedule-X error]: firstDayOfWeek must be a number between 0 and 6");if(void 0!==(null===(t=e.weekOptions)||void 0===t?void 0:t.gridHeight)&&e.weekOptions.gridHeight<0)throw new Error("[Schedule-X error]: weekOptions.gridHeight must be a positive number");if(void 0!==(null===(a=e.weekOptions)||void 0===a?void 0:a.nDays)&&(e.weekOptions.nDays<1||e.weekOptions.nDays>7))throw new Error("[Schedule-X error]: weekOptions.nDays must be a number between 1 and 7");if(void 0!==(null===(r=e.weekOptions)||void 0===r?void 0:r.eventWidth)&&(e.weekOptions.eventWidth<1||e.weekOptions.eventWidth>100))throw new Error("[Schedule-X error]: weekOptions.eventWidth must be an integer between 1 and 100");if(void 0!==(null===(s=e.monthGridOptions)||void 0===s?void 0:s.nEventsPerDay)&&e.monthGridOptions.nEventsPerDay<0)throw new Error("[Schedule-X error]: monthGridOptions.nEventsPerDay must be a positive number");const n=/^\d{2}:00$/;if(void 0!==e.dayBoundaries){const t=!n.test(e.dayBoundaries.start),a=!n.test(e.dayBoundaries.end);if(t||a)throw new Error('[Schedule-X error]: dayBoundaries must be an object with "start"- and "end" properties, each with the format HH:mm')}},validateEvents=(e=[])=>{null==e||e.forEach(e=>{if(!dateTimeStringRegex.test(e.start)&&!dateStringRegex.test(e.start))throw new Error(`[Schedule-X error]: Event start time ${e.start} is not a valid time format. Please refer to the docs for more information.`);if(!dateTimeStringRegex.test(e.end)&&!dateStringRegex.test(e.end))throw new Error(`[Schedule-X error]: Event end time ${e.end} is not a valid time format. Please refer to the docs for more information.`);if("number"==typeof e.id&&e.id%1!=0)throw new Error(`[Schedule-X error]: Event id ${e.id} is not a valid id. Only non-unicode characters that can be used by document.querySelector is allowed, see: https://developer.mozilla.org/en-US/docs/Web/CSS/ident. We recommend using uuids or integers.`);if("string"==typeof e.id&&!/^[a-zA-Z0-9_-]*$/.test(e.id))throw new Error(`[Schedule-X error]: Event id ${e.id} is not a valid id. Only non-unicode characters that can be used by document.querySelector is allowed, see: https://developer.mozilla.org/en-US/docs/Web/CSS/ident. We recommend using uuids or integers.`);if("string"!=typeof e.id&&"number"!=typeof e.id)throw new Error(`[Schedule-X error]: Event id ${e.id} is not a valid id. Only non-unicode characters that can be used by document.querySelector is allowed, see: https://developer.mozilla.org/en-US/docs/Web/CSS/ident. We recommend using uuids or integers.`)})},createCalendarAppSingleton=(e,t)=>{var a;const r=createInternalConfig(e,t),s=createTimeUnitsImpl(r),n=createCalendarState(r,s,e.selectedDate),i=createDateSelectionCallback(n,e),o=createDatePickerConfig(e,i),l=createDatePickerState(o,e.selectedDate||(null===(a=e.datePicker)||void 0===a?void 0:a.selectedDate)),c=createCalendarEventsImpl(e.events||[],e.backgroundEvents||[],r);return(new CalendarAppSingletonBuilder).withConfig(r).withTimeUnitsImpl(s).withDatePickerState(l).withCalendarEvents(c).withDatePickerConfig(o).withCalendarState(n).withTranslate(translate(r.locale,r.translations)).build()},createCalendar=(e,t)=>(validatePlugins(e.plugins,t),!0!==e.skipValidation&&(validateEvents(e.events),validateConfig(e)),new CalendarApp(createCalendarAppSingleton(e,e.plugins||[]))),createWeekForMonth=(e,t)=>(e.push({date:toDateString$1(t),events:{},backgroundEvents:[]}),e),createMonth=(e,t)=>{const{year:a,month:r}=toIntegers(e),s=t.getMonthWithTrailingAndLeadingDays(a,r),n=[];for(const i of s)n.push(i.reduce(createWeekForMonth,[]));return n};function MonthGridEvent({gridRow:e,calendarEvent:t,date:a,isFirstWeek:r,isLastWeek:s}){var n,i,o,l,c;const d=x(AppContext),u=r&&(null===(n=d.calendarState.range.value)||void 0===n?void 0:n.start)&&dateFromDateTime(t.start)<dateFromDateTime(d.calendarState.range.value.start),m=s&&(null===(i=d.calendarState.range.value)||void 0===i?void 0:i.end)&&dateFromDateTime(t.end)>dateFromDateTime(d.calendarState.range.value.end),{createDragStartTimeout:p,setClickedEventIfNotDragging:h,setClickedEvent:g}=useEventInteractions(d),y=dateFromDateTime(t.start)===a,v=t._eventFragments[a],E={borderInlineStart:y?`4px solid var(--sx-color-${t._color})`:void 0,color:`var(--sx-color-on-${t._color}-container)`,backgroundColor:`var(--sx-color-${t._color}-container)`,width:`calc(${100*v+"%"} + ${v}px - 10px)`},f=e=>{var a;isUIEventTouchEvent(e)&&e.preventDefault(),e.target&&d.config.plugins.dragAndDrop&&!(null===(a=t._options)||void 0===a?void 0:a.disableDND)&&d.config.plugins.dragAndDrop.createMonthGridDragHandler(t,d)},b=d.config._customComponentFns.monthGridEvent,j=b?"custom-month-grid-event-"+randomStringId():void 0;y$2(()=>{b&&b(getElementByCCID(j),{calendarEvent:t._getExternalEvent(),hasStartDate:y})},[t]);const R=["sx__event","sx__month-grid-event","sx__month-grid-cell"];(null===(o=t._options)||void 0===o?void 0:o.additionalClasses)&&R.push(...t._options.additionalClasses),wasEventAddedInLastSecond(t)&&R.push("is-event-new"),u&&R.push("sx__month-grid-event--overflow-left"),m&&R.push("sx__month-grid-event--overflow-right");const I=null===(l=t._customContent)||void 0===l?void 0:l.monthGrid;return u$3("div",{draggable:!!d.config.plugins.dragAndDrop,"data-event-id":t.id,"data-ccid":j,onMouseDown:e=>p(f,e),onMouseUp:e=>h(t,e),onTouchStart:e=>p(f,e),onTouchEnd:e=>h(t,e),onClick:e=>{e.stopPropagation(),invokeOnEventClickCallback(d,t,e)},onDblClick:e=>{e.stopPropagation(),invokeOnEventDoubleClickCallback(d,t,e)},onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.stopPropagation(),g(e,t),invokeOnEventClickCallback(d,t,e),nextTick(()=>{focusModal(d)}))},className:R.join(" "),style:{gridRow:e,width:E.width,padding:b?"0px":void 0,borderInlineStart:b?void 0:E.borderInlineStart,color:b?void 0:E.color,backgroundColor:b?void 0:E.backgroundColor},tabIndex:0,role:"button",children:[!b&&!I&&u$3(k$2,{children:[dateTimeStringRegex.test(t.start)&&u$3("div",{className:"sx__month-grid-event-time",children:timeFn(t.start,d.config.locale.value)}),u$3("div",{className:"sx__month-grid-event-title",children:t.title})]}),I&&u$3("div",{dangerouslySetInnerHTML:{__html:(null===(c=t._customContent)||void 0===c?void 0:c.monthGrid)||""}})]})}function MonthGridDay({day:e,isFirstWeek:t,isLastWeek:a}){const r=x(AppContext),s=Object.values(e.events).filter(e=>"object"==typeof e||e===DATE_GRID_BLOCKER).length,n=["sx__month-grid-day__header-date"],i=toJSDate(e.date),o=i;isToday(o)&&n.push("sx__is-today");const{month:l}=toIntegers(r.datePickerState.selectedDate.value),{month:c}=toIntegers(e.date),d=["sx__month-grid-day",getClassNameForWeekday(i.getDay())],[u,m]=d$2(d);y$2(()=>{const t=[...d];c!==l&&t.push("is-leading-or-trailing"),r.datePickerState.selectedDate.value===e.date&&t.push("is-selected"),m(t)},[r.datePickerState.selectedDate.value]);const p=Object.values(e.events).slice(r.config.monthGridOptions.value.nEventsPerDay).filter(e=>e===DATE_GRID_BLOCKER||"object"==typeof e).length,h=e.date+" 00:00",g=e.date+" 23:59",y=e.backgroundEvents.find(e=>{const t=dateStringRegex.test(e.start)?e.start+" 00:00":e.start,a=dateStringRegex.test(e.end)?e.end+" 23:59":e.end;return t<=h&&a>=g}),v=r.config._customComponentFns.monthGridDayName,E=d$2(v?randomStringId():"")[0];y$2(()=>{if(!v)return;const t=document.querySelector(`[data-ccid="${E}"]`);t instanceof HTMLElement&&v(t,{day:toJSDate(e.date).getDay()})},[e]);const f=r.config._customComponentFns.monthGridDate,b=d$2(f?randomStringId():"")[0];return y$2(()=>{if(!f)return;const t=document.querySelector(`[data-ccid="${b}"]`);t instanceof HTMLElement&&f(t,{date:toJSDate(e.date).getDate(),jsDate:toJSDate(e.date)})},[e]),u$3("div",{className:u.join(" "),"data-date":e.date,onClick:t=>r.config.callbacks.onClickDate&&r.config.callbacks.onClickDate(e.date,t),"aria-label":getLocalizedDate(e.date,r.config.locale.value),onDblClick:t=>{var a,s;return null===(s=(a=r.config.callbacks).onDoubleClickDate)||void 0===s?void 0:s.call(a,e.date,t)},onMouseDown:t=>{if(!t.target.classList.contains("sx__month-grid-day"))return;const a=r.config.callbacks.onMouseDownMonthGridDate;a&&a(e.date,t)},children:[y&&u$3(k$2,{children:u$3("div",{className:"sx__month-grid-background-event",title:y.title,style:__spreadValues({},y.style)})}),u$3("div",{className:"sx__month-grid-day__header",children:[t?u$3(k$2,{children:u$3("div",v?{"data-ccid":E}:{className:"sx__month-grid-day__header-day-name",children:getDayNameShort(o,r.config.locale.value)})}):null,u$3("div",b?{"data-ccid":b}:{className:n.join(" "),children:o.getDate()})]}),u$3("div",{className:"sx__month-grid-day__events",children:Object.values(e.events).slice(0,r.config.monthGridOptions.value.nEventsPerDay).map((r,s)=>"object"!=typeof r?u$3("div",{className:"sx__month-grid-blocker sx__month-grid-cell",style:{gridRow:s+1}}):u$3(MonthGridEvent,{gridRow:s+1,calendarEvent:r,date:e.date,isFirstWeek:t,isLastWeek:a}))}),p>0?u$3("button",{type:"button",className:"sx__month-grid-day__events-more sx__ripple--wide","aria-label":(j=p,1===j?r.translate("Link to 1 more event on {{date}}",{date:getLocalizedDate(e.date,r.config.locale.value)}):r.translate("Link to {{n}} more events on {{date}}",{date:getLocalizedDate(e.date,r.config.locale.value),n:s-r.config.monthGridOptions.value.nEventsPerDay})),onClick:t=>{t.stopPropagation(),r.config.callbacks.onClickPlusEvents&&r.config.callbacks.onClickPlusEvents(e.date,t),r.config.views.value.find(e=>e.name===InternalViewName.Day)&&setTimeout(()=>{r.datePickerState.selectedDate.value=e.date,r.calendarState.setView(InternalViewName.Day,e.date)},250)},children:(e=>1===e?r.translate("+ 1 event"):r.translate("+ {{n}} events",{n:e}))(p)}):null]});var j}function MonthGridWeek({week:e,isFirstWeek:t,isLastWeek:a}){const r=x(AppContext);return u$3("div",{className:"sx__month-grid-week",children:[r.config.showWeekNumbers.value&&u$3("div",{className:"sx__month-grid-week__week-number",children:getWeekNumber(toJSDate(e[0].date),r.config.firstDayOfWeek.value)}),e.map(e=>{const r=e.date;return u$3(MonthGridDay,{day:e,isFirstWeek:t,isLastWeek:a},r)})]})}const positionInMonthWeek=(e,t)=>{const a=Object.keys(t).sort(),r=a[0],s=a[a.length-1],n=new Set;for(const i of e){const e=dateFromDateTime(i.start),a=dateFromDateTime(i.end),o=!!t[e];let l=o;if(!o&&e<r&&a>=r&&(l=!0),!l)continue;const c=o?e:r,d=a<=s?a:s,u=Object.values(t).filter(e=>e.date>=c&&e.date<=d);let m,p=0;for(;void 0===m;){u.every(e=>!e.events[p])?(m=p,n.add(p)):p++}for(const[t,r]of u.entries())0===t?(i._eventFragments[c]=u.length,r.events[m]=i):r.events[m]=DATE_GRID_BLOCKER}for(const i of Array.from(n))for(const[,e]of Object.entries(t))e.events[i]||(e.events[i]=void 0);return t},positionInMonth=(e,t)=>{const a=[];return e.forEach(e=>{const t={};e.forEach(e=>t[e.date]=e),a.push(t)}),a.forEach(e=>positionInMonthWeek(t,e)),e},MonthGridWrapper=({$app:e,id:t})=>{const[a,r]=d$2([]);return useSignalEffect(()=>{e.calendarEvents.list.value.forEach(e=>{e._eventFragments={}});const t=createMonth(e.datePickerState.selectedDate.value,e.timeUnitsImpl);t.forEach(t=>{t.forEach(t=>{t.backgroundEvents=filterByRange(e.calendarEvents.backgroundEvents.value,{start:t.date,end:t.date})})});const a=e.calendarEvents.filterPredicate.value?e.calendarEvents.list.value.filter(e.calendarEvents.filterPredicate.value):e.calendarEvents.list.value;r(positionInMonth(t,a.sort(sortEventsForMonthGrid)))}),u$3(AppContext.Provider,{value:e,children:u$3("div",{id:t,className:"sx__month-grid-wrapper",children:a.map((e,t)=>u$3(MonthGridWeek,{week:e,isFirstWeek:0===t,isLastWeek:t===a.length-1},t))})})},config$2={name:InternalViewName.MonthGrid,label:"Month",setDateRange:setRangeForMonth,Component:MonthGridWrapper,hasWideScreenCompat:!0,hasSmallScreenCompat:!1,backwardForwardFn:addMonths,backwardForwardUnits:1};createPreactView(config$2);const createViewMonthGrid=()=>createPreactView(config$2),createAgendaMonth=(e,t)=>{const{year:a,month:r}=toIntegers(e);return{weeks:t.getMonthWithTrailingAndLeadingDays(a,r).map(e=>e.map(e=>({date:toDateString$1(e),events:[]})))}};function MonthAgendaDay({day:e,isActive:t,setActiveDate:a}){const r=x(AppContext),{month:s}=toIntegers(r.datePickerState.selectedDate.value),{month:n}=toIntegers(e.date),i=toJSDate(e.date),o=["sx__month-agenda-day",getClassNameForWeekday(i.getDay())];t&&o.push("sx__month-agenda-day--active"),n!==s&&o.push("is-leading-or-trailing");const l=(t,r)=>{a(e.date),r&&r(e.date,t)},c=e=>e.date===r.datePickerState.selectedDate.value,d=!!(r.config.minDate.value&&e.date<r.config.minDate.value),u=!!(r.config.maxDate.value&&e.date>r.config.maxDate.value);return u$3("button",{type:"button",className:o.join(" "),onClick:e=>l(e,r.config.callbacks.onClickAgendaDate),onDblClick:e=>l(e,r.config.callbacks.onDoubleClickAgendaDate),disabled:d||u,"aria-label":getLocalizedDate(e.date,r.config.locale.value),tabIndex:c(e)?0:-1,"data-agenda-focus":c(e)?"true":void 0,onKeyDown:e=>{const t=new Map([["ArrowDown",7],["ArrowUp",-7],["ArrowLeft",-1],["ArrowRight",1]]);r.datePickerState.selectedDate.value=addDays(r.datePickerState.selectedDate.value,t.get(e.key)||0)},children:[u$3("div",{children:i.getDate()}),u$3("div",{className:"sx__month-agenda-day__event-icons",children:e.events.slice(0,3).map(e=>u$3("div",{style:{backgroundColor:`var(--sx-color-${e._color})`},className:"sx__month-agenda-day__event-icon"}))})]})}function MonthAgendaWeek({week:e,setActiveDate:t,activeDate:a}){const r=x(AppContext);return u$3("div",{className:"sx__month-agenda-week",children:[r.config.showWeekNumbers.value&&u$3("div",{className:"sx__month-agenda-week__week-number",children:getWeekNumber(toJSDate(e[0].date),r.config.firstDayOfWeek.value)}),e.map((e,r)=>u$3(MonthAgendaDay,{setActiveDate:t,day:e,isActive:a===e.date},r+e.date))]})}function MonthAgendaDayNames({week:e}){const t=x(AppContext),a=getOneLetterOrShortDayNames(e.map(e=>toJSDate(e.date)),t.config.locale.value);return u$3("div",{className:T$2(()=>{const e=["sx__month-agenda-day-names"];return t.config.showWeekNumbers.value&&e.push("sx__has-week-numbers"),e.join(" ")},[t.config.showWeekNumbers.value]),children:a.map(e=>u$3("div",{className:"sx__month-agenda-day-name",children:e}))})}const getAllEventDates=(e,t)=>{let a=e;const r=[a];for(;a<t;)a=addDays(a,1),r.push(a);return r},placeEventInDay=e=>t=>{getAllEventDates(dateFromDateTime(t.start),dateFromDateTime(t.end)).forEach(a=>{e[a]&&e[a].events.push(t)})},positionEventsInAgenda=(e,t)=>{const a=e.weeks.reduce((e,t)=>(t.forEach(t=>{e[t.date]=t}),e),{});return t.forEach(placeEventInDay(a)),e};function MonthAgendaEvent({calendarEvent:e}){var t,a;const r=x(AppContext),{setClickedEvent:s}=useEventInteractions(r),n={backgroundColor:`var(--sx-color-${e._color}-container)`,color:`var(--sx-color-on-${e._color}-container)`,borderInlineStart:`4px solid var(--sx-color-${e._color})`},i=r.config._customComponentFns.monthAgendaEvent,o=i?"custom-month-agenda-event-"+randomStringId():void 0;y$2(()=>{i&&i(getElementByCCID(o),{calendarEvent:e._getExternalEvent()})},[e]);const l=null===(t=e._customContent)||void 0===t?void 0:t.monthAgenda,c=["sx__event","sx__month-agenda-event"];return wasEventAddedInLastSecond(e)&&c.push("is-event-new"),u$3("div",{className:c.join(" "),"data-ccid":o,"data-event-id":e.id,style:{backgroundColor:i?void 0:n.backgroundColor,color:i?void 0:n.color,borderInlineStart:i?void 0:n.borderInlineStart,padding:i?"0px":void 0},onClick:t=>(t=>{s(t,e),invokeOnEventClickCallback(r,e,t)})(t),onDblClick:t=>(t=>{s(t,e),invokeOnEventDoubleClickCallback(r,e,t)})(t),onKeyDown:t=>{"Enter"!==t.key&&" "!==t.key||(t.stopPropagation(),s(t,e),invokeOnEventClickCallback(r,e,t),nextTick(()=>{focusModal(r)}))},tabIndex:0,role:"button",children:[!i&&!l&&u$3(k$2,{children:[u$3("div",{className:"sx__month-agenda-event__title",children:e.title}),u$3("div",{className:"sx__month-agenda-event__time sx__month-agenda-event__has-icon",children:[u$3(TimeIcon,{strokeColor:`var(--sx-color-on-${e._color}-container)`}),u$3("div",{dangerouslySetInnerHTML:{__html:getTimeStamp(e,r.config.locale.value)}})]})]}),l&&u$3("div",{dangerouslySetInnerHTML:{__html:(null===(a=e._customContent)||void 0===a?void 0:a.monthAgenda)||""}})]})}function MonthAgendaEvents({events:e}){const t=x(AppContext);return u$3("div",{className:"sx__month-agenda-events",children:e.length?e.map(e=>u$3(MonthAgendaEvent,{calendarEvent:e},e.id)):u$3("div",{className:"sx__month-agenda-events__empty",children:t.translate("No events")})})}const MonthAgendaWrapper=({$app:e,id:t})=>{var a;const r=()=>{const t=e.calendarEvents.filterPredicate.value?e.calendarEvents.list.value.filter(e.calendarEvents.filterPredicate.value):e.calendarEvents.list.value;return positionEventsInAgenda(createAgendaMonth(e.datePickerState.selectedDate.value,e.timeUnitsImpl),t.sort(sortEventsByStartAndEnd))},[s,n]=d$2(r());return y$2(()=>{n(r())},[e.datePickerState.selectedDate.value,e.calendarEvents.list.value,e.calendarEvents.filterPredicate.value]),y$2(()=>{const e=new MutationObserver(e=>{e.forEach(e=>{const t=e.target;"true"===t.dataset.agendaFocus&&t.focus()})}),a=document.getElementById(t);return e.observe(a,{childList:!0,subtree:!0,attributes:!0}),()=>e.disconnect()},[]),u$3(AppContext.Provider,{value:e,children:u$3("div",{id:t,className:"sx__month-agenda-wrapper",children:[u$3(MonthAgendaDayNames,{week:s.weeks[0]}),u$3("div",{className:"sx__month-agenda-weeks",children:s.weeks.map((t,a)=>u$3(MonthAgendaWeek,{week:t,setActiveDate:t=>e.datePickerState.selectedDate.value=t,activeDate:e.datePickerState.selectedDate.value},a))}),u$3(MonthAgendaEvents,{events:(null===(a=s.weeks.flat().find(t=>t.date===e.datePickerState.selectedDate.value))||void 0===a?void 0:a.events)||[]},e.datePickerState.selectedDate.value)]})})},config$1={name:InternalViewName.MonthAgenda,label:"Month",setDateRange:setRangeForMonth,Component:MonthAgendaWrapper,hasSmallScreenCompat:!0,hasWideScreenCompat:!1,backwardForwardFn:addMonths,backwardForwardUnits:1};createPreactView(config$1);const scrollOnDateSelection=(e,t)=>{if(!t.current)return;const a=e.datePickerState.selectedDate.value,r=t.current.querySelector(`.sx__list-day[data-date="${a}"]`);r instanceof HTMLElement&&requestAnimationFrame(()=>{r.scrollIntoView({behavior:"instant",block:"start"})})},ListWrapper=({$app:e,id:t})=>{const[a,r]=d$2([]),s=A$1(null),{setClickedEvent:n}=useEventInteractions(e),i=A$1(!1),o=A$1(null);y$2(()=>{i.current=!0,(e=>{const t=e.reduce((e,t)=>{const a=dateFromDateTime(t.start),r=dateFromDateTime(t.end);let s=a;for(;s<=r;)e[s]||(e[s]=[]),e[s].push(t),s=addDays(s,1);return e},{}),a=Object.entries(t).map(([e,t])=>({date:e,events:t.sort((e,t)=>e.start.localeCompare(t.start))})).sort((e,t)=>e.date.localeCompare(t.date));r(a),o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{i.current=!1,o.current=null},100)})(e.calendarEvents.list.value)},[e.calendarEvents.list.value]),y$2(()=>{const e=()=>{o.current&&(clearTimeout(o.current),o.current=null,i.current=!1)},t=s.current;if(t)return t.addEventListener("scroll",e),()=>{t.removeEventListener("scroll",e)}},[]);const[l,c]=d$2(null);y$2(()=>{if(!s.current||!e.config.callbacks.onScrollDayIntoView)return;const t=l||new IntersectionObserver(t=>{t.forEach(t=>{if(t.isIntersecting){const a=t.target.getAttribute("data-date");a&&e.config.callbacks.onScrollDayIntoView&&!i.current&&e.config.callbacks.onScrollDayIntoView(a)}})},{root:s.current,rootMargin:"0px",threshold:.1});return s.current.querySelectorAll(".sx__list-day").forEach(e=>{t.observe(e)}),c(t),()=>{t.disconnect()}},[a]),y$2(()=>{scrollOnDateSelection(e,s)},[a,e.datePickerState.selectedDate.value]);const d=(t,a)=>{const r=dateFromDateTime(t.start),s=dateFromDateTime(t.end),n=r===a,i=s===a,o=r!==s,l={hour:"numeric",minute:"numeric",hour12:"en-US"===e.config.locale.value};return o?n?u$3(k$2,{children:[u$3("div",{className:"sx__list-event-start-time",children:toJSDate(t.start).toLocaleTimeString(e.config.locale.value,l)}),u$3("div",{className:"sx__list-event-arrow",children:"→"})]}):i?u$3(k$2,{children:[u$3("div",{className:"sx__list-event-arrow",children:"←"}),u$3("div",{className:"sx__list-event-end-time",children:toJSDate(t.end).toLocaleTimeString(e.config.locale.value,l)})]}):u$3("div",{className:"sx__list-event-arrow",children:"↔"}):u$3(k$2,{children:[u$3("div",{className:"sx__list-event-start-time",children:toJSDate(t.start).toLocaleTimeString(e.config.locale.value,l)}),t.end&&u$3("div",{className:"sx__list-event-end-time",children:toJSDate(t.end).toLocaleTimeString(e.config.locale.value,l)})]})};return u$3(AppContext.Provider,{value:e,children:u$3("div",{id:t,className:"sx__list-wrapper",ref:s,children:0===a.length?u$3("div",{className:"sx__list-no-events",children:e.translate("No events")}):a.map(t=>u$3("div",{className:"sx__list-day","data-date":t.date,children:[u$3("div",{className:"sx__list-day-header",children:u$3("div",{className:"sx__list-day-date",children:toJSDate(t.date).toLocaleDateString(e.config.locale.value,{weekday:"long",year:"numeric",month:"long",day:"numeric"})})}),u$3("div",{className:"sx__list-day-events",children:t.events.map(a=>u$3("div",{className:"sx__event sx__list-event",onClick:t=>((t,a)=>{n(t,a),invokeOnEventClickCallback(e,a,t)})(t,a),onDblClick:t=>((t,a)=>{n(t,a),invokeOnEventDoubleClickCallback(e,a,t)})(t,a),onKeyDown:t=>((t,a)=>{"Enter"!==t.key&&" "!==t.key||(t.stopPropagation(),n(t,a),invokeOnEventClickCallback(e,a,t),nextTick(()=>{focusModal(e)}))})(t,a),tabIndex:0,role:"button",children:[u$3("div",{className:"sx__list-event-color-line",style:{backgroundColor:`var(--sx-color-${a._color})`}}),u$3("div",{className:"sx__list-event-content",children:[u$3("div",{className:"sx__list-event-title",children:a.title}),u$3("div",{className:"sx__list-event-times",children:d(a,t.date)})]})]},a.id))}),u$3("div",{className:"sx__list-day-margin"})]},t.date))})})},config={name:InternalViewName.List,label:"List",setDateRange:setRangeForMonth,Component:ListWrapper,hasSmallScreenCompat:!0,hasWideScreenCompat:!0,backwardForwardFn:addMonths,backwardForwardUnits:1};createPreactView(config);const createCustomComponentFn=(e,t)=>(a,r)=>{e({Component:reactExports.createElement(t,r),wrapperElement:a})};function ScheduleXCalendar({calendarApp:e,customComponents:t}){const[a,r]=reactExports.useState(""),[s,n]=reactExports.useState([]),i=e=>{n(t=>{var a,r;const s=null===(r=null===(a=e.wrapperElement)||void 0===a?void 0:a.dataset)||void 0===r?void 0:r.ccid;if(!s)return t;const n=[...t],i=n.find(e=>{var t,a;return(null===(a=null===(t=e.wrapperElement)||void 0===t?void 0:t.dataset)||void 0===a?void 0:a.ccid)===s});return i&&n.splice(n.indexOf(i),1),[...n,e]})};return reactExports.useEffect(()=>{r("sx"+Math.random().toString(36).substring(2,11))},[]),reactExports.useEffect(()=>{if(!e)return;for(const[a,s]of Object.entries(t||{}))s&&e._setCustomComponentFn(a,createCustomComponentFn(i,s));const r=document.getElementById(a);return r?(e.render(r),()=>{e.destroy()}):void 0},[e,t,a]),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"sx-react-calendar-wrapper",id:a}),s.map(({Component:e,wrapperElement:t})=>reactDomExports.createPortal(e,t))]})})}var BookingStatus=(e=>(e.PENDING="pending",e.CONFIRMED="confirmed",e.CANCELLED="cancelled",e.COMPLETED="completed",e.IN_PROGRESS="in_progress",e))(BookingStatus||{});const PROJECT_COLORS={primary:"#629E3E",primaryLight:"#7CB342",secondary:"#2E7D32",pending:"#FFC107",confirmed:"#4CAF50",cancelled:"#F44336",completed:"#9E9E9E",inProgress:"#2196F3",bgLight:"#F5F5F5",bgDark:"#263238",surfaceDark:"#37474F"},ScheduleCalendar=({areaId:e,areaName:t="Área Común",areaInfo:a,events:r=[],selectedDate:s,theme:n="light",isLoading:i=!1,onEventClick:o,onEventCreate:l,onMonthChange:c,allowCreate:d=!0,businessHours:u={start:"08:00",end:"18:00"},className:m="",height:p="600px",width:x="100%"})=>{const[h,g]=reactExports.useState(s||(new Date).toISOString().split("T")[0]),y=reactExports.useCallback(e=>{const t=r.find(t=>t.id===String(e.id));t&&o&&o(t)},[r,o]),v=reactExports.useCallback(e=>{g(e);const t=new Date(e),a=new Date(h);t.getMonth()===a.getMonth()&&t.getFullYear()===a.getFullYear()||c&&c(t.getFullYear(),t.getMonth()+1)},[h,c]),E=reactExports.useMemo(()=>{const e=r.map(e=>({id:e.id,title:e.title,start:e.start,end:e.end,description:e.description||"",people:[]}));return createCalendar({views:[createViewMonthGrid(),createViewWeek(),createViewDay()],events:e,selectedDate:h,locale:"es-ES",dayBoundaries:{start:"00:00",end:"24:00"},monthGridOptions:{nEventsPerDay:3},callbacks:{onEventClick:y,onSelectedDateUpdate:v}})},[r,h,y,v]);reactExports.useEffect(()=>{const e=()=>{const e=document.querySelectorAll(".sx__month-grid-event, .sx__event"),t=new Map;r.forEach(e=>{t.set(e.title,e)}),e.forEach(e=>{const a=(e.querySelector(".sx__month-grid-event-title")||e.querySelector('[class*="title"]')||e).textContent||e.textContent||"",r=t.get(a);if(r&&r.status){const t=b(r.status);e.style.setProperty("background-color",t,"important"),e.style.setProperty("background",t,"important"),e.style.setProperty("border-color",t,"important"),e.style.setProperty("color","white","important");e.querySelectorAll("*").forEach(e=>{e.style.setProperty("color","white","important")})}})},t=[setTimeout(e,100),setTimeout(e,300),setTimeout(e,500),setTimeout(e,1e3)],a=new MutationObserver(()=>{setTimeout(e,50)}),s=document.body;return s&&a.observe(s,{childList:!0,subtree:!0,attributes:!0,characterData:!0}),()=>{t.forEach(clearTimeout),a.disconnect()}},[r,h]);const f=reactExports.useCallback(()=>{if(l&&d){const a={title:"Nueva Reserva",start:`${h} ${u.start}`,end:`${h} ${u.end}`,areaId:e,areaName:t,status:BookingStatus.PENDING};l(a)}},[l,d,h,u,e,t]),b=e=>{switch(e){case BookingStatus.CONFIRMED:return PROJECT_COLORS.confirmed;case BookingStatus.PENDING:return PROJECT_COLORS.pending;case BookingStatus.CANCELLED:return PROJECT_COLORS.cancelled;case BookingStatus.COMPLETED:return PROJECT_COLORS.completed;case BookingStatus.IN_PROGRESS:return PROJECT_COLORS.inProgress;default:return PROJECT_COLORS.primary}},j=(()=>{const e=(new Date).toISOString().split("T")[0],t=e.substring(0,7);return{total:r.length,today:r.filter(t=>t.start.startsWith(e)).length,thisMonth:r.filter(e=>e.start.startsWith(t)).length,confirmed:r.filter(e=>e.status===BookingStatus.CONFIRMED).length}})();return i?jsxRuntimeExports.jsx("div",{className:`schedule-calendar-wrapper ${m}`,style:{height:p,width:x},children:jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center h-full bg-gray-50 rounded-lg",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx(RefreshCw,{className:"w-8 h-8 animate-spin text-primary-dynamic mx-auto mb-4"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600",children:"Cargando calendario..."})]})})}):jsxRuntimeExports.jsxs("div",{className:`schedule-calendar-wrapper ${m}`,style:{width:x},children:[jsxRuntimeExports.jsxs("div",{className:"calendar-header bg-gradient-to-r from-primary/10 to-primary/5 border border-primary/20 rounded-t-lg p-4 shadow-sm overflow-visible",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-4 w-full",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-4",children:[jsxRuntimeExports.jsx("div",{className:"bg-primary-mint-dynamic/20 rounded-lg p-3",children:jsxRuntimeExports.jsx(Calendar,{className:"w-6 h-6 text-primary-dynamic"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[(null==a?void 0:a.capacity)&&jsxRuntimeExports.jsxs("span",{className:"flex items-center",children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),"Capacidad: ",a.capacity]}),(null==a?void 0:a.operatingHours)&&jsxRuntimeExports.jsxs("span",{className:"flex items-center",children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),a.operatingHours]}),(null==a?void 0:a.rate)&&jsxRuntimeExports.jsxs("span",{className:"flex items-center",children:[jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),"S/ ",a.rate.toFixed(2)," / hora"]})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 mt-1",children:new Date(h).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})})]})]}),d&&jsxRuntimeExports.jsx("div",{className:"flex-shrink-0",children:jsxRuntimeExports.jsxs("button",{onClick:f,className:"flex items-center space-x-2 px-4 py-2 text-white rounded-lg transition-colors shadow-md hover:shadow-lg",style:{backgroundColor:"var(--color-primary-main)",borderColor:"var(--color-border-primary)",border:"1px solid",minWidth:"140px",whiteSpace:"nowrap"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="var(--color-primary-admin)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="var(--color-primary-main)"},children:[jsxRuntimeExports.jsx(Plus,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("span",{children:"Nueva Reserva"})]})})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold text-gray-900",children:j.total}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500",children:"Total Eventos"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold text-blue-600",children:j.today}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500",children:"Hoy"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-green-50 rounded-lg p-3 text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold text-green-600",children:j.confirmed}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500",children:"Confirmados"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-purple-50 rounded-lg p-3 text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold text-purple-600",children:j.thisMonth}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500",children:"Este Mes"})]})]}),jsxRuntimeExports.jsx("div",{className:"flex items-center justify-end",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-4 text-xs",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-1",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:PROJECT_COLORS.confirmed}}),jsxRuntimeExports.jsx("span",{children:"Confirmado"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-1",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:PROJECT_COLORS.pending}}),jsxRuntimeExports.jsx("span",{children:"Pendiente"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-1",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:PROJECT_COLORS.inProgress}}),jsxRuntimeExports.jsx("span",{children:"En Progreso"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-1",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:PROJECT_COLORS.completed}}),jsxRuntimeExports.jsx("span",{children:"Completado"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-1",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:PROJECT_COLORS.cancelled}}),jsxRuntimeExports.jsx("span",{children:"Cancelado"})]})]})})]}),jsxRuntimeExports.jsx("div",{className:"calendar-container border-l border-r border-b border-gray-200 rounded-b-lg",style:{height:p,overflow:"auto"},children:E&&jsxRuntimeExports.jsx(ScheduleXCalendar,{calendarApp:E})}),jsxRuntimeExports.jsx("style",{children:`\n        .schedule-calendar-wrapper {\n          font-family: 'Inter', system-ui, -apple-system, sans-serif;\n        }\n        \n        .schedule-calendar-wrapper .sx-react-calendar {\n          --sx-color-primary: ${PROJECT_COLORS.primary};\n          --sx-color-on-primary: #ffffff;\n          --sx-color-primary-container: ${PROJECT_COLORS.primaryLight};\n          --sx-color-on-primary-container: #ffffff;\n          --sx-color-secondary: ${PROJECT_COLORS.secondary};\n          --sx-color-surface: #ffffff;\n          --sx-color-on-surface: #1f2937;\n          --sx-color-surface-variant: #f3f4f6;\n          --sx-color-on-surface-variant: #6b7280;\n          --sx-color-outline: #d1d5db;\n          --sx-border-radius: 8px;\n          --sx-font-family: 'Inter', system-ui, -apple-system, sans-serif;\n          height: 100%;\n          overflow: hidden;\n        }\n        \n        /* Configuración específica para vistas de semana y día */\n        .schedule-calendar-wrapper .sx-react-calendar .sx-week-view,\n        .schedule-calendar-wrapper .sx-react-calendar .sx-day-view {\n          height: 100%;\n          overflow-y: auto;\n          overflow-x: hidden;\n        }\n        \n        .schedule-calendar-wrapper .sx-react-calendar .sx-week-grid,\n        .schedule-calendar-wrapper .sx-react-calendar .sx-day-grid {\n          min-height: 100%;\n          overflow-y: auto;\n        }\n        \n        /* Asegurar que el contenido de las vistas tenga scroll */\n        .schedule-calendar-wrapper .sx-react-calendar .sx-week-grid-content,\n        .schedule-calendar-wrapper .sx-react-calendar .sx-day-grid-content {\n          overflow-y: auto;\n          max-height: calc(${p} - 120px);\n        }\n        \n        .schedule-calendar-wrapper .sx-react-calendar .sx-event {\n          border-radius: 6px;\n          font-weight: 500;\n          font-size: 12px;\n          box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);\n          transition: all 0.2s ease;\n        }\n        \n        /* Colores por estado de evento */\n        .schedule-calendar-wrapper .sx-react-calendar .event-confirmed {\n          background-color: ${PROJECT_COLORS.confirmed} !important;\n          border-color: ${PROJECT_COLORS.confirmed} !important;\n          color: white !important;\n        }\n        \n        .schedule-calendar-wrapper .sx-react-calendar .event-pending {\n          background-color: ${PROJECT_COLORS.pending} !important;\n          border-color: ${PROJECT_COLORS.pending} !important;\n          color: white !important;\n        }\n        \n        .schedule-calendar-wrapper .sx-react-calendar .event-in_progress {\n          background-color: ${PROJECT_COLORS.inProgress} !important;\n          border-color: ${PROJECT_COLORS.inProgress} !important;\n          color: white !important;\n        }\n        \n        .schedule-calendar-wrapper .sx-react-calendar .event-completed {\n          background-color: ${PROJECT_COLORS.completed} !important;\n          border-color: ${PROJECT_COLORS.completed} !important;\n          color: white !important;\n        }\n        \n        .schedule-calendar-wrapper .sx-react-calendar .event-cancelled {\n          background-color: ${PROJECT_COLORS.cancelled} !important;\n          border-color: ${PROJECT_COLORS.cancelled} !important;\n          color: white !important;\n        }\n        \n        .schedule-calendar-wrapper .sx-react-calendar .sx-event:hover {\n          transform: translateY(-1px);\n          box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);\n        }\n        \n        .schedule-calendar-wrapper .sx-react-calendar .sx-month-grid-day {\n          border-radius: 4px;\n          transition: background-color 0.2s ease;\n        }\n        \n        .schedule-calendar-wrapper .sx-react-calendar .sx-month-grid-day:hover {\n          background-color: ${PROJECT_COLORS.bgLight};\n        }\n        \n        .schedule-calendar-wrapper .sx-react-calendar .sx-today {\n          background-color: ${PROJECT_COLORS.primaryLight}15;\n          border: 2px solid ${PROJECT_COLORS.primary};\n        }\n        \n        .schedule-calendar-wrapper .sx-react-calendar .sx-week-grid-hour {\n          color: #6b7280;\n          font-size: 12px;\n          font-weight: 500;\n        }\n        \n        /* Scroll específico para las columnas de tiempo */\n        .schedule-calendar-wrapper .sx-react-calendar .sx__time-grid-scroll-container {\n          overflow-y: auto !important;\n          overflow-x: hidden !important;\n          height: calc(${p} - 140px) !important;\n          min-height: 1200px; /* Altura mínima para 24 horas */\n        }\n        \n        /* Contenedor principal de las vistas con scroll */\n        .schedule-calendar-wrapper .sx-react-calendar .sx__calendar-wrapper {\n          height: 100%;\n          overflow: hidden;\n        }\n        \n        /* Grid de tiempo para vistas semanales y diarias */\n        .schedule-calendar-wrapper .sx-react-calendar .sx__time-grid {\n          overflow-y: auto !important;\n          max-height: calc(${p} - 120px) !important;\n          min-height: 1200px; /* Espacio suficiente para 24 horas */\n        }\n        \n        /* Vista semanal específica */\n        .schedule-calendar-wrapper .sx-react-calendar .sx__week-view {\n          height: 100%;\n          display: flex;\n          flex-direction: column;\n        }\n        \n        .schedule-calendar-wrapper .sx-react-calendar .sx__week-view .sx__week-grid {\n          flex: 1;\n          overflow-y: auto;\n          min-height: 0;\n        }\n        \n        /* Vista diaria específica */\n        .schedule-calendar-wrapper .sx-react-calendar .sx__day-view {\n          height: 100%;\n          display: flex;\n          flex-direction: column;\n        }\n        \n        .schedule-calendar-wrapper .sx-react-calendar .sx__day-view .sx__day-grid {\n          flex: 1;\n          overflow-y: auto;\n          min-height: 0;\n        }\n        \n        ${"dark"===n?`\n          .schedule-calendar-wrapper .sx-react-calendar {\n            --sx-color-surface: ${PROJECT_COLORS.bgDark};\n            --sx-color-on-surface: #f9fafb;\n            --sx-color-surface-variant: ${PROJECT_COLORS.surfaceDark};\n            --sx-color-on-surface-variant: #d1d5db;\n            --sx-color-outline: #4b5563;\n          }\n        `:""}\n      `})]})};class EventService extends ApiBaseService{constructor(){super("/Event")}getEventById(e){return __async(this,null,function*(){return __superGet(EventService.prototype,this,"getById").call(this,e)})}getPagedEvents(e){return __async(this,null,function*(){const t=e?__spreadValues({},e):void 0;return __superGet(EventService.prototype,this,"getPaged").call(this,"paged",t)})}create(e){return __async(this,null,function*(){return this.post("",e)})}update(e,t){return __async(this,null,function*(){return this.put(`/${e}`,t)})}deleteEvent(e){return __async(this,null,function*(){return __superGet(EventService.prototype,this,"deleteById").call(this,e)})}getByCommonArea(e,t=1,a=10){return __async(this,null,function*(){const r={page:t,pageSize:a,areaId:e};return this.getPagedEvents(r)})}getByUser(e,t=1,a=10){return __async(this,null,function*(){const r={page:t,pageSize:a,userId:e};return this.getPagedEvents(r)})}getByStatus(e,t=1,a=10){return __async(this,null,function*(){const r={page:t,pageSize:a,statusTypeId:e};return this.getPagedEvents(r)})}getByDateRange(e,t,a=1,r=10){return __async(this,null,function*(){const s={page:a,pageSize:r,fromDate:e,toDate:t};return this.getPagedEvents(s)})}getActiveEvents(e=1,t=10){return __async(this,null,function*(){const a={page:e,pageSize:t,isDeleted:!1};return this.getPagedEvents(a)})}getByEventType(e,t=1,a=10){return __async(this,null,function*(){const r={page:t,pageSize:a,eventTypeId:e};return this.getPagedEvents(r)})}getUpcomingEvents(e=7,t=1,a=10){return __async(this,null,function*(){const r=new Date,s=new Date;return s.setDate(r.getDate()+e),this.getByDateRange(r.toISOString().split("T")[0],s.toISOString().split("T")[0],t,a)})}cancelEvent(e,t,a){return __async(this,null,function*(){const r={IsCanceled:!0,CanceledBy:t,CancellationReason:a,CanceledAt:(new Date).toISOString()};return this.patch(`/${e}/cancel`,r)})}confirmAttendance(e,t){return __async(this,null,function*(){const a={userId:t,isAttending:!0};return this.post(`/${e}/attendance`,a)})}approve(e,t){return __async(this,null,function*(){return this.put(`/${e}/approve`,t)})}}const generateMockCalendarEvents=(e,t=(new Date).getFullYear(),a=(new Date).getMonth()+1)=>{const r=[],s=new Date(t,a,0).getDate(),n=parseOperatingHours(e.operatingHours),i=[{id:1,name:"Ana García",email:"ana.garcia@email.com"},{id:2,name:"Carlos Rodríguez",email:"carlos.rodriguez@email.com"},{id:3,name:"María López",email:"maria.lopez@email.com"},{id:4,name:"José Martínez",email:"jose.martinez@email.com"},{id:5,name:"Laura Fernández",email:"laura.fernandez@email.com"},{id:6,name:"Roberto Silva",email:"roberto.silva@email.com"},{id:7,name:"Carmen Torres",email:"carmen.torres@email.com"},{id:8,name:"Fernando Ruiz",email:"fernando.ruiz@email.com"}],o=getEventTypesByArea(e.areaName);for(let c=1;c<=s;c++){const s=new Date(t,a-1,c),l=s.getDay(),d=0===l||6===l?.3:.6,u=Math.random()<d?Math.floor(3*Math.random())+1:0;for(let m=0;m<u;m++){const l=generateRandomTimeSlot(n),d=i[Math.floor(Math.random()*i.length)],u=o[Math.floor(Math.random()*o.length)],p=generateRandomStatus(s),x=`${e.areaId}-${t}-${a}-${c}-${m}`,h=new Date(s);let g=new Date(s);l.end<l.start&&(g=new Date(s),g.setDate(g.getDate()+1)),r.push({id:x,title:`${u.title} - ${d.name}`,description:`${u.description}\nUsuario: ${d.name}\nCapacidad: ${e.capacity} personas\nTarifa: S/ ${e.rate.toFixed(2)}`,start:`${formatDate(h)} ${l.start}`,end:`${formatDate(g)} ${l.end}`,backgroundColor:getEventColor(p),borderColor:getEventBorderColor(p),color:"#FFFFFF",areaId:e.areaId,areaName:e.areaName,userId:d.id,userName:d.name,userEmail:d.email,status:p,rate:calculateEventRate(e.rate,l),capacity:e.capacity,notes:u.notes})}}const l=generateRecurringEvents(e,t,a);return r.push(...l),r.sort((e,t)=>new Date(e.start).getTime()-new Date(t.start).getTime())},parseOperatingHours=e=>{if(e.toLowerCase().includes("24 horas")||e.toLowerCase().includes("24h"))return{start:"00:00",end:"24:00"};const t=e.match(/(\d{2}:\d{2})\s*-\s*(\d{2}:\d{2})/);return t?{start:t[1],end:t[2]}:{start:"08:00",end:"20:00"}},isValidTimeFormat=e=>{if("24:00"===e)return!0;return/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/.test(e)},sanitizeTime=e=>{if(isValidTimeFormat(e))return e;const t=parseInt(e.split(":")[0])||8,a=parseInt(e.split(":")[1])||0,r=Math.max(0,Math.min(24,t)),s=Math.max(0,Math.min(59,a));return 24===r?"24:00":`${r.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`},generateRandomTimeSlot=e=>{const t=parseInt(e.start.split(":")[0]);let a=parseInt(e.end.split(":")[0]);a<=t&&(a+=24);const r=Math.floor(3*Math.random())+1,s=a-r;if(s<=t)return{start:sanitizeTime(e.start),end:sanitizeTime(`${(t+2).toString().padStart(2,"0")}:00`),rate:50+100*Math.random(),isAvailable:!0,capacity:10+Math.floor(40*Math.random())};const n=t+Math.floor(Math.random()*(s-t)),i=(n+r)%24;return{start:sanitizeTime(`${(n%24).toString().padStart(2,"0")}:00`),end:sanitizeTime(`${i.toString().padStart(2,"0")}:00`),rate:50+100*Math.random(),isAvailable:!0,capacity:10+Math.floor(40*Math.random())}},getEventTypesByArea=e=>{const t=e.toLowerCase();return t.includes("piscina")?[{title:"Natación Libre",description:"Sesión de natación recreativa",notes:"Traer gorro y lentes"},{title:"Aqua Aeróbicos",description:"Clase de ejercicios en agua",notes:"Instructor certificado"},{title:"Clase de Natación",description:"Entrenamiento técnico",notes:"Todos los niveles"},{title:"Terapia Acuática",description:"Sesión terapéutica",notes:"Solo con reserva"}]:t.includes("gimnasio")?[{title:"Entrenamiento Personal",description:"Sesión con entrenador",notes:"Cita previa"},{title:"Yoga",description:"Clase de yoga y meditación",notes:"Traer mat"},{title:"Crossfit",description:"Entrenamiento funcional",notes:"Nivel intermedio"},{title:"Zumba",description:"Baile y ejercicio",notes:"Todos los niveles"}]:t.includes("salón")||t.includes("eventos")?[{title:"Reunión Familiar",description:"Celebración privada",notes:"Incluye decoración"},{title:"Cumpleaños Infantil",description:"Fiesta para niños",notes:"Área de juegos disponible"},{title:"Reunión de Trabajo",description:"Evento corporativo",notes:"Proyector disponible"},{title:"Boda Civil",description:"Ceremonia matrimonial",notes:"Decoración especial"},{title:"Fiesta de Graduación",description:"Celebración nocturna",notes:"Música hasta 2 AM"},{title:"Quinceañero",description:"Fiesta de 15 años",notes:"Decoración temática"},{title:"Cena de Gala",description:"Evento formal nocturno",notes:"Dress code formal"},{title:"Fiesta de Año Nuevo",description:"Celebración hasta madrugada",notes:"Evento especial 24h"}]:t.includes("cancha")||t.includes("tenis")?[{title:"Partido Singles",description:"Juego individual",notes:"Raquetas disponibles"},{title:"Partido Dobles",description:"Juego en parejas",notes:"Máximo 4 personas"},{title:"Clase de Tenis",description:"Entrenamiento técnico",notes:"Instructor profesional"},{title:"Torneo Interno",description:"Competencia entre residentes",notes:"Premios incluidos"}]:t.includes("coworking")?[{title:"Sesión de Trabajo",description:"Trabajo individual o grupal",notes:"WiFi de alta velocidad"},{title:"Reunión Virtual",description:"Videoconferencia",notes:"Cámaras y micrófonos disponibles"},{title:"Hackathon Nocturno",description:"Programación hasta altas horas",notes:"Café y snacks incluidos"},{title:"Estudio Nocturno",description:"Sesión de estudio extendida",notes:"Ambiente silencioso"},{title:"Startup Meeting",description:"Reunión de emprendedores",notes:"Pizarras disponibles"}]:[{title:"Reserva Privada",description:"Uso exclusivo del área",notes:"Uso general"},{title:"Evento Social",description:"Actividad comunitaria",notes:"Abierto a residentes"},{title:"Mantenimiento",description:"Limpieza y mantenimiento",notes:"Área temporalmente cerrada"},{title:"Actividad Especial",description:"Evento programado",notes:"Ver detalles"}]},generateRandomStatus=e=>{const t=new Date;t.setHours(0,0,0,0);const a=new Date(e);a.setHours(0,0,0,0);const r=a<t,s=a.getTime()===t.getTime(),n=Math.random();return r?n<.85?BookingStatus.COMPLETED:BookingStatus.CANCELLED:s?n<.3?BookingStatus.IN_PROGRESS:n<.6?BookingStatus.CONFIRMED:n<.8?BookingStatus.PENDING:n<.95?BookingStatus.COMPLETED:BookingStatus.CANCELLED:n<.6?BookingStatus.CONFIRMED:n<.85?BookingStatus.PENDING:n<.95?BookingStatus.IN_PROGRESS:BookingStatus.CANCELLED},getEventColor=e=>{switch(e){case BookingStatus.CONFIRMED:return PROJECT_COLORS.confirmed;case BookingStatus.PENDING:return PROJECT_COLORS.pending;case BookingStatus.CANCELLED:return PROJECT_COLORS.cancelled;case BookingStatus.COMPLETED:return PROJECT_COLORS.completed;case BookingStatus.IN_PROGRESS:return PROJECT_COLORS.inProgress;default:return PROJECT_COLORS.primary}},getEventBorderColor=e=>{const t=getEventColor(e);if(t.startsWith("#")){const e=t.substring(1),a=parseInt(e.substring(0,2),16),r=parseInt(e.substring(2,4),16),s=parseInt(e.substring(4,6),16),n=Math.max(0,a-40),i=Math.max(0,r-40),o=Math.max(0,s-40);return`#${n.toString(16).padStart(2,"0")}${i.toString(16).padStart(2,"0")}${o.toString(16).padStart(2,"0")}`}return t},calculateEventRate=(e,t)=>{const a=parseInt(t.start.split(":")[0]),r=parseInt(t.end.split(":")[0])-a;let s=1;return r>=3&&(s=.9),r>=5&&(s=.8),e*r*s},generateRecurringEvents=(e,t,a)=>{const r=[];return getMaintenanceDays(a).forEach(s=>{r.push({id:`maintenance-${e.areaId}-${t}-${a}-${s}`,title:`Mantenimiento - ${e.areaName}`,description:"Limpieza y mantenimiento preventivo del área común",start:`${t}-${a.toString().padStart(2,"0")}-${s.toString().padStart(2,"0")} 06:00`,end:`${t}-${a.toString().padStart(2,"0")}-${s.toString().padStart(2,"0")} 08:00`,backgroundColor:"#757575",borderColor:"#424242",color:"#FFFFFF",areaId:e.areaId,areaName:e.areaName,status:BookingStatus.CONFIRMED,notes:"Área temporalmente cerrada por mantenimiento"})}),r},getMaintenanceDays=e=>{const t=[];for(let a=1;a<=28;a+=7){1===new Date(2024,e-1,a).getDay()&&t.push(a)}return t},formatDate=e=>e.toISOString().split("T")[0],COMMON_AREAS_CONFIG={1:{areaId:1,areaName:"Piscina Principal",capacity:50,operatingHours:"06:00 - 22:00",rate:80,reservationRequired:!0},2:{areaId:2,areaName:"Gimnasio",capacity:25,operatingHours:"05:00 - 23:00",rate:60,reservationRequired:!0},3:{areaId:3,areaName:"Salón de Eventos",capacity:150,operatingHours:"24 Horas",rate:250,reservationRequired:!0},4:{areaId:4,areaName:"Cancha de Tenis",capacity:4,operatingHours:"06:00 - 21:00",rate:100,reservationRequired:!0},5:{areaId:5,areaName:"Área de BBQ",capacity:30,operatingHours:"10:00 - 22:00",rate:120,reservationRequired:!0},6:{areaId:6,areaName:"Sala de Juntas",capacity:20,operatingHours:"07:00 - 19:00",rate:70,reservationRequired:!0},9:{areaId:9,areaName:"Coworking 24h",capacity:20,operatingHours:"24 Horas",rate:45,reservationRequired:!1},7:{areaId:7,areaName:"Área de Juegos Infantiles",capacity:40,operatingHours:"08:00 - 18:00",rate:40,reservationRequired:!1},8:{areaId:8,areaName:"Cancha Multifuncional",capacity:20,operatingHours:"06:00 - 22:00",rate:90,reservationRequired:!0}},getAreaCalendarEvents=(e,t=(new Date).getFullYear(),a=(new Date).getMonth()+1)=>{const r=COMMON_AREAS_CONFIG[e];return r?generateMockCalendarEvents(r,t,a):[]},getAreaInfo=e=>COMMON_AREAS_CONFIG[e]||null,eventCache=new Map,getCachedAreaEvents=(e,t,a)=>{const r=`${e}-${t}-${a}`;if(eventCache.has(r))return eventCache.get(r);const s=getAreaCalendarEvents(e,t,a);return eventCache.set(r,s),s},getAreaOccupancyStats=(e,t,a)=>{const r=getCachedAreaEvents(e,t,a),s=getAreaInfo(e);if(!s)return null;const n=r.length,i=r.filter(e=>e.status===BookingStatus.CONFIRMED).length,o=r.filter(e=>e.status===BookingStatus.PENDING).length,l=r.filter(e=>e.status===BookingStatus.CANCELLED).length,c=.8*new Date(t,a,0).getDate(),d=s.operatingHours.match(/(\d{2}):(\d{2})\s*-\s*(\d{2}):(\d{2})/),u=c*(d?parseInt(d[3])-parseInt(d[1]):12),m=2*n,p=Math.min(m/u*100,100);return{totalEvents:n,confirmedEvents:i,pendingEvents:o,cancelledEvents:l,occupancyRate:Math.round(10*p)/10,totalRevenue:r.filter(e=>e.status===BookingStatus.CONFIRMED).reduce((e,t)=>e+(t.rate||0),0),averageEventDuration:2,peakDay:"Sábado",peakTime:"16:00 - 18:00"}};function EventBookings(){return jsxRuntimeExports.jsx(AlertProvider,{children:jsxRuntimeExports.jsx(EventBookingsContent,{})})}function EventBookingsContent(){var e;const{setLoading:t}=useLoading(),[a,r]=reactExports.useState([]),[s,n]=reactExports.useState([]),[i,o]=reactExports.useState([]),[l,c]=reactExports.useState([]),[d,u]=reactExports.useState([]),[m,p]=reactExports.useState(),[x,h]=reactExports.useState(null),[g,y]=reactExports.useState(-1),[v,E]=reactExports.useState(-1),[f,b]=reactExports.useState(-1),[j,R]=reactExports.useState(-1),[I,S]=reactExports.useState(!0),[_,N]=reactExports.useState(new Date),[C,T]=reactExports.useState([]),[D,A]=reactExports.useState(!1),[P,w]=reactExports.useState(!1),[M,k]=reactExports.useState(!1),[O,$]=reactExports.useState({areaId:void 0,eventDate:(new Date).toISOString().split("T")[0],startTime:"08:00",endTime:"10:00",eventDescription:"",cost:0,statusTypeId:1,eventTypeId:1}),U=new ManagementCompanyService,L=new CondominiumService,B=new BuildingService,F=new CommonAreaService,V=new EventService,{showToast:W,showConfirm:z}=useAlerts(),{hierarchy:H,hasBuilding:G}=useUserData(),{user:q}=useAuth(),Y=()=>__async(this,null,function*(){try{yield preloadCompanyCondoFilters(e=>{y(Number(e))},(e,t)=>__async(this,null,function*(){"companyId"===e&&"number"==typeof t?y(t):"condoId"===e&&"number"==typeof t&&(E(t),yield Z(t))}),X,"EventBookings")}catch(e){}}),K=()=>shouldDisableCompanyCondoSelects()||2===(null==q?void 0:q.profileTypeId);reactExports.useEffect(()=>{let e=!0;return(()=>{__async(this,null,function*(){var t,a,r;if(e)try{if(yield J(),!e)return;if(null==(t=H.company)?void 0:t.id){if(y(H.company.id),yield X(H.company.id),!e)return;if(null==(a=H.condo)?void 0:a.id){if(E(H.condo.id),yield Q(H.condo.id),yield ee(H.condo.id),!e)return;(null==(r=H.building)?void 0:r.id)&&G&&(b(H.building.id),yield te(H.building.id))}}else yield Y();e&&S(!1)}catch(s){e&&S(!1)}})})(),()=>{e=!1}},[]);const J=()=>__async(this,null,function*(){try{t(!0),h(null);const e=yield U.getPagedCompanies();if(e.isSuccess&&e.data){const t=e.data;t.items&&Array.isArray(t.items)?r(t.items):r([])}else h(e.error||"Error al cargar las empresas")}catch(e){h("Error al cargar las empresas")}finally{t(!1)}}),X=e=>__async(this,null,function*(){try{t(!0),h(null);const a={CompanyId:e,Page:1,PageSize:100},r=yield L.getPagedCondominiums(a);if(r.isSuccess&&r.data){const e=r.data;e.items&&Array.isArray(e.items)?n(e.items):e.data&&Array.isArray(e.data)?n(e.data):Array.isArray(e)?n(e):n([])}else h(r.error||"Error al cargar los condominios")}catch(a){h("Error al cargar los condominios")}finally{t(!1)}}),Z=e=>__async(this,null,function*(){const t=Number(e);E(t),b(-1),R(-1),c([]),u([]),-1!==t?(yield Q(t),yield ee(t)):o([])}),Q=e=>__async(this,null,function*(){try{t(!0),h(null);const a=yield B.getByCondominium(e);if(a.isSuccess&&a.data){const e=a.data;e.items&&Array.isArray(e.items)?o(e.items):e.data&&Array.isArray(e.data)?o(e.data):Array.isArray(e)?o(e):o([])}else h(a.error||"Error al cargar los edificios")}catch(a){h("Error al cargar los edificios")}finally{t(!1)}}),ee=e=>__async(this,null,function*(){try{t(!0),h(null);const a=yield F.getByCondoId(e);if(a.isSuccess){let e=[];const t=a.data;t&&Array.isArray(t)?e=t:t&&"object"==typeof t&&"items"in t&&Array.isArray(t.items)?e=t.items:t&&"object"==typeof t&&"data"in t&&Array.isArray(t.data)&&(e=t.data),e.length>0?c(e):(c([]),h("No hay áreas comunes definidas para este condominio"))}else c([]),h(a.error||"Error al cargar las áreas comunes")}catch(a){c([]),h("Error inesperado al cargar las áreas comunes")}finally{t(!1)}}),te=e=>__async(this,null,function*(){try{t(!0),h(null);const a=yield F.getByBuildingId(e);if(a.isSuccess){let e=[];if(a.data&&Array.isArray(a.data)?e=a.data:a.data&&"object"==typeof a.data&&"items"in a.data&&Array.isArray(a.data.items)?e=a.data.items:a.data&&"object"==typeof a.data&&"data"in a.data&&Array.isArray(a.data.data)&&(e=a.data.data),e.length>0)return void c(e)}const r=i.find(t=>t.buildingId===e),s=(null==r?void 0:r.name)||`Edificio ${e}`;c([{areaId:100*e+1,buildingId:e,condoId:v,name:`Piscina ${s}`,description:`Piscina del ${s}`,capacity:20,usageFee:50,reservationRequired:!0,operatingHours:"08:00-20:00",isDeleted:!1},{areaId:100*e+2,buildingId:e,condoId:v,name:`Gimnasio ${s}`,description:`Gimnasio del ${s}`,capacity:15,usageFee:30,reservationRequired:!0,operatingHours:"06:00-22:00",isDeleted:!1},{areaId:100*e+3,buildingId:e,condoId:v,name:`Salón de Eventos ${s}`,description:`Salón de eventos del ${s}`,capacity:50,usageFee:100,reservationRequired:!0,operatingHours:"09:00-23:00",isDeleted:!1}])}catch(a){const t=i.find(t=>t.buildingId===e),r=(null==t?void 0:t.name)||`Edificio ${e}`;c([{areaId:100*e+1,buildingId:e,condoId:v,name:`Piscina ${r}`,description:`Piscina del ${r}`,capacity:20,usageFee:50,reservationRequired:!0,operatingHours:"08:00-20:00",isDeleted:!1}]),h(null)}finally{t(!1)}});reactExports.useEffect(()=>{j>0?ae():T([])},[j,_]);const ae=()=>__async(this,null,function*(){try{A(!0);const e=_.getFullYear(),t=_.getMonth()+1,a=getAreaCalendarEvents(j,e,t);T(a)}catch(e){}finally{A(!1)}}),re=e=>__async(this,null,function*(){try{t(!0),h(null);const a=new Date,r=new Date;r.setDate(a.getDate()-30);const s=new Date;s.setDate(a.getDate()+30);const n={areaId:e,fromDate:r.toISOString().split("T")[0],toDate:s.toISOString().split("T")[0],page:1,pageSize:100},i=yield V.getPagedEvents(n);if(i.isSuccess&&i.data){const e=i.data;e.items&&Array.isArray(e.items)?u(e.items):u([])}else u([]),h(i.error||"Error al cargar los eventos")}catch(a){u([]),h("Error inesperado al cargar los eventos")}finally{t(!1)}}),se=reactExports.useMemo(()=>j>0?getAreaInfo(j):null,[j]);reactExports.useMemo(()=>j<=0?null:getAreaOccupancyStats(j,_.getFullYear(),_.getMonth()+1),[j,_]);const ne=e=>{e?(p(e),$({areaId:e.areaId,userId:e.userId,eventDate:e.eventDate?e.eventDate.split("T")[0]:"",startTime:e.startTime,endTime:e.endTime,eventDescription:e.eventDescription||"",cost:e.cost||0,statusTypeId:e.statusTypeId,eventTypeId:e.eventTypeId}),k(!1)):(p(void 0),$({areaId:-1!==j?j:void 0,eventDate:(new Date).toISOString().split("T")[0],startTime:"08:00",endTime:"10:00",eventDescription:"",cost:0,statusTypeId:1,eventTypeId:1,userId:1}),k(!1)),w(!0)},ie=e=>{p(e),$({areaId:e.areaId,userId:e.userId,eventDate:e.eventDate?e.eventDate.split("T")[0]:"",startTime:e.startTime,endTime:e.endTime,eventDescription:e.eventDescription||"",cost:e.cost||0,statusTypeId:e.statusTypeId,eventTypeId:e.eventTypeId}),k(!0),w(!0)},oe=()=>{w(!1),p(void 0),k(!1),$({areaId:void 0,eventDate:(new Date).toISOString().split("T")[0],startTime:"08:00",endTime:"10:00",eventDescription:"",cost:0,statusTypeId:1,eventTypeId:1})},le=(e,t)=>{$(a=>__spreadProps(__spreadValues({},a),{[e]:t}))},ce=e=>__async(this,null,function*(){z("Cancelar Reserva",`¿Está seguro que desea cancelar la reserva #${e.eventId}?`,()=>__async(this,null,function*(){try{t(!0);const a=yield V.deleteEvent(e.eventId);a.isSuccess?(W("success","Reserva cancelada correctamente"),yield re(j)):W("error",a.error||"Error al cancelar la reserva")}catch(a){W("error","Ocurrió un error al cancelar la reserva")}finally{t(!1)}}))}),de=a.map(e=>({value:e.companyId,label:e.name})),ue=s.map(e=>({value:e.condoId,label:e.name})),me=i.map(e=>({value:e.buildingId,label:e.name||`Edificio ${e.buildingId}`})),pe=l.map(e=>({value:e.areaId,label:e.name||`Área ${e.areaId}`}));return reactExports.useEffect(()=>{-1===v||0!==l.length||x||h("No hay áreas comunes disponibles para este condominio. Por favor, configure áreas comunes primero.")},[v,l.length,x]),jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6 p-6",children:[jsxRuntimeExports.jsx("div",{className:"mb-6",children:jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Reservas de Áreas Comunes"}),jsxRuntimeExports.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Gestione las reservas y eventos en áreas comunes del condominio"})]})}),jsxRuntimeExports.jsx(Expandex,{title:"Filtros de búsqueda",initialExpanded:!0,expandIcon:Filter,backgroundColor:"#f9fafb",className:"mb-6",children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(SelectUI$1,{id:"company",label:"Empresa",value:g,onChange:K()?()=>{}:e=>__async(this,null,function*(){const t=Number(e);y(t),E(-1),b(-1),R(-1),o([]),c([]),u([]),-1!==t?yield X(t):n([])}),icon:Building,options:de,placeholder:"Seleccione una empresa",required:!0,includeAll:!0,disabled:K()||I})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(SelectUI$1,{id:"condominium",label:"Condominio",value:v,onChange:K()?()=>{}:Z,icon:Building2,options:ue,placeholder:"Seleccione un condominio",required:!0,includeAll:!0,disabled:K()||-1===g})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(SelectUI$1,{id:"building",label:"Edificio",value:f,onChange:e=>__async(this,null,function*(){const t=Number(e);b(t),R(-1),u([]),h(null),-1!==t?yield te(t):-1!==v?yield ee(v):c([])}),icon:Building2,options:me,placeholder:"Seleccione un edificio",includeAll:!0,disabled:-1===v})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(SelectUI$1,{id:"area",label:"Área Común",value:j,onChange:e=>{const t=Number(e);R(t),-1!==t?(ae(),re(t)):(u([]),T([]))},icon:Home,options:pe,placeholder:"Seleccione un área común",required:!0,includeAll:!0,disabled:-1===v})})]})}),x&&jsxRuntimeExports.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-6",children:x}),jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-lg border border-gray-200 overflow-hidden",children:j>0?jsxRuntimeExports.jsx(ScheduleCalendar,{areaId:j,areaName:j<=0?"Selecciona un área común":(null==se?void 0:se.areaName)||"Área Común",areaInfo:se?{capacity:se.capacity,operatingHours:se.operatingHours,rate:se.rate,description:se.description}:void 0,events:C,isLoading:D,onEventClick:e=>{const t={eventId:parseInt(e.id),areaId:e.areaId||j,userId:e.userId||1,eventDate:e.start.split(" ")[0],startTime:e.start.split(" ")[1],endTime:e.end.split(" ")[1],eventDescription:e.description||"",cost:e.rate||0,statusTypeId:"confirmed"===e.status?2:"pending"===e.status?1:3,eventTypeId:1,isDeleted:!1,areaName:e.areaName,userName:e.userName,statusName:e.status||"Pendiente",eventTypeName:"Reserva"};ie(t)},onEventCreate:e=>__async(this,null,function*(){var t,a,r;return $({areaId:e.areaId||j,eventDate:(null==(t=e.start)?void 0:t.split(" ")[0])||(new Date).toISOString().split("T")[0],startTime:(null==(a=e.start)?void 0:a.split(" ")[1])||"08:00",endTime:(null==(r=e.end)?void 0:r.split(" ")[1])||"10:00",eventDescription:e.description||"",cost:e.rate||0,statusTypeId:1,eventTypeId:1,userId:1}),k(!1),w(!0),!0}),onEventUpdate:e=>__async(this,null,function*(){const t={eventId:parseInt(e.id),areaId:e.areaId||j,userId:e.userId||1,eventDate:e.start.split(" ")[0],startTime:e.start.split(" ")[1],endTime:e.end.split(" ")[1],eventDescription:e.description||"",cost:e.rate||0,statusTypeId:"confirmed"===e.status?2:"pending"===e.status?1:3,eventTypeId:1,isDeleted:!1,areaName:e.areaName,userName:e.userName,statusName:e.status||"Pendiente",eventTypeName:"Reserva"};return ne(t),!0}),onEventDelete:e=>__async(this,null,function*(){const t=d.find(t=>t.eventId===parseInt(e));return t&&(yield ce(t)),!0}),onMonthChange:(e,t)=>{const a=new Date(e,t-1,1);N(a)},allowCreate:!0,allowEdit:!0,allowDelete:!0,height:"700px",businessHours:{start:(null==se?void 0:se.operatingHours.split(" - ")[0])||"08:00",end:(null==se?void 0:se.operatingHours.split(" - ")[1])||"18:00"}}):jsxRuntimeExports.jsxs("div",{className:"p-12 text-center",children:[jsxRuntimeExports.jsx(Calendar,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-gray-500 mb-2",children:"Selecciona un área común"}),jsxRuntimeExports.jsx("p",{className:"text-gray-400",children:"Utiliza los filtros superiores para seleccionar una empresa, condominio, edificio y área común"})]})}),jsxRuntimeExports.jsx(ModalUI,{isOpen:P,onClose:oe,title:M?"Detalles de Reserva":m?"Editar Reserva":"Nueva Reserva",footer:M?jsxRuntimeExports.jsx(ButtonUI,{icon:X$1,title:"Cerrar",onClick:oe,theme:"cancel"}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ButtonUI,{icon:X$1,title:"Cancelar",onClick:oe,iconColor:"var(--color-action-delete)",textColor:"var(--color-action-delete)",borderColor:"var(--color-action-delete)",backgroundColor:"#ffffff",className:"hover:bg-red-50"}),jsxRuntimeExports.jsx(ButtonUI,{icon:Save,title:"Guardar",onClick:()=>__async(this,null,function*(){try{if(t(!0),!O.areaId)return void W("error","Debe seleccionar un área común");if(!O.eventDate)return void W("error","Debe seleccionar una fecha para el evento");if(!O.startTime||!O.endTime)return void W("error","Debe especificar el horario del evento");if(m){const e={eventId:m.eventId,areaId:O.areaId,userId:O.userId,eventDate:O.eventDate,startTime:O.startTime,endTime:O.endTime,eventDescription:O.eventDescription,cost:O.cost,statusTypeId:O.statusTypeId,eventTypeId:O.eventTypeId,routeId:m.eventId,updatedBy:"current-user",updatedAt:(new Date).toISOString()},t=yield V.update(m.eventId,e);t.isSuccess?(W("success","Reserva actualizada correctamente"),-1!==j&&(yield re(j)),oe()):W("error",t.error||"Error al actualizar la reserva")}else{const e={areaId:O.areaId,userId:O.userId,eventDate:O.eventDate,startTime:O.startTime,endTime:O.endTime,eventDescription:O.eventDescription,cost:O.cost,statusTypeId:O.statusTypeId,eventTypeId:O.eventTypeId,createdBy:"current-user",createdAt:(new Date).toISOString()},t=yield V.create(e);t.isSuccess?(W("success","Reserva creada correctamente"),-1!==j&&(yield re(j)),oe()):W("error",t.error||"Error al crear la reserva")}}catch(e){W("error","Ocurrió un error al guardar los datos")}finally{t(!1)}}),iconColor:"#ffffff",textColor:"#ffffff",borderColor:"var(--color-primary-main)",backgroundColor:"var(--color-primary-main)",className:"hover:bg-primary-admin-dynamic"})]}),children:jsxRuntimeExports.jsxs("div",{className:"space-y-4 p-4",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(SelectUI$1,{id:"areaId",label:"Área Común",value:void 0===O.areaId?"":O.areaId,onChange:e=>le("areaId",Number(e)),options:pe,placeholder:"Seleccione área común",required:!0,disabled:M}),jsxRuntimeExports.jsx(DatepickerUI,{id:"eventDate",label:"Fecha de Reserva",value:O.eventDate||"",onChange:e=>le("eventDate","string"==typeof e?e:null),icon:Calendar,required:!0,disabled:M})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(TimePickerUI,{id:"startTime",label:"Hora de Inicio",value:O.startTime||"",onChange:e=>le("startTime",e),icon:Clock,required:!0,disabled:M}),jsxRuntimeExports.jsx(TimePickerUI,{id:"endTime",label:"Hora de Fin",value:O.endTime||"",onChange:e=>le("endTime",e),icon:Clock,required:!0,disabled:M})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(SelectUI$1,{id:"eventTypeId",label:"Tipo de Evento",value:void 0===O.eventTypeId?"":O.eventTypeId,onChange:e=>le("eventTypeId",Number(e)),options:[{value:1,label:"Reserva"},{value:2,label:"Evento Social"},{value:3,label:"Mantenimiento"},{value:4,label:"Otro"}],placeholder:"Seleccione tipo de evento",required:!0,disabled:M}),jsxRuntimeExports.jsx(InputUI,{id:"cost",label:"Costo (S/.)",type:"number",value:(null==(e=O.cost)?void 0:e.toString())||"0",onChange:e=>le("cost",Number(e)),disabled:M})]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 gap-4",children:jsxRuntimeExports.jsx(InputUI,{id:"eventDescription",label:"Descripción",value:O.eventDescription||"",onChange:e=>le("eventDescription",e),disabled:M})}),m&&jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 gap-4",children:jsxRuntimeExports.jsx(SelectUI$1,{id:"statusTypeId",label:"Estado",value:void 0===O.statusTypeId?"":O.statusTypeId,onChange:e=>le("statusTypeId",Number(e)),options:[{value:1,label:"Pendiente"},{value:2,label:"Aprobado"},{value:3,label:"Rechazado"},{value:4,label:"Cancelado"},{value:5,label:"Finalizado"}],disabled:M})})]})})]})}var ScheduleType=(e=>(e.NORMAL="normal",e.SPECIAL="special",e.MAINTENANCE="maintenance",e.BLOCKED="blocked",e.EXTENDED="extended",e))(ScheduleType||{});const SCHEDULE_TEMPLATES={standard:{templateName:"Horario Estándar",daysOfWeek:[{dayOfWeek:0,isActive:!0,timeSlots:[{startTime:"09:00",endTime:"18:00",isAvailable:!0,priceMultiplier:1.2}]},{dayOfWeek:1,isActive:!0,timeSlots:[{startTime:"06:00",endTime:"22:00",isAvailable:!0,priceMultiplier:1}]},{dayOfWeek:2,isActive:!0,timeSlots:[{startTime:"06:00",endTime:"22:00",isAvailable:!0,priceMultiplier:1}]},{dayOfWeek:3,isActive:!0,timeSlots:[{startTime:"06:00",endTime:"22:00",isAvailable:!0,priceMultiplier:1}]},{dayOfWeek:4,isActive:!0,timeSlots:[{startTime:"06:00",endTime:"22:00",isAvailable:!0,priceMultiplier:1}]},{dayOfWeek:5,isActive:!0,timeSlots:[{startTime:"06:00",endTime:"22:00",isAvailable:!0,priceMultiplier:1}]},{dayOfWeek:6,isActive:!0,timeSlots:[{startTime:"08:00",endTime:"20:00",isAvailable:!0,priceMultiplier:1.3}]}]},extended:{templateName:"Horario Extendido (24h)",daysOfWeek:[{dayOfWeek:0,isActive:!0,timeSlots:[{startTime:"00:00",endTime:"24:00",isAvailable:!0,priceMultiplier:1.5}]},{dayOfWeek:1,isActive:!0,timeSlots:[{startTime:"00:00",endTime:"24:00",isAvailable:!0,priceMultiplier:1}]},{dayOfWeek:2,isActive:!0,timeSlots:[{startTime:"00:00",endTime:"24:00",isAvailable:!0,priceMultiplier:1}]},{dayOfWeek:3,isActive:!0,timeSlots:[{startTime:"00:00",endTime:"24:00",isAvailable:!0,priceMultiplier:1}]},{dayOfWeek:4,isActive:!0,timeSlots:[{startTime:"00:00",endTime:"24:00",isAvailable:!0,priceMultiplier:1}]},{dayOfWeek:5,isActive:!0,timeSlots:[{startTime:"00:00",endTime:"24:00",isAvailable:!0,priceMultiplier:1.2}]},{dayOfWeek:6,isActive:!0,timeSlots:[{startTime:"00:00",endTime:"24:00",isAvailable:!0,priceMultiplier:1.5}]}]},morning:{templateName:"Solo Mañanas",daysOfWeek:[{dayOfWeek:0,isActive:!1,timeSlots:[]},{dayOfWeek:1,isActive:!0,timeSlots:[{startTime:"06:00",endTime:"12:00",isAvailable:!0,priceMultiplier:.8}]},{dayOfWeek:2,isActive:!0,timeSlots:[{startTime:"06:00",endTime:"12:00",isAvailable:!0,priceMultiplier:.8}]},{dayOfWeek:3,isActive:!0,timeSlots:[{startTime:"06:00",endTime:"12:00",isAvailable:!0,priceMultiplier:.8}]},{dayOfWeek:4,isActive:!0,timeSlots:[{startTime:"06:00",endTime:"12:00",isAvailable:!0,priceMultiplier:.8}]},{dayOfWeek:5,isActive:!0,timeSlots:[{startTime:"06:00",endTime:"12:00",isAvailable:!0,priceMultiplier:.8}]},{dayOfWeek:6,isActive:!0,timeSlots:[{startTime:"08:00",endTime:"14:00",isAvailable:!0,priceMultiplier:1}]}]},evening:{templateName:"Solo Tardes/Noches",daysOfWeek:[{dayOfWeek:0,isActive:!0,timeSlots:[{startTime:"14:00",endTime:"22:00",isAvailable:!0,priceMultiplier:1.3}]},{dayOfWeek:1,isActive:!0,timeSlots:[{startTime:"17:00",endTime:"22:00",isAvailable:!0,priceMultiplier:1.2}]},{dayOfWeek:2,isActive:!0,timeSlots:[{startTime:"17:00",endTime:"22:00",isAvailable:!0,priceMultiplier:1.2}]},{dayOfWeek:3,isActive:!0,timeSlots:[{startTime:"17:00",endTime:"22:00",isAvailable:!0,priceMultiplier:1.2}]},{dayOfWeek:4,isActive:!0,timeSlots:[{startTime:"17:00",endTime:"22:00",isAvailable:!0,priceMultiplier:1.2}]},{dayOfWeek:5,isActive:!0,timeSlots:[{startTime:"17:00",endTime:"24:00",isAvailable:!0,priceMultiplier:1.5}]},{dayOfWeek:6,isActive:!0,timeSlots:[{startTime:"14:00",endTime:"24:00",isAvailable:!0,priceMultiplier:1.5}]}]},unavailable:{templateName:"No Disponible",daysOfWeek:[{dayOfWeek:0,isActive:!0,timeSlots:[{startTime:"00:00",endTime:"24:00",isAvailable:!1,priceMultiplier:0}]},{dayOfWeek:1,isActive:!0,timeSlots:[{startTime:"00:00",endTime:"24:00",isAvailable:!1,priceMultiplier:0}]},{dayOfWeek:2,isActive:!0,timeSlots:[{startTime:"00:00",endTime:"24:00",isAvailable:!1,priceMultiplier:0}]},{dayOfWeek:3,isActive:!0,timeSlots:[{startTime:"00:00",endTime:"24:00",isAvailable:!1,priceMultiplier:0}]},{dayOfWeek:4,isActive:!0,timeSlots:[{startTime:"00:00",endTime:"24:00",isAvailable:!1,priceMultiplier:0}]},{dayOfWeek:5,isActive:!0,timeSlots:[{startTime:"00:00",endTime:"24:00",isAvailable:!1,priceMultiplier:0}]},{dayOfWeek:6,isActive:!0,timeSlots:[{startTime:"00:00",endTime:"24:00",isAvailable:!1,priceMultiplier:0}]}]},maintenance:{templateName:"Mantenimiento",daysOfWeek:[{dayOfWeek:0,isActive:!1,timeSlots:[]},{dayOfWeek:1,isActive:!0,timeSlots:[{startTime:"06:00",endTime:"08:00",isAvailable:!1,priceMultiplier:0}]},{dayOfWeek:2,isActive:!0,timeSlots:[{startTime:"06:00",endTime:"08:00",isAvailable:!1,priceMultiplier:0}]},{dayOfWeek:3,isActive:!0,timeSlots:[{startTime:"06:00",endTime:"08:00",isAvailable:!1,priceMultiplier:0}]},{dayOfWeek:4,isActive:!0,timeSlots:[{startTime:"06:00",endTime:"08:00",isAvailable:!1,priceMultiplier:0}]},{dayOfWeek:5,isActive:!0,timeSlots:[{startTime:"06:00",endTime:"08:00",isAvailable:!1,priceMultiplier:0}]},{dayOfWeek:6,isActive:!1,timeSlots:[]}]}},scheduleCache=new Map,generateMockSchedules=(e,t,a,r=SCHEDULE_TEMPLATES.standard)=>{var s;const n=`${e}-${t}-${a}-${r.templateName}`;if(scheduleCache.has(n))return scheduleCache.get(n);const i=[],o=new Date(t),l=new Date(a);let c=1e4*e;for(let d=new Date(o);d<=l;d.setDate(d.getDate()+1)){const t=d.getDay(),a=d.toISOString().split("T")[0],n=r.daysOfWeek.find(e=>e.dayOfWeek===t);if(n&&n.isActive){const t=null==(s=r.specialDays)?void 0:s.find(e=>e.date===a);(t?t.timeSlots:n.timeSlots).forEach(s=>{const n=parseInt(s.startTime.split(":")[0]),o="24:00"===s.endTime?24:parseInt(s.endTime.split(":")[0]);for(let l=n;l<o;l++){let n=ScheduleType.NORMAL;t?n=ScheduleType.SPECIAL:s.isAvailable?r.templateName.toLowerCase().includes("extendido")&&(n=ScheduleType.EXTENDED):n=r.templateName.toLowerCase().includes("mantenimiento")?ScheduleType.MAINTENANCE:(r.templateName.toLowerCase().includes("bloqueado"),ScheduleType.BLOCKED),i.push({scheduleId:c++,areaId:e,scheduleDate:a,startTime:`${l.toString().padStart(2,"0")}:00`,endTime:23===l?"24:00":`${(l+1).toString().padStart(2,"0")}:00`,isAvailable:s.isAvailable,maxCapacity:s.maxCapacity,priceMultiplier:s.priceMultiplier||1,notes:s.notes||(s.isAvailable?void 0:`${r.templateName} - No disponible para reservas`),scheduleType:n,isDeleted:!1,createdAt:(new Date).toISOString(),createdBy:"system"})}})}}return scheduleCache.set(n,i),i},getSchedulesByAreaAndDateRange=(e,t,a)=>generateMockSchedules(e,t,a),getScheduleStats=(e,t,a)=>{var r,s;const n=getSchedulesByAreaAndDateRange(e,t,a),i=n.length,o=n.filter(e=>e.isAvailable).length,l=n.filter(e=>!e.isAvailable).length,c=new Map;n.forEach(e=>{const t=e.startTime;c.set(t,(c.get(t)||0)+1)});const d=Array.from(c.entries()).sort((e,t)=>t[1]-e[1]);return{totalSlots:i,availableSlots:o,blockedSlots:l,occupancyRate:i>0?Math.round(l/i*100):0,mostPopularTime:(null==(r=d[0])?void 0:r[0])||"10:00",leastPopularTime:(null==(s=d[d.length-1])?void 0:s[0])||"22:00",averageDailySlots:i>0?Math.round(i/7):0}},today=new Date,nextWeek=new Date(today);nextWeek.setDate(today.getDate()+7),[1,2,3,4,5].forEach(e=>{generateMockSchedules(e,today.toISOString().split("T")[0],nextWeek.toISOString().split("T")[0],3===e?SCHEDULE_TEMPLATES.extended:SCHEDULE_TEMPLATES.standard)});var TemplateType=(e=>(e.SYSTEM="SYSTEM",e.CUSTOM="CUSTOM",e))(TemplateType||{}),TemplateStatus=(e=>(e.ACTIVE="ACTIVE",e.INACTIVE="INACTIVE",e.DRAFT="DRAFT",e))(TemplateStatus||{});class ScheduleTemplateService{constructor(){}getTemplatesPaged(){return __async(this,arguments,function*(e={}){try{let t=[{templateId:1,templateName:"Horario Estándar",description:"Lunes a Viernes 8:00-18:00, Sábado 8:00-14:00",templateType:TemplateType.SYSTEM,status:TemplateStatus.ACTIVE,isDefault:!0,createdBy:"SYSTEM",createdAt:"2024-01-01T00:00:00Z",isDeleted:!1,version:1,days:[{dayScheduleId:1,templateId:1,dayOfWeek:1,isActive:!0,startTime:"08:00",endTime:"18:00",createdBy:"SYSTEM",createdAt:"2024-01-01T00:00:00Z",isDeleted:!1,version:1},{dayScheduleId:2,templateId:1,dayOfWeek:2,isActive:!0,startTime:"08:00",endTime:"18:00",createdBy:"SYSTEM",createdAt:"2024-01-01T00:00:00Z",isDeleted:!1,version:1},{dayScheduleId:3,templateId:1,dayOfWeek:3,isActive:!0,startTime:"08:00",endTime:"18:00",createdBy:"SYSTEM",createdAt:"2024-01-01T00:00:00Z",isDeleted:!1,version:1},{dayScheduleId:4,templateId:1,dayOfWeek:4,isActive:!0,startTime:"08:00",endTime:"18:00",createdBy:"SYSTEM",createdAt:"2024-01-01T00:00:00Z",isDeleted:!1,version:1},{dayScheduleId:5,templateId:1,dayOfWeek:5,isActive:!0,startTime:"08:00",endTime:"18:00",createdBy:"SYSTEM",createdAt:"2024-01-01T00:00:00Z",isDeleted:!1,version:1},{dayScheduleId:6,templateId:1,dayOfWeek:6,isActive:!0,startTime:"08:00",endTime:"14:00",createdBy:"SYSTEM",createdAt:"2024-01-01T00:00:00Z",isDeleted:!1,version:1},{dayScheduleId:7,templateId:1,dayOfWeek:0,isActive:!1,startTime:"00:00",endTime:"00:00",createdBy:"SYSTEM",createdAt:"2024-01-01T00:00:00Z",isDeleted:!1,version:1}]},{templateId:2,templateName:"Horario Extendido",description:"Lunes a Viernes 6:00-22:00, Fin de semana 8:00-20:00",templateType:TemplateType.SYSTEM,status:TemplateStatus.ACTIVE,isDefault:!1,createdBy:"SYSTEM",createdAt:"2024-01-01T00:00:00Z",isDeleted:!1,version:1,days:[]},{templateId:3,templateName:"Solo Fines de Semana",description:"Sábado y Domingo 10:00-18:00",templateType:TemplateType.SYSTEM,status:TemplateStatus.ACTIVE,isDefault:!1,createdBy:"SYSTEM",createdAt:"2024-01-01T00:00:00Z",isDeleted:!1,version:1,days:[]},{templateId:4,templateName:"No Disponible",description:"Sin horarios disponibles",templateType:TemplateType.SYSTEM,status:TemplateStatus.ACTIVE,isDefault:!1,createdBy:"SYSTEM",createdAt:"2024-01-01T00:00:00Z",isDeleted:!1,version:1,days:[]}].filter(e=>!e.isDeleted);e.templateName&&(t=t.filter(t=>t.templateName.toLowerCase().includes(e.templateName.toLowerCase()))),e.status&&(t=t.filter(t=>t.status===e.status)),e.templateType&&(t=t.filter(t=>t.templateType===e.templateType)),void 0!==e.companyId&&(t=t.filter(t=>t.companyId===e.companyId));const a=e.pageNumber||1,r=e.pageSize||10,s=t.length,n=Math.ceil(s/r),i=(a-1)*r;return{items:t.slice(i,i+r),totalCount:s,currentPage:a,pageSize:r,totalPages:n,hasPrevious:a>1,hasNext:a<n}}catch(t){throw t}})}getTemplatesForSelector(){return __async(this,null,function*(){try{return[{value:1,label:"Horario Estándar (L-V 8:00-18:00, S 8:00-14:00)"},{value:2,label:"Horario Extendido (L-V 6:00-22:00, FS 8:00-20:00)"},{value:3,label:"Solo Fines de Semana (S-D 10:00-18:00)"},{value:4,label:"No Disponible"}]}catch(e){throw e}})}getTemplateById(e){return __async(this,null,function*(){try{return(yield this.getTemplatesPaged()).items.find(t=>t.templateId===e)||null}catch(t){throw t}})}create(e){return __async(this,null,function*(){try{return{templateId:Date.now(),templateName:e.templateName,description:e.description,templateType:e.templateType||TemplateType.CUSTOM,status:e.status||TemplateStatus.ACTIVE,isDefault:e.isDefault||!1,companyId:e.companyId,createdBy:e.createdBy,createdAt:(new Date).toISOString(),isDeleted:!1,version:1,days:e.days.map((e,t)=>({dayScheduleId:Date.now()+t,templateId:Date.now(),dayOfWeek:e.dayOfWeek,isActive:e.isActive,startTime:e.startTime,endTime:e.endTime,createdBy:e.createdBy,createdAt:(new Date).toISOString(),isDeleted:!1,version:1}))}}catch(t){throw t}})}update(e){return __async(this,null,function*(){var t;try{const a=yield this.getById(e.templateId);if(!a)throw new Error("Plantilla no encontrada");return __spreadProps(__spreadValues({},a),{templateName:e.templateName,description:e.description,status:e.status||a.status,isDefault:null!=(t=e.isDefault)?t:a.isDefault,updatedBy:e.updatedBy,updatedAt:(new Date).toISOString(),version:a.version+1,days:e.days.map((t,r)=>({dayScheduleId:t.dayScheduleId||Date.now()+r,templateId:e.templateId,dayOfWeek:t.dayOfWeek,isActive:t.isActive,startTime:t.startTime,endTime:t.endTime,createdBy:a.createdBy,createdAt:a.createdAt,updatedBy:t.updatedBy,updatedAt:(new Date).toISOString(),isDeleted:!1,version:a.version+1}))})}catch(a){throw a}})}delete(e,t){return __async(this,null,function*(){try{return!0}catch(e){throw e}})}duplicate(e,t,a){return __async(this,null,function*(){var r;try{const s=yield this.getById(e);if(!s)throw new Error("Plantilla origen no encontrada");const n={templateName:t,description:s.description,templateType:TemplateType.CUSTOM,status:TemplateStatus.DRAFT,isDefault:!1,companyId:s.companyId,days:(null==(r=s.days)?void 0:r.map(e=>({dayOfWeek:e.dayOfWeek,isActive:e.isActive,startTime:e.startTime,endTime:e.endTime,createdBy:a})))||[],createdBy:a};return yield this.create(n)}catch(s){throw s}})}}function EventSchedules(){return jsxRuntimeExports.jsx(AlertProvider,{children:jsxRuntimeExports.jsx(EventSchedulesContent,{})})}function EventSchedulesContent(){var e,t,a,r;const{setLoading:s}=useLoading(),{showToast:n,showConfirm:i}=useAlerts(),{hierarchy:o,hasBuilding:l}=useUserData(),{user:c}=useAuth(),[d,u]=reactExports.useState([]),[m,p]=reactExports.useState([]),[x,h]=reactExports.useState([]),[g,y]=reactExports.useState([]),[v,E]=reactExports.useState(-1),[f,b]=reactExports.useState(-1),[j,R]=reactExports.useState(-1),[I,S]=reactExports.useState(-1),[_,N]=reactExports.useState([]),[C,T]=reactExports.useState({startDate:(new Date).toISOString().split("T")[0],endDate:(()=>{const e=new Date;return e.setDate(e.getDate()+30),e.toISOString().split("T")[0]})()}),[D,A]=reactExports.useState([]),[P,w]=reactExports.useState(!1),[M,k]=reactExports.useState(!1),[O,$]=reactExports.useState(!1),[U,L]=reactExports.useState(!1),[B,F]=reactExports.useState(null),[V,W]=reactExports.useState(!1),[z,H]=reactExports.useState(!1),[G,q]=reactExports.useState([]),[Y,K]=reactExports.useState(null),[J,X]=reactExports.useState({}),[Z,Q]=reactExports.useState({weekdays:{startTime:"08:00",endTime:"18:00",isActive:!0},saturday:{startTime:"08:00",endTime:"14:00",isActive:!0},sunday:{startTime:"09:00",endTime:"13:00",isActive:!1}}),[ee,te]=reactExports.useState(null),ae=e=>{const[t,a]=e.split(":").map(Number);return 60*t+a},re=e=>{const t=e%60;return`${Math.floor(e/60).toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`},se=(e,t,a)=>{Q(r=>{const s=r[e];if(!s.isActive)return __spreadProps(__spreadValues({},r),{[e]:__spreadProps(__spreadValues({},s),{[t]:a})});let n="startTime"===t?a:s.startTime,i="endTime"===t?a:s.endTime;const o=ae(n),l=ae(i);if(o>=l){if("startTime"===t){const e=o+60;i=re(Math.min(e,1439)),te({type:"info",message:`La hora de fin se ajustó automáticamente a ${i} para mantener al menos 1 hora de diferencia.`})}else{const e=l-60;n=re(Math.max(e,0)),te({type:"info",message:`La hora de inicio se ajustó automáticamente a ${n} para mantener al menos 1 hora de diferencia.`})}setTimeout(()=>te(null),3e3)}else te(null);return __spreadProps(__spreadValues({},r),{[e]:{startTime:n,endTime:i}})})},[ne,ie]=reactExports.useState({areaId:void 0,startDate:(new Date).toISOString().split("T")[0],endDate:(()=>{const e=new Date;return e.setDate(e.getDate()+30),e.toISOString().split("T")[0]})(),template:SCHEDULE_TEMPLATES.standard,excludeDates:[],overwriteExisting:!1}),[oe,le]=reactExports.useState({areaId:void 0,scheduleDate:(new Date).toISOString().split("T")[0],startTime:"08:00",endTime:"10:00",isAvailable:!0,scheduleType:ScheduleType.NORMAL,maxCapacity:void 0,priceMultiplier:1});reactExports.useEffect(()=>{let e=!0;return(()=>{__async(this,null,function*(){var t,a,r;if(e)try{if(s(!0),yield de(),!e)return;if(null==(t=o.company)?void 0:t.id){if(E(o.company.id),yield ue(o.company.id),!e)return;if(null==(a=o.condo)?void 0:a.id){if(b(o.condo.id),yield me(o.condo.id),yield pe(o.condo.id),!e)return;(null==(r=o.building)?void 0:r.id)&&l&&R(o.building.id)}}else yield ce();e&&Re()}catch(n){}finally{e&&s(!1)}})})(),()=>{e=!1}},[]),reactExports.useEffect(()=>{I>0?xe():N([])},[I,C]);const ce=()=>__async(this,null,function*(){try{yield preloadCompanyCondoFilters(e=>{E(Number(e))},(e,t)=>__async(this,null,function*(){"companyId"===e&&"number"==typeof t&&-1!==t&&(E(t),yield ue(t)),"condoId"===e&&"number"==typeof t&&-1!==t&&(b(t),yield me(t),yield pe(t))}),ue,"EventSchedules")}catch(e){}}),de=()=>__async(this,null,function*(){try{s(!0);const e=new((yield __vitePreload(()=>__async(this,null,function*(){const{ManagementCompanyService:e}=yield Promise.resolve().then(()=>managementCompany_service);return{ManagementCompanyService:e}}),void 0)).ManagementCompanyService),t=yield e.getPagedCompanies();if(t.isSuccess&&t.data){const e=t.data;e.items&&Array.isArray(e.items)?u(e.items):u([])}else u([]);shouldDisableCompanyCondoSelects()&&d.length>0&&(E(d[0].companyId||1),yield ue(d[0].companyId||1))}catch(e){}finally{s(!1)}}),ue=e=>__async(this,null,function*(){try{s(!0);const t=new((yield __vitePreload(()=>__async(this,null,function*(){const{CondominiumService:e}=yield Promise.resolve().then(()=>condominium_service);return{CondominiumService:e}}),void 0)).CondominiumService),a={CompanyId:e,Page:1,PageSize:100},r=yield t.getPagedCondominiums(a);if(r.isSuccess&&r.data){const e=r.data;e.items&&Array.isArray(e.items)?p(e.items):e.data&&Array.isArray(e.data)?p(e.data):Array.isArray(e)?p(e):p([])}else p([])}catch(t){}finally{s(!1)}}),me=e=>__async(this,null,function*(){try{s(!0);const t=new((yield __vitePreload(()=>__async(this,null,function*(){const{BuildingService:e}=yield Promise.resolve().then(()=>building_service);return{BuildingService:e}}),void 0)).BuildingService),a=yield t.getByCondominium(e);if(a.isSuccess&&a.data){const e=a.data;e.items&&Array.isArray(e.items)?h(e.items):e.data&&Array.isArray(e.data)?h(e.data):Array.isArray(e)?h(e):h([])}else h([])}catch(t){}finally{s(!1)}}),pe=e=>__async(this,null,function*(){try{s(!0);const t=new((yield __vitePreload(()=>__async(this,null,function*(){const{CommonAreaService:e}=yield Promise.resolve().then(()=>commonArea_service);return{CommonAreaService:e}}),void 0)).CommonAreaService),a=yield t.getByCondoId(e);if(a.isSuccess&&a.data){const e=a.data;e.items&&Array.isArray(e.items)?y(e.items):e.data&&Array.isArray(e.data)?y(e.data):Array.isArray(e)?y(e):y([])}else y([])}catch(t){}finally{s(!1)}}),xe=()=>__async(this,null,function*(){try{s(!0),w(!0);const e=new((yield __vitePreload(()=>__async(this,null,function*(){const{CommonAreaScheduleService:e}=yield import("./commonAreaSchedule.service-BPiBg1Sw.js");return{CommonAreaScheduleService:e}}),__vite__mapDeps([0,1,2,3,4]))).CommonAreaScheduleService),t={areaId:I,startDate:C.startDate,endDate:C.endDate,pageSize:500},a=yield e.getSchedulesPaged(t);if(a.isSuccess&&a.data){const e=a.data;if(e.items&&Array.isArray(e.items)){N(e.items);const t=he(e.items);A(t)}else N([]),A([])}else N([]),A([])}catch(e){N([]),A([])}finally{s(!1),w(!1)}}),he=e=>e.map(e=>{var t;return{id:(null==(t=e.scheduleId)?void 0:t.toString())||`temp-${Date.now()}`,title:ge(e),start:`${e.scheduleDate} ${e.startTime}`,end:`${e.scheduleDate} ${e.endTime}`,description:e.notes||ye(e),areaId:e.areaId,areaName:(null==Ce?void 0:Ce.name)||"Área Común",status:ve(e),userName:"Sistema",userId:1,rate:0}}),ge=e=>{const t={[ScheduleType.NORMAL]:"Disponible",[ScheduleType.SPECIAL]:"Especial",[ScheduleType.MAINTENANCE]:"Mantenimiento",[ScheduleType.BLOCKED]:"Bloqueado",[ScheduleType.EXTENDED]:"Extendido"};if(!e.isAvailable)switch(e.scheduleType){case ScheduleType.MAINTENANCE:return"Mantenimiento";case ScheduleType.BLOCKED:return"Bloqueado";case ScheduleType.SPECIAL:return"No Disponible - Especial";default:return"No Disponible"}return t[e.scheduleType]||"Normal"},ye=e=>{let t="Horario "+(e.isAvailable?"disponible":"no disponible");return e.maxCapacity&&(t+=` - Capacidad máxima: ${e.maxCapacity}`),e.priceMultiplier&&1!==e.priceMultiplier&&(t+=` - Multiplicador: ${(100*e.priceMultiplier).toFixed(0)}%`),t},ve=e=>{if(!e.isAvailable)switch(e.scheduleType){case ScheduleType.MAINTENANCE:return BookingStatus.IN_PROGRESS;case ScheduleType.BLOCKED:default:return BookingStatus.CANCELLED}switch(e.scheduleType){case ScheduleType.BLOCKED:return BookingStatus.CANCELLED;case ScheduleType.MAINTENANCE:return BookingStatus.IN_PROGRESS;case ScheduleType.SPECIAL:return BookingStatus.PENDING;case ScheduleType.EXTENDED:return BookingStatus.COMPLETED;default:return BookingStatus.CONFIRMED}},Ee=e=>__async(this,null,function*(){E(e),b(-1),R(-1),S(-1),p([]),h([]),y([]),N([]),e>0&&(yield ue(e))}),fe=e=>__async(this,null,function*(){b(e),R(-1),S(-1),h([]),y([]),N([]),e>0&&(yield me(e),yield pe(e))}),be=(e,t)=>{T(a=>__spreadProps(__spreadValues({},a),{[e]:t}))},je=new ScheduleTemplateService,Re=()=>__async(this,null,function*(){try{const e=yield je.getTemplatesPaged({status:TemplateStatus.ACTIVE,pageSize:100});q(e.items)}catch(e){}}),Ie=e=>__async(this,null,function*(){i("Eliminar Plantilla",`¿Está seguro de eliminar la plantilla "${e.templateName}"?`,()=>__async(this,null,function*(){try{s(!0),yield je.delete(e.templateId,"admin@system.com"),n("success","Plantilla eliminada exitosamente"),yield Re()}catch(t){n("error","Error al eliminar la plantilla")}finally{s(!1)}}))}),Se=e=>{e?(K(e),X({templateName:e.templateName,description:e.description,templateType:e.templateType,status:e.status,daysOfWeek:e.daysOfWeek})):(K(null),X({templateName:"",description:"",templateType:TemplateType.CUSTOM,status:TemplateStatus.DRAFT,daysOfWeek:Array.from({length:7},(e,t)=>({dayOfWeek:t,isActive:t>=1&&t<=5,timeSlots:t>=1&&t<=5?[{startTime:"08:00",endTime:"18:00",isAvailable:!0,priceMultiplier:1,scheduleType:"NORMAL"}]:[]}))})),H(!0)},_e=e=>{e?(F(e),le({areaId:e.areaId,scheduleDate:e.scheduleDate,startTime:e.startTime,endTime:e.endTime,isAvailable:e.isAvailable,scheduleType:e.scheduleType,maxCapacity:e.maxCapacity,priceMultiplier:e.priceMultiplier,notes:e.notes})):(F(null),le({areaId:I,scheduleDate:(new Date).toISOString().split("T")[0],startTime:"08:00",endTime:"10:00",isAvailable:!0,scheduleType:ScheduleType.NORMAL,maxCapacity:void 0,priceMultiplier:1})),$(!0)},Ne=e=>__async(this,null,function*(){i("Eliminar Horario",`¿Está seguro que desea eliminar el horario del ${e.scheduleDate} de ${e.startTime} a ${e.endTime}?`,()=>__async(this,null,function*(){try{s(!0);const t=new((yield __vitePreload(()=>__async(this,null,function*(){const{CommonAreaScheduleService:e}=yield import("./commonAreaSchedule.service-BPiBg1Sw.js");return{CommonAreaScheduleService:e}}),__vite__mapDeps([0,1,2,3,4]))).CommonAreaScheduleService),a=yield t.deleteSchedule(e.scheduleId);a.isSuccess?(n("success","Horario eliminado correctamente"),yield xe()):n("error",a.error||"Error al eliminar el horario")}catch(t){n("error","Error al eliminar el horario")}finally{s(!1)}}))}),Ce=reactExports.useMemo(()=>g.find(e=>e.areaId===I),[g,I]),Te=reactExports.useMemo(()=>I<=0?null:getScheduleStats(I,C.startDate,C.endDate),[I,C]),De=d.map(e=>({value:e.companyId||0,label:e.name})),Ae=m.map(e=>({value:e.condoId,label:e.name})),Pe=x.map(e=>({value:e.buildingId,label:e.name||`Edificio ${e.buildingId}`})),we=g.map(e=>({value:e.areaId,label:e.name||`Área ${e.areaId}`})),Me=e=>{var t,a,r;const s=null==(t=e.daysOfWeek.find(e=>1===e.dayOfWeek&&e.isActive))?void 0:t.timeSlots[0],n=null==(a=e.daysOfWeek.find(e=>6===e.dayOfWeek&&e.isActive))?void 0:a.timeSlots[0],i=null==(r=e.daysOfWeek.find(e=>0===e.dayOfWeek&&e.isActive))?void 0:r.timeSlots[0];if("00:00"===(null==s?void 0:s.startTime)&&"24:00"===(null==s?void 0:s.endTime))return!1===s.isAvailable?"Todo el día bloqueado":"24 horas";if(s&&!s.isAvailable)return`Mantenimiento L-V: ${s.startTime}-${s.endTime}`;if(e.daysOfWeek.some(e=>e.isActive&&e.timeSlots.some(e=>!e.isAvailable))&&!1===(null==s?void 0:s.isAvailable))return"Períodos no disponibles";const o=[];return s&&o.push(`L-V: ${s.startTime}-${s.endTime}`),n&&n.startTime!==(null==s?void 0:s.startTime)&&o.push(`S: ${n.startTime}-${n.endTime}`),i&&i.startTime!==(null==s?void 0:s.startTime)&&i.startTime!==(null==n?void 0:n.startTime)&&o.push(`D: ${i.startTime}-${i.endTime}`),o.join(" • ")},ke=reactExports.useMemo(()=>{const e=Object.entries(SCHEDULE_TEMPLATES).map(([e,t])=>({value:e,label:`${t.templateName} (${Me(t)})`})),t=G.filter(e=>e.status===TemplateStatus.ACTIVE).map(e=>({value:`custom-${e.templateId}`,label:`${e.templateName} (Personalizada - ${e.weeklyHours||0}h/sem)`}));return[...e,...t.length>0?[{value:"---",label:"--- Plantillas Personalizadas ---",disabled:!0},...t]:[]]},[G]),Oe=[{value:ScheduleType.NORMAL,label:"Normal"},{value:ScheduleType.SPECIAL,label:"Especial"},{value:ScheduleType.MAINTENANCE,label:"Mantenimiento"},{value:ScheduleType.BLOCKED,label:"Bloqueado"},{value:ScheduleType.EXTENDED,label:"Extendido"}];return jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6 p-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:[jsxRuntimeExports.jsx(Settings,{className:"w-6 h-6 inline-block mr-2 text-primary"}),"Gestión de Horarios Disponibles"]}),jsxRuntimeExports.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Configure los horarios disponibles para reservas en las áreas comunes"})]}),5!==(null==c?void 0:c.profileTypeId)&&6!==(null==c?void 0:c.profileTypeId)&&jsxRuntimeExports.jsxs("div",{className:"flex space-x-3",children:[I>0&&Te&&jsxRuntimeExports.jsx(ButtonUI,{title:"Ver Estadísticas",icon:Calendar,onClick:()=>L(!0),theme:"primaryOutline",className:"flex items-center space-x-2"}),jsxRuntimeExports.jsx(ButtonUI,{title:"Carga Masiva",icon:Copy,onClick:()=>{I<=0?n("warning","Seleccione un área común primero"):(ie(e=>__spreadProps(__spreadValues({},e),{areaId:I,startDate:C.startDate,endDate:C.endDate})),k(!0))},disabled:I<=0,className:"bg-blue-600 hover:bg-blue-700 text-white"}),jsxRuntimeExports.jsx(ButtonUI,{title:"Nuevo Horario",icon:Plus,onClick:()=>_e(),disabled:I<=0,className:"bg-primary hover:bg-primary/90 text-white"})]})]}),jsxRuntimeExports.jsx(Expandex,{title:"Filtros de búsqueda",initialExpanded:!0,expandIcon:Filter,backgroundColor:"#f9fafb",className:"mb-6",children:jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h3",{className:"text-sm font-medium text-gray-900 mb-3 flex items-center",children:[jsxRuntimeExports.jsx(Building2,{className:"w-4 h-4 mr-2 text-primary"}),"Selección de Área Común"]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[jsxRuntimeExports.jsx(SelectUI$1,{id:"company",label:"Empresa Gestora",icon:Home,value:v,onChange:e=>Ee(Number(e)),disabled:shouldDisableCompanyCondoSelects()||2===(null==c?void 0:c.profileTypeId),options:De,placeholder:"Seleccionar empresa...",className:"w-full"}),jsxRuntimeExports.jsx(SelectUI$1,{id:"condominium",label:"Condominio",icon:Building2,value:f,onChange:e=>fe(Number(e)),disabled:v<=0||0===m.length||2===(null==c?void 0:c.profileTypeId),options:Ae,placeholder:"Seleccionar condominio...",className:"w-full"}),jsxRuntimeExports.jsx(SelectUI$1,{id:"building",label:"Edificio",icon:Building,value:j,onChange:e=>{return t=Number(e),R(t),S(-1),void N([]);var t},disabled:f<=0||0===x.length,options:Pe,placeholder:"Seleccionar edificio...",className:"w-full"}),jsxRuntimeExports.jsx(SelectUI$1,{id:"commonArea",label:"Área Común",icon:Calendar,value:I,onChange:e=>{return t=Number(e),S(t),ie(e=>__spreadProps(__spreadValues({},e),{areaId:t})),void le(e=>__spreadProps(__spreadValues({},e),{areaId:t}));var t},disabled:f<=0||0===g.length,options:we,placeholder:"Seleccionar área común...",className:"w-full"})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h3",{className:"text-sm font-medium text-gray-900 mb-3 flex items-center",children:[jsxRuntimeExports.jsx(Calendar,{className:"w-4 h-4 mr-2 text-primary"}),"Rango de Fechas"]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(DatepickerUI,{id:"startDate",label:"Fecha Inicio",value:C.startDate,onChange:e=>be("startDate",e),icon:Calendar}),jsxRuntimeExports.jsx(DatepickerUI,{id:"endDate",label:"Fecha Fin",value:C.endDate,onChange:e=>be("endDate",e),icon:Calendar})]})]})]})}),jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-lg border border-gray-200 overflow-hidden",children:I>0?jsxRuntimeExports.jsx(ScheduleCalendar,{areaId:I,areaName:`Gestión de Horarios - ${(null==Ce?void 0:Ce.name)||"Área Común"}`,areaInfo:Ce?{capacity:Ce.capacity,operatingHours:Ce.operatingHours,rate:Ce.usageFee,description:`${_.length} horarios configurados • ${(null==Te?void 0:Te.availableSlots)||0} disponibles`}:void 0,events:D,isLoading:P,onEventClick:e=>{const t=_.find(t=>{var a;return(null==(a=t.scheduleId)?void 0:a.toString())===e.id});t&&_e(t)},onEventCreate:e=>__async(this,null,function*(){var t,a,r;return le({areaId:I,scheduleDate:(null==(t=e.start)?void 0:t.split(" ")[0])||(new Date).toISOString().split("T")[0],startTime:(null==(a=e.start)?void 0:a.split(" ")[1])||"08:00",endTime:(null==(r=e.end)?void 0:r.split(" ")[1])||"10:00",isAvailable:!0,scheduleType:ScheduleType.NORMAL,maxCapacity:void 0,priceMultiplier:1,notes:e.description||""}),F(null),$(!0),!0}),onEventUpdate:e=>__async(this,null,function*(){const t=_.find(t=>{var a;return(null==(a=t.scheduleId)?void 0:a.toString())===e.id});return t&&_e(t),!0}),onEventDelete:e=>__async(this,null,function*(){const t=_.find(t=>{var a;return(null==(a=t.scheduleId)?void 0:a.toString())===e});return t&&(yield Ne(t)),!0}),onMonthChange:(e,t)=>{const a=new Date(e,t-1,1),r=new Date(e,t,0);T({startDate:a.toISOString().split("T")[0],endDate:r.toISOString().split("T")[0]})},allowCreate:!0,allowEdit:!0,allowDelete:!0,height:"700px",businessHours:{start:(null==(e=null==Ce?void 0:Ce.operatingHours)?void 0:e.split(" - ")[0])||"08:00",end:(null==(t=null==Ce?void 0:Ce.operatingHours)?void 0:t.split(" - ")[1])||"18:00"}}):jsxRuntimeExports.jsxs("div",{className:"p-12 text-center",children:[jsxRuntimeExports.jsx(Settings,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-gray-500 mb-2",children:"Selecciona un área común"}),jsxRuntimeExports.jsx("p",{className:"text-gray-400",children:"Utiliza los filtros superiores para seleccionar un área común y gestionar sus horarios disponibles"})]})}),jsxRuntimeExports.jsx(ModalUI,{isOpen:M,onClose:()=>k(!1),title:"Carga Masiva de Horarios",footer:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ButtonUI,{icon:X$1,title:"Cancelar",onClick:()=>k(!1),theme:"modalCancel"}),jsxRuntimeExports.jsx(ButtonUI,{icon:Save,title:"Crear Horarios",onClick:()=>__async(this,null,function*(){try{if(s(!0),!ne.areaId||!ne.template)return void n("error","Datos incompletos para la carga masiva");const e=new((yield __vitePreload(()=>__async(this,null,function*(){const{CommonAreaScheduleService:e}=yield import("./commonAreaSchedule.service-BPiBg1Sw.js");return{CommonAreaScheduleService:e}}),__vite__mapDeps([0,1,2,3,4]))).CommonAreaScheduleService),t={areaId:ne.areaId,startDate:ne.startDate,endDate:ne.endDate,templateId:null,overwriteExisting:ne.overwriteExisting||!1,excludeDates:ne.excludeDates||[],manualTemplate:{templateName:ne.template.templateName,daysOfWeek:ne.template.daysOfWeek.map(e=>({dayOfWeek:e.dayOfWeek,isActive:e.isActive,timeSlots:e.timeSlots.map(e=>({startTime:e.startTime,endTime:e.endTime,isAvailable:e.isAvailable||!0,maxCapacity:e.maxCapacity,priceMultiplier:1,notes:e.notes}))}))},createdBy:"admin@system.com"},a=yield e.bulkCreate(t);if(a.isSuccess&&a.data){const e=a.data;n("success",`Carga masiva completada: ${e.created} creados, ${e.skipped} omitidos`)}else n("error",a.error||"Error en la carga masiva");k(!1),yield xe()}catch(e){n("error","Error al crear los horarios")}finally{s(!1)}}),className:"bg-primary hover:bg-primary/90 text-white"})]}),children:jsxRuntimeExports.jsxs("div",{className:"space-y-4 p-4",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(DatepickerUI,{id:"bulk-startDate",label:"Fecha Inicio",value:ne.startDate||"",onChange:e=>ie(t=>__spreadProps(__spreadValues({},t),{startDate:e})),icon:Calendar}),jsxRuntimeExports.jsx(DatepickerUI,{id:"bulk-endDate",label:"Fecha Fin",value:ne.endDate||"",onChange:e=>ie(t=>__spreadProps(__spreadValues({},t),{endDate:e})),icon:Calendar})]}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("div",{className:"flex items-end space-x-2",children:jsxRuntimeExports.jsx("div",{className:"flex-1",children:jsxRuntimeExports.jsx(SelectUI$1,{id:"template",label:"Plantilla de Horarios",value:Object.keys(SCHEDULE_TEMPLATES).find(e=>SCHEDULE_TEMPLATES[e]===ne.template)||"standard",onChange:e=>{if("string"==typeof e&&e.startsWith("custom-")){const t=parseInt(e.replace("custom-","")),a=G.find(e=>e.templateId===t);if(a){const e=convertCustomToSystemTemplate(a);ie(t=>__spreadProps(__spreadValues({},t),{template:e}))}}else ie(t=>__spreadProps(__spreadValues({},t),{template:SCHEDULE_TEMPLATES[e]}))},options:ke,placeholder:"Seleccionar plantilla..."})})})}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",id:"overwriteExisting",checked:ne.overwriteExisting||!1,onChange:e=>ie(t=>__spreadProps(__spreadValues({},t),{overwriteExisting:e.target.checked})),className:"rounded border-gray-300"}),jsxRuntimeExports.jsx("label",{htmlFor:"overwriteExisting",className:"text-sm text-gray-700",children:"Sobrescribir horarios existentes"})]}),jsxRuntimeExports.jsx("div",{className:"flex justify-center mt-4",children:jsxRuntimeExports.jsx(ButtonUI,{icon:Settings,title:"Gestionar Plantillas",onClick:()=>{Re(),W(!0)},theme:"primaryOutline",className:"px-4 py-2"})})]})}),jsxRuntimeExports.jsx(ModalUI,{isOpen:O,onClose:()=>$(!1),title:B?"Editar Horario":"Nuevo Horario",footer:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ButtonUI,{icon:X$1,title:"Cancelar",onClick:()=>$(!1),theme:"modalCancel"}),jsxRuntimeExports.jsx(ButtonUI,{icon:Save,title:"Guardar",onClick:()=>__async(this,null,function*(){try{s(!0);const e=new((yield __vitePreload(()=>__async(this,null,function*(){const{CommonAreaScheduleService:e}=yield import("./commonAreaSchedule.service-BPiBg1Sw.js");return{CommonAreaScheduleService:e}}),__vite__mapDeps([0,1,2,3,4]))).CommonAreaScheduleService);if(B){const t={scheduleId:B.scheduleId,areaId:oe.areaId,scheduleDate:oe.scheduleDate,startTime:oe.startTime,endTime:oe.endTime,isAvailable:oe.isAvailable,scheduleType:oe.scheduleType,maxCapacity:oe.maxCapacity,notes:oe.notes,updatedBy:"admin@system.com"},a=yield e.update(B.scheduleId,t);if(!a.isSuccess)return void n("error",a.error||"Error al actualizar el horario");n("success","Horario actualizado correctamente")}else{const t={areaId:oe.areaId,scheduleDate:oe.scheduleDate,startTime:oe.startTime,endTime:oe.endTime,isAvailable:oe.isAvailable,scheduleType:oe.scheduleType,maxCapacity:oe.maxCapacity,notes:oe.notes,createdBy:"admin@system.com"},a=yield e.create(t);if(!a.isSuccess)return void n("error",a.error||"Error al crear el horario");n("success","Horario creado correctamente")}$(!1),yield xe()}catch(e){n("error","Error al guardar el horario")}finally{s(!1)}}),className:"bg-primary hover:bg-primary/90 text-white"})]}),children:jsxRuntimeExports.jsxs("div",{className:"space-y-4 p-4",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(DatepickerUI,{id:"schedule-date",label:"Fecha",value:oe.scheduleDate||"",onChange:e=>le(t=>__spreadProps(__spreadValues({},t),{scheduleDate:e})),icon:Calendar}),jsxRuntimeExports.jsx(SelectUI$1,{id:"schedule-type",label:"Tipo de Horario",value:oe.scheduleType||ScheduleType.NORMAL,onChange:e=>le(t=>__spreadProps(__spreadValues({},t),{scheduleType:e})),options:Oe})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(TimePickerUI,{id:"schedule-startTime",label:"Hora Inicio",value:oe.startTime||"",onChange:e=>le(t=>__spreadProps(__spreadValues({},t),{startTime:e})),icon:Clock}),jsxRuntimeExports.jsx(TimePickerUI,{id:"schedule-endTime",label:"Hora Fin",value:oe.endTime||"",onChange:e=>le(t=>__spreadProps(__spreadValues({},t),{endTime:e})),icon:Clock})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(InputUI,{id:"maxCapacity",label:"Capacidad Máxima",type:"number",value:(null==(a=oe.maxCapacity)?void 0:a.toString())||"",onChange:e=>le(t=>__spreadProps(__spreadValues({},t),{maxCapacity:e?Number(e):void 0}))}),jsxRuntimeExports.jsx(InputUI,{id:"priceMultiplier",label:"Multiplicador de Precio",type:"number",value:(null==(r=oe.priceMultiplier)?void 0:r.toString())||"1.0",onChange:e=>le(t=>__spreadProps(__spreadValues({},t),{priceMultiplier:e?Number(e):1}))})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",id:"isAvailable",checked:oe.isAvailable||!1,onChange:e=>le(t=>__spreadProps(__spreadValues({},t),{isAvailable:e.target.checked})),className:"rounded border-gray-300"}),jsxRuntimeExports.jsx("label",{htmlFor:"isAvailable",className:"text-sm text-gray-700",children:"Horario disponible para reservas"})]}),jsxRuntimeExports.jsx(InputUI,{id:"notes",label:"Notas",value:oe.notes||"",onChange:e=>le(t=>__spreadProps(__spreadValues({},t),{notes:e}))})]})}),jsxRuntimeExports.jsx(ModalUI,{isOpen:U,onClose:()=>L(!1),title:"Estadísticas de Horarios",children:Te&&jsxRuntimeExports.jsxs("div",{className:"space-y-6 p-4",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold text-blue-600",children:Te.totalSlots}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500",children:"Total Horarios"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold text-green-600",children:Te.availableSlots}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500",children:"Disponibles"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-red-50 rounded-lg p-4 text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold text-red-600",children:Te.blockedSlots}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500",children:"Bloqueados"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 text-center",children:[jsxRuntimeExports.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[Te.occupancyRate,"%"]}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500",children:"Tasa Ocupación"})]})]}),jsxRuntimeExports.jsxs("div",{className:"border-t pt-4",children:[jsxRuntimeExports.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Información Adicional"}),jsxRuntimeExports.jsxs("div",{className:"space-y-2 text-sm",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-600",children:"Hora más popular:"}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:Te.mostPopularTime})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-600",children:"Hora menos popular:"}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:Te.leastPopularTime})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-600",children:"Promedio diario:"}),jsxRuntimeExports.jsxs("span",{className:"font-medium",children:[Te.averageDailySlots," horarios"]})]})]})]})]})}),jsxRuntimeExports.jsx(ModalUI,{isOpen:V,onClose:()=>W(!1),title:"Gestión de Plantillas Personalizadas",size:"xl",footer:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ButtonUI,{icon:X$1,title:"Cerrar",onClick:()=>W(!1),iconColor:"#629E3E",textColor:"#629E3E",borderColor:"#629E3E",className:"hover:bg-gray-50"}),jsxRuntimeExports.jsx(ButtonUI,{icon:Plus,title:"Nueva Plantilla",onClick:()=>Se(),className:"bg-primary hover:bg-primary/90 text-white"})]}),children:jsxRuntimeExports.jsx("div",{className:"p-4 max-h-96 overflow-y-auto",children:0===G.length?jsxRuntimeExports.jsxs("div",{className:"text-center py-8",children:[jsxRuntimeExports.jsx(Settings,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-gray-500 mb-2",children:"No hay plantillas personalizadas"}),jsxRuntimeExports.jsx("p",{className:"text-gray-400 mb-4",children:"Crea tu primera plantilla personalizada para configurar horarios específicos"}),jsxRuntimeExports.jsx(ButtonUI,{icon:Plus,title:"Crear Primera Plantilla",onClick:()=>Se(),className:"bg-primary hover:bg-primary/90 text-white"})]}):jsxRuntimeExports.jsx("div",{className:"space-y-3",children:G.map(e=>jsxRuntimeExports.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsxs("h4",{className:"font-medium text-gray-900 flex items-center",children:[e.templateName,e.isDefault&&jsxRuntimeExports.jsx("span",{className:"ml-2 px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full",children:"Por defecto"})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.description||"Sin descripción"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-xs text-gray-500",children:[jsxRuntimeExports.jsxs("span",{children:["Estado: ",e.status]}),jsxRuntimeExports.jsxs("span",{children:["Horas/sem: ",e.weeklyHours||0,"h"]}),jsxRuntimeExports.jsxs("span",{children:["Slots: ",e.totalTimeSlots||0]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx(ButtonUI,{icon:Pen,title:"Editar",onClick:()=>Se(e),iconColor:"#629E3E",textColor:"#629E3E",borderColor:"#629E3E",className:"hover:bg-gray-50 px-2 py-1 text-sm"}),jsxRuntimeExports.jsx(ButtonUI,{icon:Trash2,title:"Eliminar",onClick:()=>Ie(e),theme:"delete",className:"px-2 py-1 text-sm"})]})]})},e.templateId))})})}),jsxRuntimeExports.jsx(ModalUI,{isOpen:z,onClose:()=>H(!1),title:Y?"Editar Plantilla":"Nueva Plantilla",size:"xl",footer:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ButtonUI,{icon:X$1,title:"Cancelar",onClick:()=>H(!1),iconColor:"#629E3E",textColor:"#629E3E",borderColor:"#629E3E",className:"hover:bg-gray-50"}),jsxRuntimeExports.jsx(ButtonUI,{icon:Save,title:Y?"Actualizar":"Crear",onClick:Y?()=>__async(this,null,function*(){if(Y)try{s(!0);const e=__spreadProps(__spreadValues({},J),{templateId:Y.templateId,updatedBy:"admin@system.com"});yield je.update(e),n("success","Plantilla actualizada exitosamente"),H(!1),yield Re()}catch(e){n("error","Error al actualizar la plantilla")}finally{s(!1)}}):()=>__async(this,null,function*(){try{s(!0);const e=__spreadProps(__spreadValues({},J),{createdBy:"admin@system.com"});yield je.create(e),n("success","Plantilla creada exitosamente"),H(!1),yield Re()}catch(e){n("error","Error al crear la plantilla")}finally{s(!1)}}),className:"bg-primary hover:bg-primary/90 text-white"})]}),children:jsxRuntimeExports.jsxs("div",{className:"p-4 space-y-4 max-h-96 overflow-y-auto",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(InputUI,{id:"templateName",label:"Nombre de Plantilla",placeholder:"Ej: Horario Personalizado...",value:J.templateName||"",onChange:e=>X(t=>__spreadProps(__spreadValues({},t),{templateName:e})),required:!0}),jsxRuntimeExports.jsx(SelectUI$1,{id:"templateStatus",label:"Estado",value:J.status||TemplateStatus.DRAFT,onChange:e=>X(t=>__spreadProps(__spreadValues({},t),{status:e})),options:[{value:TemplateStatus.DRAFT,label:"Borrador"},{value:TemplateStatus.ACTIVE,label:"Activa"},{value:TemplateStatus.INACTIVE,label:"Inactiva"}]})]}),jsxRuntimeExports.jsx(InputUI,{id:"templateDescription",label:"Descripción",placeholder:"Descripción opcional...",value:J.description||"",onChange:e=>X(t=>__spreadProps(__spreadValues({},t),{description:e}))}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-3",children:[jsxRuntimeExports.jsxs("h3",{className:"text-lg font-semibold flex items-center",children:[jsxRuntimeExports.jsx(Calendar,{className:"w-5 h-5 mr-2 text-primary"}),"Configuración de Horarios"]}),jsxRuntimeExports.jsx("div",{className:"bg-gray-100 px-3 py-1 rounded-full",children:jsxRuntimeExports.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[Object.values(Z).filter(e=>e.isActive).length," de 3 períodos activos"]})})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Configura los horarios disponibles para cada día de la semana"}),jsxRuntimeExports.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:[jsxRuntimeExports.jsxs("p",{className:"text-sm text-blue-800 mb-2",children:["💡 ",jsxRuntimeExports.jsx("strong",{children:"Tip:"})," Esta es una versión simplificada para crear plantillas básicas. Para configuraciones avanzadas, ve a la página de Configuración → Plantillas de Horarios."]}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-blue-700",children:["🔄 ",jsxRuntimeExports.jsx("strong",{children:"Activar/Desactivar:"})," Usa los toggles para incluir o excluir períodos específicos en tu plantilla (ej: desactivar domingos para cerrar ese día)."]})]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 gap-3",children:[{label:"Lunes a Viernes",key:"weekdays"},{label:"Sábado",key:"saturday"},{label:"Domingo",key:"sunday"}].map(({label:e,key:t},a)=>jsxRuntimeExports.jsxs("div",{className:"border rounded-lg p-3 transition-all duration-200 "+(Z[t].isActive?"border-gray-300 bg-white":"border-gray-200 bg-gray-50"),children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-3",children:[jsxRuntimeExports.jsx("h4",{className:"font-medium "+(Z[t].isActive?"text-gray-900":"text-gray-500"),children:e}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx("span",{className:"text-sm "+(Z[t].isActive?"text-gray-600":"text-gray-400"),children:Z[t].isActive?"Activo":"Inactivo"}),jsxRuntimeExports.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:Z[t].isActive,onChange:e=>((e,t)=>{const a=Object.values(Z).filter(e=>e.isActive).length;if(!t&&1===a)return te({type:"warning",message:"Debe mantener al menos un período activo en la plantilla."}),void setTimeout(()=>te(null),3e3);Q(a=>__spreadProps(__spreadValues({},a),{[e]:__spreadProps(__spreadValues({},a[e]),{isActive:t})})),te(null)})(t,e.target.checked),className:"sr-only peer"}),jsxRuntimeExports.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-3 "+(Z[t].isActive?"":"opacity-50"),children:[jsxRuntimeExports.jsx(TimePickerUI,{id:`startTime-${a}`,label:"Hora Inicio",value:Z[t].startTime,onChange:e=>se(t,"startTime",e),icon:Clock,disabled:!Z[t].isActive}),jsxRuntimeExports.jsx(TimePickerUI,{id:`endTime-${a}`,label:"Hora Fin",value:Z[t].endTime,onChange:e=>se(t,"endTime",e),icon:Clock,disabled:!Z[t].isActive})]})]},t))}),ee&&jsxRuntimeExports.jsx("div",{className:"mt-3 p-3 rounded-lg border "+("info"===ee.type?"bg-blue-50 border-blue-200 text-blue-800":"bg-yellow-50 border-yellow-200 text-yellow-800"),children:jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"mr-2",children:"info"===ee.type?"💡":"⚠️"}),jsxRuntimeExports.jsx("p",{className:"text-sm font-medium",children:ee.message})]})})]})]})})]})}class VisitorService extends ApiBaseService{constructor(){super("/Visitor")}getVisitorById(e){return __async(this,null,function*(){return __superGet(VisitorService.prototype,this,"getById").call(this,e)})}getPagedVisitors(e){return __async(this,null,function*(){const t=e?__spreadValues({},e):void 0;return __superGet(VisitorService.prototype,this,"getPaged").call(this,"paged",t)})}create(e){return __async(this,null,function*(){return this.post("",e)})}update(e,t){return __async(this,null,function*(){return this.put(`/${e}`,t)})}deleteVisitor(e){return __async(this,null,function*(){return __superGet(VisitorService.prototype,this,"deleteById").call(this,e)})}getByDepartment(e,t=1,a=10){return __async(this,null,function*(){const r={page:t,pageSize:a,departmentId:e};return this.getPagedVisitors(r)})}searchByName(e,t=1,a=10){return __async(this,null,function*(){const r={page:t,pageSize:a,fullName:e};return this.getPagedVisitors(r)})}searchByIdentification(e,t=1,a=10){return __async(this,null,function*(){const r={page:t,pageSize:a,identificationNumber:e};return this.getPagedVisitors(r)})}getByVisitDate(e,t=1,a=10){return __async(this,null,function*(){const r={page:t,pageSize:a,visitDate:e};return this.getPagedVisitors(r)})}getAuthorizedVisitors(e=1,t=10){return __async(this,null,function*(){const a={page:e,pageSize:t,isAuthorized:!0};return this.getPagedVisitors(a)})}getUnauthorizedVisitors(e=1,t=10){return __async(this,null,function*(){const a={page:e,pageSize:t,isAuthorized:!1};return this.getPagedVisitors(a)})}getByAuthorizer(e,t=1,a=10){return __async(this,null,function*(){const r={page:t,pageSize:a,authorizedBy:e};return this.getPagedVisitors(r)})}getByDateRange(e,t,a=1,r=10){return __async(this,null,function*(){const s={page:a,pageSize:r,startDate:e,endDate:t};return this.getPagedVisitors(s)})}authorizeVisitor(e,t){return __async(this,null,function*(){const a={isAuthorized:!0,authorizedBy:t,authorizedAt:(new Date).toISOString()};return this.patch(`/${e}/authorize`,a)})}revokeAuthorization(e,t){return __async(this,null,function*(){const a={isAuthorized:!1,revokedBy:t,revokedAt:(new Date).toISOString()};return this.patch(`/${e}/revoke`,a)})}checkIn(e){return __async(this,null,function*(){const t={checkInTime:(new Date).toISOString()};return this.post(`/${e}/check-in`,t)})}checkOut(e){return __async(this,null,function*(){const t={checkOutTime:(new Date).toISOString()};return this.post(`/${e}/check-out`,t)})}getCurrentVisitors(e=1,t=10){return __async(this,null,function*(){const a={page:e,pageSize:t};return this.getPaged("current",a)})}}function VisitRegistry(){return jsxRuntimeExports.jsx(AlertProvider,{children:jsxRuntimeExports.jsx(VisitRegistryContent,{})})}function VisitRegistryContent(){const{setLoading:e}=useLoading(),[t,a]=reactExports.useState([]),[r,s]=reactExports.useState([]),[n,i]=reactExports.useState([]),[o,l]=reactExports.useState([]),[c,d]=reactExports.useState([]),[u,m]=reactExports.useState(),[p,x]=reactExports.useState(null),[h,g]=reactExports.useState(!1),[y,v]=reactExports.useState(!1),[E,f]=reactExports.useState(!1),[b,j]=reactExports.useState(null),[R,I]=reactExports.useState("-1"),[S,_]=reactExports.useState("-1"),[N,C]=reactExports.useState({Page:1,PageSize:10,IsActive:!0}),[T,D]=reactExports.useState({statusTypeId:1,itemsRemoval:!1,companyId:void 0,condoId:void 0,buildingId:void 0,departmentId:void 0}),A=new VisitorService,P=new CondominiumService,w=new ManagementCompanyService,M=new BuildingService,k=new DepartmentService,{showToast:O,showConfirm:$}=useAlerts(),U=()=>__async(this,null,function*(){try{yield preloadCompanyCondoFilters(e=>{I(e)},ee,W,"Registry")}catch(e){}}),L=()=>shouldDisableCompanyCondoSelects();reactExports.useEffect(()=>((()=>{__async(this,null,function*(){try{e(!0);const t=yield w.getPaged();if(t.isSuccess&&t.data){let e=[];e=t.data.items&&Array.isArray(t.data.items)?t.data.items:Array.isArray(t.data)?t.data:[],e.forEach((e,t)=>{e.companyId||e.managementCompanyId}),s(e),yield B(),yield U()}else x("Error al cargar las empresas")}catch(t){x("Error de conexión al cargar empresas")}finally{e(!1)}})})(),()=>{}),[]);const B=()=>__async(this,null,function*(){try{e(!0),x(null);const t=F();setTimeout(()=>{a(t),e(!1)},500)}catch(t){x("Error al cargar los visitantes"),e(!1)}}),F=()=>{const e=new Date,t=new Date(e);t.setDate(e.getDate()-1);const a=e=>e.toISOString();return[{visitorId:1,condoId:1,condoName:"Condominio del Sol",departmentId:101,departmentName:"Departamento 101",firstName:"Juan",lastName:"Pérez",documentNumber:"12345678",documentTypeId:1,documentTypeName:"DNI",visitDate:a(t),exitDate:a(e),vehiclePlate:"ABC-123",relationshipToResident:"Familiar",statusTypeId:2,statusName:"Con salida",notes:"Visitante familiar",contactNumber:"987654321",itemsRemoval:!1,createdAt:a(t),createdBy:"admin",updatedAt:a(e),updatedBy:"admin",isDeleted:!1},{visitorId:2,condoId:1,condoName:"Condominio del Sol",departmentId:202,departmentName:"Departamento 202",firstName:"María",lastName:"González",documentNumber:"87654321",documentTypeId:1,documentTypeName:"DNI",visitDate:a(e),vehiclePlate:"XYZ-789",relationshipToResident:"Amigo",statusTypeId:1,statusName:"Activo",notes:"Visita social",contactNumber:"912345678",itemsRemoval:!1,createdAt:a(e),createdBy:"admin",isDeleted:!1},{visitorId:3,condoId:1,condoName:"Condominio del Sol",departmentId:301,departmentName:"Departamento 301",firstName:"Carlos",lastName:"Rodríguez",documentNumber:"45678901",documentTypeId:2,documentTypeName:"CE",visitDate:a(t),vehiclePlate:"",relationshipToResident:"Servicio",statusTypeId:1,statusName:"Activo",notes:"Técnico de internet",contactNumber:"923456789",itemsRemoval:!0,itemsDescription:"Herramientas de trabajo",createdAt:a(t),createdBy:"admin",isDeleted:!1},{visitorId:4,condoId:1,condoName:"Condominio del Sol",departmentId:102,departmentName:"Departamento 102",firstName:"Ana",lastName:"Martínez",documentNumber:"56789012",documentTypeId:1,documentTypeName:"DNI",visitDate:a(e),exitDate:a(e),vehiclePlate:"DEF-456",relationshipToResident:"Delivery",statusTypeId:2,statusName:"Con salida",notes:"Entrega de paquete",contactNumber:"934567890",itemsRemoval:!1,createdAt:a(e),createdBy:"admin",updatedAt:a(e),updatedBy:"admin",isDeleted:!1},{visitorId:5,condoId:1,condoName:"Condominio del Sol",departmentId:201,departmentName:"Departamento 201",firstName:"Pedro",lastName:"Sánchez",documentNumber:"67890123",documentTypeId:1,documentTypeName:"DNI",visitDate:a(t),vehiclePlate:"GHI-789",relationshipToResident:"Familiar",statusTypeId:1,statusName:"Activo",contactNumber:"945678901",itemsRemoval:!1,createdAt:a(t),createdBy:"admin",isDeleted:!1}]},V=(e,t=3)=>__async(this,null,function*(){let a=null;for(let s=1;s<=t;s++)try{const r=yield e();if(!r||"object"!=typeof r)return r;if(!("isSuccess"in r))return r;{const e=r;if(e.isSuccess)return r;a=new Error(e.error||"Error en la llamada al servicio")}if(s<t){const e=Math.min(1e3*Math.pow(2,s-1),8e3);yield new Promise(t=>setTimeout(t,e))}}catch(r){if(a=r instanceof Error?r:new Error(String(r)),s<t){const e=Math.min(1e3*Math.pow(2,s-1),8e3);yield new Promise(t=>setTimeout(t,e))}}throw a||new Error("Error desconocido en llamada al servicio")}),W=t=>__async(this,null,function*(){try{e(!0);const a={CompanyId:t,Page:1,PageSize:100},r=yield V(()=>P.getPaged(a));if(r.isSuccess&&r.data){let e=[];if(Array.isArray(r.data))e=r.data;else if(r.data.items&&Array.isArray(r.data.items))e=r.data.items;else{const t=r.data;t.data&&Array.isArray(t.data)&&(e=t.data)}i(e),0===e.length?x("No se encontraron condominios para esta empresa"):x(null)}else i([]),x(r.error||"Error al cargar los condominios. Verifique su conexión.")}catch(a){i([]),x("Error inesperado al cargar los condominios después de varios intentos")}finally{e(!1)}}),z=t=>__async(this,null,function*(){try{e(!0),x(null);const a=yield M.getByCondoId(t);if(a.isSuccess&&a.data){let e=[];if(Array.isArray(a.data))e=a.data;else if(a.data.items&&Array.isArray(a.data.items))e=a.data.items;else{const t=a.data;e=t.data&&Array.isArray(t.data)?t.data:[]}l(e)}else l([]),x(a.error||"Error al cargar los edificios")}catch(a){l([]),x("Error inesperado al cargar los edificios")}finally{e(!1)}}),H=t=>__async(this,null,function*(){try{e(!0),x(null);const a=yield k.getByBuildingId(t);if(a.isSuccess&&a.data){let e=[];if(Array.isArray(a.data))e=a.data;else if(a.data.items&&Array.isArray(a.data.items))e=a.data.items;else{const t=a.data;e=t.data&&Array.isArray(t.data)?t.data:[]}d(e)}else d([]),x(a.error||"Error al cargar los departamentos")}catch(a){d([]),x("Error inesperado al cargar los departamentos")}finally{e(!1)}}),G=r.map(e=>{const t=e.companyId||e.managementCompanyId;return null==t?null:{value:t.toString(),label:e.name||"Sin nombre"}}).filter(Boolean),q=e=>__async(this,null,function*(){if("-1"===((null==e?void 0:e.toString())||"-1")||!e)return l([]),d([]),_("-1"),ee("condoId",null),ee("buildingId",null),ee("departmentId",null),void C(e=>__spreadProps(__spreadValues({},e),{CondoId:void 0}));const t=Number(e);if(isNaN(t))null==O||O("error","ID de condominio inválido");else try{ee("condoId",t),ee("buildingId",null),ee("departmentId",null),_("-1"),d([]),yield z(t),C(e=>__spreadProps(__spreadValues({},e),{CondoId:t}))}catch(a){null==O||O("error","Error al cargar los edificios. Por favor, intente nuevamente.")}}),Y=e=>__async(this,null,function*(){const t=(null==e?void 0:e.toString())||"-1";if(_(t),"-1"===t||!e)return d([]),ee("buildingId",null),void ee("departmentId",null);const a=Number(e);if(isNaN(a))null==O||O("error","ID de edificio inválido");else try{ee("buildingId",a),ee("departmentId",null),yield H(a)}catch(r){null==O||O("error","Error al cargar los departamentos. Por favor, intente nuevamente.")}}),K=(e,t)=>{C(a=>__spreadProps(__spreadValues({},a),{[e]:t}))},J=[{accessorKey:"visitorId",header:"ID",cell:({row:e})=>jsxRuntimeExports.jsxs("span",{className:"font-semibold",children:["#",e.original.visitorId]})},{accessorKey:"fullName",header:"Visitante",cell:({row:e})=>{const t=e.original,a=`${t.firstName||""} ${t.lastName||""}`.trim();return jsxRuntimeExports.jsxs("div",{className:"flex flex-col",children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:a||"Sin nombre"}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-gray-500",children:["Doc: ",t.documentNumber||"N/A"]})]})}},{accessorKey:"departmentName",header:"Departamento",cell:({row:e})=>jsxRuntimeExports.jsx("span",{className:"font-medium",children:e.original.departmentName||`Depto. #${e.original.departmentId}`})},{accessorKey:"visitDate",header:"Fecha de Ingreso",cell:({getValue:e})=>{const t=e();return jsxRuntimeExports.jsx("span",{className:"font-medium",children:format(new Date(t),"dd/MM/yyyy HH:mm",{locale:es})})}},{accessorKey:"exitDate",header:"Fecha de Salida",cell:({getValue:e})=>{const t=e();return t?jsxRuntimeExports.jsx("span",{className:"font-medium",children:format(new Date(t),"dd/MM/yyyy HH:mm",{locale:es})}):jsxRuntimeExports.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Activo"})}},{accessorKey:"statusName",header:"Estado",cell:({row:e})=>{let t="bg-gray-100 text-gray-800";switch(e.original.statusTypeId){case 1:t="bg-green-100 text-green-800";break;case 2:t="bg-blue-100 text-blue-800";break;case 3:t="bg-red-100 text-red-800"}return jsxRuntimeExports.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t}`,children:e.original.statusName||"Desconocido"})}}],X=e=>__async(this,null,function*(){m(void 0),D({statusTypeId:1,itemsRemoval:!1}),yield Z(),v(!1),g(!0)}),Z=()=>__async(this,null,function*(){try{const e=e=>{D(t=>{const a=e(t);return __spreadValues(__spreadValues({},t),a)})};yield preloadCompanyCondoSelects(e,e=>__async(this,null,function*(){yield W(e);const{condoId:t,shouldPreload:a}=getCompanyCondoFromLocalStorage();a&&t&&setTimeout(()=>__async(this,null,function*(){yield z(t),D(e=>__spreadProps(__spreadValues({},e),{condoId:t}))}),200)}),"Registry-Modal")}catch(e){}}),Q=()=>{g(!1),m(void 0),v(!1),D({statusTypeId:1,itemsRemoval:!1})},ee=(e,t)=>__async(this,null,function*(){D(a=>__spreadProps(__spreadValues({},a),{[e]:t})),"companyId"===e&&"number"==typeof t&&-1!==t&&(I(t.toString()),C(e=>__spreadProps(__spreadValues({},e),{CompanyId:t}))),"condoId"===e&&"number"==typeof t&&-1!==t&&(C(e=>__spreadProps(__spreadValues({},e),{CondoId:t})),yield q(t))}),te=t=>{$("Eliminar Visitante",`¿Está seguro que desea eliminar el registro del visitante ${t.firstName||""} ${t.lastName||""}?`,()=>{$("Confirmar Eliminación","Esta acción no se puede deshacer. ¿Está completamente seguro?",()=>__async(this,null,function*(){try{e(!0);const a=yield A.delete(t.visitorId);a.isSuccess?(O("success","Visitante eliminado correctamente"),B()):O("error",a.error||"Error al eliminar el visitante")}catch(a){O("error","Ocurrió un error al eliminar el visitante")}finally{e(!1)}}))})},ae=[{icon:Eye,label:"Ver Detalles",onClick:e=>(e=>{m(e),D({condoId:e.condoId,departmentId:e.departmentId,firstName:e.firstName,lastName:e.lastName,documentNumber:e.documentNumber,documentTypeId:e.documentTypeId,vehiclePlate:e.vehiclePlate,relationshipToResident:e.relationshipToResident,statusTypeId:e.statusTypeId,notes:e.notes,contactNumber:e.contactNumber,itemsRemoval:e.itemsRemoval,itemsDescription:e.itemsDescription,authorizedByUserId:e.authorizedByUserId}),v(!0),g(!0)})(e)},{icon:LogOut,label:"Registrar Salida",onClick:e=>(e=>{e.exitDate?O("warning","Este visitante ya tiene registrada su salida"):(j(e.visitorId),f(!0),g(!0))})(e),hidden:e=>null!==e.exitDate},{icon:Trash2,label:"Eliminar",onClick:e=>te(e)}],re=n.map(e=>void 0===e.condoId||null===e.condoId?null:{value:e.condoId.toString(),label:e.name||"Sin nombre"}).filter(Boolean);return jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6 p-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Registro de Visitas"}),jsxRuntimeExports.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Gestione el registro de entrada y salida de visitantes"})]}),jsxRuntimeExports.jsx(ButtonUI,{icon:Plus,title:"Nuevo Visitante",borderColor:"#629E3E",textColor:"#ffffff",className:"bg-primary hover:bg-primary/90",onClick:()=>X()})]}),jsxRuntimeExports.jsxs(Expandex,{title:"Filtros de búsqueda",initialExpanded:!0,expandIcon:Filter,backgroundColor:"#f9fafb",className:"mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[jsxRuntimeExports.jsx(SelectUI$1,{id:"companyId",label:"Empresa",value:R,onChange:L()?()=>{}:e=>__async(this,null,function*(){const t=(null==e?void 0:e.toString())||"-1";if(I(t),"-1"===t||!e)return i([]),l([]),d([]),_("-1"),ee("condoId",null),ee("buildingId",null),ee("departmentId",null),void C(e=>__spreadProps(__spreadValues({},e),{CompanyId:void 0,CondoId:void 0}));const a=Number(e);if(isNaN(a))return null==O||O("error","ID de empresa inválido"),void i([]);try{C(e=>__spreadProps(__spreadValues({},e),{CondoId:void 0})),ee("companyId",a),ee("condoId",null),ee("buildingId",null),ee("departmentId",null),yield W(a),C(e=>__spreadProps(__spreadValues({},e),{CompanyId:a}))}catch(r){null==O||O("error","Error al cargar los condominios. Por favor, intente nuevamente.")}}),options:[{value:"-1",label:"Todas las empresas"},...G],placeholder:"Seleccione una empresa",required:!0,disabled:L()}),jsxRuntimeExports.jsx(SelectUI$1,{id:"condoId",label:"Condominio",value:N.CondoId?N.CondoId.toString():"-1",onChange:L()?()=>{}:q,options:[{value:"-1",label:"Todos los condominios"},...re],placeholder:"Seleccione condominio",disabled:L()||"-1"===R||0===n.length}),jsxRuntimeExports.jsx(SelectUI$1,{id:"buildingId",label:"Edificio",value:S,onChange:Y,options:[{value:"-1",label:"Todos los edificios"},...o.map(e=>({value:e.buildingId.toString(),label:e.name||`Edificio ${e.buildingId}`}))],placeholder:"Seleccione edificio",disabled:!N.CondoId||0===o.length}),jsxRuntimeExports.jsx(InputUI,{id:"nameFilter",label:"Nombre",value:N.NameFilter||"",onChange:e=>K("NameFilter",e||void 0),placeholder:"Filtrar por nombre"}),jsxRuntimeExports.jsx(InputUI,{id:"documentNumber",label:"Documento",value:N.DocumentNumber||"",onChange:e=>K("DocumentNumber",e||void 0),placeholder:"Número de documento"}),jsxRuntimeExports.jsx(DatepickerUI,{id:"fromDate",label:"Desde",value:N.FromVisitDate||"",onChange:e=>K("FromVisitDate",e||void 0),placeholder:"Fecha inicial"}),jsxRuntimeExports.jsx(DatepickerUI,{id:"toDate",label:"Hasta",value:N.ToVisitDate||"",onChange:e=>K("ToVisitDate",e||void 0),placeholder:"Fecha final"})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end mt-4 space-x-2",children:[jsxRuntimeExports.jsx(ButtonUI,{title:"Limpiar",onClick:()=>{C({Page:1,PageSize:10,IsActive:!0}),I("-1"),i([]),setTimeout(()=>{B()},0)},borderColor:"#6B7280",textColor:"#6B7280",className:"hover:bg-gray-50"}),jsxRuntimeExports.jsx(ButtonUI,{title:"Aplicar Filtros",onClick:()=>{B()},borderColor:"#629E3E",textColor:"#ffffff",className:"bg-primary hover:bg-primary/90"})]})]}),p&&jsxRuntimeExports.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-6",children:p}),jsxRuntimeExports.jsx(DataGrid,{data:t,columns:J,actions:ae}),jsxRuntimeExports.jsx(ModalUI,{isOpen:h&&!E,onClose:Q,title:y?"Detalles de Visitante":u?"Editar Visitante":"Nuevo Visitante",footer:y?jsxRuntimeExports.jsx(ButtonUI,{icon:X$1,title:"Cerrar",onClick:Q,theme:"cancel"}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ButtonUI,{icon:X$1,title:"Cancelar",onClick:Q,theme:"modalCancel"}),jsxRuntimeExports.jsx(ButtonUI,{icon:Save,title:"Guardar",onClick:()=>__async(this,null,function*(){try{if(e(!0),!T.companyId)return O("error","Debe seleccionar una empresa"),void e(!1);if(!T.condoId)return O("error","Debe seleccionar un condominio"),void e(!1);if(!T.buildingId)return O("error","Debe seleccionar un edificio"),void e(!1);if(!T.departmentId)return O("error","Debe seleccionar un departamento"),void e(!1);if(!T.firstName&&!T.lastName&&!T.documentNumber)return O("error","Debe ingresar al menos un dato de identificación (nombre, apellido o documento)"),void e(!1);const a=new AbortController,r=setTimeout(()=>a.abort(),1e4);if(u){const e=__spreadProps(__spreadValues({visitorId:u.visitorId,condoId:T.condoId},T.buildingId&&{buildingId:T.buildingId}),{departmentId:T.departmentId,firstName:T.firstName||"",lastName:T.lastName||"",documentNumber:T.documentNumber||"",documentTypeId:T.documentTypeId,vehiclePlate:T.vehiclePlate||"",relationshipToResident:T.relationshipToResident||"",statusTypeId:T.statusTypeId||1,notes:T.notes||"",contactNumber:T.contactNumber||"",itemsRemoval:!0===T.itemsRemoval,itemsDescription:T.itemsDescription||"",authorizedByUserId:T.authorizedByUserId,routeId:u.visitorId,updatedBy:"current-user",updatedAt:(new Date).toISOString()});try{const t=yield Promise.race([A.update(u.visitorId,e),new Promise((e,t)=>setTimeout(()=>t(new Error("La operación ha expirado")),1e4))]);clearTimeout(r),t.isSuccess?(O("success","Visitante actualizado correctamente"),B(),Q()):O("error",t.error||"Error al actualizar el visitante")}catch(t){t instanceof Error?"AbortError"===t.name||"La operación ha expirado"===t.message?O("error","La operación tomó demasiado tiempo. Por favor, intente nuevamente."):O("error","Error al actualizar: "+(t.message||"Error desconocido")):O("error","Error desconocido al actualizar")}}else{const e=__spreadProps(__spreadValues({condoId:T.condoId},T.buildingId&&{buildingId:T.buildingId}),{departmentId:T.departmentId,firstName:T.firstName||"",lastName:T.lastName||"",documentNumber:T.documentNumber||"",documentTypeId:T.documentTypeId,vehiclePlate:T.vehiclePlate||"",relationshipToResident:T.relationshipToResident||"",statusTypeId:T.statusTypeId||1,notes:T.notes||"",contactNumber:T.contactNumber||"",itemsRemoval:!0===T.itemsRemoval,itemsDescription:T.itemsDescription||"",authorizedByUserId:T.authorizedByUserId,createdBy:"current-user",createdAt:(new Date).toISOString()});try{const t=yield Promise.race([A.create(e),new Promise((e,t)=>setTimeout(()=>t(new Error("La operación ha expirado")),1e4))]);clearTimeout(r),t.isSuccess?(O("success","Visitante registrado correctamente"),B(),Q()):O("error",t.error||"Error al registrar el visitante")}catch(t){t instanceof Error?"AbortError"===t.name||"La operación ha expirado"===t.message?O("error","La operación tomó demasiado tiempo. Por favor, intente nuevamente."):O("error","Error al registrar: "+(t.message||"Error desconocido")):O("error","Error desconocido al registrar")}}}catch(a){O("error","Ocurrió un error al procesar los datos")}finally{e(!1)}}),borderColor:"#629E3E",textColor:"#ffffff",className:"bg-primary hover:bg-primary/90"})]}),children:jsxRuntimeExports.jsxs("div",{className:"space-y-4 p-4",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(SelectUI$1,{id:"companyId",label:"Empresa",value:T.companyId?T.companyId.toString():"-1",onChange:L()||y?()=>{}:e=>{if("-1"===e)return ee("companyId",null),void i([]);const t=Number(e);ee("companyId",t),t>0?W(t):i([])},options:[{value:"-1",label:"Seleccione empresa"},...G],placeholder:"Seleccione empresa",required:!0,disabled:L()||y}),jsxRuntimeExports.jsx(SelectUI$1,{id:"condoId",label:"Condominio",value:T.condoId?T.condoId.toString():"-1",onChange:L()||y?()=>{}:e=>{if("-1"===e)return ee("condoId",null),l([]),void d([]);const t=Number(e);ee("condoId",t),t>0?z(t):(l([]),d([]))},options:[{value:"-1",label:"Seleccione condominio"},...n.map(e=>({value:e.condoId.toString(),label:e.name||`Condominio ${e.condoId}`}))],placeholder:"Seleccione condominio",required:!0,disabled:L()||y||!T.companyId})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(SelectUI$1,{id:"buildingId",label:"Edificio",value:T.buildingId?T.buildingId.toString():"-1",onChange:Y,options:[{value:"-1",label:"Seleccione edificio"},...o.map(e=>({value:e.buildingId.toString(),label:e.name||`Edificio ${e.buildingId}`}))],placeholder:"Seleccione edificio",required:!0,disabled:y||!T.condoId}),jsxRuntimeExports.jsx(SelectUI$1,{id:"departmentId",label:"Departamento",value:T.departmentId?T.departmentId.toString():"-1",onChange:e=>{ee("departmentId","-1"!==e?Number(e):null)},options:[{value:"-1",label:"Seleccione departamento"},...c.map(e=>({value:e.departmentId.toString(),label:e.departmentNumber||`Departamento ${e.departmentId}`}))],placeholder:"Seleccione departamento",required:!0,disabled:y||!T.buildingId})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(InputUI,{id:"firstName",label:"Nombre(s)",value:T.firstName||"",onChange:e=>ee("firstName",e),placeholder:"Nombre del visitante",disabled:y}),jsxRuntimeExports.jsx(InputUI,{id:"lastName",label:"Apellido(s)",value:T.lastName||"",onChange:e=>ee("lastName",e),placeholder:"Apellido del visitante",disabled:y})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(InputUI,{id:"documentNumber",label:"Documento",value:T.documentNumber||"",onChange:e=>ee("documentNumber",e),placeholder:"Número de documento",disabled:y}),jsxRuntimeExports.jsx(InputUI,{id:"contactNumber",label:"Teléfono",value:T.contactNumber||"",onChange:e=>ee("contactNumber",e),placeholder:"Número de contacto",disabled:y})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(InputUI,{id:"vehiclePlate",label:"Placa de Vehículo",value:T.vehiclePlate||"",onChange:e=>ee("vehiclePlate",e),placeholder:"Si ingresó con vehículo",disabled:y}),jsxRuntimeExports.jsx(InputUI,{id:"relationshipToResident",label:"Relación con Residente",value:T.relationshipToResident||"",onChange:e=>ee("relationshipToResident",e),placeholder:"Ej: Familiar, Amigo, Servicio",disabled:y})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(SelectUI$1,{id:"itemsRemoval",label:"¿Retira objetos?",value:!0===T.itemsRemoval?"1":"0",onChange:e=>ee("itemsRemoval","1"===e),options:[{value:"0",label:"No"},{value:"1",label:"Sí"}],disabled:y}),jsxRuntimeExports.jsx(InputUI,{id:"itemsDescription",label:"Descripción de objetos",value:T.itemsDescription||"",onChange:e=>ee("itemsDescription",e),placeholder:"Descripción de los objetos que retira",disabled:y||!T.itemsRemoval})]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:jsxRuntimeExports.jsx(InputUI,{id:"notes",label:"Notas Adicionales",value:T.notes||"",onChange:e=>ee("notes",e),placeholder:"Observaciones adicionales",disabled:y})})]})}),jsxRuntimeExports.jsx(ModalUI,{isOpen:h&&E,onClose:()=>{g(!1),f(!1),j(null)},title:"Registrar Salida",footer:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ButtonUI,{icon:X$1,title:"Cancelar",onClick:()=>{g(!1),f(!1),j(null)},theme:"modalCancel"}),jsxRuntimeExports.jsx(ButtonUI,{icon:LogOut,title:"Confirmar Salida",onClick:()=>__async(this,null,function*(){if(b)try{e(!0);const t={visitorId:b,notes:"Salida registrada por el sistema",updatedBy:"current-user",updatedAt:(new Date).toISOString()},a=yield A.registerExit(b,t);a.isSuccess?(O("success","Salida registrada correctamente"),B(),g(!1),f(!1),j(null)):O("error",a.error||"Error al registrar la salida")}catch(t){O("error","Ocurrió un error al registrar la salida")}finally{e(!1)}}),borderColor:"#629E3E",textColor:"#ffffff",className:"bg-primary hover:bg-primary/90"})]}),children:jsxRuntimeExports.jsxs("div",{className:"p-6 text-center",children:[jsxRuntimeExports.jsx(LogOut,{className:"mx-auto mb-4 text-gray-400 w-12 h-12"}),jsxRuntimeExports.jsx("h3",{className:"mb-5 text-lg font-normal text-gray-500",children:"¿Está seguro de registrar la salida de este visitante?"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Una vez registrada la salida, el visitante se marcará como inactivo."})]})})]})}var IncidentSeverityLevel=(e=>(e[e.Low=1]="Low",e[e.Medium=2]="Medium",e[e.High=3]="High",e[e.Critical=4]="Critical",e))(IncidentSeverityLevel||{}),IncidentStatusEnum$1=(e=>(e[e.Pending=1]="Pending",e[e.InProgress=2]="InProgress",e[e.Resolved=3]="Resolved",e[e.Closed=4]="Closed",e[e.Cancelled=5]="Cancelled",e))(IncidentStatusEnum$1||{});const mockIncidentTypes=[{id:1,name:"Avería de infraestructura",description:"Problemas con instalaciones físicas del condominio",isActive:!0,createdAt:"2023-01-15T10:30:00Z",createdBy:"admin"},{id:2,name:"Seguridad",description:"Incidentes relacionados con seguridad y vigilancia",isActive:!0,createdAt:"2023-01-15T10:35:00Z",createdBy:"admin"},{id:3,name:"Ruidos molestos",description:"Quejas por ruidos que alteran la convivencia",isActive:!0,createdAt:"2023-01-15T10:40:00Z",createdBy:"admin"},{id:4,name:"Problemas de limpieza",description:"Problemas en la limpieza de áreas comunes",isActive:!0,createdAt:"2023-01-15T10:45:00Z",createdBy:"admin"},{id:5,name:"Problemas de estacionamiento",description:"Incidencias en las áreas de estacionamiento",isActive:!0,createdAt:"2023-01-15T10:50:00Z",createdBy:"admin"},{id:6,name:"Mascotas",description:"Problemas relacionados con mascotas de residentes",isActive:!1,createdAt:"2023-01-15T10:55:00Z",createdBy:"admin",updatedAt:"2023-02-20T14:25:00Z",updatedBy:"admin"}],mockIncidentStatuses=[{id:IncidentStatusEnum$1.Pending,name:"Pendiente",description:"Incidente registrado pero sin asignar",isActive:!0,createdAt:"2023-01-10T09:00:00Z",createdBy:"admin"},{id:IncidentStatusEnum$1.InProgress,name:"En Proceso",description:"Incidente asignado y en atención",isActive:!0,createdAt:"2023-01-10T09:05:00Z",createdBy:"admin"},{id:IncidentStatusEnum$1.Resolved,name:"Resuelto",description:"Incidente solucionado",isActive:!0,createdAt:"2023-01-10T09:10:00Z",createdBy:"admin"},{id:IncidentStatusEnum$1.Closed,name:"Cerrado",description:"Incidente resuelto y verificado",isActive:!0,createdAt:"2023-01-10T09:15:00Z",createdBy:"admin"},{id:IncidentStatusEnum$1.Cancelled,name:"Cancelado",description:"Incidente cancelado por reportante o administración",isActive:!0,createdAt:"2023-01-10T09:20:00Z",createdBy:"admin"}],getStatusName=e=>{const t=mockIncidentStatuses.find(t=>t.id===e);return t?t.name:"Desconocido"},getTypeName=e=>{const t=mockIncidentTypes.find(t=>t.id===e);return t?t.name:"Desconocido"},mockIncidents=[{incidentId:1,condoId:1,condoName:"Condominio Las Palmas",description:"Filtración de agua en el techo del lobby principal",dateReported:"2023-06-10T08:30:00Z",incidentTypeId:1,incidentTypeName:getTypeName(1),statusTypeId:IncidentStatusEnum$1.Resolved,statusName:getStatusName(IncidentStatusEnum$1.Resolved),severityLevel:IncidentSeverityLevel.High,reportedByUserId:5,reportedByUserName:"María González",resolvedByUserId:2,resolvedByUserName:"Carlos Rodríguez",dateResolved:"2023-06-12T14:20:00Z",notes:"Se reparó la tubería y se pintó el área afectada",createdAt:"2023-06-10T08:30:00Z",createdBy:"mgonzalez",updatedAt:"2023-06-12T14:25:00Z",updatedBy:"admin",isDeleted:!1},{incidentId:2,condoId:1,condoName:"Condominio Las Palmas",description:"Ruidos excesivos en departamento 301 a altas horas de la noche",dateReported:"2023-06-15T10:45:00Z",incidentTypeId:3,incidentTypeName:getTypeName(3),statusTypeId:IncidentStatusEnum$1.Closed,statusName:getStatusName(IncidentStatusEnum$1.Closed),severityLevel:IncidentSeverityLevel.Medium,reportedByUserId:8,reportedByUserName:"Pedro Martínez",resolvedByUserId:2,resolvedByUserName:"Carlos Rodríguez",dateResolved:"2023-06-16T11:30:00Z",notes:"Se habló con el propietario y se aplicó una multa conforme al reglamento",createdAt:"2023-06-15T10:45:00Z",createdBy:"pmartinez",updatedAt:"2023-06-16T11:35:00Z",updatedBy:"admin",isDeleted:!1},{incidentId:3,condoId:2,condoName:"Condominio Vista Verde",description:"Vehículo estacionado en zona prohibida bloqueando acceso",dateReported:"2023-06-20T09:15:00Z",incidentTypeId:5,incidentTypeName:getTypeName(5),statusTypeId:IncidentStatusEnum$1.InProgress,statusName:getStatusName(IncidentStatusEnum$1.InProgress),severityLevel:IncidentSeverityLevel.Medium,reportedByUserId:10,reportedByUserName:"Ana Sánchez",createdAt:"2023-06-20T09:15:00Z",createdBy:"asanchez",isDeleted:!1},{incidentId:4,condoId:1,condoName:"Condominio Las Palmas",description:"Luz quemada en pasillo del tercer piso",dateReported:"2023-06-22T16:30:00Z",incidentTypeId:1,incidentTypeName:getTypeName(1),statusTypeId:IncidentStatusEnum$1.Pending,statusName:getStatusName(IncidentStatusEnum$1.Pending),severityLevel:IncidentSeverityLevel.Low,reportedByUserId:12,reportedByUserName:"Roberto Díaz",createdAt:"2023-06-22T16:30:00Z",createdBy:"rdiaz",isDeleted:!1},{incidentId:5,condoId:3,condoName:"Condominio Monte Alto",description:"Persona sospechosa rondando el estacionamiento",dateReported:"2023-06-25T20:45:00Z",incidentTypeId:2,incidentTypeName:getTypeName(2),statusTypeId:IncidentStatusEnum$1.Closed,statusName:getStatusName(IncidentStatusEnum$1.Closed),severityLevel:IncidentSeverityLevel.Critical,reportedByUserId:15,reportedByUserName:"Francisca López",resolvedByUserId:3,resolvedByUserName:"Juan Pérez",dateResolved:"2023-06-25T21:30:00Z",notes:"Se revisaron las cámaras y se aumentó la vigilancia. Era un visitante esperando a un residente.",createdAt:"2023-06-25T20:45:00Z",createdBy:"flopez",updatedAt:"2023-06-25T21:35:00Z",updatedBy:"admin",isDeleted:!1},{incidentId:6,condoId:2,condoName:"Condominio Vista Verde",description:"Fuga de agua en baño de área común de piscina",dateReported:"2023-06-28T11:20:00Z",incidentTypeId:1,incidentTypeName:getTypeName(1),statusTypeId:IncidentStatusEnum$1.InProgress,statusName:getStatusName(IncidentStatusEnum$1.InProgress),severityLevel:IncidentSeverityLevel.Medium,reportedByUserId:18,reportedByUserName:"Santiago Ramírez",createdAt:"2023-06-28T11:20:00Z",createdBy:"sramirez",updatedAt:"2023-06-28T14:15:00Z",updatedBy:"admin",isDeleted:!1},{incidentId:7,condoId:1,condoName:"Condominio Las Palmas",description:"Acumulación de basura en área de reciclaje",dateReported:"2023-07-01T08:50:00Z",incidentTypeId:4,incidentTypeName:getTypeName(4),statusTypeId:IncidentStatusEnum$1.Resolved,statusName:getStatusName(IncidentStatusEnum$1.Resolved),severityLevel:IncidentSeverityLevel.Medium,reportedByUserId:22,reportedByUserName:"Carmen Vidal",resolvedByUserId:2,resolvedByUserName:"Carlos Rodríguez",dateResolved:"2023-07-01T13:40:00Z",notes:"Se coordinó recogida extraordinaria con empresa de limpieza",createdAt:"2023-07-01T08:50:00Z",createdBy:"cvidal",updatedAt:"2023-07-01T13:45:00Z",updatedBy:"admin",isDeleted:!1},{incidentId:8,condoId:3,condoName:"Condominio Monte Alto",description:"Perro sin correa en áreas comunes",dateReported:"2023-07-05T16:10:00Z",incidentTypeId:6,incidentTypeName:getTypeName(6),statusTypeId:IncidentStatusEnum$1.Cancelled,statusName:getStatusName(IncidentStatusEnum$1.Cancelled),severityLevel:IncidentSeverityLevel.Low,reportedByUserId:7,reportedByUserName:"Javier Mendoza",resolvedByUserId:3,resolvedByUserName:"Juan Pérez",dateResolved:"2023-07-06T09:20:00Z",notes:"Se habló con el propietario. El incidente fue reportado 3 veces seguidas cuando en realidad fue un solo evento.",createdAt:"2023-07-05T16:10:00Z",createdBy:"jmendoza",updatedAt:"2023-07-06T09:25:00Z",updatedBy:"admin",isDeleted:!1}];IncidentStatusEnum$1.Pending,getStatusName(IncidentStatusEnum$1.Pending),IncidentStatusEnum$1.InProgress,getStatusName(IncidentStatusEnum$1.InProgress),IncidentStatusEnum$1.Resolved,getStatusName(IncidentStatusEnum$1.Resolved),IncidentStatusEnum$1.Pending,getStatusName(IncidentStatusEnum$1.Pending),IncidentStatusEnum$1.InProgress,getStatusName(IncidentStatusEnum$1.InProgress),IncidentStatusEnum$1.Resolved,getStatusName(IncidentStatusEnum$1.Resolved),IncidentStatusEnum$1.Closed,getStatusName(IncidentStatusEnum$1.Closed),IncidentStatusEnum$1.Pending,getStatusName(IncidentStatusEnum$1.Pending),IncidentStatusEnum$1.InProgress,getStatusName(IncidentStatusEnum$1.InProgress),IncidentStatusEnum$1.Pending,getStatusName(IncidentStatusEnum$1.Pending),IncidentStatusEnum$1.Pending,getStatusName(IncidentStatusEnum$1.Pending),IncidentStatusEnum$1.InProgress,getStatusName(IncidentStatusEnum$1.InProgress),IncidentStatusEnum$1.Resolved,getStatusName(IncidentStatusEnum$1.Resolved),IncidentStatusEnum$1.Closed,getStatusName(IncidentStatusEnum$1.Closed),IncidentStatusEnum$1.Pending,getStatusName(IncidentStatusEnum$1.Pending),IncidentStatusEnum$1.InProgress,getStatusName(IncidentStatusEnum$1.InProgress),IncidentStatusEnum$1.Pending,getStatusName(IncidentStatusEnum$1.Pending),IncidentStatusEnum$1.InProgress,getStatusName(IncidentStatusEnum$1.InProgress),IncidentStatusEnum$1.Resolved,getStatusName(IncidentStatusEnum$1.Resolved),IncidentStatusEnum$1.Pending,getStatusName(IncidentStatusEnum$1.Pending),IncidentStatusEnum$1.InProgress,getStatusName(IncidentStatusEnum$1.InProgress),IncidentStatusEnum$1.Cancelled,getStatusName(IncidentStatusEnum$1.Cancelled);const mockCondominiums$2=[{condoId:1,name:"Condominio Las Palmas"},{condoId:2,name:"Condominio Vista Verde"},{condoId:3,name:"Condominio Monte Alto"}],mockUsers=[{userId:2,name:"Carlos Rodríguez"},{userId:3,name:"Juan Pérez"},{userId:5,name:"María González"},{userId:7,name:"Javier Mendoza"},{userId:8,name:"Pedro Martínez"},{userId:10,name:"Ana Sánchez"},{userId:12,name:"Roberto Díaz"},{userId:15,name:"Francisca López"},{userId:18,name:"Santiago Ramírez"},{userId:22,name:"Carmen Vidal"}];function IncidentReports(){return jsxRuntimeExports.jsx(AlertProvider,{children:jsxRuntimeExports.jsx(IncidentReportsContent,{})})}function IncidentReportsContent(){var e,t,a,r,s,n,i,o,l,c;const{setLoading:d}=useLoading(),{showToast:u,showConfirm:m}=useAlerts(),{permissions:p,user:x}=useRoleBasedAccess(),[h,g]=reactExports.useState([]),[y,v]=reactExports.useState(),[E,f]=reactExports.useState(null),[b,j]=reactExports.useState([]),[R,I]=reactExports.useState([]),[S,_]=reactExports.useState("-1"),N=new ManagementCompanyService,C=new CondominiumService,[T,D]=reactExports.useState(!1),[A,P]=reactExports.useState(!1),[w,M]=reactExports.useState(!1),[k,O]=reactExports.useState(null),[$,U]=reactExports.useState({companyId:void 0,condoId:void 0,incidentTypeId:void 0,statusTypeId:void 0,severityLevel:void 0,fromDate:void 0,toDate:void 0,reportedByUserId:void 0}),[L,B]=reactExports.useState({condoId:void 0,description:"",incidentTypeId:void 0,statusTypeId:IncidentStatusEnum$1.Pending,severityLevel:IncidentSeverityLevel.Medium,reportedByUserId:void 0,notes:""});reactExports.useEffect(()=>{(()=>{__async(this,null,function*(){try{d(!0);const e=yield N.getPaged();if(e.isSuccess&&e.data){let t=[];e.data.items&&Array.isArray(e.data.items)?t=e.data.items:Array.isArray(e.data)&&(t=e.data),j(t),yield F()}yield H()}catch(e){f("Error al cargar los datos iniciales")}finally{d(!1)}})})()},[]);const F=()=>__async(this,null,function*(){try{(new AuthService).getUser();yield preloadCompanyCondoFilters(e=>{_(e)},J,z,"IncidentReports")}catch(e){}}),V=()=>shouldDisableCompanyCondoSelects(),W=()=>__async(this,null,function*(){try{const e=e=>{B(t=>{const a=e(t);return __spreadValues(__spreadValues({},t),a)})};yield preloadCompanyCondoSelects(e,e=>__async(this,null,function*(){yield z(e)}),"IncidentReports-Modal")}catch(e){}}),z=e=>__async(this,null,function*(){try{d(!0);const t={CompanyId:e,Page:1,PageSize:100},a=yield C.getPaged(t);if(a.isSuccess&&a.data){let e=[];if(Array.isArray(a.data))e=a.data;else if(a.data.items&&Array.isArray(a.data.items))e=a.data.items;else if(a.data.data&&Array.isArray(a.data.data))e=a.data.data;else{const t=a.data;if(t&&"object"==typeof t)for(const a in t)if(Array.isArray(t[a])){e=t[a];break}}I(e),0===e.length?f("No se encontraron condominios para esta empresa"):f(null)}else I([]),f(a.error||"Error al cargar los condominios")}catch(t){I([]),f("Error inesperado al cargar los condominios")}finally{d(!1)}}),H=()=>__async(this,null,function*(){try{d(!0),f(null),setTimeout(()=>{let e=[...mockIncidents];if(void 0!==$.condoId&&(e=e.filter(e=>e.condoId===$.condoId)),void 0!==$.incidentTypeId&&(e=e.filter(e=>e.incidentTypeId===$.incidentTypeId)),void 0!==$.statusTypeId&&(e=e.filter(e=>e.statusTypeId===$.statusTypeId)),void 0!==$.severityLevel&&(e=e.filter(e=>e.severityLevel===$.severityLevel)),void 0!==$.reportedByUserId&&(e=e.filter(e=>e.reportedByUserId===$.reportedByUserId)),$.fromDate){const t=new Date($.fromDate);e=e.filter(e=>new Date(e.dateReported)>=t)}if($.toDate){const t=new Date($.toDate);e=e.filter(e=>new Date(e.dateReported)<=t)}g(e),d(!1)},500)}catch(e){f("Error al cargar los incidentes"),d(!1)}}),G=(e,t)=>{U(a=>__spreadProps(__spreadValues({},a),{[e]:""===t||"-1"===t?void 0:t}))},q=[{accessorKey:"incidentId",header:"ID",cell:({row:e})=>jsxRuntimeExports.jsxs("span",{className:"font-semibold",children:["#",e.original.incidentId]})},{accessorKey:"description",header:"Descripción",cell:({row:e})=>jsxRuntimeExports.jsx("div",{className:"max-w-xs truncate",title:e.original.description,children:e.original.description})},{accessorKey:"condoName",header:"Condominio",cell:({row:e})=>jsxRuntimeExports.jsx("span",{className:"font-medium",children:e.original.condoName})},{accessorKey:"incidentTypeName",header:"Tipo",cell:({row:e})=>jsxRuntimeExports.jsx("span",{className:"font-medium",children:e.original.incidentTypeName})},{accessorKey:"dateReported",header:"Fecha Reportado",cell:({getValue:e})=>{const t=e();return jsxRuntimeExports.jsx("span",{className:"font-medium",children:format(new Date(t),"dd/MM/yyyy HH:mm",{locale:es})})}},{accessorKey:"statusName",header:"Estado",cell:({row:e})=>{let t="bg-gray-100 text-gray-800";switch(e.original.statusTypeId){case IncidentStatusEnum$1.Pending:t="bg-yellow-100 text-yellow-800";break;case IncidentStatusEnum$1.InProgress:t="bg-blue-100 text-blue-800";break;case IncidentStatusEnum$1.Resolved:t="bg-green-100 text-green-800";break;case IncidentStatusEnum$1.Closed:t="bg-purple-100 text-purple-800";break;case IncidentStatusEnum$1.Cancelled:t="bg-red-100 text-red-800"}return jsxRuntimeExports.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t}`,children:e.original.statusName})}},{accessorKey:"severityLevel",header:"Severidad",cell:({row:e})=>{let t="Desconocida",a="bg-gray-100 text-gray-800";switch(e.original.severityLevel){case IncidentSeverityLevel.Low:t="Baja",a="bg-green-100 text-green-800";break;case IncidentSeverityLevel.Medium:t="Media",a="bg-yellow-100 text-yellow-800";break;case IncidentSeverityLevel.High:t="Alta",a="bg-orange-100 text-orange-800";break;case IncidentSeverityLevel.Critical:t="Crítica",a="bg-red-100 text-red-800"}return jsxRuntimeExports.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${a}`,children:t})}},{accessorKey:"reportedByUserName",header:"Reportado por",cell:({row:e})=>jsxRuntimeExports.jsx("span",{className:"font-medium",children:e.original.reportedByUserName})}],Y=e=>__async(this,null,function*(){v(void 0),B({condoId:void 0,description:"",incidentTypeId:void 0,statusTypeId:IncidentStatusEnum$1.Pending,severityLevel:IncidentSeverityLevel.Medium,reportedByUserId:void 0,notes:"",dateReported:(new Date).toISOString()}),yield W(),P(!1),D(!0)}),K=()=>{D(!1),v(void 0),P(!1),M(!1),O(null)},J=(e,t)=>__async(this,null,function*(){B(a=>__spreadProps(__spreadValues({},a),{[e]:""===t||"-1"===t?void 0:t})),"companyId"===e&&"number"==typeof t&&-1!==t&&(_(t.toString()),U(e=>__spreadProps(__spreadValues({},e),{companyId:t}))),"condoId"===e&&"number"==typeof t&&-1!==t&&U(e=>__spreadProps(__spreadValues({},e),{condoId:t}))}),X=e=>{m("Eliminar Incidente",`¿Está seguro que desea eliminar el incidente #${e.incidentId}?`,()=>{m("Confirmar Eliminación","Esta acción no se puede deshacer. ¿Está completamente seguro?",()=>__async(this,null,function*(){try{d(!0),setTimeout(()=>{const t=h.filter(t=>t.incidentId!==e.incidentId);g(t),u("success","Incidente eliminado correctamente"),d(!1)},500)}catch(t){u("error","Ocurrió un error al eliminar el incidente"),d(!1)}}))})},Z=[{icon:Eye,label:"Ver Detalles",onClick:e=>(e=>{v(e),B({incidentId:e.incidentId,condoId:e.condoId,description:e.description||"",incidentTypeId:e.incidentTypeId,statusTypeId:e.statusTypeId,severityLevel:e.severityLevel,reportedByUserId:e.reportedByUserId,notes:e.notes||"",dateReported:e.dateReported,resolvedByUserId:e.resolvedByUserId,dateResolved:e.dateResolved}),P(!0),D(!0)})(e),hidden:()=>!p.canViewIncidentsReports()},{icon:Check,label:"Resolver",onClick:e=>(e=>{e.statusTypeId!==IncidentStatusEnum$1.Resolved&&e.statusTypeId!==IncidentStatusEnum$1.Closed&&e.statusTypeId!==IncidentStatusEnum$1.Cancelled?(O(e.incidentId),v(e),M(!0),D(!0)):u("warning","Este incidente ya ha sido resuelto o cancelado")})(e),hidden:e=>!p.canEditIncidentsReports()||e.statusTypeId===IncidentStatusEnum$1.Resolved||e.statusTypeId===IncidentStatusEnum$1.Closed||e.statusTypeId===IncidentStatusEnum$1.Cancelled},{icon:Trash2,label:"Eliminar",onClick:e=>X(e),hidden:()=>!p.canDeleteIncidents()}];return jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6 p-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Reportes de Incidentes"}),jsxRuntimeExports.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Gestione los incidentes reportados en los condominios"}),x&&jsxRuntimeExports.jsxs("p",{className:"mt-1 text-xs text-blue-600",children:["Usuario: ",x.firstName," ",x.lastName," | Rol: ",x.role]})]}),jsxRuntimeExports.jsx(ConditionalRender,{resource:SubResource.INCIDENTS_REPORTS,action:Action.CREATE,fallback:null,children:jsxRuntimeExports.jsx(ButtonUI,{icon:Plus,title:"Nuevo Incidente",borderColor:"var(--color-primary-admin)",textColor:"#ffffff",className:"bg-primary hover:bg-primary/90",onClick:()=>Y()})}),jsxRuntimeExports.jsx(ConditionalRender,{resource:SubResource.INCIDENTS_REPORTS,action:Action.EXPORT,fallback:null,children:jsxRuntimeExports.jsx(ButtonUI,{icon:Download,title:"Exportar",borderColor:"#0369a1",textColor:"#ffffff",className:"bg-blue-600 hover:bg-blue-700 ml-2",onClick:()=>u("info","Función de exportar en desarrollo")})})]}),jsxRuntimeExports.jsxs(Expandex,{title:"Filtros de búsqueda",initialExpanded:!0,expandIcon:Filter,borderColor:"#629E3E",backgroundColor:"#f9fafb",className:"mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[jsxRuntimeExports.jsx(SelectUI$1,{id:"companyId",label:"Empresa",value:S,onChange:V()?()=>{}:e=>__async(this,null,function*(){const t=(null==e?void 0:e.toString())||"-1";if(_(t),"-1"===t||!e)return I([]),void U(e=>__spreadProps(__spreadValues({},e),{companyId:void 0,condoId:void 0}));const a=Number(e);if(isNaN(a))I([]);else try{U(e=>__spreadProps(__spreadValues({},e),{condoId:void 0})),yield z(a),U(e=>__spreadProps(__spreadValues({},e),{companyId:a}))}catch(r){null==u||u("error","Error al cargar los condominios")}}),options:[{value:"-1",label:"Todas las empresas"},...b.map(e=>{const t=e.companyId||e.managementCompanyId;return{value:(null==t?void 0:t.toString())||"",label:e.name||"Sin nombre"}}).filter(e=>""!==e.value)],placeholder:"Seleccione una empresa",disabled:V()}),jsxRuntimeExports.jsx(SelectUI$1,{id:"condoId",label:"Condominio",value:(null==(e=$.condoId)?void 0:e.toString())||"-1",onChange:V()?()=>{}:e=>G("condoId",Number(e)),options:[{value:"-1",label:"Todos los condominios"},...R.map(e=>({value:e.condoId.toString(),label:e.name}))],placeholder:"Seleccione condominio",disabled:V()||"-1"===S||0===R.length}),jsxRuntimeExports.jsx(SelectUI$1,{id:"incidentTypeId",label:"Tipo de Incidente",value:(null==(t=$.incidentTypeId)?void 0:t.toString())||"-1",onChange:e=>G("incidentTypeId",Number(e)),options:[{value:"-1",label:"Todos los tipos"},...mockIncidentTypes.map(e=>({value:e.id.toString(),label:e.name}))],placeholder:"Seleccione tipo"}),jsxRuntimeExports.jsx(SelectUI$1,{id:"statusTypeId",label:"Estado",value:(null==(a=$.statusTypeId)?void 0:a.toString())||"-1",onChange:e=>G("statusTypeId",Number(e)),options:[{value:"-1",label:"Todos los estados"},...mockIncidentStatuses.map(e=>({value:e.id.toString(),label:e.name}))],placeholder:"Seleccione estado"}),jsxRuntimeExports.jsx(SelectUI$1,{id:"severityLevel",label:"Severidad",value:(null==(r=$.severityLevel)?void 0:r.toString())||"-1",onChange:e=>G("severityLevel",Number(e)),options:[{value:"-1",label:"Todas las severidades"},{value:IncidentSeverityLevel.Low.toString(),label:"Baja"},{value:IncidentSeverityLevel.Medium.toString(),label:"Media"},{value:IncidentSeverityLevel.High.toString(),label:"Alta"},{value:IncidentSeverityLevel.Critical.toString(),label:"Crítica"}],placeholder:"Seleccione severidad"}),jsxRuntimeExports.jsx(SelectUI$1,{id:"reportedByUserId",label:"Reportado por",value:(null==(s=$.reportedByUserId)?void 0:s.toString())||"-1",onChange:e=>G("reportedByUserId",Number(e)),options:[{value:"-1",label:"Todos los usuarios"},...mockUsers.map(e=>({value:e.userId.toString(),label:e.name}))],placeholder:"Seleccione usuario"}),jsxRuntimeExports.jsx(DatepickerUI,{id:"fromDate",label:"Desde",value:$.fromDate||"",onChange:e=>G("fromDate",e),placeholder:"Fecha inicial"}),jsxRuntimeExports.jsx(DatepickerUI,{id:"toDate",label:"Hasta",value:$.toDate||"",onChange:e=>G("toDate",e),placeholder:"Fecha final"})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end mt-4 space-x-2",children:[jsxRuntimeExports.jsx(ButtonUI,{title:"Limpiar",onClick:()=>{U({companyId:void 0,condoId:void 0,incidentTypeId:void 0,statusTypeId:void 0,severityLevel:void 0,fromDate:void 0,toDate:void 0,reportedByUserId:void 0}),_("-1"),I([]),setTimeout(()=>{H()},0)},borderColor:"var(--color-action-cancel)",textColor:"var(--color-action-cancel)",className:"hover:bg-gray-50"}),jsxRuntimeExports.jsx(ButtonUI,{title:"Aplicar Filtros",onClick:()=>{H()},borderColor:"var(--color-primary-admin)",textColor:"#ffffff",className:"bg-primary hover:bg-primary/90"})]})]}),E&&jsxRuntimeExports.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-6",children:E}),jsxRuntimeExports.jsx(DataGrid,{data:h,columns:q,actions:Z}),jsxRuntimeExports.jsx(ModalUI,{isOpen:T&&!w,onClose:K,title:A?"Detalles de Incidente":y?"Editar Incidente":"Nuevo Incidente",footer:A?jsxRuntimeExports.jsx(ButtonUI,{icon:X$1,title:"Cerrar",onClick:K,theme:"cancel"}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ButtonUI,{icon:X$1,title:"Cancelar",onClick:K,borderColor:"var(--color-action-delete)",textColor:"var(--color-action-delete)",className:"hover:bg-red-50"}),jsxRuntimeExports.jsx(ButtonUI,{icon:Save,title:"Guardar",onClick:()=>__async(this,null,function*(){try{if(d(!0),!L.condoId)return u("error","Debe seleccionar un condominio"),void d(!1);if(!L.incidentTypeId)return u("error","Debe seleccionar un tipo de incidente"),void d(!1);if(!L.reportedByUserId)return u("error","Debe seleccionar un usuario que reporta"),void d(!1);if(!L.description)return u("error","Debe ingresar una descripción"),void d(!1);setTimeout(()=>{var e,t,a,r;if(y){const e=h.map(e=>{var t,a,r,s;return e.incidentId===y.incidentId?__spreadProps(__spreadValues({},e),{condoId:L.condoId,condoName:(null==(t=mockCondominiums$2.find(e=>e.condoId===L.condoId))?void 0:t.name)||e.condoName,description:L.description,incidentTypeId:L.incidentTypeId,incidentTypeName:(null==(a=mockIncidentTypes.find(e=>e.id===L.incidentTypeId))?void 0:a.name)||e.incidentTypeName,statusTypeId:L.statusTypeId,statusName:(null==(r=mockIncidentStatuses.find(e=>e.id===L.statusTypeId))?void 0:r.name)||e.statusName,severityLevel:L.severityLevel,reportedByUserId:L.reportedByUserId,reportedByUserName:(null==(s=mockUsers.find(e=>e.userId===L.reportedByUserId))?void 0:s.name)||e.reportedByUserName,notes:L.notes,updatedAt:(new Date).toISOString(),updatedBy:"current-user"}):e});g(e),u("success","Incidente actualizado correctamente")}else{const s={incidentId:Math.max(...h.map(e=>e.incidentId))+1,condoId:L.condoId,condoName:(null==(e=mockCondominiums$2.find(e=>e.condoId===L.condoId))?void 0:e.name)||"Condominio",description:L.description||"",dateReported:L.dateReported||(new Date).toISOString(),incidentTypeId:L.incidentTypeId,incidentTypeName:(null==(t=mockIncidentTypes.find(e=>e.id===L.incidentTypeId))?void 0:t.name)||"Tipo",statusTypeId:L.statusTypeId,statusName:(null==(a=mockIncidentStatuses.find(e=>e.id===L.statusTypeId))?void 0:a.name)||"Estado",severityLevel:L.severityLevel,reportedByUserId:L.reportedByUserId,reportedByUserName:(null==(r=mockUsers.find(e=>e.userId===L.reportedByUserId))?void 0:r.name)||"Usuario",notes:L.notes||"",createdAt:(new Date).toISOString(),createdBy:"current-user",isDeleted:!1};g([...h,s]),u("success","Incidente creado correctamente")}K(),d(!1)},500)}catch(e){u("error","Ocurrió un error al procesar el incidente"),d(!1)}}),theme:"modalSave"})]}),children:jsxRuntimeExports.jsxs("div",{className:"space-y-4 p-4",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(SelectUI$1,{id:"companyId",label:"Empresa",value:(null==(n=L.companyId)?void 0:n.toString())||"-1",onChange:V()||A?()=>{}:e=>{if("-1"===e)return J("companyId",null),void I([]);const t=Number(e);J("companyId",t),t>0?z(t):I([])},options:[{value:"-1",label:"Seleccione empresa"},...b.map(e=>{const t=e.companyId||e.managementCompanyId;return{value:(null==t?void 0:t.toString())||"",label:e.name||"Sin nombre"}}).filter(e=>""!==e.value)],placeholder:"Seleccione empresa",required:!0,disabled:V()||A}),jsxRuntimeExports.jsx(SelectUI$1,{id:"condoId",label:"Condominio",value:(null==(i=L.condoId)?void 0:i.toString())||"-1",onChange:V()||A?()=>{}:e=>J("condoId",Number(e)),options:[{value:"-1",label:"Seleccione condominio"},...R.map(e=>({value:e.condoId.toString(),label:e.name}))],placeholder:"Seleccione condominio",required:!0,disabled:V()||A||!L.companyId}),jsxRuntimeExports.jsx(SelectUI$1,{id:"incidentTypeId",label:"Tipo de Incidente",value:(null==(o=L.incidentTypeId)?void 0:o.toString())||"-1",onChange:e=>J("incidentTypeId",Number(e)),options:[{value:"-1",label:"Seleccione tipo"},...mockIncidentTypes.filter(e=>e.isActive).map(e=>({value:e.id.toString(),label:e.name}))],placeholder:"Seleccione tipo",required:!0,disabled:A})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx(SelectUI$1,{id:"severityLevel",label:"Severidad",value:(null==(l=L.severityLevel)?void 0:l.toString())||"2",onChange:e=>J("severityLevel",Number(e)),options:[{value:IncidentSeverityLevel.Low.toString(),label:"Baja"},{value:IncidentSeverityLevel.Medium.toString(),label:"Media"},{value:IncidentSeverityLevel.High.toString(),label:"Alta"},{value:IncidentSeverityLevel.Critical.toString(),label:"Crítica"}],placeholder:"Seleccione severidad",required:!0,disabled:A}),jsxRuntimeExports.jsx(SelectUI$1,{id:"reportedByUserId",label:"Reportado por",value:(null==(c=L.reportedByUserId)?void 0:c.toString())||"-1",onChange:e=>J("reportedByUserId",Number(e)),options:[{value:"-1",label:"Seleccione usuario"},...mockUsers.map(e=>({value:e.userId.toString(),label:e.name}))],placeholder:"Seleccione usuario",required:!0,disabled:A})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[jsxRuntimeExports.jsx(TextAreaUI,{id:"description",label:"Descripción",value:L.description||"",onChange:e=>J("description",e),placeholder:"Describa el incidente",required:!0,rows:3}),jsxRuntimeExports.jsx(TextAreaUI,{id:"notes",label:"Notas Adicionales",value:L.notes||"",onChange:e=>J("notes",e),placeholder:"Observaciones adicionales",rows:3})]}),A&&L.dateResolved&&jsxRuntimeExports.jsxs("div",{className:"mt-4 p-4 bg-green-50 rounded-lg border border-green-200",children:[jsxRuntimeExports.jsx("h4",{className:"font-medium text-green-800",children:"Incidente Resuelto"}),jsxRuntimeExports.jsxs("div",{className:"mt-2 space-y-2 text-sm",children:[jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"Resuelto por:"})," ",null==y?void 0:y.resolvedByUserName]}),jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"Fecha de resolución:"})," ",format(new Date(L.dateResolved),"dd/MM/yyyy HH:mm",{locale:es})]})]})]})]})}),jsxRuntimeExports.jsx(ModalUI,{isOpen:T&&w,onClose:K,title:"Resolver Incidente",footer:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ButtonUI,{icon:X$1,title:"Cancelar",onClick:K,theme:"cancel"}),jsxRuntimeExports.jsx(ButtonUI,{icon:Check,title:"Confirmar Resolución",onClick:()=>__async(this,null,function*(){if(k&&y)try{d(!0),setTimeout(()=>{const e=h.map(e=>{var t;return e.incidentId===k?__spreadProps(__spreadValues({},e),{statusTypeId:IncidentStatusEnum$1.Resolved,statusName:(null==(t=mockIncidentStatuses.find(e=>e.id===IncidentStatusEnum$1.Resolved))?void 0:t.name)||"Resuelto",resolvedByUserId:2,resolvedByUserName:"Carlos Rodríguez",dateResolved:(new Date).toISOString(),updatedAt:(new Date).toISOString(),updatedBy:"current-user"}):e});g(e),u("success","Incidente resuelto correctamente"),K(),d(!1)},500)}catch(e){u("error","Ocurrió un error al resolver el incidente"),d(!1)}}),borderColor:"#629E3E",textColor:"#ffffff",className:"bg-primary hover:bg-primary/90"})]}),children:jsxRuntimeExports.jsxs("div",{className:"p-6 text-center",children:[jsxRuntimeExports.jsx("div",{className:"mx-auto mb-4 w-12 h-12 flex items-center justify-center rounded-full bg-green-100",children:jsxRuntimeExports.jsx(Check,{className:"text-green-600 w-6 h-6"})}),jsxRuntimeExports.jsx("h3",{className:"mb-5 text-lg font-normal text-gray-500",children:"¿Está seguro de marcar este incidente como resuelto?"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Esta acción actualizará el estado del incidente y registrará la fecha de resolución."})]})})]})}var IncidentStatusEnum=(e=>(e[e.Reportado=1]="Reportado",e[e.EnProceso=2]="EnProceso",e[e.Asignado=3]="Asignado",e[e.EnRevision=4]="EnRevision",e[e.Resuelto=5]="Resuelto",e[e.Cerrado=6]="Cerrado",e[e.Cancelado=7]="Cancelado",e))(IncidentStatusEnum||{});const mockIncidentLogs=[{id:1,incidentId:1,statusId:IncidentStatusEnum.Reportado,statusName:"Reportado",description:"Incidente reportado inicialmente",createdAt:new Date(2023,6,10,9,15).toISOString(),createdBy:"Juan Pérez",userId:1,userName:"Juan Pérez"},{id:2,incidentId:1,statusId:IncidentStatusEnum.EnProceso,statusName:"En Proceso",description:"Se inicia atención del incidente",createdAt:new Date(2023,6,10,10,30).toISOString(),createdBy:"Ana Gómez",userId:2,userName:"Ana Gómez"},{id:3,incidentId:1,statusId:IncidentStatusEnum.Resuelto,statusName:"Resuelto",description:"Se completó la reparación",createdAt:new Date(2023,6,11,15,45).toISOString(),createdBy:"Carlos López",userId:3,userName:"Carlos López"},{id:4,incidentId:2,statusId:IncidentStatusEnum.Reportado,statusName:"Reportado",description:"Reporte inicial del problema",createdAt:new Date(2023,6,15,8,20).toISOString(),createdBy:"María Rodríguez",userId:4,userName:"María Rodríguez"},{id:5,incidentId:2,statusId:IncidentStatusEnum.Asignado,statusName:"Asignado",description:"Asignado a equipo de mantenimiento",createdAt:new Date(2023,6,15,9,45).toISOString(),createdBy:"Roberto Sánchez",userId:5,userName:"Roberto Sánchez"},{id:6,incidentId:3,statusId:IncidentStatusEnum.Reportado,statusName:"Reportado",description:"Reporte de fuga en baño comunitario",createdAt:new Date(2023,6,18,12,10).toISOString(),createdBy:"Laura Martínez",userId:6,userName:"Laura Martínez"},{id:7,incidentId:3,statusId:IncidentStatusEnum.EnProceso,statusName:"En Proceso",description:"Plomero enviado al lugar",createdAt:new Date(2023,6,18,14,30).toISOString(),createdBy:"Pedro Díaz",userId:7,userName:"Pedro Díaz"},{id:8,incidentId:3,statusId:IncidentStatusEnum.Resuelto,statusName:"Resuelto",description:"Fuga reparada, se cambió la llave de paso",createdAt:new Date(2023,6,18,17,15).toISOString(),createdBy:"Pedro Díaz",userId:7,userName:"Pedro Díaz"},{id:9,incidentId:4,statusId:IncidentStatusEnum.Reportado,statusName:"Reportado",description:"Problema con puerta de acceso principal",createdAt:new Date(2023,6,20,7,50).toISOString(),createdBy:"Carmen Flores",userId:8,userName:"Carmen Flores"},{id:10,incidentId:4,statusId:IncidentStatusEnum.Cancelado,statusName:"Cancelado",description:"Cancelado por resolución del problema por parte del residente",createdAt:new Date(2023,6,20,8,30).toISOString(),createdBy:"Carmen Flores",userId:8,userName:"Carmen Flores"},{id:11,incidentId:5,statusId:IncidentStatusEnum.Reportado,statusName:"Reportado",description:"Fallo en sistema de iluminación del estacionamiento",createdAt:new Date(2023,6,25,19,20).toISOString(),createdBy:"Jorge Vargas",userId:9,userName:"Jorge Vargas"},{id:12,incidentId:5,statusId:IncidentStatusEnum.EnProceso,statusName:"En Proceso",description:"Revisión programada del sistema eléctrico",createdAt:new Date(2023,6,26,10,15).toISOString(),createdBy:"Felipe Torres",userId:10,userName:"Felipe Torres"},{id:23,incidentId:8,statusId:IncidentStatusEnum.Reportado,statusName:"Reportado",description:"Incidente inicial: Vecino reporta perro sin correa en áreas de jardín común.",createdAt:new Date(2023,6,5,16,10).toISOString(),createdBy:"Sistema",userId:7,userName:"Javier Mendoza"},{id:24,incidentId:8,statusId:IncidentStatusEnum.EnProceso,statusName:"En Proceso",description:"Se inicia investigación. Se verifica con el personal de seguridad.",createdAt:new Date(2023,6,5,16,45).toISOString(),createdBy:"Sistema",userId:3,userName:"Juan Pérez"},{id:25,incidentId:8,statusId:IncidentStatusEnum.EnProceso,statusName:"En Proceso",description:"Según cámaras, se identifica al propietario del perro como residente del Apto. 502.",createdAt:new Date(2023,6,5,17,30).toISOString(),createdBy:"Sistema",userId:3,userName:"Juan Pérez"},{id:26,incidentId:8,statusId:IncidentStatusEnum.Asignado,statusName:"Asignado",description:"Caso asignado a administración para contactar al propietario.",createdAt:new Date(2023,6,5,18,0).toISOString(),createdBy:"Sistema",userId:3,userName:"Juan Pérez"},{id:27,incidentId:8,statusId:IncidentStatusEnum.EnRevision,statusName:"En Revisión",description:"Se habló con propietario. Indica que el perro escapó accidentalmente y ya tomó medidas.",createdAt:new Date(2023,6,6,8,45).toISOString(),createdBy:"Sistema",userId:3,userName:"Juan Pérez"},{id:28,incidentId:8,statusId:IncidentStatusEnum.Cancelado,statusName:"Cancelado",description:"Se determina que es la primera vez que ocurre el incidente. Se emite advertencia y se da por cerrado sin sanción.",createdAt:new Date(2023,6,6,9,20).toISOString(),createdBy:"Sistema",userId:3,userName:"Juan Pérez"}],getLogsByIncidentId=e=>mockIncidentLogs.filter(t=>t.incidentId===e);function IncidentLog(){return jsxRuntimeExports.jsx(AlertProvider,{children:jsxRuntimeExports.jsx(IncidentLogContent,{})})}function IncidentLogContent(){var e,t,a,r,s;const{setLoading:n}=useLoading(),{showToast:i}=useAlerts(),[o,l]=reactExports.useState([]),[c,d]=reactExports.useState(0),[u,m]=reactExports.useState(1),[p,x]=reactExports.useState(10),[h,g]=reactExports.useState([]),[y,v]=reactExports.useState([]),[E,f]=reactExports.useState("-1"),b=new ManagementCompanyService,j=new CondominiumService,[R,I]=reactExports.useState(null),[S,_]=reactExports.useState([]),[N,C]=reactExports.useState(null),[T,D]=reactExports.useState(!1),[A,P]=reactExports.useState(!1),[w,M]=reactExports.useState(!1),[k,O]=reactExports.useState({statusId:void 0,description:""}),[$,U]=reactExports.useState(null),[L,B]=reactExports.useState({companyId:void 0,incidentId:void 0,condoId:void 0,statusId:void 0,reportedByUserId:void 0,fromDate:void 0,toDate:void 0,isResolved:void 0});reactExports.useEffect(()=>{(()=>{__async(this,null,function*(){try{n(!0);const e=yield b.getPaged();if(e.isSuccess&&e.data){let t=[];e.data.items&&Array.isArray(e.data.items)?t=e.data.items:Array.isArray(e.data)&&(t=e.data),g(t),yield F()}yield z()}catch(e){U("Error al cargar los datos iniciales")}finally{n(!1)}})})()},[u,p]);const F=()=>__async(this,null,function*(){try{(new AuthService).getUser();yield preloadCompanyCondoFilters(e=>{f(e)},Y,W,"IncidentLog")}catch(e){}}),V=()=>shouldDisableCompanyCondoSelects(),W=e=>__async(this,null,function*(){try{n(!0);const t={CompanyId:e,Page:1,PageSize:100},a=yield j.getPaged(t);if(a.isSuccess&&a.data){let e=[];if(Array.isArray(a.data))e=a.data;else if(a.data.items&&Array.isArray(a.data.items))e=a.data.items;else{const t=a.data;if(t&&"object"==typeof t)for(const a in t)if(Array.isArray(t[a])){e=t[a];break}}v(e),0===e.length?U("No se encontraron condominios para esta empresa"):U(null)}else v([]),U(a.error||"Error al cargar los condominios")}catch(t){v([]),U("Error inesperado al cargar los condominios")}finally{n(!1)}}),z=()=>__async(this,null,function*(){try{n(!0),U(null),setTimeout(()=>{let e=[...mockIncidents];void 0!==L.incidentId&&(e=e.filter(e=>e.incidentId===L.incidentId)),void 0!==L.condoId&&(e=e.filter(e=>e.condoId===L.condoId)),void 0!==L.statusId&&(e=e.filter(e=>e.statusTypeId===L.statusId)),void 0!==L.reportedByUserId&&(e=e.filter(e=>e.reportedByUserId===L.reportedByUserId)),void 0!==L.isResolved&&(e=L.isResolved?e.filter(e=>e.statusTypeId===IncidentStatusEnum.Resuelto||e.statusTypeId===IncidentStatusEnum.Cerrado):e.filter(e=>e.statusTypeId!==IncidentStatusEnum.Resuelto&&e.statusTypeId!==IncidentStatusEnum.Cerrado)),L.fromDate&&(e=e.filter(e=>new Date(e.dateReported)>=L.fromDate)),L.toDate&&(e=e.filter(e=>new Date(e.dateReported)<=L.toDate)),e.sort((e,t)=>new Date(t.dateReported).getTime()-new Date(e.dateReported).getTime());const t=e.length,a=(u-1)*p,r=Math.min(a+p,t),s=e.slice(a,r);l(s),d(t),n(!1)},500)}catch(e){U("Error al cargar los incidentes"),n(!1)}}),H=e=>{try{n(!0),setTimeout(()=>{const t=getLogsByIncidentId(e);t.sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()),_(t),n(!1)},300)}catch(t){i("error","Error al cargar el historial del incidente"),n(!1)}},G=()=>{O({statusId:void 0,description:""}),C(null)},q=e=>{e?(C(e),O({statusId:e.statusId,description:e.description||""})):G(),P(!0)},Y=(e,t)=>__async(this,null,function*(){B(a=>__spreadProps(__spreadValues({},a),{[e]:""===t||"-1"===t||null===t?void 0:t})),"companyId"===e&&"number"==typeof t&&-1!==t&&f(t.toString())}),K=(e,t)=>{B(a=>__spreadProps(__spreadValues({},a),{[e]:t&&"string"==typeof t?new Date(t):void 0}))},J=(e,t)=>{O(a=>__spreadProps(__spreadValues({},a),{[e]:t}))},X=[{accessorKey:"incidentId",header:"ID",cell:({row:e})=>jsxRuntimeExports.jsxs("span",{className:"font-semibold",children:["#",e.original.incidentId]})},{accessorKey:"condoName",header:"Condominio",cell:({row:e})=>jsxRuntimeExports.jsx("span",{className:"font-medium",children:e.original.condoName})},{accessorKey:"description",header:"Descripción",cell:({row:e})=>jsxRuntimeExports.jsx("div",{className:"max-w-xs truncate",title:e.original.description,children:e.original.description})},{accessorKey:"incidentTypeName",header:"Tipo",cell:({row:e})=>jsxRuntimeExports.jsx("span",{className:"font-medium",children:e.original.incidentTypeName})},{accessorKey:"statusName",header:"Estado",cell:({row:e})=>{let t="bg-gray-100 text-gray-800";switch(e.original.statusTypeId){case IncidentStatusEnum.Reportado:t="bg-yellow-100 text-yellow-800";break;case IncidentStatusEnum.EnProceso:t="bg-blue-100 text-blue-800";break;case IncidentStatusEnum.Asignado:t="bg-indigo-100 text-indigo-800";break;case IncidentStatusEnum.EnRevision:t="bg-purple-100 text-purple-800";break;case IncidentStatusEnum.Resuelto:t="bg-green-100 text-green-800";break;case IncidentStatusEnum.Cerrado:t="bg-teal-100 text-teal-800";break;case IncidentStatusEnum.Cancelado:t="bg-red-100 text-red-800"}return jsxRuntimeExports.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t}`,children:e.original.statusName})}},{accessorKey:"dateReported",header:"Fecha Reporte",cell:({getValue:e})=>{const t=e();return jsxRuntimeExports.jsx("span",{className:"font-medium",children:format(new Date(t),"dd/MM/yyyy HH:mm",{locale:es})})}},{accessorKey:"reportedByUserName",header:"Reportado por",cell:({row:e})=>jsxRuntimeExports.jsx("span",{className:"font-medium",children:e.original.reportedByUserName})},{accessorKey:"severityLevel",header:"Severidad",cell:({row:e})=>{let t="",a="";switch(e.original.severityLevel){case IncidentSeverityLevel.Low:t="bg-green-100 text-green-800",a="Baja";break;case IncidentSeverityLevel.Medium:t="bg-yellow-100 text-yellow-800",a="Media";break;case IncidentSeverityLevel.High:t="bg-orange-100 text-orange-800",a="Alta";break;case IncidentSeverityLevel.Critical:t="bg-red-100 text-red-800",a="Crítica";break;default:t="bg-gray-100 text-gray-800",a="Desconocida"}return jsxRuntimeExports.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t}`,children:a})}}],Z=[{accessorKey:"id",header:"ID",cell:({row:e})=>jsxRuntimeExports.jsxs("span",{className:"font-semibold",children:["#",e.original.id]})},{accessorKey:"statusName",header:"Estado",cell:({row:e})=>{let t="bg-gray-100 text-gray-800";switch(e.original.statusId){case IncidentStatusEnum.Reportado:t="bg-yellow-100 text-yellow-800";break;case IncidentStatusEnum.EnProceso:t="bg-blue-100 text-blue-800";break;case IncidentStatusEnum.Asignado:t="bg-indigo-100 text-indigo-800";break;case IncidentStatusEnum.EnRevision:t="bg-purple-100 text-purple-800";break;case IncidentStatusEnum.Resuelto:t="bg-green-100 text-green-800";break;case IncidentStatusEnum.Cerrado:t="bg-teal-100 text-teal-800";break;case IncidentStatusEnum.Cancelado:t="bg-red-100 text-red-800"}return jsxRuntimeExports.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t}`,children:e.original.statusName})}},{accessorKey:"description",header:"Descripción",cell:({row:e})=>jsxRuntimeExports.jsx("div",{className:"max-w-xs truncate",title:e.original.description,children:e.original.description})}],Q=[{icon:SquarePen,label:"Editar",onClick:e=>q(e)},{icon:Trash2,label:"Eliminar",onClick:e=>(e=>{C(e),M(!0)})(e)}],ee=[{icon:ClipboardList,label:"Ver Historial",onClick:e=>(e=>{I(e),H(e.incidentId),D(!0)})(e)}];return jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6 p-6",children:[jsxRuntimeExports.jsx("div",{className:"flex justify-between items-center mb-6",children:jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Bitácora de Incidentes"}),jsxRuntimeExports.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Historial de cambios de estado en incidentes"})]})}),jsxRuntimeExports.jsxs(Expandex,{title:"Filtros de búsqueda",initialExpanded:!0,expandIcon:Filter,borderColor:"#629E3E",backgroundColor:"#f9fafb",className:"mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[jsxRuntimeExports.jsx(SelectUI$1,{id:"companyId",label:"Empresa",value:E,onChange:V()?()=>{}:e=>__async(this,null,function*(){const t=(null==e?void 0:e.toString())||"-1";if(f(t),"-1"===t||!e)return v([]),void B(e=>__spreadProps(__spreadValues({},e),{companyId:void 0,condoId:void 0}));const a=Number(e);if(isNaN(a))v([]);else try{B(e=>__spreadProps(__spreadValues({},e),{condoId:void 0})),yield W(a),B(e=>__spreadProps(__spreadValues({},e),{companyId:a}))}catch(r){i("error","Error al cargar los condominios")}}),options:[{value:"-1",label:"Todas las empresas"},...h.map(e=>{const t=e.companyId||e.managementCompanyId;return{value:(null==t?void 0:t.toString())||"",label:e.name||"Sin nombre"}}).filter(e=>""!==e.value)],placeholder:"Seleccione una empresa",disabled:V()}),jsxRuntimeExports.jsx(SelectUI$1,{id:"condoId",label:"Condominio",value:(null==(e=L.condoId)?void 0:e.toString())||"-1",onChange:V()?()=>{}:e=>Y("condoId",Number(e)),options:[{value:"-1",label:"Todos los condominios"},...y.map(e=>({value:e.condoId.toString(),label:e.name}))],placeholder:"Seleccione condominio",disabled:V()||"-1"===E||0===y.length}),jsxRuntimeExports.jsx(SelectUI$1,{id:"incidentId",label:"Incidente",value:(null==(t=L.incidentId)?void 0:t.toString())||"-1",onChange:e=>Y("incidentId",Number(e)),options:[{value:"-1",label:"Todos los incidentes"},...mockIncidents.map(e=>{var t;return{value:e.incidentId.toString(),label:`#${e.incidentId} - ${null==(t=e.description)?void 0:t.substring(0,30)}${e.description&&e.description.length>30?"...":""}`}})],placeholder:"Seleccione incidente"}),jsxRuntimeExports.jsx(SelectUI$1,{id:"statusId",label:"Estado",value:(null==(a=L.statusId)?void 0:a.toString())||"-1",onChange:e=>Y("statusId",Number(e)),options:[{value:"-1",label:"Todos los estados"},...mockIncidentStatuses.map(e=>({value:e.id.toString(),label:e.name}))],placeholder:"Seleccione estado"}),jsxRuntimeExports.jsx(SelectUI$1,{id:"reportedByUserId",label:"Reportado por",value:(null==(r=L.reportedByUserId)?void 0:r.toString())||"-1",onChange:e=>Y("reportedByUserId",Number(e)),options:[{value:"-1",label:"Todos los usuarios"},...mockUsers.map(e=>({value:e.userId.toString(),label:e.name}))],placeholder:"Seleccione usuario"}),jsxRuntimeExports.jsx(DatepickerUI,{id:"fromDate",label:"Desde",value:L.fromDate?format(L.fromDate,"yyyy-MM-dd"):null,onChange:e=>K("fromDate",e),placeholder:"Fecha inicial"}),jsxRuntimeExports.jsx(DatepickerUI,{id:"toDate",label:"Hasta",value:L.toDate?format(L.toDate,"yyyy-MM-dd"):null,onChange:e=>K("toDate",e),placeholder:"Fecha final"}),jsxRuntimeExports.jsx(SelectUI$1,{id:"isResolved",label:"Estado de resolución",value:void 0===L.isResolved?"-1":L.isResolved?"1":"0",onChange:e=>{Y("isResolved","1"===e||"0"!==e&&null)},options:[{value:"-1",label:"Todos"},{value:"1",label:"Resueltos"},{value:"0",label:"Pendientes"}],placeholder:"Seleccione estado"})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end mt-4 space-x-2",children:[jsxRuntimeExports.jsx(ButtonUI,{title:"Limpiar",onClick:()=>{B({companyId:void 0,incidentId:void 0,condoId:void 0,statusId:void 0,reportedByUserId:void 0,fromDate:void 0,toDate:void 0,isResolved:void 0}),f("-1"),v([]),m(1),setTimeout(()=>{z()},0)},theme:"cancel"}),jsxRuntimeExports.jsx(ButtonUI,{title:"Aplicar Filtros",onClick:()=>{m(1),z()},borderColor:"#629E3E",textColor:"#ffffff",className:"bg-primary hover:bg-primary/90"})]})]}),$&&jsxRuntimeExports.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-6",children:$}),jsxRuntimeExports.jsx(DataGrid,{data:o,columns:X,actions:ee,onPageChange:e=>m(e),onPageSizeChange:e=>x(e),initialPage:u,initialPageSize:p,totalRecords:c}),jsxRuntimeExports.jsx(ModalUI,{isOpen:T,onClose:()=>D(!1),title:`Historial de Incidente #${(null==R?void 0:R.incidentId)||""}`,size:"5xl",footer:jsxRuntimeExports.jsxs("div",{className:"flex justify-between w-full",children:[jsxRuntimeExports.jsx(ButtonUI,{icon:Plus,title:"Nuevo Registro",onClick:()=>q(),theme:"primary"}),jsxRuntimeExports.jsx(ButtonUI,{icon:X$1,title:"Cerrar",onClick:()=>D(!1),theme:"cancel"})]}),children:jsxRuntimeExports.jsxs("div",{className:"p-4",children:[R&&jsxRuntimeExports.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[jsxRuntimeExports.jsx("h3",{className:"text-md font-semibold mb-2",children:"Detalles del Incidente"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Descripción:"})," ",R.description]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Condominio:"})," ",R.condoName]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Tipo:"})," ",R.incidentTypeName]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Estado:"})," ",R.statusName]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Reportado por:"})," ",R.reportedByUserName]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Fecha Reporte:"})," ",format(new Date(R.dateReported),"dd/MM/yyyy HH:mm",{locale:es})]}),R.resolvedByUserName&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Resuelto por:"})," ",R.resolvedByUserName]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Fecha Resolución:"})," ",R.dateResolved?format(new Date(R.dateResolved),"dd/MM/yyyy HH:mm",{locale:es}):"-"]})]})]})]}),jsxRuntimeExports.jsx(DataGrid,{data:S,columns:Z,actions:Q})]})}),jsxRuntimeExports.jsx(ModalUI,{isOpen:A,onClose:()=>P(!1),title:N?"Editar Registro de Estado":"Nuevo Registro de Estado",footer:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ButtonUI,{icon:X$1,title:"Cancelar",onClick:()=>P(!1),theme:"modalCancel"}),jsxRuntimeExports.jsx(ButtonUI,{icon:Save,title:"Guardar",onClick:N?()=>{R&&N&&(k.statusId?(n(!0),setTimeout(()=>{var e;try{const t=mockIncidentLogs.findIndex(e=>e.id===N.id);t>=0?(mockIncidentLogs[t]=__spreadProps(__spreadValues({},mockIncidentLogs[t]),{statusId:k.statusId,statusName:(null==(e=mockIncidentStatuses.find(e=>e.id===k.statusId))?void 0:e.name)||"Desconocido",description:k.description||mockIncidentLogs[t].description||""}),H(R.incidentId),P(!1),G(),i("success","Registro de estado actualizado correctamente")):i("error","No se encontró el registro a actualizar"),n(!1)}catch(t){i("error","Error al actualizar el registro de estado"),n(!1)}},500)):i("error","Debe seleccionar un estado"))}:()=>{R&&(k.statusId?(n(!0),setTimeout(()=>{var e,t;try{const a={id:Math.max(...mockIncidentLogs.map(e=>e.id))+1,incidentId:R.incidentId,statusId:k.statusId,statusName:(null==(e=mockIncidentStatuses.find(e=>e.id===k.statusId))?void 0:e.name)||"Desconocido",description:k.description||"",createdAt:(new Date).toISOString(),createdBy:"Usuario Actual",userId:1,userName:"Usuario Actual"};mockIncidentLogs.push(a),H(R.incidentId);const r=[...o],s=r.find(e=>e.incidentId===R.incidentId);s&&(s.statusTypeId=k.statusId,s.statusName=(null==(t=mockIncidentStatuses.find(e=>e.id===k.statusId))?void 0:t.name)||"Desconocido",s.updatedAt=(new Date).toISOString(),s.updatedBy="Usuario Actual",l(r)),P(!1),G(),i("success","Registro de estado creado correctamente"),n(!1)}catch(a){i("error","Error al guardar el registro de estado"),n(!1)}},500)):i("error","Debe seleccionar un estado"))},theme:"modalSave"})]}),children:jsxRuntimeExports.jsxs("div",{className:"space-y-4 p-4",children:[N&&jsxRuntimeExports.jsx("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg border border-gray-200",children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 gap-2 text-sm",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"ID:"})," #",N.id]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Registrado por:"})," ",N.userName||N.createdBy]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Fecha:"})," ",format(new Date(N.createdAt),"dd/MM/yyyy HH:mm",{locale:es})]})]})}),jsxRuntimeExports.jsx(SelectUI$1,{id:"statusId",label:"Estado",value:(null==(s=k.statusId)?void 0:s.toString())||"",onChange:e=>J("statusId",Number(e)),options:mockIncidentStatuses.map(e=>({value:e.id.toString(),label:e.name})),placeholder:"Seleccione estado",required:!0}),jsxRuntimeExports.jsx(TextAreaUI,{id:"description",label:"Descripción",value:k.description||"",onChange:e=>J("description",e),placeholder:"Describa los detalles de este cambio de estado",rows:4})]})}),jsxRuntimeExports.jsx(ModalUI,{isOpen:w,onClose:()=>M(!1),title:"Confirmar Eliminación",footer:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ButtonUI,{title:"Cancelar",onClick:()=>M(!1),theme:"cancel"}),jsxRuntimeExports.jsx(ButtonUI,{icon:Trash2,title:"Eliminar",onClick:()=>{N&&(n(!0),setTimeout(()=>{try{const e=mockIncidentLogs.findIndex(e=>e.id===N.id);e>=0?(mockIncidentLogs.splice(e,1),R&&H(R.incidentId),i("success","Registro de estado eliminado correctamente")):i("error","No se encontró el registro a eliminar"),M(!1),C(null),n(!1)}catch(e){i("error","Error al eliminar el registro de estado"),n(!1)}},500))},theme:"delete"})]}),children:jsxRuntimeExports.jsxs("div",{className:"p-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center mb-4",children:[jsxRuntimeExports.jsx(AlertTriangle,{className:"text-red-500 mr-3",size:24}),jsxRuntimeExports.jsx("p",{className:"text-gray-700",children:"¿Está seguro de que desea eliminar este registro de estado? Esta acción no se puede deshacer."})]}),N&&jsxRuntimeExports.jsxs("div",{className:"bg-gray-50 p-3 rounded border border-gray-200 text-sm",children:[jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Fecha:"})," ",format(new Date(N.createdAt),"dd/MM/yyyy HH:mm",{locale:es})]}),jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Estado:"})," ",N.statusName]}),jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Descripción:"})," ",N.description||"-"]})]})]})}),jsxRuntimeExports.jsxs("div",{className:"mt-8 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center mb-3",children:[jsxRuntimeExports.jsx(Clock,{className:"text-gray-600 mr-2",size:18}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Acerca de la Bitácora"})]}),jsxRuntimeExports.jsxs("div",{className:"text-sm text-gray-600",children:[jsxRuntimeExports.jsx("p",{className:"mb-2",children:"La bitácora registra todos los cambios de estado que experimentan los incidentes desde su creación hasta su resolución."}),jsxRuntimeExports.jsxs("div",{className:"mt-3 grid grid-cols-2 md:grid-cols-4 gap-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-300 mr-2"}),jsxRuntimeExports.jsx("span",{children:"Reportado: Incidente registrado"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-300 mr-2"}),jsxRuntimeExports.jsx("span",{children:"En Proceso: En atención"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full bg-indigo-300 mr-2"}),jsxRuntimeExports.jsx("span",{children:"Asignado: Personal asignado"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full bg-purple-300 mr-2"}),jsxRuntimeExports.jsx("span",{children:"En Revisión: Verificando"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full bg-green-300 mr-2"}),jsxRuntimeExports.jsx("span",{children:"Resuelto: Solucionado"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full bg-teal-300 mr-2"}),jsxRuntimeExports.jsx("span",{children:"Cerrado: Verificado y finalizado"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full bg-red-300 mr-2"}),jsxRuntimeExports.jsx("span",{children:"Cancelado: Incidente descartado"})]})]})]})]})]})}const CheckboxUI=({id:e,label:t,checked:a,onChange:r,disabled:s=!1,className:n=""})=>jsxRuntimeExports.jsxs("div",{className:`flex items-center ${n}`,children:[jsxRuntimeExports.jsx("input",{id:e,type:"checkbox",checked:a,onChange:e=>r(e.target.checked),disabled:s,className:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-2 focus:ring-primary cursor-pointer"}),jsxRuntimeExports.jsx("label",{htmlFor:e,className:`ml-2 text-sm font-medium ${s?"text-gray-400":"text-gray-700"} cursor-pointer`,children:t})]});function IncidentTypes(){return jsxRuntimeExports.jsx(AlertProvider,{children:jsxRuntimeExports.jsx(IncidentTypesContent,{})})}function IncidentTypesContent(){const{setLoading:e}=useLoading(),{showToast:t,showConfirm:a}=useAlerts(),[r,s]=reactExports.useState([]),[n,i]=reactExports.useState(),[o,l]=reactExports.useState(null),[c,d]=reactExports.useState(!1),[u,m]=reactExports.useState({name:"",description:"",isActive:!0});reactExports.useEffect(()=>{p()},[]);const p=()=>__async(this,null,function*(){try{e(!0),l(null),setTimeout(()=>{const t=[...mockIncidentTypes].sort((e,t)=>e.name.localeCompare(t.name));s(t),e(!1)},500)}catch(t){l("Error al cargar los tipos de incidentes"),e(!1)}}),x=[{accessorKey:"id",header:"ID",cell:({row:e})=>jsxRuntimeExports.jsxs("span",{className:"font-semibold",children:["#",e.original.id]})},{accessorKey:"name",header:"Nombre",cell:({row:e})=>jsxRuntimeExports.jsx("span",{className:"font-medium",children:e.original.name})},{accessorKey:"description",header:"Descripción",cell:({row:e})=>jsxRuntimeExports.jsx("div",{className:"max-w-xs truncate",title:e.original.description,children:e.original.description})},{accessorKey:"isActive",header:"Estado",cell:({row:e})=>e.original.isActive?jsxRuntimeExports.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Activo"}):jsxRuntimeExports.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"Inactivo"})},{accessorKey:"createdAt",header:"Fecha Creación",cell:({row:e})=>jsxRuntimeExports.jsx("span",{className:"font-medium",children:new Date(e.original.createdAt).toLocaleDateString("es-ES")})},{accessorKey:"updatedAt",header:"Última Actualización",cell:({row:e})=>e.original.updatedAt?jsxRuntimeExports.jsx("span",{className:"font-medium",children:new Date(e.original.updatedAt).toLocaleDateString("es-ES")}):jsxRuntimeExports.jsx("span",{className:"text-gray-400",children:"-"})}],h=e=>{e?(i(e),m({id:e.id,name:e.name,description:e.description||"",isActive:e.isActive})):(i(void 0),m({name:"",description:"",isActive:!0})),d(!0)},g=()=>{d(!1),i(void 0)},y=(e,t)=>{m(a=>__spreadProps(__spreadValues({},a),{[e]:t}))},v=[{icon:SquarePen,label:"Editar",onClick:e=>h(e)},{icon:Check,label:"Cambiar Estado",onClick:n=>(n=>{const i=!n.isActive,o=i?"activar":"desactivar";a((i?"Activar":"Desactivar")+" Tipo de Incidente",`¿Está seguro que desea ${o} el tipo de incidente "${n.name}"?`,()=>{try{e(!0),setTimeout(()=>{const a=r.map(e=>e.id===n.id?__spreadProps(__spreadValues({},e),{isActive:i,updatedAt:(new Date).toISOString(),updatedBy:"current-user"}):e);s(a),t("success",`Tipo de incidente ${i?"activado":"desactivado"} correctamente`),e(!1)},500)}catch(a){t("error",`Ocurrió un error al ${o} el tipo de incidente`),e(!1)}})})(n)},{icon:Trash2,label:"Eliminar",onClick:n=>(n=>{a("Eliminar Tipo de Incidente",`¿Está seguro que desea eliminar el tipo de incidente "${n.name}"?`,()=>{try{e(!0),setTimeout(()=>{const a=r.filter(e=>e.id!==n.id);s(a),t("success","Tipo de incidente eliminado correctamente"),e(!1)},500)}catch(a){t("error","Ocurrió un error al eliminar el tipo de incidente"),e(!1)}})})(n)}];return jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6 p-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Tipos de Incidentes"}),jsxRuntimeExports.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Gestione los tipos de incidentes que pueden reportarse en los condominios"})]}),jsxRuntimeExports.jsx(ButtonUI,{icon:Plus,title:"Nuevo Tipo",theme:"primary",onClick:()=>h()})]}),o&&jsxRuntimeExports.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-6",children:o}),jsxRuntimeExports.jsx(DataGrid,{data:r,columns:x,actions:v}),jsxRuntimeExports.jsx(ModalUI,{isOpen:c,onClose:g,title:n?"Editar Tipo de Incidente":"Nuevo Tipo de Incidente",footer:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(ButtonUI,{icon:X$1,title:"Cancelar",onClick:g,theme:"delete"}),jsxRuntimeExports.jsx(ButtonUI,{icon:Save,title:"Guardar",onClick:()=>__async(this,null,function*(){try{if(e(!0),!u.name||""===u.name.trim())return t("error","El nombre es obligatorio"),void e(!1);setTimeout(()=>{if(n){const e=r.map(e=>e.id===n.id?__spreadProps(__spreadValues({},e),{name:u.name,description:u.description,isActive:u.isActive,updatedAt:(new Date).toISOString(),updatedBy:"current-user"}):e);s(e),t("success","Tipo de incidente actualizado correctamente")}else{const e={id:Math.max(...r.map(e=>e.id))+1,name:u.name,description:u.description,isActive:u.isActive,createdAt:(new Date).toISOString(),createdBy:"current-user"};s([...r,e]),t("success","Tipo de incidente creado correctamente")}g(),e(!1)},500)}catch(a){t("error","Ocurrió un error al procesar el tipo de incidente"),e(!1)}}),theme:"primary"})]}),children:jsxRuntimeExports.jsxs("div",{className:"space-y-4 p-4",children:[jsxRuntimeExports.jsx(InputUI,{id:"name",label:"Nombre",value:u.name||"",onChange:e=>y("name",e),placeholder:"Nombre del tipo de incidente",required:!0}),jsxRuntimeExports.jsx(TextAreaUI,{id:"description",label:"Descripción",value:u.description||"",onChange:e=>y("description",e),placeholder:"Describa el tipo de incidente",rows:3}),jsxRuntimeExports.jsx(CheckboxUI,{id:"isActive",label:"Activo",checked:u.isActive||!1,onChange:e=>y("isActive",e)}),n&&jsxRuntimeExports.jsxs("div",{className:"mt-4 text-xs text-gray-500",children:[jsxRuntimeExports.jsxs("p",{children:["ID: ",n.id]}),jsxRuntimeExports.jsxs("p",{children:["Creado: ",new Date(n.createdAt).toLocaleString("es-ES")," por ",n.createdBy||"Sistema"]}),n.updatedAt&&jsxRuntimeExports.jsxs("p",{children:["Última actualización: ",new Date(n.updatedAt).toLocaleString("es-ES")," por ",n.updatedBy||"Sistema"]})]})]})}),jsxRuntimeExports.jsxs("div",{className:"mt-8 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center mb-3",children:[jsxRuntimeExports.jsx(AlertTriangle,{className:"text-amber-600 mr-2",size:18}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Acerca de los Tipos de Incidentes"})]}),jsxRuntimeExports.jsxs("div",{className:"text-sm text-gray-600",children:[jsxRuntimeExports.jsx("p",{className:"mb-2",children:"Los tipos de incidentes definen las categorías para clasificar los problemas reportados en los condominios."}),jsxRuntimeExports.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[jsxRuntimeExports.jsx("li",{children:"Los tipos de incidentes activos estarán disponibles para seleccionar al crear nuevos reportes."}),jsxRuntimeExports.jsx("li",{children:"Los tipos de incidentes inactivos se mantendrán en reportes históricos pero no serán seleccionables para nuevos reportes."}),jsxRuntimeExports.jsx("li",{children:"Si necesita eliminar un tipo de incidente, asegúrese de que no existan reportes asociados."})]})]})]})]})}var MaintenanceStatusEnum=(e=>(e[e.Pending=1]="Pending",e[e.Scheduled=2]="Scheduled",e[e.InProgress=3]="InProgress",e[e.Completed=4]="Completed",e[e.Cancelled=5]="Cancelled",e[e.Rescheduled=6]="Rescheduled",e[e.Delayed=7]="Delayed",e))(MaintenanceStatusEnum||{}),MaintenanceTypeEnum=(e=>(e[e.Electrical=1]="Electrical",e[e.Plumbing=2]="Plumbing",e[e.Structural=3]="Structural",e[e.HVAC=4]="HVAC",e[e.Landscaping=5]="Landscaping",e[e.Pool=6]="Pool",e[e.Security=7]="Security",e[e.Cleaning=8]="Cleaning",e[e.Equipment=9]="Equipment",e[e.Other=10]="Other",e))(MaintenanceTypeEnum||{});const mockMaintenance=[{maintenanceId:1,condoId:1,condoName:"Residencial Las Palmas",commonAreaId:3,commonAreaName:"Piscina",userId:2,userName:"Carlos Rodríguez",title:"Mantenimiento mensual de piscina",description:"Limpieza profunda, revisión de bombas y niveles químicos",maintenanceDate:new Date(2023,7,5).toISOString(),startTime:"09:00:00",endTime:"12:00:00",maintenanceTypeId:MaintenanceTypeEnum.Pool,maintenanceTypeName:"Piscina",statusTypeId:MaintenanceStatusEnum.Completed,statusName:"Completado",notes:"Se cambió el filtro principal y se recalibró el sistema de cloración automática",isPreventive:!0,nextScheduledDate:new Date(2023,8,5).toISOString(),frequencyInDays:30,createdAt:new Date(2023,6,28).toISOString(),createdBy:"Ana Martínez",updatedAt:new Date(2023,7,5,12,15).toISOString(),updatedBy:"Carlos Rodríguez",isDeleted:!1},{maintenanceId:2,condoId:1,condoName:"Residencial Las Palmas",commonAreaId:1,commonAreaName:"Sala de reuniones",userId:3,userName:"Miguel Torres",title:"Revisión sistema de aire acondicionado",description:"Mantenimiento preventivo del sistema central",maintenanceDate:new Date(2023,7,10).toISOString(),startTime:"14:00:00",endTime:"17:00:00",maintenanceTypeId:MaintenanceTypeEnum.HVAC,maintenanceTypeName:"Climatización",statusTypeId:MaintenanceStatusEnum.Scheduled,statusName:"Programado",notes:"Se requiere limpieza de filtros y revisión de carga de gas refrigerante",isPreventive:!0,nextScheduledDate:new Date(2023,10,10).toISOString(),frequencyInDays:90,createdAt:new Date(2023,6,30).toISOString(),createdBy:"Laura Sánchez",updatedAt:void 0,updatedBy:void 0,isDeleted:!1},{maintenanceId:3,condoId:1,condoName:"Residencial Las Palmas",commonAreaId:4,commonAreaName:"Jardín principal",userId:4,userName:"Javier López",title:"Poda de árboles y mantenimiento de jardines",description:"Poda semestral y aplicación de fertilizantes",maintenanceDate:new Date(2023,7,15).toISOString(),startTime:"08:00:00",endTime:"16:00:00",maintenanceTypeId:MaintenanceTypeEnum.Landscaping,maintenanceTypeName:"Jardinería",statusTypeId:MaintenanceStatusEnum.InProgress,statusName:"En Progreso",notes:"Se está realizando la poda de árboles y arbustos. Se aplicará fertilizante al finalizar.",isPreventive:!0,nextScheduledDate:new Date(2024,1,15).toISOString(),frequencyInDays:180,createdAt:new Date(2023,7,1).toISOString(),createdBy:"Roberto García",updatedAt:new Date(2023,7,15,9,30).toISOString(),updatedBy:"Javier López",isDeleted:!1},{maintenanceId:4,condoId:1,condoName:"Residencial Las Palmas",commonAreaId:2,commonAreaName:"Gimnasio",userId:2,userName:"Carlos Rodríguez",title:"Reparación de caminadora",description:"La caminadora #3 presenta fallos en el sistema de inclinación",maintenanceDate:new Date(2023,7,6).toISOString(),startTime:"10:00:00",endTime:"12:00:00",maintenanceTypeId:MaintenanceTypeEnum.Equipment,maintenanceTypeName:"Equipamiento",statusTypeId:MaintenanceStatusEnum.Completed,statusName:"Completado",notes:"Se reemplazó el motor de inclinación y se calibró el sistema. Se recomienda no exceder los 30 minutos de uso continuo.",isPreventive:!1,nextScheduledDate:void 0,frequencyInDays:void 0,createdAt:new Date(2023,7,4).toISOString(),createdBy:"Diana Pérez",updatedAt:new Date(2023,7,6,11,45).toISOString(),updatedBy:"Carlos Rodríguez",isDeleted:!1},{maintenanceId:5,condoId:2,condoName:"Edificio Central",commonAreaId:5,commonAreaName:"Hall de entrada",userId:5,userName:"Elena Gómez",title:"Reparación de filtración en techo",description:"Se detectó filtración de agua en el techo del hall principal durante la última lluvia",maintenanceDate:new Date(2023,7,8).toISOString(),startTime:"09:00:00",endTime:"18:00:00",maintenanceTypeId:MaintenanceTypeEnum.Structural,maintenanceTypeName:"Estructural",statusTypeId:MaintenanceStatusEnum.Scheduled,statusName:"Programado",notes:"Se requiere evaluación para determinar origen de la filtración y reparación del impermeabilizante",isPreventive:!1,nextScheduledDate:void 0,frequencyInDays:void 0,createdAt:new Date(2023,7,3).toISOString(),createdBy:"Mariano Díaz",updatedAt:void 0,updatedBy:void 0,isDeleted:!1},{maintenanceId:6,condoId:2,condoName:"Edificio Central",commonAreaId:6,commonAreaName:"Estacionamiento",userId:6,userName:"Fernando Martín",title:"Mantenimiento sistema de seguridad",description:"Revisión y mantenimiento de cámaras y sensores de movimiento",maintenanceDate:new Date(2023,7,20).toISOString(),startTime:"14:00:00",endTime:"18:00:00",maintenanceTypeId:MaintenanceTypeEnum.Security,maintenanceTypeName:"Seguridad",statusTypeId:MaintenanceStatusEnum.Pending,statusName:"Pendiente",notes:"Se revisarán todas las cámaras y se actualizará el software de monitoreo",isPreventive:!0,nextScheduledDate:new Date(2023,10,20).toISOString(),frequencyInDays:90,createdAt:new Date(2023,7,5).toISOString(),createdBy:"Laura Sánchez",updatedAt:void 0,updatedBy:void 0,isDeleted:!1},{maintenanceId:7,condoId:3,condoName:"Terrazas del Norte",commonAreaId:7,commonAreaName:"Sala de máquinas",userId:7,userName:"Ricardo Molina",title:"Revisión de bomba de agua",description:"Mantenimiento preventivo de la bomba principal de agua",maintenanceDate:new Date(2023,7,12).toISOString(),startTime:"10:00:00",endTime:"13:00:00",maintenanceTypeId:MaintenanceTypeEnum.Plumbing,maintenanceTypeName:"Plomería",statusTypeId:MaintenanceStatusEnum.Completed,statusName:"Completado",notes:"Se realizó limpieza de filtros, cambio de sellos y ajuste de presión. Sistema funcionando correctamente.",isPreventive:!0,nextScheduledDate:new Date(2023,10,12).toISOString(),frequencyInDays:90,createdAt:new Date(2023,6,25).toISOString(),createdBy:"Roberto García",updatedAt:new Date(2023,7,12,12,50).toISOString(),updatedBy:"Ricardo Molina",isDeleted:!1},{maintenanceId:8,condoId:3,condoName:"Terrazas del Norte",commonAreaId:8,commonAreaName:"Pasillos",userId:3,userName:"Miguel Torres",title:"Reparación de iluminación",description:"Fallo en sistema de iluminación de pasillos del segundo piso",maintenanceDate:new Date(2023,7,7).toISOString(),startTime:"11:00:00",endTime:"14:00:00",maintenanceTypeId:MaintenanceTypeEnum.Electrical,maintenanceTypeName:"Eléctrico",statusTypeId:MaintenanceStatusEnum.Completed,statusName:"Completado",notes:"Se reemplazaron 3 transformadores dañados y se verificó el funcionamiento de todas las luminarias",isPreventive:!1,nextScheduledDate:void 0,frequencyInDays:void 0,createdAt:new Date(2023,7,6).toISOString(),createdBy:"Sofia Reyes",updatedAt:new Date(2023,7,7,13,45).toISOString(),updatedBy:"Miguel Torres",isDeleted:!1},{maintenanceId:9,condoId:4,condoName:"Vista Hermosa",commonAreaId:9,commonAreaName:"Salón de fiestas",userId:4,userName:"Javier López",title:"Limpieza profunda",description:"Limpieza general post-evento",maintenanceDate:new Date(2023,7,9).toISOString(),startTime:"08:00:00",endTime:"12:00:00",maintenanceTypeId:MaintenanceTypeEnum.Cleaning,maintenanceTypeName:"Limpieza",statusTypeId:MaintenanceStatusEnum.Cancelled,statusName:"Cancelado",notes:"Cancelado debido a que el evento fue pospuesto",isPreventive:!1,nextScheduledDate:void 0,frequencyInDays:void 0,createdAt:new Date(2023,7,5).toISOString(),createdBy:"Diana Pérez",updatedAt:new Date(2023,7,8,17,30).toISOString(),updatedBy:"Sofia Reyes",isDeleted:!1},{maintenanceId:10,condoId:4,condoName:"Vista Hermosa",commonAreaId:10,commonAreaName:"Área de juegos infantiles",userId:5,userName:"Elena Gómez",title:"Mantenimiento de juegos infantiles",description:"Revisión y mantenimiento de columpios, resbaladilla y demás equipos",maintenanceDate:new Date(2023,7,25).toISOString(),startTime:"09:00:00",endTime:"13:00:00",maintenanceTypeId:MaintenanceTypeEnum.Equipment,maintenanceTypeName:"Equipamiento",statusTypeId:MaintenanceStatusEnum.Pending,statusName:"Pendiente",notes:"Se requiere revisar uniones, tornillos y pintura de todos los juegos",isPreventive:!0,nextScheduledDate:new Date(2024,1,25).toISOString(),frequencyInDays:180,createdAt:new Date(2023,7,10).toISOString(),createdBy:"Roberto García",updatedAt:void 0,updatedBy:void 0,isDeleted:!1},{maintenanceId:11,condoId:1,condoName:"Residencial Las Palmas",commonAreaId:11,commonAreaName:"Sistema eléctrico general",userId:2,userName:"Carlos Rodríguez",title:"Revisión de tableros eléctricos",description:"Inspección preventiva de tableros y distribución eléctrica",maintenanceDate:new Date(2023,8,5).toISOString(),startTime:"08:00:00",endTime:"14:00:00",maintenanceTypeId:MaintenanceTypeEnum.Electrical,maintenanceTypeName:"Eléctrico",statusTypeId:MaintenanceStatusEnum.Scheduled,statusName:"Programado",notes:"Se verificarán conexiones, temperaturas y balanceo de cargas",isPreventive:!0,nextScheduledDate:new Date(2024,2,5).toISOString(),frequencyInDays:180,createdAt:new Date(2023,7,15).toISOString(),createdBy:"Ana Martínez",updatedAt:void 0,updatedBy:void 0,isDeleted:!1},{maintenanceId:12,condoId:2,condoName:"Edificio Central",commonAreaId:12,commonAreaName:"Ascensor principal",userId:6,userName:"Fernando Martín",title:"Reparación de ascensor",description:"Fallo en sistema de nivelación del ascensor",maintenanceDate:new Date(2023,7,7).toISOString(),startTime:"09:00:00",endTime:"18:00:00",maintenanceTypeId:MaintenanceTypeEnum.Other,maintenanceTypeName:"Otro",statusTypeId:MaintenanceStatusEnum.InProgress,statusName:"En Progreso",notes:"Técnico especializado trabajando en sensor de nivelación y sistema de control",isPreventive:!1,nextScheduledDate:void 0,frequencyInDays:void 0,createdAt:new Date(2023,7,6).toISOString(),createdBy:"Mariano Díaz",updatedAt:new Date(2023,7,7,10,30).toISOString(),updatedBy:"Fernando Martín",isDeleted:!1}],mockMaintenanceStaff=[{userId:2,name:"Carlos Rodríguez",role:"Técnico de mantenimiento",specialties:"Eléctrico, Equipamiento"},{userId:3,name:"Miguel Torres",role:"Técnico de mantenimiento",specialties:"Climatización, Eléctrico"},{userId:4,name:"Javier López",role:"Jardinero",specialties:"Jardinería, Limpieza"},{userId:5,name:"Elena Gómez",role:"Técnico de mantenimiento",specialties:"Estructural, Equipamiento"},{userId:6,name:"Fernando Martín",role:"Jefe de mantenimiento",specialties:"Seguridad, General"},{userId:7,name:"Ricardo Molina",role:"Plomero",specialties:"Plomería, Piscina"}],mockCommonAreas=[{commonAreaId:1,name:"Sala de reuniones",condoId:1},{commonAreaId:2,name:"Gimnasio",condoId:1},{commonAreaId:3,name:"Piscina",condoId:1},{commonAreaId:4,name:"Jardín principal",condoId:1},{commonAreaId:5,name:"Hall de entrada",condoId:2},{commonAreaId:6,name:"Estacionamiento",condoId:2},{commonAreaId:7,name:"Sala de máquinas",condoId:3},{commonAreaId:8,name:"Pasillos",condoId:3},{commonAreaId:9,name:"Salón de fiestas",condoId:4},{commonAreaId:10,name:"Área de juegos infantiles",condoId:4},{commonAreaId:11,name:"Sistema eléctrico general",condoId:1},{commonAreaId:12,name:"Ascensor principal",condoId:2}],mockCondominiums$1=[{condoId:1,name:"Residencial Las Palmas"},{condoId:2,name:"Edificio Central"},{condoId:3,name:"Terrazas del Norte"},{condoId:4,name:"Vista Hermosa"}],mockMaintenanceTypes=[{id:MaintenanceTypeEnum.Electrical,name:"Eléctrico",description:"Sistemas eléctricos, iluminación, tableros"},{id:MaintenanceTypeEnum.Plumbing,name:"Plomería",description:"Sistemas de agua, desagües, bombas"},{id:MaintenanceTypeEnum.Structural,name:"Estructural",description:"Paredes, techos, pisos, filtraciones"},{id:MaintenanceTypeEnum.HVAC,name:"Climatización",description:"Aire acondicionado, ventilación, calefacción"},{id:MaintenanceTypeEnum.Landscaping,name:"Jardinería",description:"Jardines, plantas, riego"},{id:MaintenanceTypeEnum.Pool,name:"Piscina",description:"Limpieza, tratamiento de agua, bombas"},{id:MaintenanceTypeEnum.Security,name:"Seguridad",description:"Cámaras, alarmas, controles de acceso"},{id:MaintenanceTypeEnum.Cleaning,name:"Limpieza",description:"Limpieza general o especializada"},{id:MaintenanceTypeEnum.Equipment,name:"Equipamiento",description:"Equipos, máquinas, mobiliario"},{id:MaintenanceTypeEnum.Other,name:"Otro",description:"Otros tipos de mantenimiento"}],mockMaintenanceStatuses=[{id:MaintenanceStatusEnum.Pending,name:"Pendiente",description:"Mantenimiento pendiente de asignación o inicio"},{id:MaintenanceStatusEnum.Scheduled,name:"Programado",description:"Mantenimiento programado con fecha y hora"},{id:MaintenanceStatusEnum.InProgress,name:"En Progreso",description:"Mantenimiento en ejecución"},{id:MaintenanceStatusEnum.Completed,name:"Completado",description:"Mantenimiento finalizado correctamente"},{id:MaintenanceStatusEnum.Cancelled,name:"Cancelado",description:"Mantenimiento cancelado"},{id:MaintenanceStatusEnum.Rescheduled,name:"Reprogramado",description:"Mantenimiento reprogramado para otra fecha"},{id:MaintenanceStatusEnum.Delayed,name:"Retrasado",description:"Mantenimiento retrasado respecto a la fecha programada"}],getPreventiveMaintenance=()=>mockMaintenance.filter(e=>e.isPreventive&&!e.isDeleted),getCorrectiveMaintenance=()=>mockMaintenance.filter(e=>!e.isPreventive&&!e.isDeleted),addMaintenance=e=>{const t=Math.max(...mockMaintenance.map(e=>e.maintenanceId))+1,a=__spreadProps(__spreadValues({},e),{maintenanceId:t,createdAt:(new Date).toISOString(),isDeleted:!1});return mockMaintenance.push(a),a},updateMaintenance=e=>{const t=mockMaintenance.findIndex(t=>t.maintenanceId===e.maintenanceId);return-1!==t&&(mockMaintenance[t]=__spreadProps(__spreadValues({},e),{updatedAt:(new Date).toISOString()}),!0)},deleteMaintenance=e=>{const t=mockMaintenance.findIndex(t=>t.maintenanceId===e);return-1!==t&&(mockMaintenance[t].isDeleted=!0,mockMaintenance[t].updatedAt=(new Date).toISOString(),!0)};function MaintenanceBaseWrapper(e){return jsxRuntimeExports.jsx(AlertProvider,{children:jsxRuntimeExports.jsx(MaintenanceBase,__spreadValues({},e))})}function MaintenanceBase({type:e,title:t,description:a,getDataFunction:r,sortOrder:s,showFrequencyFields:n,defaultValues:i,infoText:o}){var l,c,d,u,m,p,x,h,g,y,v,E;const{setLoading:f}=useLoading(),{showToast:b}=useAlerts(),[j,R]=reactExports.useState([]),[I,S]=reactExports.useState(0),[_,N]=reactExports.useState(1),[C,T]=reactExports.useState(10),[D,A]=reactExports.useState(null),[P,w]=reactExports.useState([]),[M,k]=reactExports.useState([]),[O,$]=reactExports.useState(-1),[U,L]=reactExports.useState(!0),B=new ManagementCompanyService,F=new CondominiumService,[V,W]=reactExports.useState(!1),[z,H]=reactExports.useState(!1),[G,q]=reactExports.useState(!1),[Y,K]=reactExports.useState(!1),[J,X]=reactExports.useState({condoId:void 0,maintenanceTypeId:void 0,statusTypeId:void 0,userId:void 0,fromDate:void 0,toDate:void 0}),[Z,Q]=reactExports.useState(null);reactExports.useEffect(()=>{se()},[_,C]),reactExports.useEffect(()=>{(()=>{__async(this,null,function*(){try{f(!0),yield ae(),yield ee(),L(!1)}catch(e){Q("Error al cargar los datos iniciales")}finally{f(!1)}})})()},[]);const ee=()=>__async(this,null,function*(){try{(new AuthService).getUser();yield preloadCompanyCondoFilters(e=>{$(Number(e))},(e,t)=>__async(this,null,function*(){"companyId"===e&&"number"==typeof t&&-1!==t&&(yield re(t)),"condoId"===e&&"number"==typeof t&&-1!==t&&oe("condoId",t)}),re,"MaintenanceBase")}catch(e){}}),te=()=>shouldDisableCompanyCondoSelects(),ae=()=>__async(this,null,function*(){try{f(!0),Q(null);const e=yield B.getPaged();if(e.isSuccess&&e.data){const t=e.data;t.items&&Array.isArray(t.items)?w(t.items):w([])}else Q(e.error||"Error al cargar las empresas")}catch(e){Q("Error al cargar las empresas")}finally{f(!1)}}),re=e=>__async(this,null,function*(){try{f(!0),Q(null);const t={CompanyId:e,Page:1,PageSize:100},a=yield F.getPaged(t);if(a.isSuccess&&a.data){const e=a.data;e.items&&Array.isArray(e.items)?k(e.items):e.data&&Array.isArray(e.data)?k(e.data):Array.isArray(e)?k(e):k([])}else Q(a.error||"Error al cargar los condominios")}catch(t){Q("Error al cargar los condominios")}finally{f(!1)}}),se=()=>{try{f(!0),Q(null),setTimeout(()=>{let e=r();void 0!==J.condoId&&(e=e.filter(e=>e.condoId===J.condoId)),void 0!==J.maintenanceTypeId&&(e=e.filter(e=>e.maintenanceTypeId===J.maintenanceTypeId)),void 0!==J.statusTypeId&&(e=e.filter(e=>e.statusTypeId===J.statusTypeId)),void 0!==J.userId&&(e=e.filter(e=>e.userId===J.userId)),J.fromDate&&(e=e.filter(e=>new Date(e.maintenanceDate)>=J.fromDate)),J.toDate&&(e=e.filter(e=>new Date(e.maintenanceDate)<=J.toDate)),e.sort((e,t)=>{const a=new Date(e.maintenanceDate).getTime(),r=new Date(t.maintenanceDate).getTime();return"asc"===s?a-r:r-a});const t=e.length,a=(_-1)*C,n=Math.min(a+C,t),i=e.slice(a,n);R(i),S(t),f(!1)},300)}catch(t){Q("Error al cargar los mantenimientos "+("preventive"===e?"preventivos":"correctivos")),f(!1)}},ne=e=>{if(!e)return"No disponible";try{return format(new Date(e),"dd/MM/yyyy",{locale:es})}catch(t){return"Fecha inválida"}},ie=e=>{if(e)A(e);else{const e={maintenanceId:0,condoId:mockCondominiums$1[0].condoId,condoName:mockCondominiums$1[0].name,commonAreaId:void 0,commonAreaName:void 0,userId:mockMaintenanceStaff[0].userId,userName:mockMaintenanceStaff[0].name,title:i.title||"",description:i.description||"",maintenanceDate:(new Date).toISOString(),startTime:i.startTime||"09:00:00",endTime:i.endTime||"12:00:00",maintenanceTypeId:mockMaintenanceTypes[0].id,maintenanceTypeName:mockMaintenanceTypes[0].name,statusTypeId:i.statusTypeId||MaintenanceStatusEnum.Pending,statusName:i.statusName||"Pendiente",notes:i.notes||"",isPreventive:i.isPreventive||!1,nextScheduledDate:i.nextScheduledDate,frequencyInDays:i.frequencyInDays,createdAt:(new Date).toISOString(),createdBy:"Usuario Actual",isDeleted:!1};A(e)}H(!0)},oe=(e,t)=>{X(a=>__spreadProps(__spreadValues({},a),{[e]:""===t||"-1"===t?void 0:t}))},le=[{accessorKey:"maintenanceId",header:"ID",cell:({row:e})=>jsxRuntimeExports.jsxs("span",{className:"font-semibold",children:["#",e.original.maintenanceId]})},{accessorKey:"title",header:"Título",cell:({row:e})=>jsxRuntimeExports.jsx("div",{className:"max-w-xs truncate",title:e.original.title,children:e.original.title})},{accessorKey:"condoName",header:"Condominio",cell:({row:e})=>jsxRuntimeExports.jsx("span",{className:"font-medium",children:e.original.condoName})},{accessorKey:"commonAreaName",header:"Área Común",cell:({row:e})=>jsxRuntimeExports.jsx("span",{className:"font-medium",children:e.original.commonAreaName})},{accessorKey:"maintenanceTypeName",header:"Tipo",cell:({row:e})=>jsxRuntimeExports.jsx("span",{className:"font-medium",children:e.original.maintenanceTypeName})},{accessorKey:"statusName",header:"Estado",cell:({row:e})=>{let t="bg-gray-100 text-gray-800";switch(e.original.statusTypeId){case MaintenanceStatusEnum.Pending:t="bg-yellow-100 text-yellow-800";break;case MaintenanceStatusEnum.Scheduled:t="bg-blue-100 text-blue-800";break;case MaintenanceStatusEnum.InProgress:t="bg-indigo-100 text-indigo-800";break;case MaintenanceStatusEnum.Completed:t="bg-green-100 text-green-800";break;case MaintenanceStatusEnum.Cancelled:t="bg-red-100 text-red-800";break;case MaintenanceStatusEnum.Rescheduled:t="bg-purple-100 text-purple-800";break;case MaintenanceStatusEnum.Delayed:t="bg-orange-100 text-orange-800"}return jsxRuntimeExports.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t}`,children:e.original.statusName})}},{accessorKey:"maintenanceDate",header:"Fecha",cell:({getValue:e})=>{const t=e();return jsxRuntimeExports.jsx("span",{className:"font-medium",children:ne(t)})}},{accessorKey:"startTime",header:"Hora",cell:({row:e})=>jsxRuntimeExports.jsxs("span",{className:"font-medium",children:[e.original.startTime.substring(0,5)," - ",e.original.endTime.substring(0,5)]})},{accessorKey:"userName",header:"Asignado a",cell:({row:e})=>jsxRuntimeExports.jsx("span",{className:"font-medium",children:e.original.userName})}];n&&le.push({accessorKey:"frequencyInDays",header:"Frecuencia",cell:({row:e})=>jsxRuntimeExports.jsx("span",{className:"font-medium",children:e.original.frequencyInDays?`${e.original.frequencyInDays} días`:"-"})});const ce=[{icon:Search,label:"Ver Detalles",onClick:e=>(e=>{A(e),W(!0)})(e)},{icon:Clock,label:"Actualizar Progreso",onClick:e=>(e=>{A(e),K(!0)})(e),hidden:e=>e.statusTypeId===MaintenanceStatusEnum.Completed||e.statusTypeId===MaintenanceStatusEnum.Cancelled},{icon:SquarePen,label:"Editar",onClick:e=>ie(e)},{icon:Trash2,label:"Eliminar",onClick:e=>(e=>{A(e),q(!0)})(e)}];return jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6 p-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:t}),jsxRuntimeExports.jsx("p",{className:"mt-1 text-sm text-gray-500",children:a})]}),jsxRuntimeExports.jsx(ButtonUI,{icon:PlusCircle,title:"Nuevo Mantenimiento "+("preventive"===e?"Preventivo":"Correctivo"),onClick:()=>ie(),borderColor:"var(--color-primary-admin)",textColor:"#ffffff",className:"bg-primary hover:bg-primary/90"})]}),jsxRuntimeExports.jsxs(Expandex,{title:"Filtros de búsqueda",initialExpanded:!0,expandIcon:Filter,backgroundColor:"#f9fafb",className:"mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[jsxRuntimeExports.jsx(SelectUI$1,{id:"company",label:"Empresa",value:O,onChange:te()?()=>{}:e=>__async(this,null,function*(){const t=Number(e);$(t),oe("condoId",void 0),-1!==t?yield re(t):k([])}),options:P.filter(e=>void 0!==e.companyId).map(e=>({value:e.companyId,label:e.name})),placeholder:"Seleccione una empresa",required:!0,includeAll:!0,disabled:te()||U}),jsxRuntimeExports.jsx(SelectUI$1,{id:"condoId",label:"Condominio",value:(null==(l=J.condoId)?void 0:l.toString())||"-1",onChange:te()?()=>{}:e=>oe("condoId",Number(e)),options:[{value:"-1",label:"Todos los condominios"},...M.map(e=>({value:e.condoId.toString(),label:e.name}))],placeholder:"Seleccione condominio",disabled:te()||-1===O}),jsxRuntimeExports.jsx(SelectUI$1,{id:"maintenanceTypeId",label:"Tipo de Mantenimiento",value:(null==(c=J.maintenanceTypeId)?void 0:c.toString())||"-1",onChange:e=>oe("maintenanceTypeId",Number(e)),options:[{value:"-1",label:"Todos los tipos"},...mockMaintenanceTypes.map(e=>({value:e.id.toString(),label:e.name}))],placeholder:"Seleccione tipo"}),jsxRuntimeExports.jsx(SelectUI$1,{id:"statusTypeId",label:"Estado",value:(null==(d=J.statusTypeId)?void 0:d.toString())||"-1",onChange:e=>oe("statusTypeId",Number(e)),options:[{value:"-1",label:"Todos los estados"},...mockMaintenanceStatuses.map(e=>({value:e.id.toString(),label:e.name}))],placeholder:"Seleccione estado"}),jsxRuntimeExports.jsx(SelectUI$1,{id:"userId",label:"Asignado a",value:(null==(u=J.userId)?void 0:u.toString())||"-1",onChange:e=>oe("userId",Number(e)),options:[{value:"-1",label:"Todos los técnicos"},...mockMaintenanceStaff.map(e=>({value:e.userId.toString(),label:e.name}))],placeholder:"Seleccione técnico"}),jsxRuntimeExports.jsx(DatepickerUI,{id:"fromDate",label:"Desde",value:J.fromDate?format(J.fromDate,"yyyy-MM-dd"):"",onChange:e=>{const t="string"==typeof e?e:Array.isArray(e)?e[0]:"";oe("fromDate",t?new Date(t):void 0)},placeholder:"Fecha inicial"}),jsxRuntimeExports.jsx(DatepickerUI,{id:"toDate",label:"Hasta",value:J.toDate?format(J.toDate,"yyyy-MM-dd"):"",onChange:e=>{const t="string"==typeof e?e:Array.isArray(e)?e[0]:"";oe("toDate",t?new Date(t):void 0)},placeholder:"Fecha final"})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end mt-4 space-x-2",children:[jsxRuntimeExports.jsx(ButtonUI,{title:"Limpiar",onClick:()=>{X({condoId:void 0,maintenanceTypeId:void 0,statusTypeId:void 0,userId:void 0,fromDate:void 0,toDate:void 0}),N(1),setTimeout(()=>{se()},0)},borderColor:"var(--color-action-cancel)",textColor:"var(--color-action-cancel)",className:"hover:bg-gray-50"}),jsxRuntimeExports.jsx(ButtonUI,{title:"Aplicar Filtros",onClick:()=>{N(1),se()},borderColor:"var(--color-primary-admin)",textColor:"#ffffff",className:"bg-primary hover:bg-primary/90"})]})]}),Z&&jsxRuntimeExports.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-6",children:Z}),jsxRuntimeExports.jsx(DataGrid,{data:j,columns:le,actions:ce,onPageChange:e=>N(e),onPageSizeChange:e=>T(e),initialPage:_,initialPageSize:C,totalRecords:I}),jsxRuntimeExports.jsxs("div",{className:"mt-8 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center mb-3",children:[jsxRuntimeExports.jsx(Wrench,{className:"text-gray-600 mr-2",size:18}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"preventive"===e?"Acerca de los Mantenimientos Preventivos":"Acerca de los Mantenimientos Correctivos"})]}),jsxRuntimeExports.jsxs("div",{className:"text-sm text-gray-600",children:[jsxRuntimeExports.jsx("p",{className:"mb-2",children:o}),jsxRuntimeExports.jsxs("div",{className:"mt-3 grid grid-cols-2 md:grid-cols-4 gap-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-300 mr-2"}),jsxRuntimeExports.jsxs("span",{children:["Pendiente: ","preventive"===e?"Programado sin asignar":"Reportado sin asignar"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-300 mr-2"}),jsxRuntimeExports.jsx("span",{children:"Programado: Con fecha y hora"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full bg-indigo-300 mr-2"}),jsxRuntimeExports.jsx("span",{children:"En Progreso: En ejecución"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full bg-green-300 mr-2"}),jsxRuntimeExports.jsx("span",{children:"Completado: Finalizado"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full bg-red-300 mr-2"}),jsxRuntimeExports.jsx("span",{children:"Cancelado: No realizado"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full bg-purple-300 mr-2"}),jsxRuntimeExports.jsx("span",{children:"Reprogramado: Nueva fecha"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full bg-orange-300 mr-2"}),jsxRuntimeExports.jsx("span",{children:"Retrasado: Fuera de plazo"})]})]})]})]}),jsxRuntimeExports.jsx(ModalUI,{isOpen:V,onClose:()=>W(!1),title:`Detalles de Mantenimiento #${(null==D?void 0:D.maintenanceId)||""}`,size:"2xl",footer:jsxRuntimeExports.jsx("div",{className:"flex justify-end space-x-3",children:jsxRuntimeExports.jsx(ButtonUI,{icon:X$1,title:"Cerrar",onClick:()=>W(!1),borderColor:"#6B7280",textColor:"#6B7280",className:"hover:bg-gray-50"})}),children:D&&jsxRuntimeExports.jsxs("div",{className:"p-4",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold w-32",children:"ID:"}),jsxRuntimeExports.jsxs("span",{children:["#",D.maintenanceId]})]}),jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold w-32",children:"Título:"}),jsxRuntimeExports.jsx("span",{children:D.title})]}),jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold w-32",children:"Condominio:"}),jsxRuntimeExports.jsx("span",{children:D.condoName})]}),jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold w-32",children:"Área Común:"}),jsxRuntimeExports.jsx("span",{children:D.commonAreaName})]}),jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold w-32",children:"Tipo:"}),jsxRuntimeExports.jsx("span",{children:D.maintenanceTypeName})]}),jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold w-32",children:"Asignado a:"}),jsxRuntimeExports.jsx("span",{children:D.userName})]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold w-32",children:"Estado:"}),jsxRuntimeExports.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium \n                    ${D.statusTypeId===MaintenanceStatusEnum.Pending?"bg-yellow-100 text-yellow-800":""}\n                    ${D.statusTypeId===MaintenanceStatusEnum.Scheduled?"bg-blue-100 text-blue-800":""}\n                    ${D.statusTypeId===MaintenanceStatusEnum.InProgress?"bg-indigo-100 text-indigo-800":""}\n                    ${D.statusTypeId===MaintenanceStatusEnum.Completed?"bg-green-100 text-green-800":""}\n                    ${D.statusTypeId===MaintenanceStatusEnum.Cancelled?"bg-red-100 text-red-800":""}\n                    ${D.statusTypeId===MaintenanceStatusEnum.Rescheduled?"bg-purple-100 text-purple-800":""}\n                    ${D.statusTypeId===MaintenanceStatusEnum.Delayed?"bg-orange-100 text-orange-800":""}\n                  `,children:D.statusName})]}),jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold w-32",children:"Fecha:"}),jsxRuntimeExports.jsx("span",{children:ne(D.maintenanceDate)})]}),jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold w-32",children:"Horario:"}),jsxRuntimeExports.jsxs("span",{children:[D.startTime.substring(0,5)," - ",D.endTime.substring(0,5)]})]}),n&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold w-32",children:"Frecuencia:"}),jsxRuntimeExports.jsx("span",{children:D.frequencyInDays?`${D.frequencyInDays} días`:"No aplica"})]}),jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold w-32",children:"Próxima fecha:"}),jsxRuntimeExports.jsx("span",{children:D.nextScheduledDate?ne(D.nextScheduledDate):"No programada"})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold w-32",children:"Creado por:"}),jsxRuntimeExports.jsx("span",{children:D.createdBy})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold mb-2",children:"Descripción:"}),jsxRuntimeExports.jsx("div",{className:"bg-gray-50 p-3 rounded border border-gray-200",children:D.description||"Sin descripción"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold mb-2",children:"Notas/Observaciones:"}),jsxRuntimeExports.jsx("div",{className:"bg-gray-50 p-3 rounded border border-gray-200",children:D.notes||"Sin notas"})]}),jsxRuntimeExports.jsxs("div",{className:"mt-6 border-t pt-4 flex justify-between text-sm text-gray-500",children:[jsxRuntimeExports.jsxs("div",{children:["Creado: ",ne(D.createdAt)]}),D.updatedAt&&jsxRuntimeExports.jsxs("div",{children:["Última actualización: ",ne(D.updatedAt)]})]})]})}),jsxRuntimeExports.jsx(ModalUI,{isOpen:Y,onClose:()=>K(!1),title:"Actualizar Progreso de Mantenimiento",size:"lg",footer:jsxRuntimeExports.jsxs("div",{className:"flex justify-between w-full",children:[jsxRuntimeExports.jsx(ButtonUI,{icon:X$1,title:"Cancelar",onClick:()=>K(!1),theme:"modalCancel"}),jsxRuntimeExports.jsx(ButtonUI,{icon:CheckCircle,title:"Guardar",onClick:()=>{if(D){const e=__spreadProps(__spreadValues({},D),{statusTypeId:MaintenanceStatusEnum.Completed,statusName:"Completado",notes:D.notes?`${D.notes}\n${(new Date).toLocaleString()} - Mantenimiento completado.`:`${(new Date).toLocaleString()} - Mantenimiento completado.`,updatedAt:(new Date).toISOString(),updatedBy:"Usuario Actual"});updateMaintenance(e)?(b("success","Estado del mantenimiento actualizado correctamente"),se(),K(!1)):b("error","Error al actualizar el estado del mantenimiento")}},borderColor:"#629E3E",textColor:"#ffffff",className:"bg-primary hover:bg-primary/90"})]}),children:D&&jsxRuntimeExports.jsxs("div",{className:"p-4",children:[jsxRuntimeExports.jsxs("div",{className:"mb-4",children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold text-lg mb-2",children:D.title}),jsxRuntimeExports.jsx("p",{className:"text-gray-600",children:D.description})]}),jsxRuntimeExports.jsx("div",{className:"mb-4",children:jsxRuntimeExports.jsx(SelectUI$1,{id:"progressStatus",label:"Actualizar Estado",value:D.statusTypeId.toString(),onChange:e=>{var t;if(D){const a=Number(e),r=(null==(t=mockMaintenanceStatuses.find(e=>e.id===a))?void 0:t.name)||"";A(__spreadProps(__spreadValues({},D),{statusTypeId:a,statusName:r}))}},options:mockMaintenanceStatuses.filter(e=>e.id!==D.statusTypeId).map(e=>({value:e.id.toString(),label:e.name})),required:!0})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium mb-1",children:"Notas de Actualización"}),jsxRuntimeExports.jsx("textarea",{rows:4,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary focus:ring-primary sm:text-sm",placeholder:"Ingrese notas o comentarios sobre el avance del mantenimiento",value:D.notes||"",onChange:e=>{D&&A(__spreadProps(__spreadValues({},D),{notes:e.target.value}))}})]})]})}),jsxRuntimeExports.jsx(ModalUI,{isOpen:G,onClose:()=>q(!1),title:"Confirmar Eliminación",size:"md",footer:jsxRuntimeExports.jsxs("div",{className:"flex justify-between w-full",children:[jsxRuntimeExports.jsx(ButtonUI,{title:"Cancelar",onClick:()=>q(!1),borderColor:"#6B7280",textColor:"#6B7280",className:"hover:bg-gray-50"}),jsxRuntimeExports.jsx(ButtonUI,{icon:Trash2,title:"Eliminar",onClick:()=>{D&&(deleteMaintenance(D.maintenanceId)?(b("success","Mantenimiento eliminado correctamente"),se(),q(!1)):b("error","Error al eliminar el mantenimiento"))},theme:"delete"})]}),children:jsxRuntimeExports.jsxs("div",{className:"p-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center mb-4",children:[jsxRuntimeExports.jsx("div",{className:"rounded-full bg-red-100 p-2 mr-3",children:jsxRuntimeExports.jsx(Trash2,{className:"h-5 w-5 text-red-600"})}),jsxRuntimeExports.jsx("p",{className:"text-gray-700",children:"¿Está seguro de que desea eliminar este mantenimiento? Esta acción no se puede deshacer."})]}),D&&jsxRuntimeExports.jsxs("div",{className:"bg-gray-50 p-3 rounded border border-gray-200 text-sm",children:[jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"ID:"})," #",D.maintenanceId]}),jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Título:"})," ",D.title]}),jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Fecha:"})," ",ne(D.maintenanceDate)]}),jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Área:"})," ",D.commonAreaName]})]})]})}),jsxRuntimeExports.jsx(ModalUI,{isOpen:z,onClose:()=>H(!1),title:D?"Editar Mantenimiento":"Nuevo Mantenimiento "+("preventive"===e?"Preventivo":"Correctivo"),size:"2xl",footer:jsxRuntimeExports.jsxs("div",{className:"flex justify-between w-full",children:[jsxRuntimeExports.jsx(ButtonUI,{icon:X$1,title:"Cancelar",onClick:()=>H(!1),theme:"modalCancel"}),jsxRuntimeExports.jsx(ButtonUI,{icon:CheckCircle,title:"Guardar",onClick:()=>{if(D)updateMaintenance(D)?(b("success","Mantenimiento actualizado correctamente"),se(),H(!1)):b("error","Error al actualizar el mantenimiento");else{const t=__spreadProps(__spreadValues({},i),{maintenanceId:0,createdAt:(new Date).toISOString(),createdBy:"Usuario Actual",isDeleted:!1}),a=addMaintenance(t);a?(b("success",`Mantenimiento ${"preventive"===e?"preventivo":"correctivo"} #${a.maintenanceId} creado correctamente`),se(),H(!1)):b("error","Error al crear el mantenimiento")}},borderColor:"#629E3E",textColor:"#ffffff",className:"bg-primary hover:bg-primary/90"})]}),children:jsxRuntimeExports.jsxs("div",{className:"p-4",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(InputUI,{id:"title",label:"Título",type:"text",value:(null==D?void 0:D.title)||"",onChange:e=>{D&&A(__spreadProps(__spreadValues({},D),{title:e}))},placeholder:"Título del mantenimiento",required:!0})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(SelectUI$1,{id:"maintenanceTypeId",label:"Tipo de Mantenimiento",value:(null==(m=null==D?void 0:D.maintenanceTypeId)?void 0:m.toString())||mockMaintenanceTypes[0].id.toString(),onChange:e=>{var t;if(D){const a=Number(e),r=(null==(t=mockMaintenanceTypes.find(e=>e.id===a))?void 0:t.name)||"";A(__spreadProps(__spreadValues({},D),{maintenanceTypeId:a,maintenanceTypeName:r}))}},options:mockMaintenanceTypes.map(e=>({value:e.id.toString(),label:e.name})),required:!0})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(SelectUI$1,{id:"condoId",label:"Condominio",value:(null==(p=null==D?void 0:D.condoId)?void 0:p.toString())||mockCondominiums$1[0].condoId.toString(),onChange:e=>{var t;if(D){const a=Number(e),r=(null==(t=mockCondominiums$1.find(e=>e.condoId===a))?void 0:t.name)||"";A(__spreadProps(__spreadValues({},D),{condoId:a,condoName:r,commonAreaId:void 0,commonAreaName:void 0}))}},options:mockCondominiums$1.map(e=>({value:e.condoId.toString(),label:e.name})),required:!0})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(SelectUI$1,{id:"commonAreaId",label:"Área Común",value:(null==(x=null==D?void 0:D.commonAreaId)?void 0:x.toString())||"",onChange:e=>{var t;if(D){const a=Number(e),r=(null==(t=mockCommonAreas.find(e=>e.commonAreaId===a))?void 0:t.name)||"";A(__spreadProps(__spreadValues({},D),{commonAreaId:a,commonAreaName:r}))}},options:mockCommonAreas.filter(e=>e.condoId===((null==D?void 0:D.condoId)||mockCondominiums$1[0].condoId)).map(e=>({value:e.commonAreaId.toString(),label:e.name})),required:!0})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(DatepickerUI,{id:"maintenanceDate",label:"Fecha de Mantenimiento",value:(null==D?void 0:D.maintenanceDate)?ne(D.maintenanceDate).split("/").reverse().join("-"):"",onChange:e=>{if(D&&e){const t="string"==typeof e?e:Array.isArray(e)?e[0]:"";A(__spreadProps(__spreadValues({},D),{maintenanceDate:t?new Date(t).toISOString():D.maintenanceDate}))}},required:!0})}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Hora Inicio ",jsxRuntimeExports.jsx("span",{className:"text-warning",children:"*"})]}),jsxRuntimeExports.jsx("input",{type:"time",className:"w-full px-4 py-3 bg-white border border-gray-300 rounded-lg transition-all duration-200 focus:ring-2 focus:ring-primary focus:border-primary hover:border-primary focus:outline-none",value:(null==(h=null==D?void 0:D.startTime)?void 0:h.substring(0,5))||"09:00",onChange:e=>{D&&A(__spreadProps(__spreadValues({},D),{startTime:e.target.value+":00"}))},required:!0})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Hora Fin ",jsxRuntimeExports.jsx("span",{className:"text-warning",children:"*"})]}),jsxRuntimeExports.jsx("input",{type:"time",className:"w-full px-4 py-3 bg-white border border-gray-300 rounded-lg transition-all duration-200 focus:ring-2 focus:ring-primary focus:border-primary hover:border-primary focus:outline-none",value:(null==(g=null==D?void 0:D.endTime)?void 0:g.substring(0,5))||"12:00",onChange:e=>{D&&A(__spreadProps(__spreadValues({},D),{endTime:e.target.value+":00"}))},required:!0})]})]}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(SelectUI$1,{id:"userId",label:"Asignar a",value:(null==(y=null==D?void 0:D.userId)?void 0:y.toString())||mockMaintenanceStaff[0].userId.toString(),onChange:e=>{var t;if(D){const a=Number(e),r=(null==(t=mockMaintenanceStaff.find(e=>e.userId===a))?void 0:t.name)||"";A(__spreadProps(__spreadValues({},D),{userId:a,userName:r}))}},options:mockMaintenanceStaff.map(e=>({value:e.userId.toString(),label:`${e.name} (${e.specialties})`})),required:!0})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(SelectUI$1,{id:"statusTypeId",label:"Estado",value:(null==(v=null==D?void 0:D.statusTypeId)?void 0:v.toString())||MaintenanceStatusEnum.Pending.toString(),onChange:e=>{var t;if(D){const a=Number(e),r=(null==(t=mockMaintenanceStatuses.find(e=>e.id===a))?void 0:t.name)||"";A(__spreadProps(__spreadValues({},D),{statusTypeId:a,statusName:r}))}},options:mockMaintenanceStatuses.map(e=>({value:e.id.toString(),label:e.name})),required:!0})}),n&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(InputUI,{id:"frequencyInDays",label:"Frecuencia (días)",type:"number",value:(null==(E=null==D?void 0:D.frequencyInDays)?void 0:E.toString())||"30",onChange:e=>{if(D){const t=Number(e),a=new Date(D.maintenanceDate);a.setDate(a.getDate()+t),A(__spreadProps(__spreadValues({},D),{frequencyInDays:t,nextScheduledDate:a.toISOString()}))}},placeholder:"Días entre mantenimientos",required:!0})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(DatepickerUI,{id:"nextScheduledDate",label:"Próxima Fecha Programada",value:(null==D?void 0:D.nextScheduledDate)?ne(D.nextScheduledDate).split("/").reverse().join("-"):"",onChange:e=>{if(D&&e){const t="string"==typeof e?e:Array.isArray(e)?e[0]:"";A(__spreadProps(__spreadValues({},D),{nextScheduledDate:t?new Date(t).toISOString():D.nextScheduledDate}))}},required:!0})})]})]}),jsxRuntimeExports.jsxs("div",{className:"mt-4",children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium mb-1",children:"Descripción"}),jsxRuntimeExports.jsx("textarea",{rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary focus:ring-primary sm:text-sm",placeholder:"Descripción detallada del mantenimiento",value:(null==D?void 0:D.description)||"",onChange:e=>{D&&A(__spreadProps(__spreadValues({},D),{description:e.target.value}))}})]}),jsxRuntimeExports.jsxs("div",{className:"mt-4",children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium mb-1",children:"Notas/Observaciones"}),jsxRuntimeExports.jsx("textarea",{rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary focus:ring-primary sm:text-sm",placeholder:"Notas adicionales o comentarios",value:(null==D?void 0:D.notes)||"",onChange:e=>{D&&A(__spreadProps(__spreadValues({},D),{notes:e.target.value}))}})]})]})})]})}function PreventiveMaintenance(){return jsxRuntimeExports.jsx(MaintenanceBaseWrapper,{type:"preventive",title:"Mantenimientos Preventivos",description:"Gestión de mantenimientos programados periódicos",getDataFunction:getPreventiveMaintenance,sortOrder:"asc",showFrequencyFields:!0,defaultValues:{title:"",description:"Descripción del mantenimiento",statusTypeId:MaintenanceStatusEnum.Pending,statusName:"Pendiente",isPreventive:!0,frequencyInDays:30,startTime:"09:00:00",endTime:"12:00:00"},infoText:"Los mantenimientos preventivos son trabajos programados de forma regular para evitar fallos y mantener el funcionamiento óptimo de las instalaciones. Estos se realizan de forma periódica según una frecuencia establecida."})}function CorrectiveMaintenance(){return jsxRuntimeExports.jsx(MaintenanceBaseWrapper,{type:"corrective",title:"Mantenimientos Correctivos",description:"Gestión de reparaciones y mantenimientos no programados",getDataFunction:getCorrectiveMaintenance,sortOrder:"desc",showFrequencyFields:!1,defaultValues:{title:"",description:"Descripción del mantenimiento correctivo",statusTypeId:MaintenanceStatusEnum.Pending,statusName:"Pendiente",isPreventive:!1,startTime:"09:00:00",endTime:"12:00:00"},infoText:"Los mantenimientos correctivos son reparaciones o intervenciones no programadas que responden a fallos, averías o necesidades urgentes en las instalaciones. Estos no siguen una periodicidad establecida."})}const mockDocumentTypes=[{documentTypeId:1,documentName:"Comunicado Oficial",description:"Comunicados oficiales de la administración del condominio"},{documentTypeId:2,documentName:"Reglamento",description:"Reglamentos internos y normas del condominio"},{documentTypeId:3,documentName:"Estado Financiero",description:"Documentos relacionados a los estados financieros del condominio"},{documentTypeId:4,documentName:"Acta de Reunión",description:"Actas de reuniones de copropietarios"},{documentTypeId:5,documentName:"Manual de Usuario",description:"Manuales para el uso de instalaciones y servicios"},{documentTypeId:6,documentName:"Circular Informativa",description:"Circulares con información relevante para los residentes"}],getDocumentTypeById=e=>mockDocumentTypes.find(t=>t.documentTypeId===e),getDocumentTypeName=e=>{const t=getDocumentTypeById(e);return t?t.documentName:"Desconocido"},mockDocuments=[{documentId:1,condoId:1,title:"Reglamento de Convivencia 2023",fileUrl:"https://example.com/files/reglamento2023.pdf",fileType:"application/pdf",documentTypeId:2,description:"Actualización del reglamento de convivencia del condominio para el año 2023",isPublic:!0,uploadDate:new Date(2023,0,15).toISOString(),uploadedByUserId:1,isDeleted:!1},{documentId:2,condoId:1,title:"Circular: Corte de agua programado",fileUrl:"https://example.com/files/circular_agua.pdf",fileType:"application/pdf",documentTypeId:6,description:"Información sobre corte de agua programado para mantenimiento de tuberías el día 25/04/2023",isPublic:!0,uploadDate:new Date(2023,3,20).toISOString(),uploadedByUserId:2,isDeleted:!1},{documentId:3,condoId:2,title:"Estado Financiero Primer Trimestre 2023",fileUrl:"https://example.com/files/finanzas_q1_2023.xlsx",fileType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",documentTypeId:3,description:"Informe financiero del primer trimestre del año 2023",isPublic:!0,uploadDate:new Date(2023,3,10).toISOString(),uploadedByUserId:1,isDeleted:!1},{documentId:4,condoId:1,title:"Acta de Asamblea General Ordinaria",fileUrl:"https://example.com/files/acta_asamblea_2023.pdf",fileType:"application/pdf",documentTypeId:4,description:"Acta de la asamblea general ordinaria de propietarios realizada el 05/03/2023",isPublic:!0,uploadDate:new Date(2023,2,10).toISOString(),uploadedByUserId:3,isDeleted:!1},{documentId:5,condoId:3,title:"Manual de Uso de Piscina",fileUrl:"https://example.com/files/manual_piscina.pdf",fileType:"application/pdf",documentTypeId:5,description:"Instructivo para el uso adecuado de la piscina y normas de seguridad",isPublic:!0,uploadDate:new Date(2023,4,5).toISOString(),uploadedByUserId:2,isDeleted:!1},{documentId:6,condoId:1,title:"Comunicado: Nuevas medidas de seguridad",fileUrl:"https://example.com/files/seguridad.pdf",fileType:"application/pdf",documentTypeId:1,description:"Información sobre las nuevas medidas de seguridad implementadas en el condominio",isPublic:!0,uploadDate:new Date(2023,4,12).toISOString(),uploadedByUserId:1,isDeleted:!1},{documentId:7,condoId:2,title:"Circular: Mantenimiento de ascensores",fileUrl:"https://example.com/files/circular_ascensores.pdf",fileType:"application/pdf",documentTypeId:6,description:"Cronograma de mantenimiento de ascensores para los próximos meses",isPublic:!0,uploadDate:new Date(2023,4,20).toISOString(),uploadedByUserId:3,isDeleted:!1},{documentId:8,condoId:3,title:"Reglamento de uso de áreas comunes",fileUrl:"https://example.com/files/areas_comunes.pdf",fileType:"application/pdf",documentTypeId:2,description:"Normativa actualizada para el uso de las áreas comunes del condominio",isPublic:!0,uploadDate:new Date(2023,1,28).toISOString(),uploadedByUserId:2,isDeleted:!1},{documentId:9,condoId:1,title:"Estado Financiero Segundo Trimestre 2023",fileUrl:"https://example.com/files/finanzas_q2_2023.xlsx",fileType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",documentTypeId:3,description:"Informe financiero del segundo trimestre del año 2023",isPublic:!1,uploadDate:new Date(2023,6,15).toISOString(),uploadedByUserId:1,isDeleted:!1},{documentId:10,condoId:2,title:"Comunicado: Proyecto de renovación de jardines",fileUrl:"https://example.com/files/proyecto_jardines.pdf",fileType:"application/pdf",documentTypeId:1,description:"Presentación del proyecto de renovación de áreas verdes y jardines del condominio",isPublic:!0,uploadDate:new Date(2023,5,10).toISOString(),uploadedByUserId:3,isDeleted:!1}],getFilteredDocuments=(e,t,a,r,s,n,i=1,o=10)=>{let l=[...mockDocuments].filter(e=>!e.isDeleted);if(void 0!==e&&(l=l.filter(t=>t.condoId===e)),void 0!==t&&(l=l.filter(e=>e.documentTypeId===t)),void 0!==a&&(l=l.filter(e=>e.isPublic===a)),r){const e=r.toLowerCase();l=l.filter(t=>{var a;return(null==(a=t.title)?void 0:a.toLowerCase().includes(e))||!1})}if(s&&(l=l.filter(e=>new Date(e.uploadDate)>=s)),n){const e=new Date(n);e.setDate(e.getDate()+1),l=l.filter(t=>new Date(t.uploadDate)<e)}l.sort((e,t)=>new Date(t.uploadDate).getTime()-new Date(e.uploadDate).getTime());const c=l.length,d=(i-1)*o,u=Math.min(d+o,c);return{documents:l.slice(d,u),totalCount:c,pageSize:o,currentPage:i,totalPages:Math.ceil(c/o)}},createDocument=e=>{const t={documentId:Math.max(...mockDocuments.map(e=>e.documentId),0)+1,condoId:e.condoId,title:e.title||"",fileUrl:e.fileUrl||"",fileType:e.fileType||"",documentTypeId:e.documentTypeId,description:e.description||"",isPublic:e.isPublic,uploadDate:e.uploadDate||(new Date).toISOString(),uploadedByUserId:e.uploadedByUserId,isDeleted:!1};return mockDocuments.push(t),t},updateDocument=e=>{var t,a,r,s,n,i,o;const l=mockDocuments.findIndex(t=>t.documentId===e.documentId);if(-1===l)return!1;const c=mockDocuments[l];return mockDocuments[l]=__spreadProps(__spreadValues({},c),{condoId:null!=(t=e.condoId)?t:c.condoId,title:null!=(a=e.title)?a:c.title,fileUrl:null!=(r=e.fileUrl)?r:c.fileUrl,fileType:null!=(s=e.fileType)?s:c.fileType,documentTypeId:null!=(n=e.documentTypeId)?n:c.documentTypeId,description:null!=(i=e.description)?i:c.description,isPublic:null!=(o=e.isPublic)?o:c.isPublic}),!0},deleteDocument=e=>{const t=mockDocuments.findIndex(t=>t.documentId===e);return-1!==t&&(mockDocuments[t]=__spreadProps(__spreadValues({},mockDocuments[t]),{isDeleted:!0}),!0)},mockCondominiums=[{condoId:1,companyId:1,name:"Residencial Las Palmas",address:"Av. Las Palmeras 789, San Isidro",latitude:-12.0964,longitude:-77.0349,totalUnits:50,totalFloors:15,amenities:"Piscina, Gimnasio, Sala de eventos",parkingSpaces:60,securityFeatures:"24/7 vigilancia, cámaras CCTV",contactEmail:"admin@laspalmas.com",contactPhone:"+51 999 666 555",websiteUrl:"https://laspalmas.com",createdAt:new Date("2024-02-01"),createdBy:"admin",isDeleted:!1},{condoId:2,companyId:1,name:"Condominio El Mirador",address:"Calle Mirador 321, Miraflores",latitude:-12.1219,longitude:-77.0299,totalUnits:30,totalFloors:10,amenities:"Terraza, BBQ, Juegos infantiles",parkingSpaces:35,securityFeatures:"Control de acceso biométrico",contactEmail:"admin@elmirador.com",contactPhone:"+51 999 555 444",websiteUrl:"https://elmirador.com",createdAt:new Date("2024-02-15"),createdBy:"admin",isDeleted:!1}];function InformationPage(){return jsxRuntimeExports.jsx(AlertProvider,{children:jsxRuntimeExports.jsx(InformationPageContent,{})})}function InformationPageContent(){var e,t,a,r,s;const{setLoading:n}=useLoading(),{showToast:i}=useAlerts(),[o,l]=reactExports.useState([]),[c,d]=reactExports.useState(0),[u,m]=reactExports.useState(1),[p,x]=reactExports.useState(10),[h,g]=reactExports.useState(null),[y,v]=reactExports.useState([]),[E,f]=reactExports.useState([]),[b,j]=reactExports.useState(-1),[R,I]=reactExports.useState(!0),S=new ManagementCompanyService,_=new CondominiumService,[N,C]=reactExports.useState(!1),[T,D]=reactExports.useState(!1),[A,P]=reactExports.useState(!1),[w,M]=reactExports.useState({condoId:1,title:"",fileUrl:"",fileType:"application/pdf",documentTypeId:1,description:"",isPublic:!0,uploadDate:(new Date).toISOString(),uploadedByUserId:1}),[k,O]=reactExports.useState({condoId:void 0,documentTypeId:void 0,isPublic:void 0,title:void 0,fromDate:void 0,toDate:void 0}),[$,U]=reactExports.useState(null);reactExports.useEffect(()=>{W()},[u,p]),reactExports.useEffect(()=>{(()=>{__async(this,null,function*(){try{n(!0),yield F(),yield L(),I(!1)}catch(e){U("Error al cargar los datos iniciales")}finally{n(!1)}})})()},[]);const L=()=>__async(this,null,function*(){try{(new AuthService).getUser();yield preloadCompanyCondoFilters(e=>{j(Number(e))},(e,t)=>__async(this,null,function*(){"companyId"===e&&"number"==typeof t&&-1!==t&&(yield V(t)),"condoId"===e&&"number"==typeof t&&-1!==t&&G("condoId",t)}),V,"InformationPage")}catch(e){}}),B=()=>shouldDisableCompanyCondoSelects(),F=()=>__async(this,null,function*(){try{n(!0),U(null);const e=yield S.getPaged();if(e.isSuccess&&e.data){const t=e.data;t.items&&Array.isArray(t.items)?v(t.items):v([])}else U(e.error||"Error al cargar las empresas")}catch(e){U("Error al cargar las empresas")}finally{n(!1)}}),V=e=>__async(this,null,function*(){try{n(!0),U(null);const t={CompanyId:e,Page:1,PageSize:100},a=yield _.getPaged(t);if(a.isSuccess&&a.data){const e=a.data;e.items&&Array.isArray(e.items)?f(e.items):e.data&&Array.isArray(e.data)?f(e.data):Array.isArray(e)?f(e):f([])}else U(a.error||"Error al cargar los condominios")}catch(t){U("Error al cargar los condominios")}finally{n(!1)}});reactExports.useEffect(()=>{T&&M(h?{documentId:h.documentId,condoId:h.condoId,title:h.title,fileUrl:h.fileUrl,fileType:h.fileType,documentTypeId:h.documentTypeId,description:h.description,isPublic:h.isPublic,uploadDate:h.uploadDate,uploadedByUserId:h.uploadedByUserId}:{condoId:1,title:"",fileUrl:"",fileType:"application/pdf",documentTypeId:1,description:"",isPublic:!0,uploadDate:(new Date).toISOString(),uploadedByUserId:1})},[T,h]);const W=()=>{try{n(!0),U(null),setTimeout(()=>{const e=getFilteredDocuments(k.condoId,k.documentTypeId,k.isPublic,k.title,k.fromDate,k.toDate,u,p);l(e.documents),d(e.totalCount),n(!1)},300)}catch(e){U("Error al cargar los documentos. Por favor, intente nuevamente."),n(!1)}},z=e=>{if(!e)return"No disponible";try{return format(new Date(e),"dd/MM/yyyy",{locale:es})}catch(t){return"Fecha inválida"}},H=(e,t)=>{M(a=>__spreadProps(__spreadValues({},a),{[e]:t}))},G=(e,t)=>{O(a=>__spreadProps(__spreadValues({},a),{[e]:""===t||"-1"===t?void 0:t}))},q=[{accessorKey:"documentId",header:"ID",cell:({row:e})=>jsxRuntimeExports.jsxs("span",{className:"font-semibold",children:["#",e.original.documentId]})},{accessorKey:"title",header:"Título",cell:({row:e})=>jsxRuntimeExports.jsx("div",{className:"max-w-xs truncate",title:e.original.title||"",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx(FileText,{className:"h-4 w-4 mr-2 text-primary"}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:e.original.title})]})})},{accessorKey:"documentTypeId",header:"Tipo",cell:({row:e})=>jsxRuntimeExports.jsx("span",{className:"font-medium",children:getDocumentTypeName(e.original.documentTypeId)})},{accessorKey:"isPublic",header:"Visibilidad",cell:({row:e})=>jsxRuntimeExports.jsx("div",{className:"flex items-center",children:e.original.isPublic?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Unlock,{className:"h-4 w-4 text-green-600 mr-1"}),jsxRuntimeExports.jsx("span",{className:"text-green-600 text-sm",children:"Público"})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Lock,{className:"h-4 w-4 text-amber-600 mr-1"}),jsxRuntimeExports.jsx("span",{className:"text-amber-600 text-sm",children:"Privado"})]})})},{accessorKey:"fileType",header:"Formato",cell:({row:e})=>{const t=(()=>{if(!e.original.fileType)return"Desconocido";return{"application/pdf":"PDF","application/msword":"Word","application/vnd.openxmlformats-officedocument.wordprocessingml.document":"Word","application/vnd.ms-excel":"Excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"Excel","image/jpeg":"Imagen JPG","image/png":"Imagen PNG","text/plain":"Texto","application/zip":"ZIP"}[e.original.fileType]||e.original.fileType.split("/")[1]||"Archivo"})();return jsxRuntimeExports.jsx("span",{className:"font-medium",children:t})}},{accessorKey:"uploadDate",header:"Fecha de Subida",cell:({getValue:e})=>{const t=e();return jsxRuntimeExports.jsx("span",{className:"font-medium",children:z(t)})}},{accessorKey:"condoId",header:"Condominio",cell:({row:e})=>{const t=mockCondominiums.find(t=>t.condoId===e.original.condoId);return jsxRuntimeExports.jsx("span",{className:"font-medium",children:(null==t?void 0:t.name)||"Desconocido"})}}],Y=[{icon:Eye,label:"Ver Detalles",onClick:e=>(e=>{g(e),C(!0)})(e)},{icon:ExternalLink,label:"Abrir Documento",onClick:e=>window.open(e.fileUrl||"","_blank"),hidden:e=>!e.fileUrl},{icon:SquarePen,label:"Editar",onClick:e=>(e=>{g(e||null),D(!0)})(e)},{icon:Trash2,label:"Eliminar",onClick:e=>(e=>{g(e),P(!0)})(e)}];return jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6 p-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center mb-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Gestión de Información"}),jsxRuntimeExports.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Administre documentos, comunicados y reglamentos para mantener informados a los residentes."})]}),jsxRuntimeExports.jsx(ButtonUI,{icon:Plus,title:"Nuevo Documento",onClick:()=>{g(null),D(!0)},borderColor:"var(--color-primary-admin)",textColor:"#ffffff",className:"bg-primary hover:bg-primary/90"})]}),jsxRuntimeExports.jsxs(Expandex,{title:"Filtros de búsqueda",initialExpanded:!0,expandIcon:Filter,backgroundColor:"#f9fafb",className:"mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[jsxRuntimeExports.jsx(SelectUI$1,{id:"company",label:"Empresa",value:b,onChange:B()?()=>{}:e=>__async(this,null,function*(){const t=Number(e);j(t),G("condoId",void 0),-1!==t?yield V(t):f([])}),options:y.filter(e=>void 0!==e.companyId).map(e=>({value:e.companyId,label:e.name})),placeholder:"Seleccione una empresa",required:!0,includeAll:!0,disabled:B()||R}),jsxRuntimeExports.jsx(SelectUI$1,{id:"condoId",label:"Condominio",value:(null==(e=k.condoId)?void 0:e.toString())||"-1",onChange:B()?()=>{}:e=>G("condoId",Number(e)),options:[{value:"-1",label:"Todos los condominios"},...E.map(e=>({value:e.condoId.toString(),label:e.name}))],placeholder:"Seleccione condominio",disabled:B()||-1===b}),jsxRuntimeExports.jsx(SelectUI$1,{id:"documentTypeId",label:"Tipo de Documento",value:(null==(t=k.documentTypeId)?void 0:t.toString())||"-1",onChange:e=>G("documentTypeId",Number(e)),options:[{value:"-1",label:"Todos los tipos"},...mockDocumentTypes.map(e=>({value:e.documentTypeId.toString(),label:e.documentName||"Sin nombre"}))],placeholder:"Seleccione tipo"}),jsxRuntimeExports.jsx(SelectUI$1,{id:"isPublic",label:"Visibilidad",value:void 0===k.isPublic?"-1":k.isPublic.toString(),onChange:e=>{G("isPublic","-1"===e?void 0:"true"===e)},options:[{value:"-1",label:"Todos"},{value:"true",label:"Públicos"},{value:"false",label:"Privados"}],placeholder:"Seleccione visibilidad"}),jsxRuntimeExports.jsxs("div",{className:"md:col-span-3",children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Título del documento"}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx(Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),jsxRuntimeExports.jsx("input",{type:"text",className:"pl-10 pr-4 py-3 bg-white border border-gray-300 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary",placeholder:"Buscar por título...",value:k.title||"",onChange:e=>G("title",e.target.value)})]})]}),jsxRuntimeExports.jsx(DatepickerUI,{id:"fromDate",label:"Desde",value:k.fromDate?format(k.fromDate,"yyyy-MM-dd"):"",onChange:e=>{const t="string"==typeof e?e:Array.isArray(e)?e[0]:"";G("fromDate",t?new Date(t):void 0)},placeholder:"Fecha inicial"}),jsxRuntimeExports.jsx(DatepickerUI,{id:"toDate",label:"Hasta",value:k.toDate?format(k.toDate,"yyyy-MM-dd"):"",onChange:e=>{const t="string"==typeof e?e:Array.isArray(e)?e[0]:"";G("toDate",t?new Date(t):void 0)},placeholder:"Fecha final"})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end mt-4 space-x-2",children:[jsxRuntimeExports.jsx(ButtonUI,{title:"Limpiar",icon:RotateCcw,onClick:()=>{O({condoId:void 0,documentTypeId:void 0,isPublic:void 0,title:void 0,fromDate:void 0,toDate:void 0}),m(1),setTimeout(()=>{W()},0)},theme:"cancel"}),jsxRuntimeExports.jsx(ButtonUI,{title:"Aplicar Filtros",icon:Search,onClick:()=>{m(1),W()},theme:"primary"})]})]}),$&&jsxRuntimeExports.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-6",children:$}),jsxRuntimeExports.jsx(DataGrid,{data:o,columns:q,actions:Y,onPageChange:e=>m(e),onPageSizeChange:e=>x(e),initialPage:u,initialPageSize:p,totalRecords:c}),jsxRuntimeExports.jsxs("div",{className:"mt-8 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center mb-3",children:[jsxRuntimeExports.jsx(FileText,{className:"text-gray-600 mr-2",size:18}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Sobre la Gestión de Información"})]}),jsxRuntimeExports.jsxs("div",{className:"text-sm text-gray-600",children:[jsxRuntimeExports.jsx("p",{className:"mb-2",children:"Este módulo permite administrar documentos importantes y comunicados para los residentes del condominio. Puede crear, actualizar, eliminar y gestionar el acceso a diferentes tipos de documentos como reglamentos, circulares informativas, actas de reuniones, estados financieros y más."}),jsxRuntimeExports.jsxs("div",{className:"mt-3 grid grid-cols-2 md:grid-cols-4 gap-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full bg-green-300 mr-2"}),jsxRuntimeExports.jsx("span",{children:"Públicos: Visibles para todos los residentes"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full bg-amber-300 mr-2"}),jsxRuntimeExports.jsx("span",{children:"Privados: Solo para administración"})]})]})]})]}),jsxRuntimeExports.jsx(ModalUI,{isOpen:N,onClose:()=>C(!1),title:"Detalles del Documento",size:"2xl",footer:jsxRuntimeExports.jsxs("div",{className:"flex justify-end space-x-3",children:[(null==h?void 0:h.fileUrl)&&jsxRuntimeExports.jsx(ButtonUI,{icon:ExternalLink,title:"Abrir Documento",onClick:()=>window.open(h.fileUrl||"","_blank"),theme:"primary"}),jsxRuntimeExports.jsx(ButtonUI,{icon:X$1,title:"Cerrar",onClick:()=>C(!1),theme:"cancel"})]}),children:h&&jsxRuntimeExports.jsxs("div",{className:"p-4",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold w-32",children:"ID:"}),jsxRuntimeExports.jsxs("span",{children:["#",h.documentId]})]}),jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold w-32",children:"Título:"}),jsxRuntimeExports.jsx("span",{children:h.title})]}),jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold w-32",children:"Tipo:"}),jsxRuntimeExports.jsx("span",{children:getDocumentTypeName(h.documentTypeId)})]}),jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold w-32",children:"Visibilidad:"}),jsxRuntimeExports.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+(h.isPublic?"bg-green-100 text-green-800":"bg-amber-100 text-amber-800"),children:h.isPublic?"Público":"Privado"})]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold w-32",children:"Condominio:"}),jsxRuntimeExports.jsx("span",{children:(null==(a=mockCondominiums.find(e=>e.condoId===h.condoId))?void 0:a.name)||"Desconocido"})]}),jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold w-32",children:"Formato:"}),jsxRuntimeExports.jsx("span",{children:(()=>{if(!h.fileType)return"Desconocido";return{"application/pdf":"PDF","application/msword":"Word","application/vnd.openxmlformats-officedocument.wordprocessingml.document":"Word","application/vnd.ms-excel":"Excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"Excel","image/jpeg":"Imagen JPG","image/png":"Imagen PNG","text/plain":"Texto","application/zip":"ZIP"}[h.fileType]||h.fileType.split("/")[1]||"Archivo"})()})]}),jsxRuntimeExports.jsxs("div",{className:"flex",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold w-32",children:"Fecha:"}),jsxRuntimeExports.jsx("span",{children:z(h.uploadDate)})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold mb-2",children:"Descripción:"}),jsxRuntimeExports.jsx("div",{className:"bg-gray-50 p-3 rounded border border-gray-200",children:h.description||"Sin descripción"})]}),h.fileUrl&&jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold mb-2",children:"Enlace al documento:"}),jsxRuntimeExports.jsx("div",{className:"bg-gray-50 p-3 rounded border border-gray-200 break-all",children:jsxRuntimeExports.jsxs("a",{href:h.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline flex items-center",children:[h.fileUrl,jsxRuntimeExports.jsx(ExternalLink,{className:"h-4 w-4 ml-1"})]})})]})]})}),jsxRuntimeExports.jsx(ModalUI,{isOpen:T,onClose:()=>D(!1),title:h?"Editar Documento":"Nuevo Documento",size:"2xl",footer:jsxRuntimeExports.jsxs("div",{className:"flex justify-between w-full",children:[jsxRuntimeExports.jsx(ButtonUI,{icon:X$1,title:"Cancelar",onClick:()=>D(!1),theme:"modalCancel"}),jsxRuntimeExports.jsx(ButtonUI,{icon:CheckCircle,title:"Guardar",onClick:()=>{try{if(n(!0),!w.title||!w.documentTypeId)return i("error","Por favor complete los campos obligatorios"),void n(!1);setTimeout(()=>{let e=!1;if(h)e=updateDocument({documentId:h.documentId,condoId:w.condoId,title:w.title,fileUrl:w.fileUrl,fileType:w.fileType,documentTypeId:w.documentTypeId,description:w.description,isPublic:w.isPublic,routeId:1}),e?i("success","Documento actualizado correctamente"):i("error","Error al actualizar el documento");else{const t=createDocument(w);t?(i("success",`Documento creado correctamente con ID: ${t.documentId}`),e=!0):i("error","Error al crear el documento")}e&&(D(!1),W()),n(!1)},500)}catch(e){i("error","Ocurrió un error inesperado"),n(!1)}},theme:"modalSave"})]}),children:jsxRuntimeExports.jsx("div",{className:"p-4",children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Título ",jsxRuntimeExports.jsx("span",{className:"text-red-500",children:"*"})]}),jsxRuntimeExports.jsx("input",{type:"text",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary focus:ring-primary sm:text-sm",placeholder:"Título del documento",value:w.title||"",onChange:e=>H("title",e.target.value),required:!0})]}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(SelectUI$1,{id:"documentTypeId",label:"Tipo de Documento",value:(null==(r=w.documentTypeId)?void 0:r.toString())||"1",onChange:e=>H("documentTypeId",Number(e)),options:mockDocumentTypes.map(e=>({value:e.documentTypeId.toString(),label:e.documentName||"Sin nombre"})),required:!0})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(SelectUI$1,{id:"condoId",label:"Condominio",value:(null==(s=w.condoId)?void 0:s.toString())||"1",onChange:e=>H("condoId",Number(e)),options:mockCondominiums.map(e=>({value:e.condoId.toString(),label:e.name})),required:!0})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium mb-1",children:"Formato de Archivo"}),jsxRuntimeExports.jsxs("select",{className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary focus:ring-primary sm:text-sm",value:w.fileType||"application/pdf",onChange:e=>H("fileType",e.target.value),children:[jsxRuntimeExports.jsx("option",{value:"application/pdf",children:"PDF"}),jsxRuntimeExports.jsx("option",{value:"application/msword",children:"Word"}),jsxRuntimeExports.jsx("option",{value:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",children:"Word (DOCX)"}),jsxRuntimeExports.jsx("option",{value:"application/vnd.ms-excel",children:"Excel"}),jsxRuntimeExports.jsx("option",{value:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",children:"Excel (XLSX)"}),jsxRuntimeExports.jsx("option",{value:"image/jpeg",children:"Imagen JPG"}),jsxRuntimeExports.jsx("option",{value:"image/png",children:"Imagen PNG"}),jsxRuntimeExports.jsx("option",{value:"text/plain",children:"Texto Plano"}),jsxRuntimeExports.jsx("option",{value:"application/zip",children:"Archivo ZIP"})]})]}),jsxRuntimeExports.jsxs("div",{className:"md:col-span-2",children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium mb-1",children:"URL del Archivo"}),jsxRuntimeExports.jsx("div",{className:"flex",children:jsxRuntimeExports.jsxs("div",{className:"relative flex-grow",children:[jsxRuntimeExports.jsx(Upload,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),jsxRuntimeExports.jsx("input",{type:"text",className:"pl-10 pr-4 py-2 bg-white border border-gray-300 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary",placeholder:"URL del documento (https://...)",value:w.fileUrl||"",onChange:e=>H("fileUrl",e.target.value)})]})}),jsxRuntimeExports.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Ingrese la URL donde se encuentra alojado el documento. En un entorno real, aquí tendríamos un botón para subir el archivo."})]}),jsxRuntimeExports.jsx("div",{className:"md:col-span-2",children:jsxRuntimeExports.jsx(DatepickerUI,{id:"uploadDate",label:"Fecha de Subida",value:w.uploadDate?format(new Date(w.uploadDate),"yyyy-MM-dd"):format(new Date,"yyyy-MM-dd"),onChange:e=>{const t="string"==typeof e?e:Array.isArray(e)?e[0]:"";H("uploadDate",t?new Date(t).toISOString():(new Date).toISOString())},icon:Calendar})}),jsxRuntimeExports.jsx("div",{className:"md:col-span-2",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("input",{id:"isPublic",type:"checkbox",className:"h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded",checked:w.isPublic||!1,onChange:e=>H("isPublic",e.target.checked)}),jsxRuntimeExports.jsx("label",{htmlFor:"isPublic",className:"ml-2 block text-sm text-gray-900",children:"Documento público (visible para todos los residentes)"})]})}),jsxRuntimeExports.jsxs("div",{className:"md:col-span-2",children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium mb-1",children:"Descripción"}),jsxRuntimeExports.jsx("textarea",{rows:4,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary focus:ring-primary sm:text-sm",placeholder:"Descripción del documento...",value:w.description||"",onChange:e=>H("description",e.target.value)})]})]})})}),jsxRuntimeExports.jsx(ModalUI,{isOpen:A,onClose:()=>P(!1),title:"Confirmar Eliminación",size:"md",footer:jsxRuntimeExports.jsxs("div",{className:"flex justify-between w-full",children:[jsxRuntimeExports.jsx(ButtonUI,{title:"Cancelar",onClick:()=>P(!1),theme:"cancel"}),jsxRuntimeExports.jsx(ButtonUI,{icon:Trash2,title:"Eliminar",onClick:()=>{if(h)try{n(!0),setTimeout(()=>{deleteDocument(h.documentId)?(i("success","Documento eliminado correctamente"),P(!1),W()):i("error","Error al eliminar el documento"),n(!1)},300)}catch(e){i("error","Ocurrió un error inesperado"),n(!1)}},theme:"delete"})]}),children:jsxRuntimeExports.jsxs("div",{className:"p-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center mb-4",children:[jsxRuntimeExports.jsx("div",{className:"rounded-full bg-red-100 p-2 mr-3",children:jsxRuntimeExports.jsx(Trash2,{className:"h-5 w-5 text-red-600"})}),jsxRuntimeExports.jsx("p",{className:"text-gray-700",children:"¿Está seguro de que desea eliminar este documento? Esta acción no se puede deshacer."})]}),h&&jsxRuntimeExports.jsxs("div",{className:"bg-gray-50 p-3 rounded border border-gray-200 text-sm",children:[jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"ID:"})," #",h.documentId]}),jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Título:"})," ",h.title]}),jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Tipo:"})," ",getDocumentTypeName(h.documentTypeId)]}),jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Fecha:"})," ",z(h.uploadDate)]})]})]})})]})}const PRESET_COLORS=["#047857","#629E3E","#10b981","#ecfdf5","#CCDAA0","#1a2234","#283249","#334155","#475569","#64748b","#ef4444","#f59e0b","#3b82f6","#8b5cf6","#ec4899","#DC2626","#D97706","#6B7280","#9ca3af","#e5e7eb","#111827","#6b7280","#ffffff","#000000","#2563eb"];function ColorPickerUI({id:e,label:t,value:a,onChange:r,defaultValue:s,disabled:n=!1,showPreview:i=!0,className:o="",required:l=!1,error:c}){const[d,u]=reactExports.useState(!1),[m,p]=reactExports.useState(a),x=reactExports.useRef(null),h=reactExports.useRef(null);reactExports.useEffect(()=>{p(a)},[a]),reactExports.useEffect(()=>{const e=e=>{x.current&&!x.current.contains(e.target)&&u(!1)};return d&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[d]);const g=e=>{p(e),r(e)},y=e=>{const t=e.target.value;p(t),r(t)},v=e=>/^#([0-9A-F]{3}){1,2}$/i.test(e);return jsxRuntimeExports.jsxs("div",{className:`relative ${o}`,children:[jsxRuntimeExports.jsxs("label",{htmlFor:e,className:"block text-sm font-medium text-gray-700 mb-2",children:[t,l&&jsxRuntimeExports.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>u(!d),disabled:n,className:`\n              w-12 h-10 rounded-md border-2 border-gray-300 \n              transition-all duration-200 \n              ${n?"opacity-50 cursor-not-allowed":"hover:border-primary-admin-dynamic cursor-pointer"}\n              ${c?"border-red-500":""}\n              focus:outline-none focus:ring-2 focus:ring-primary-admin-dynamic focus:ring-offset-2\n            `,style:{backgroundColor:v(m)?m:"#ffffff"},title:`Color actual: ${m}`,children:!v(m)&&jsxRuntimeExports.jsx(Palette,{className:"w-5 h-5 mx-auto text-gray-400"})}),jsxRuntimeExports.jsx("input",{ref:h,type:"text",id:e,value:m,onChange:y,disabled:n,placeholder:"#047857",className:`\n              flex-1 px-3 py-2 border rounded-md transition-all duration-200\n              ${n?"bg-gray-100 cursor-not-allowed":"bg-white"}\n              ${c?"border-red-500":"border-gray-300 focus:border-primary-admin-dynamic"}\n              focus:outline-none focus:ring-2 focus:ring-primary-admin-dynamic focus:ring-offset-2\n            `}),s&&m!==s&&jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>{s&&g(s)},disabled:n,className:"p-2 text-gray-500 hover:text-primary-admin-dynamic transition-colors duration-200",title:"Restaurar valor por defecto",children:jsxRuntimeExports.jsx(RotateCcw,{className:"w-4 h-4"})})]}),d&&!n&&jsxRuntimeExports.jsxs("div",{ref:x,className:"absolute top-full left-0 mt-2 p-4 bg-white border border-gray-200 rounded-lg shadow-lg z-50 min-w-64",children:[jsxRuntimeExports.jsxs("div",{className:"mb-4",children:[jsxRuntimeExports.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-2",children:"Selector de color:"}),jsxRuntimeExports.jsx("input",{type:"color",value:v(m)?m:"#047857",onChange:e=>g(e.target.value),className:"w-full h-10 rounded border border-gray-300 cursor-pointer"})]}),jsxRuntimeExports.jsxs("div",{className:"mb-4",children:[jsxRuntimeExports.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-2",children:"Colores preestablecidos:"}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-5 gap-2",children:PRESET_COLORS.map((e,t)=>jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>(e=>{g(e),u(!1)})(e),className:`\n                      w-8 h-8 rounded border-2 transition-all duration-200\n                      ${m===e?"border-gray-800 scale-110":"border-gray-300 hover:border-gray-500"}\n                    `,style:{backgroundColor:e},title:e},t))})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-2",children:"Código hexadecimal:"}),jsxRuntimeExports.jsx("input",{type:"text",value:m,onChange:y,placeholder:"#047857",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded focus:outline-none focus:border-primary-admin-dynamic"})]})]})]}),i&&v(m)&&jsxRuntimeExports.jsxs("div",{className:"mt-2 p-2 border border-gray-200 rounded-md bg-gray-50",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-600",children:[jsxRuntimeExports.jsx("span",{children:"Vista previa:"}),jsxRuntimeExports.jsx("span",{className:"font-mono",children:m.toUpperCase()})]}),jsxRuntimeExports.jsxs("div",{className:"mt-1 flex space-x-2",children:[jsxRuntimeExports.jsx("div",{className:"flex-1 h-6 rounded",style:{backgroundColor:m}}),jsxRuntimeExports.jsx("div",{className:"flex-1 h-6 rounded border border-gray-300 flex items-center justify-center text-xs",style:{backgroundColor:"white",color:m},children:"Texto"})]})]}),c&&jsxRuntimeExports.jsx("p",{className:"mt-1 text-sm text-red-600",children:c}),!c&&jsxRuntimeExports.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Formato: #RRGGBB (ej: #047857)"})]})}function ImageUploadUI({id:e,label:t,value:a,onChange:r,disabled:s=!1,className:n="",required:i=!1,error:o,maxSizeKB:l=500,acceptedFormats:c=["image/jpeg","image/png","image/gif","image/webp"],showPreview:d=!0,previewSize:u="md"}){const m=reactExports.useRef(null),[p,x]=reactExports.useState(!1),[h,g]=reactExports.useState(!1),y=reactExports.useCallback(e=>__async(this,null,function*(){g(!0);try{const t=(e=>c.includes(e.type)?e.size/1024>l?`El archivo es muy grande. Máximo: ${l}KB`:null:`Formato no válido. Acepta: ${c.map(e=>e.split("/")[1]).join(", ")}`)(e);if(t)return void alert(t);const a=yield(e=>new Promise((t,a)=>{const r=new FileReader;r.onload=()=>t(r.result),r.onerror=a,r.readAsDataURL(e)}))(e);r(a)}catch(t){alert("Error al procesar la imagen")}finally{g(!1)}}),[r,l,c]),v=()=>{!s&&m.current&&m.current.click()},E=reactExports.useCallback(e=>{var t;if(e.preventDefault(),x(!1),s)return;const a=null==(t=e.dataTransfer.files)?void 0:t[0];a&&y(a)},[s,y]),f=reactExports.useCallback(e=>{e.preventDefault(),s||x(!0)},[s]),b=reactExports.useCallback(e=>{e.preventDefault(),x(!1)},[]);return jsxRuntimeExports.jsxs("div",{className:`${n}`,children:[jsxRuntimeExports.jsxs("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--color-text-primary)"},children:[t,i&&jsxRuntimeExports.jsx("span",{className:"ml-1",style:{color:"var(--color-error-main)"},children:"*"})]}),jsxRuntimeExports.jsx("input",{ref:m,type:"file",accept:c.join(","),onChange:e=>{var t;const a=null==(t=e.target.files)?void 0:t[0];a&&y(a),e.target.value=""},className:"hidden",disabled:s,id:e}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[!a&&jsxRuntimeExports.jsx("div",{onClick:v,onDrop:E,onDragOver:f,onDragLeave:b,className:"relative border-2 border-dashed rounded-lg p-6 transition-all duration-200",style:{opacity:s?.5:1,cursor:s?"not-allowed":"pointer",backgroundColor:s||h?"var(--color-surface-disabled)":p?"var(--color-primary-admin-alpha)":"var(--color-surface-input)",borderColor:o?"var(--color-error-main)":p?"var(--color-primary-admin)":"var(--color-border-light)"},onMouseEnter:e=>{s||p||o||(e.currentTarget.style.borderColor="var(--color-primary-admin)")},onMouseLeave:e=>{s||p||o||(e.currentTarget.style.borderColor="var(--color-border-light)")},children:jsxRuntimeExports.jsx("div",{className:"text-center",children:h?jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx("div",{className:"animate-spin mx-auto w-8 h-8 border-2 border-t-transparent rounded-full",style:{borderColor:"var(--color-primary-admin) transparent transparent transparent"}}),jsxRuntimeExports.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Procesando imagen..."})]}):jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Upload,{className:"mx-auto h-8 w-8",style:{color:"var(--color-text-muted)"}}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium",style:{color:"var(--color-text-primary)"},children:p?"Suelta la imagen aquí":"Sube una imagen"}),jsxRuntimeExports.jsx("p",{className:"text-xs mt-1",style:{color:"var(--color-text-muted)"},children:"Arrastra y suelta o haz clic para seleccionar"}),jsxRuntimeExports.jsxs("p",{className:"text-xs mt-1",style:{color:"var(--color-text-muted)"},children:[c.map(e=>e.split("/")[1]).join(", ").toUpperCase()," - Máx: ",l,"KB"]})]})]})})}),a&&d&&jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-sm font-medium",style:{color:"var(--color-text-primary)"},children:"Vista previa:"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>window.open(a,"_blank"),className:"p-1 transition-colors",style:{color:"var(--color-text-muted)"},title:"Ver en tamaño completo",onMouseEnter:e=>{e.currentTarget.style.color="var(--color-primary-admin)"},onMouseLeave:e=>{e.currentTarget.style.color="var(--color-text-muted)"},children:jsxRuntimeExports.jsx(Eye,{className:"w-4 h-4"})}),!s&&jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>{r(null)},className:"p-1 transition-colors",style:{color:"var(--color-text-muted)"},title:"Eliminar imagen",onMouseEnter:e=>{e.currentTarget.style.color="var(--color-error-main)"},onMouseLeave:e=>{e.currentTarget.style.color="var(--color-text-muted)"},children:jsxRuntimeExports.jsx(X$1,{className:"w-4 h-4"})})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-start space-x-4",children:[jsxRuntimeExports.jsx("div",{className:"border rounded-lg overflow-hidden flex-shrink-0",style:__spreadProps(__spreadValues({},{sm:{width:"64px",height:"64px"},md:{width:"120px",height:"120px"},lg:{width:"200px",height:"200px"}}[u]),{borderColor:"var(--color-border-light)",backgroundColor:"var(--color-surface-secondary)"}),children:jsxRuntimeExports.jsx("img",{src:a,alt:"Preview",className:"w-full h-full object-contain",onError:e=>{const t=e.target;t.style.display="none",t.parentElement.innerHTML='<div class="w-full h-full flex items-center justify-center"><FileImage class="w-8 h-8 text-gray-400" /></div>'}})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsxs("div",{className:"text-xs space-y-1",style:{color:"var(--color-text-muted)"},children:[jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Tamaño:"})," ",Math.round(3*a.length/4/1024),"KB"]}),jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Formato:"})," ",a.split(";")[0].split(":")[1]||"Desconocido"]}),jsxRuntimeExports.jsxs("p",{className:"break-all",children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Datos:"})," ",a.substring(0,50),"..."]})]}),!s&&jsxRuntimeExports.jsx("button",{type:"button",onClick:v,className:"mt-2 text-xs transition-colors",style:{color:"var(--color-primary-admin)"},onMouseEnter:e=>{e.currentTarget.style.color="var(--color-primary-admin-dark)"},onMouseLeave:e=>{e.currentTarget.style.color="var(--color-primary-admin)"},children:"Cambiar imagen"})]})]})]})]}),o&&jsxRuntimeExports.jsxs("div",{className:"mt-2 flex items-center text-sm",style:{color:"var(--color-error-main)"},children:[jsxRuntimeExports.jsx(AlertCircle,{className:"w-4 h-4 mr-1 flex-shrink-0"}),jsxRuntimeExports.jsx("span",{children:o})]}),!o&&jsxRuntimeExports.jsxs("p",{className:"mt-2 text-xs",style:{color:"var(--color-text-muted)"},children:["Formatos aceptados: ",c.map(e=>e.split("/")[1]).join(", ").toUpperCase(),". Tamaño máximo: ",l,"KB."]})]})}var t=function(e,t){return e<t?-1:e>t?1:0},r=function(e){return e.reduce(function(e,t){return e+t},0)},n=function(){function e(e){this.colors=e}var t=e.prototype;return t.palette=function(){return this.colors},t.map=function(e){return e},e}(),o=function(){function e(e,t,a){return(e<<10)+(t<<5)+a}function a(e){var t=[],a=!1;function r(){t.sort(e),a=!0}return{push:function(e){t.push(e),a=!1},peek:function(e){return a||r(),void 0===e&&(e=t.length-1),t[e]},pop:function(){return a||r(),t.pop()},size:function(){return t.length},map:function(e){return t.map(e)},debug:function(){return a||r(),t}}}function s(e,t,a,r,s,n,i){var o=this;o.r1=e,o.r2=t,o.g1=a,o.g2=r,o.b1=s,o.b2=n,o.histo=i}function i(){this.vboxes=new a(function(e,a){return t(e.vbox.count()*e.vbox.volume(),a.vbox.count()*a.vbox.volume())})}function o(t,a){if(a.count()){var r=a.r2-a.r1+1,s=a.g2-a.g1+1,n=Math.max.apply(null,[r,s,a.b2-a.b1+1]);if(1==a.count())return[a.copy()];var i,o,l,c,d=0,u=[],m=[];if(n==r)for(i=a.r1;i<=a.r2;i++){for(c=0,o=a.g1;o<=a.g2;o++)for(l=a.b1;l<=a.b2;l++)c+=t[e(i,o,l)]||0;u[i]=d+=c}else if(n==s)for(i=a.g1;i<=a.g2;i++){for(c=0,o=a.r1;o<=a.r2;o++)for(l=a.b1;l<=a.b2;l++)c+=t[e(o,i,l)]||0;u[i]=d+=c}else for(i=a.b1;i<=a.b2;i++){for(c=0,o=a.r1;o<=a.r2;o++)for(l=a.g1;l<=a.g2;l++)c+=t[e(o,l,i)]||0;u[i]=d+=c}return u.forEach(function(e,t){m[t]=d-e}),function(e){var t,r,s,n,o,l=e+"1",c=e+"2",p=0;for(i=a[l];i<=a[c];i++)if(u[i]>d/2){for(s=a.copy(),n=a.copy(),o=(t=i-a[l])<=(r=a[c]-i)?Math.min(a[c]-1,~~(i+r/2)):Math.max(a[l],~~(i-1-t/2));!u[o];)o++;for(p=m[o];!p&&u[o-1];)p=m[--o];return s[c]=o,n[l]=s[c]+1,[s,n]}}(n==r?"r":n==s?"g":"b")}}return s.prototype={volume:function(e){var t=this;return t._volume&&!e||(t._volume=(t.r2-t.r1+1)*(t.g2-t.g1+1)*(t.b2-t.b1+1)),t._volume},count:function(t){var a=this,r=a.histo;if(!a._count_set||t){var s,n,i,o=0;for(s=a.r1;s<=a.r2;s++)for(n=a.g1;n<=a.g2;n++)for(i=a.b1;i<=a.b2;i++)o+=r[e(s,n,i)]||0;a._count=o,a._count_set=!0}return a._count},copy:function(){var e=this;return new s(e.r1,e.r2,e.g1,e.g2,e.b1,e.b2,e.histo)},avg:function(t){var a=this,r=a.histo;if(!a._avg||t){var s,n,i,o,l=0,c=0,d=0,u=0;if(a.r1===a.r2&&a.g1===a.g2&&a.b1===a.b2)a._avg=[a.r1<<3,a.g1<<3,a.b1<<3];else{for(n=a.r1;n<=a.r2;n++)for(i=a.g1;i<=a.g2;i++)for(o=a.b1;o<=a.b2;o++)l+=s=r[e(n,i,o)]||0,c+=s*(n+.5)*8,d+=s*(i+.5)*8,u+=s*(o+.5)*8;a._avg=l?[~~(c/l),~~(d/l),~~(u/l)]:[~~(8*(a.r1+a.r2+1)/2),~~(8*(a.g1+a.g2+1)/2),~~(8*(a.b1+a.b2+1)/2)]}}return a._avg},contains:function(e){var t=this,a=e[0]>>3;return gval=e[1]>>3,bval=e[2]>>3,a>=t.r1&&a<=t.r2&&gval>=t.g1&&gval<=t.g2&&bval>=t.b1&&bval<=t.b2}},i.prototype={push:function(e){this.vboxes.push({vbox:e,color:e.avg()})},palette:function(){return this.vboxes.map(function(e){return e.color})},size:function(){return this.vboxes.size()},map:function(e){for(var t=this.vboxes,a=0;a<t.size();a++)if(t.peek(a).vbox.contains(e))return t.peek(a).color;return this.nearest(e)},nearest:function(e){for(var t,a,r,s=this.vboxes,n=0;n<s.size();n++)((a=Math.sqrt(Math.pow(e[0]-s.peek(n).color[0],2)+Math.pow(e[1]-s.peek(n).color[1],2)+Math.pow(e[2]-s.peek(n).color[2],2)))<t||void 0===t)&&(t=a,r=s.peek(n).color);return r},forcebw:function(){var e=this.vboxes;e.sort(function(e,a){return t(r(e.color),r(a.color))});var a=e[0].color;a[0]<5&&a[1]<5&&a[2]<5&&(e[0].color=[0,0,0]);var s=e.length-1,n=e[s].color;n[0]>251&&n[1]>251&&n[2]>251&&(e[s].color=[255,255,255])}},{quantize:function(r,l){if(!Number.isInteger(l)||l<1||l>256)throw new Error("Invalid maximum color count. It must be an integer between 1 and 256.");if(!r.length||l<2||l>256)return!1;if(!r.length||l<2||l>256)return!1;for(var c=[],d=new Set,u=0;u<r.length;u++){var m=r[u],p=m.join(",");d.has(p)||(d.add(p),c.push(m))}if(c.length<=l)return new n(c);var x,h,g,y=(x=r,g=new Array(32768),x.forEach(function(t){h=e(t[0]>>3,t[1]>>3,t[2]>>3),g[h]=(g[h]||0)+1}),g);y.forEach(function(){});var v=function(e,t){var a,r,n,i=1e6,o=0,l=1e6,c=0,d=1e6,u=0;return e.forEach(function(e){(a=e[0]>>3)<i?i=a:a>o&&(o=a),(r=e[1]>>3)<l?l=r:r>c&&(c=r),(n=e[2]>>3)<d?d=n:n>u&&(u=n)}),new s(i,o,l,c,d,u,t)}(r,y),E=new a(function(e,a){return t(e.count(),a.count())});function f(e,t){for(var a,r=e.size(),s=0;s<1e3;){if(r>=t)return;if(s++>1e3)return;if((a=e.pop()).count()){var n=o(y,a),i=n[0],l=n[1];if(!i)return;e.push(i),l&&(e.push(l),r++)}else e.push(a),s++}}E.push(v),f(E,.75*l);for(var b=new a(function(e,a){return t(e.count()*e.volume(),a.count()*a.volume())});E.size();)b.push(E.pop());f(b,l);for(var j=new i;b.size();)j.push(b.pop());return j}}}().quantize,e=function(e){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.width=this.canvas.width=e.naturalWidth,this.height=this.canvas.height=e.naturalHeight,this.context.drawImage(e,0,0,this.width,this.height)};e.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)};var u=function(){};u.prototype.getColor=function(e,t){return void 0===t&&(t=10),this.getPalette(e,5,t)[0]},u.prototype.getPalette=function(t,a,r){var s=function(e){var t=e.colorCount,a=e.quality;if(void 0!==t&&Number.isInteger(t)){if(1===t)throw new Error("colorCount should be between 2 and 20. To get one color, call getColor() instead of getPalette()");t=Math.max(t,2),t=Math.min(t,20)}else t=10;return(void 0===a||!Number.isInteger(a)||a<1)&&(a=10),{colorCount:t,quality:a}}({colorCount:a,quality:r}),n=new e(t),i=function(e,t,a){for(var r,s,n,i,o,l=e,c=[],d=0;d<t;d+=a)s=l[0+(r=4*d)],n=l[r+1],i=l[r+2],(void 0===(o=l[r+3])||o>=125)&&(s>250&&n>250&&i>250||c.push([s,n,i]));return c}(n.getImageData().data,n.width*n.height,s.quality),l=o(i,s.colorCount);return l?l.palette():null},u.prototype.getColorFromUrl=function(e,t,a){var r=this,s=document.createElement("img");s.addEventListener("load",function(){var n=r.getPalette(s,5,a);t(n[0],e)}),s.src=e},u.prototype.getImageData=function(e,t){var a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.onload=function(){if(200==this.status){var e=new Uint8Array(this.response);i=e.length;for(var a=new Array(i),r=0;r<e.length;r++)a[r]=String.fromCharCode(e[r]);var s=a.join(""),n=window.btoa(s);t("data:image/png;base64,"+n)}},a.send()},u.prototype.getColorAsync=function(e,t,a){var r=this;this.getImageData(e,function(e){var s=document.createElement("img");s.addEventListener("load",function(){var e=r.getPalette(s,5,a);t(e[0],this)}),s.src=e})};class BrandingAIModule{constructor(){__publicField(this,"name","BrandingAI"),__publicField(this,"version","1.1.0"),__publicField(this,"description","Análisis real de colores de logos usando ColorThief"),__publicField(this,"capabilities",["extractColorsFromLogos","generateBrandingPalette"]),__publicField(this,"isReady",!1),__publicField(this,"colorThief",null)}initialize(){return __async(this,null,function*(){try{this.colorThief=new u,this.isReady=!0}catch(e){throw new Error(`No se pudo inicializar BrandingAI: ${e}`)}})}generateBrandingPalette(e,t){return __async(this,null,function*(){this.isReady||(yield this.initialize());try{null==t||t(10);const a=yield this.extractColorsFromLogos(e);null==t||t(40);const r=this.generatePaletteFromColors(a);null==t||t(80);const s=this.analyzeColorProfile(a);null==t||t(95);const n={suggestions:r,alternatives:this.generateAlternatives(a),analysis:s};return null==t||t(100),n}catch(a){throw new Error(`Error en análisis de branding: ${a}`)}})}extractColorsFromLogos(e){return __async(this,null,function*(){const t=[];try{if(e.logoPrimary){const a=yield this.extractColorsFromBase64(e.logoPrimary);t.push(...a.map(e=>__spreadProps(__spreadValues({},e),{percentage:.7*e.percentage})))}if(e.logoSecondary){const a=yield this.extractColorsFromBase64(e.logoSecondary);t.push(...a.map(e=>__spreadProps(__spreadValues({},e),{percentage:.3*e.percentage})))}return 0===t.length?[{hex:"#047857",percentage:40},{hex:"#1a2234",percentage:30},{hex:"#10b981",percentage:20},{hex:"#6b7280",percentage:10}]:this.normalizeDominantColors(t)}catch(a){return[{hex:"#047857",percentage:40},{hex:"#1a2234",percentage:30},{hex:"#10b981",percentage:20},{hex:"#6b7280",percentage:10}]}})}extractColorsFromBase64(e){return __async(this,null,function*(){return new Promise((t,a)=>{try{if(!this.colorThief)throw new Error("ColorThief no inicializado");const a=new Image;a.crossOrigin="anonymous",a.onload=()=>{try{if(!this.colorThief)throw new Error("ColorThief no disponible");const e=this.colorThief.getPalette(a,6,10);if(!e||0===e.length)return void t([]);const r=e.map((e,t)=>({hex:this.rgbToHex(e[0],e[1],e[2]),percentage:Math.max(5,50-7*t)}));t(r)}catch(e){t([])}},a.onerror=()=>{t([])},a.src=e}catch(r){t([])}})})}normalizeDominantColors(e){const t=[];for(const a of e){const e=t.find(e=>this.isSimilarColor(a.hex,e.hex));e?e.percentage+=a.percentage:t.push(__spreadValues({},a))}return t.sort((e,t)=>t.percentage-e.percentage).slice(0,6).map((e,t)=>__spreadProps(__spreadValues({},e),{percentage:Math.max(5,e.percentage)}))}generatePaletteFromColors(e){var t,a;const r=(null==(t=e[0])?void 0:t.hex)||"#047857",s=(null==(a=e[1])?void 0:a.hex)||"#629E3E",n=this.generateNavyFromColor(r);return{primary:{main:r,admin:s,light:this.lightenColor(r),mint:this.generateMintColor(r),sage:this.generateSageColor(r)},navy:{main:n,header:this.darkenColor(n),dark:this.darkenColor(n,.3)},states:{success:"#10b981",warning:"#f59e0b",error:"#ef4444",info:"#3b82f6"},actions:{view:s,edit:"#d97706",delete:"#dc2626",create:r,cancel:"#6b7280"},confidence:.9,dominantColors:e.slice(0,3).map(e=>e.hex),colorHarmony:"custom"}}analyzeColorProfile(e){return{dominantColors:e.slice(0,5).map((e,t)=>({color:e.hex,percentage:e.percentage,name:`Color ${t+1}`})),colorProfile:"Extraído de Logos",mood:["auténtico","personalizado","coherente"],recommendations:["Paleta generada basada en análisis real de los logos","Los colores reflejan la identidad visual existente","Se mantiene la coherencia con la marca actual","Se recomienda usar los colores principales para elementos importantes"]}}generateAlternatives(e){const t=[];for(let a=1;a<Math.min(3,e.length);a++){const r=e[a].hex,s=e[(a+1)%e.length].hex;t.push({primary:{main:r,admin:s,light:this.lightenColor(r),mint:this.generateMintColor(r),sage:this.generateSageColor(r)},navy:{main:this.generateNavyFromColor(r),header:this.darkenColor(this.generateNavyFromColor(r)),dark:this.darkenColor(this.generateNavyFromColor(r),.3)},states:{success:"#10b981",warning:"#f59e0b",error:"#ef4444",info:"#3b82f6"},actions:{view:s,edit:"#d97706",delete:"#dc2626",create:r,cancel:"#6b7280"},confidence:.75,dominantColors:[r,s],colorHarmony:"custom"})}return t}rgbToHex(e,t,a){return"#"+((1<<24)+(e<<16)+(t<<8)+a).toString(16).slice(1)}lightenColor(e){const t=this.hexToRgb(e);return t?this.rgbToHex(Math.min(255,t.r+40),Math.min(255,t.g+40),Math.min(255,t.b+40)):e}darkenColor(e,t=.2){const a=this.hexToRgb(e);return a?this.rgbToHex(Math.max(0,Math.round(a.r*(1-t))),Math.max(0,Math.round(a.g*(1-t))),Math.max(0,Math.round(a.b*(1-t)))):e}generateNavyFromColor(e){return"#1a2234"}generateMintColor(e){const t=this.hexToRgb(e);return t?this.rgbToHex(Math.min(255,t.r+200),Math.min(255,t.g+200),Math.min(255,t.b+180)):"#ecfdf5"}generateSageColor(e){const t=this.hexToRgb(e);return t?this.rgbToHex(Math.min(255,t.r+100),Math.min(255,t.g+120),Math.min(255,t.b+80)):"#CCDAA0"}hexToRgb(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}isSimilarColor(e,t){const a=this.hexToRgb(e),r=this.hexToRgb(t);if(!a||!r)return!1;return Math.abs(a.r-r.r)+Math.abs(a.g-r.g)+Math.abs(a.b-r.b)<60}}const useBrandingAI=()=>{const[e,t]=reactExports.useState({isLoading:!1,error:null,progress:0}),[a,r]=reactExports.useState(null),s=reactExports.useCallback(e=>__async(void 0,null,function*(){t(e=>__spreadProps(__spreadValues({},e),{isLoading:!0,error:null,progress:0})),r(null);try{const a=new BrandingAIModule,s=e=>{t(t=>__spreadProps(__spreadValues({},t),{progress:e}))},n=yield a.generateBrandingPalette(e,s);return r(n),t(e=>__spreadProps(__spreadValues({},e),{isLoading:!1,progress:100})),n}catch(a){const e=a instanceof Error?a.message:"Error generando paleta de branding";return t(t=>__spreadProps(__spreadValues({},t),{isLoading:!1,error:e,progress:0})),null}}),[]),n=reactExports.useCallback(()=>{t({isLoading:!1,error:null,progress:0}),r(null)},[]);return __spreadProps(__spreadValues({},e),{results:a,generateBrandingPalette:s,resetState:n})},COLOR_CATEGORIES=[{id:"primary",label:"Colores Principales",description:"Colores primarios de la marca y identidad corporativa",icon:Palette,colors:[{key:"primaryMain",label:"Principal",description:"Color principal del sistema",defaultValue:THEME_COLORS$1.primary.main},{key:"primaryAdmin",label:"Administrativo",description:"Color para interfaces administrativas",defaultValue:THEME_COLORS$1.primary.admin},{key:"primaryLight",label:"Claro",description:"Variante clara del principal",defaultValue:THEME_COLORS$1.primary.light},{key:"primaryMint",label:"Menta",description:"Verde menta muy suave",defaultValue:THEME_COLORS$1.primary.mint},{key:"primarySage",label:"Sage",description:"Verde sage secundario",defaultValue:THEME_COLORS$1.primary.sage}]},{id:"navy",label:"Colores Navy",description:"Colores oscuros para headers y elementos destacados",icon:Settings,colors:[{key:"navyMain",label:"Navy Principal",description:"Color principal para headers",defaultValue:THEME_COLORS$1.navy.main},{key:"navyHeader",label:"Header",description:"Color específico para headers de grids",defaultValue:THEME_COLORS$1.navy.header},{key:"navyDark",label:"Navy Oscuro",description:"Navy oscuro para hover y estados",defaultValue:THEME_COLORS$1.navy.dark}]},{id:"states",label:"Estados del Sistema",description:"Colores para feedback y estados de la aplicación",icon:AlertCircle,colors:[{key:"stateSuccessMain",label:"Éxito",description:"Color para estados exitosos",defaultValue:THEME_COLORS$1.states.success.main},{key:"stateWarningMain",label:"Advertencia",description:"Color para advertencias",defaultValue:THEME_COLORS$1.states.warning.main},{key:"stateErrorMain",label:"Error",description:"Color para errores",defaultValue:THEME_COLORS$1.states.error.main},{key:"stateInfoMain",label:"Información",description:"Color para información",defaultValue:THEME_COLORS$1.states.info.main}]},{id:"actions",label:"Acciones y Botones",description:"Colores para botones y acciones del usuario",icon:CheckCircle,colors:[{key:"actionViewMain",label:"Ver/Visualizar",description:"Color para acciones de vista",defaultValue:THEME_COLORS$1.actions.view.main},{key:"actionEditMain",label:"Editar",description:"Color para acciones de edición",defaultValue:THEME_COLORS$1.actions.edit.main},{key:"actionDeleteMain",label:"Eliminar",description:"Color para acciones de eliminación",defaultValue:THEME_COLORS$1.actions.delete.main},{key:"actionCreateMain",label:"Crear/Nuevo",description:"Color para acciones de creación",defaultValue:THEME_COLORS$1.actions.create.main},{key:"actionCancelMain",label:"Cancelar",description:"Color para acciones de cancelación",defaultValue:THEME_COLORS$1.actions.cancel.main}]}],createDefaultFormData=()=>{const e={brandName:"Mi Empresa",logoPrimary:"",logoSecondary:""};return COLOR_CATEGORIES.forEach(t=>{t.colors.forEach(t=>{e[t.key]=t.defaultValue})}),e.secondaryMain=THEME_COLORS$1.secondary.main,e.surfaceSidebar=THEME_COLORS$1.surfaces.sidebar,e.surfaceModal=THEME_COLORS$1.surfaces.modal,e.surfaceContent=THEME_COLORS$1.surfaces.content,e.surfaceCard=THEME_COLORS$1.surfaces.card,e.surfaceInput=THEME_COLORS$1.surfaces.input,e.borderLight=THEME_COLORS$1.borders.light,e.borderMedium=THEME_COLORS$1.borders.medium,e.borderDark=THEME_COLORS$1.borders.dark,e.borderPrimary=THEME_COLORS$1.borders.primary,e.borderAccent=THEME_COLORS$1.borders.accent,e.textPrimary=THEME_COLORS$1.text.primary,e.textSecondary=THEME_COLORS$1.text.secondary,e.textMuted=THEME_COLORS$1.text.muted,e.textInverse=THEME_COLORS$1.text.inverse,e.textAccent=THEME_COLORS$1.text.accent,e.textLink=THEME_COLORS$1.text.link,e},mapDtoToFormData=e=>({brandName:e.brandName,logoPrimary:e.logoPrimary||"",logoSecondary:e.logoSecondary||"",primaryMain:e.primaryMain,primaryAdmin:e.primaryAdmin,primaryLight:e.primaryLight,primaryMint:e.primaryMint,primarySage:e.primarySage,navyMain:e.navyMain,navyHeader:e.navyHeader,navyDark:e.navyDark,secondaryMain:e.secondaryMain,stateSuccessMain:e.stateSuccessMain,stateWarningMain:e.stateWarningMain,stateErrorMain:e.stateErrorMain,stateInfoMain:e.stateInfoMain,actionViewMain:e.actionViewMain,actionEditMain:e.actionEditMain,actionDeleteMain:e.actionDeleteMain,actionCreateMain:e.actionCreateMain,actionCancelMain:e.actionCancelMain,surfaceSidebar:e.surfaceSidebar,surfaceModal:e.surfaceModal,surfaceContent:e.surfaceContent,surfaceCard:e.surfaceCard,surfaceInput:e.surfaceInput,borderLight:e.borderLight,borderMedium:e.borderMedium,borderDark:e.borderDark,borderPrimary:e.borderPrimary,borderAccent:e.borderAccent,textPrimary:e.textPrimary,textSecondary:e.textSecondary,textMuted:e.textMuted,textInverse:e.textInverse,textAccent:e.textAccent,textLink:e.textLink}),formDataToCreateCommand=(e,t)=>({companyId:t,brandName:e.brandName,primaryMain:e.primaryMain,primaryAdmin:e.primaryAdmin,primaryLight:e.primaryLight,primaryMint:e.primaryMint,primarySage:e.primarySage,navyMain:e.navyMain,navyHeader:e.navyHeader,navyDark:e.navyDark,secondaryMain:e.secondaryMain,stateSuccessMain:e.stateSuccessMain,stateWarningMain:e.stateWarningMain,stateErrorMain:e.stateErrorMain,stateInfoMain:e.stateInfoMain,actionViewMain:e.actionViewMain,actionEditMain:e.actionEditMain,actionDeleteMain:e.actionDeleteMain,actionCreateMain:e.actionCreateMain,actionCancelMain:e.actionCancelMain,surfaceSidebar:e.surfaceSidebar,surfaceModal:e.surfaceModal,surfaceContent:e.surfaceContent,surfaceCard:e.surfaceCard,surfaceInput:e.surfaceInput,borderLight:e.borderLight,borderMedium:e.borderMedium,borderDark:e.borderDark,borderPrimary:e.borderPrimary,borderAccent:e.borderAccent,textPrimary:e.textPrimary,textSecondary:e.textSecondary,textMuted:e.textMuted,textInverse:e.textInverse,textAccent:e.textAccent,textLink:e.textLink,logoPrimary:e.logoPrimary||null,logoSecondary:e.logoSecondary||null}),formDataToUpdateCommand=(e,t,a)=>({id:t,companyId:a,brandName:e.brandName,primaryMain:e.primaryMain,primaryAdmin:e.primaryAdmin,primaryLight:e.primaryLight,primaryMint:e.primaryMint,primarySage:e.primarySage,navyMain:e.navyMain,navyHeader:e.navyHeader,navyDark:e.navyDark,secondaryMain:e.secondaryMain,stateSuccessMain:e.stateSuccessMain,stateWarningMain:e.stateWarningMain,stateErrorMain:e.stateErrorMain,stateInfoMain:e.stateInfoMain,actionViewMain:e.actionViewMain,actionEditMain:e.actionEditMain,actionDeleteMain:e.actionDeleteMain,actionCreateMain:e.actionCreateMain,actionCancelMain:e.actionCancelMain,surfaceSidebar:e.surfaceSidebar,surfaceModal:e.surfaceModal,surfaceContent:e.surfaceContent,surfaceCard:e.surfaceCard,surfaceInput:e.surfaceInput,borderLight:e.borderLight,borderMedium:e.borderMedium,borderDark:e.borderDark,borderPrimary:e.borderPrimary,borderAccent:e.borderAccent,textPrimary:e.textPrimary,textSecondary:e.textSecondary,textMuted:e.textMuted,textInverse:e.textInverse,textAccent:e.textAccent,textLink:e.textLink,logoPrimary:e.logoPrimary||null,logoSecondary:e.logoSecondary||null});function BrandingConfigPageContent(){var e,t,a,r;const[s,n]=reactExports.useState(createDefaultFormData()),[i,o]=reactExports.useState(createDefaultFormData()),[l,c]=reactExports.useState(null),[d,u]=reactExports.useState(!0),[m,p]=reactExports.useState(!1),[x,h]=reactExports.useState(!1),[g,y]=reactExports.useState(null),[v,E]=reactExports.useState(null),[f,b]=reactExports.useState("logos"),j=reactExports.useMemo(()=>new BrandingConfigService,[]),{applyColors:R,refreshLogos:I}=useBranding(),{user:S}=useAuth(),{showAlert:_}=useAlerts(),{isLoading:N,progress:C,error:T,results:D,generateBrandingPalette:A,resetState:P}=useBrandingAI(),{setPreviewLogos:w,setIsPreviewMode:M}=useBranding();reactExports.useEffect(()=>{(()=>{__async(this,null,function*(){if(null==S?void 0:S.companyId){u(!0),y(null);try{const e=yield j.getBrandingConfigByCompany(S.companyId);if(e.isSuccess&&e.data){const t=mapDtoToFormData(e.data);n(t),o(t),c(e.data)}else{const e=createDefaultFormData();n(e),o(e),c(null)}}catch(e){y("Error cargando configuración existente");const t=createDefaultFormData();n(t),o(t),c(null)}finally{u(!1)}}else u(!1)})})()},[null==S?void 0:S.companyId,j]);const k=reactExports.useMemo(()=>JSON.stringify(s)!==JSON.stringify(i),[s,i]),O=reactExports.useCallback(e=>({primary:{main:e.primaryMain||THEME_COLORS$1.primary.main,admin:e.primaryAdmin||THEME_COLORS$1.primary.admin,light:e.primaryLight||THEME_COLORS$1.primary.light,mint:e.primaryMint||THEME_COLORS$1.primary.mint,sage:e.primarySage||THEME_COLORS$1.primary.sage},navy:{main:e.navyMain||THEME_COLORS$1.navy.main,header:e.navyHeader||THEME_COLORS$1.navy.header,dark:e.navyDark||THEME_COLORS$1.navy.dark},secondary:{main:e.secondaryMain||THEME_COLORS$1.secondary.main},states:{success:{main:e.stateSuccessMain||THEME_COLORS$1.states.success.main},warning:{main:e.stateWarningMain||THEME_COLORS$1.states.warning.main},error:{main:e.stateErrorMain||THEME_COLORS$1.states.error.main},info:{main:e.stateInfoMain||THEME_COLORS$1.states.info.main}},actions:{view:{main:e.actionViewMain||THEME_COLORS$1.actions.view.main},edit:{main:e.actionEditMain||THEME_COLORS$1.actions.edit.main},delete:{main:e.actionDeleteMain||THEME_COLORS$1.actions.delete.main},create:{main:e.actionCreateMain||THEME_COLORS$1.actions.create.main},cancel:{main:e.actionCancelMain||THEME_COLORS$1.actions.cancel.main}},surfaces:{sidebar:e.surfaceSidebar||THEME_COLORS$1.surfaces.sidebar,modal:e.surfaceModal||THEME_COLORS$1.surfaces.modal,content:e.surfaceContent||THEME_COLORS$1.surfaces.content,card:e.surfaceCard||THEME_COLORS$1.surfaces.card,input:e.surfaceInput||THEME_COLORS$1.surfaces.input},borders:{light:e.borderLight||THEME_COLORS$1.borders.light,medium:e.borderMedium||THEME_COLORS$1.borders.medium,dark:e.borderDark||THEME_COLORS$1.borders.dark,primary:e.borderPrimary||THEME_COLORS$1.borders.primary,accent:e.borderAccent||THEME_COLORS$1.borders.accent},text:{primary:e.textPrimary||THEME_COLORS$1.text.primary,secondary:e.textSecondary||THEME_COLORS$1.text.secondary,muted:e.textMuted||THEME_COLORS$1.text.muted,inverse:e.textInverse||THEME_COLORS$1.text.inverse,accent:e.textAccent||THEME_COLORS$1.text.accent,link:e.textLink||THEME_COLORS$1.text.link},logos:{primary:e.logoPrimary||null,secondary:e.logoSecondary||null}}),[]);reactExports.useEffect(()=>{if(x){const e=O(s);applyDynamicColors(e),w({primary:s.logoPrimary||null,secondary:s.logoSecondary||null}),M(!0)}else{const e=O(i);applyDynamicColors(e),w(null),M(!1)}},[x,s,i,O,w,M]);const $=reactExports.useMemo(()=>Boolean(s.logoPrimary||s.logoSecondary),[s.logoPrimary,s.logoSecondary]),U=reactExports.useCallback((e,t)=>{n(a=>__spreadProps(__spreadValues({},a),{[e]:t})),y(null),E(null)},[]),L=reactExports.useCallback((e,t)=>{n(a=>__spreadProps(__spreadValues({},a),{[e]:t||""})),y(null),E(null),P()},[P]),B=reactExports.useCallback(()=>__async(this,null,function*(){try{const e=yield A({logoPrimary:s.logoPrimary||void 0,logoSecondary:s.logoSecondary||void 0,brandName:s.brandName,style:"auto"});if(e&&e.suggestions){const t={primaryMain:e.suggestions.primary.main,primaryAdmin:e.suggestions.primary.admin,primaryLight:e.suggestions.primary.light,primaryMint:e.suggestions.primary.mint,primarySage:e.suggestions.primary.sage,navyMain:e.suggestions.navy.main,navyHeader:e.suggestions.navy.header,navyDark:e.suggestions.navy.dark,stateSuccessMain:e.suggestions.states.success,stateWarningMain:e.suggestions.states.warning,stateErrorMain:e.suggestions.states.error,stateInfoMain:e.suggestions.states.info,actionViewMain:e.suggestions.actions.view,actionEditMain:e.suggestions.actions.edit,actionDeleteMain:e.suggestions.actions.delete,actionCreateMain:e.suggestions.actions.create,actionCancelMain:e.suggestions.actions.cancel};n(e=>__spreadValues(__spreadValues({},e),t)),y(null),h(!0)}}catch(e){y("Error generando colores con IA. Inténtalo de nuevo.")}}),[s.logoPrimary,s.logoSecondary,s.brandName,A]);reactExports.useCallback(()=>{if(null==D?void 0:D.suggestions){const e={primaryMain:D.suggestions.primary.main,primaryAdmin:D.suggestions.primary.admin,primaryLight:D.suggestions.primary.light,primaryMint:D.suggestions.primary.mint,primarySage:D.suggestions.primary.sage,navyMain:D.suggestions.navy.main,navyHeader:D.suggestions.navy.header,navyDark:D.suggestions.navy.dark,stateSuccessMain:D.suggestions.states.success,stateWarningMain:D.suggestions.states.warning,stateErrorMain:D.suggestions.states.error,stateInfoMain:D.suggestions.states.info,actionViewMain:D.suggestions.actions.view,actionEditMain:D.suggestions.actions.edit,actionDeleteMain:D.suggestions.actions.delete,actionCreateMain:D.suggestions.actions.create,actionCancelMain:D.suggestions.actions.cancel};n(t=>__spreadValues(__spreadValues({},t),e)),h(!0)}},[D]);const F=reactExports.useCallback(()=>{if(!(null==S?void 0:S.companyId))return void y("No se encontró información de la empresa");if(!k)return void y("No hay cambios para guardar");const e=Boolean(l);_({title:"Seleccionar tipo de guardado",message:e?`Ya existe una configuración (${(null==l?void 0:l.brandName)||"Configuración Actual"}). ¿Qué deseas hacer con los cambios?`:"¿Cómo deseas guardar esta configuración de branding?",type:"confirmation",presentation:"modal",onConfirm:()=>V(),onCancel:e?()=>W():()=>{},confirmText:e?"Guardar como Nuevo":"Crear Configuración",cancelText:e?"Actualizar Existente":"Cancelar"})},[null==S?void 0:S.companyId,k,l,_]),V=()=>__async(this,null,function*(){if(null==S?void 0:S.companyId){p(!0),y(null),E(null);try{const e=formDataToCreateCommand(s,S.companyId),t=yield j.create(e);if(t.isSuccess)E("Nueva configuración creada exitosamente"),yield z();else{const e=`Error creando nueva configuración: ${t.error||"Error desconocido"}`;y(e)}}catch(e){y("Error creando nueva configuración")}finally{p(!1)}}else y("No se encontró información de la empresa")}),W=()=>__async(this,null,function*(){if((null==S?void 0:S.companyId)&&l){p(!0),y(null),E(null);try{const e=formDataToUpdateCommand(s,l.id,S.companyId),t=yield j.update(l.id,e);if(t.isSuccess)E("Configuración actualizada exitosamente"),yield z();else{const e=`Error actualizando configuración: ${t.error||"Error desconocido"}`;y(e)}}catch(e){y("Error actualizando configuración")}finally{p(!1)}}else y("No se encontró información de la empresa o configuración existente")}),z=()=>__async(this,null,function*(){if(null==S?void 0:S.companyId)try{const e=yield j.getBrandingConfigByCompany(S.companyId);if(e.isSuccess&&e.data){const t=e.data;if(j.saveBrandingToCache(t)){j.getCacheStats();setTimeout(()=>{j.getBrandingFromCache(t.companyId)},100)}const a=j.convertToColorsFormat(t);applyDynamicColors(a),(t.logoPrimary||t.logoSecondary)&&(w({primary:t.logoPrimary||null,secondary:t.logoSecondary||null}),M(!1)),I();const r=mapDtoToFormData(t);n(r),o(r),c(t),h(!1)}}catch(e){}});return d?jsxRuntimeExports.jsx("div",{className:"min-h-96 flex items-center justify-center",children:jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-primary-admin-dynamic border-t-transparent rounded-full mx-auto mb-4"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600",children:"Cargando configuración de branding..."})]})}):jsxRuntimeExports.jsxs("div",{className:"space-y-8 max-w-7xl mx-auto",children:[jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-8",style:{borderColor:"var(--color-border-light)",background:"linear-gradient(135deg, var(--color-surface-card) 0%, var(--color-primary-mint) 100%)"},children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-4",children:[jsxRuntimeExports.jsx("div",{className:"p-3 rounded-lg",style:{backgroundColor:"var(--color-primary-admin)"},children:jsxRuntimeExports.jsx(Palette,{className:"w-8 h-8 text-white"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Colores Corporativos"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 mt-1 text-lg",children:"Personaliza la identidad visual completa de tu empresa"}),l&&jsxRuntimeExports.jsxs("p",{className:"text-sm text-blue-600 mt-1",children:["Configuración: ",l.brandName," (ID: ",l.id,")"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-3",children:[$&&jsxRuntimeExports.jsx(ButtonUI,{icon:N?Loader2:Brain,title:N?"Generando...":"Generar con IA",onClick:B,disabled:N||m,className:"px-4 py-2 text-white transition-all duration-200 "+(N?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 hover:scale-105")}),jsxRuntimeExports.jsx(ButtonUI,{icon:x?EyeOff:Eye,title:x?"Ocultar Vista Previa":"Vista Previa",onClick:()=>{h(!x)},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2"}),k&&jsxRuntimeExports.jsx(ButtonUI,{icon:RotateCcw,title:"Resetear Cambios",onClick:()=>{n(__spreadValues({},i)),y(null),E(null),h(!1)},className:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2"}),jsxRuntimeExports.jsx(ButtonUI,{icon:m?Loader2:Save,title:m?"Guardando...":"Guardar",onClick:F,disabled:m||!k,borderColor:"var(--color-primary-admin)",textColor:"#ffffff",className:"px-6 py-2 transition-all duration-200 "+(m?"bg-primary-admin-dynamic/70 cursor-not-allowed":"bg-primary-admin-dynamic hover:bg-primary-admin-dynamic/90")})]})]}),jsxRuntimeExports.jsx(AnimatePresence,{children:N&&jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,height:0,marginTop:0},animate:{opacity:1,height:"auto",marginTop:24},exit:{opacity:0,height:0,marginTop:0},className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center text-blue-800",children:[jsxRuntimeExports.jsx(Loader2,{className:"w-5 h-5 mr-2 animate-spin"}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Generando colores con IA"})]}),jsxRuntimeExports.jsxs("div",{className:"mt-2",children:[jsxRuntimeExports.jsx("div",{className:"w-full bg-blue-200 rounded-full h-2",children:jsxRuntimeExports.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${C}%`}})}),jsxRuntimeExports.jsxs("p",{className:"text-blue-700 text-sm mt-1",children:["Analizando logos y generando paleta de colores... ",Math.round(C),"%"]})]})]})}),jsxRuntimeExports.jsx(AnimatePresence,{children:D&&!N&&jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,height:0,marginTop:0},animate:{opacity:1,height:"auto",marginTop:24},exit:{opacity:0,height:0,marginTop:0},className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center text-green-800",children:[jsxRuntimeExports.jsx(Zap,{className:"w-5 h-5 mr-2"}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Colores generados con IA"}),jsxRuntimeExports.jsxs("span",{className:"ml-2 text-sm bg-green-200 px-2 py-1 rounded",children:[Math.round(100*((null==(e=D.suggestions)?void 0:e.confidence)||0)),"% confianza"]})]}),jsxRuntimeExports.jsxs("p",{className:"text-green-700 text-sm mt-1",children:["Se analizaron ",(null==(t=null==D?void 0:D.analysis)?void 0:t.dominantColors.length)||0," colores dominantes. Perfil detectado: ",jsxRuntimeExports.jsx("strong",{children:(null==(a=null==D?void 0:D.analysis)?void 0:a.colorProfile)||"N/A"})]}),(null==(r=null==D?void 0:D.analysis)?void 0:r.recommendations)&&D.analysis.recommendations.length>0&&jsxRuntimeExports.jsxs("div",{className:"mt-2",children:[jsxRuntimeExports.jsx("p",{className:"text-green-700 text-sm font-medium",children:"Recomendaciones:"}),jsxRuntimeExports.jsx("ul",{className:"text-green-600 text-xs mt-1 list-disc list-inside",children:D.analysis.recommendations.slice(0,2).map((e,t)=>jsxRuntimeExports.jsx("li",{children:e},t))})]})]})}),jsxRuntimeExports.jsx(AnimatePresence,{children:x&&jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,height:0,marginTop:0},animate:{opacity:1,height:"auto",marginTop:24},exit:{opacity:0,height:0,marginTop:0},className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center text-blue-800",children:[jsxRuntimeExports.jsx(Eye,{className:"w-5 h-5 mr-2"}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Modo Vista Previa Activo"})]}),jsxRuntimeExports.jsx("p",{className:"text-blue-700 text-sm mt-1",children:"Los cambios se están aplicando temporalmente. Guarda para hacer los cambios permanentes."})]})}),jsxRuntimeExports.jsx(AnimatePresence,{children:v&&jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center text-green-800",children:[jsxRuntimeExports.jsx(CheckCircle,{className:"w-5 h-5 mr-2"}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Éxito"})]}),jsxRuntimeExports.jsx("p",{className:"text-green-700 text-sm mt-1",children:v})]})}),jsxRuntimeExports.jsx(AnimatePresence,{children:g&&jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mt-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center text-red-800",children:[jsxRuntimeExports.jsx(AlertCircle,{className:"w-5 h-5 mr-2"}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Error"})]}),jsxRuntimeExports.jsx("p",{className:"text-red-700 text-sm mt-1",children:g})]})}),jsxRuntimeExports.jsx(AnimatePresence,{children:T&&jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mt-6 p-4 bg-orange-50 border border-orange-200 rounded-lg",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center text-orange-800",children:[jsxRuntimeExports.jsx(AlertCircle,{className:"w-5 h-5 mr-2"}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:"Error de IA"})]}),jsxRuntimeExports.jsx("p",{className:"text-orange-700 text-sm mt-1",children:T})]})})]}),jsxRuntimeExports.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:jsxRuntimeExports.jsxs(Tabs,{value:f,onValueChange:b,variant:"cards",className:"w-full",children:[jsxRuntimeExports.jsx("div",{className:"p-6 border-b border-gray-200",children:jsxRuntimeExports.jsxs(TabsList,{className:"grid w-full grid-cols-2 max-w-md",children:[jsxRuntimeExports.jsx(TabsTrigger,{value:"logos",icon:Image$1,badge:s.logoPrimary||s.logoSecondary?"✓":"",children:"Logos"}),jsxRuntimeExports.jsx(TabsTrigger,{value:"colors",icon:Palette,badge:COLOR_CATEGORIES.length,children:"Colores"})]})}),jsxRuntimeExports.jsx(TabsContent,{value:"logos",className:"p-8",children:jsxRuntimeExports.jsxs("div",{className:"space-y-8",children:[jsxRuntimeExports.jsxs("div",{className:"text-center mb-8",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:"Configuración de Logos"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600",children:"Carga los logos de tu empresa para personalizar la aplicación"}),!$&&jsxRuntimeExports.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg inline-block",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center text-blue-800",children:[jsxRuntimeExports.jsx(Brain,{className:"w-4 h-4 mr-2"}),jsxRuntimeExports.jsx("span",{className:"text-sm",children:"Carga al menos un logo para generar colores automáticamente con IA"})]})})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 max-w-4xl mx-auto",children:[jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1},className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:[jsxRuntimeExports.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[jsxRuntimeExports.jsx(Image$1,{className:"w-5 h-5 mr-2",style:{color:"var(--color-primary-admin)"}}),"Logo Principal"]}),jsxRuntimeExports.jsx(ImageUploadUI,{id:"logoPrimary",label:"",value:s.logoPrimary||"",onChange:e=>L("logoPrimary",e),maxSizeKB:200,previewSize:"lg",acceptedFormats:["image/png","image/jpeg","image/svg+xml"],className:"w-full"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Recomendado: PNG o SVG, máximo 200KB"})]}),jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.2},className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:[jsxRuntimeExports.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[jsxRuntimeExports.jsx(Image$1,{className:"w-5 h-5 mr-2",style:{color:"var(--color-primary-admin)"}}),"Logo Secundario"]}),jsxRuntimeExports.jsx(ImageUploadUI,{id:"logoSecondary",label:"",value:s.logoSecondary||"",onChange:e=>L("logoSecondary",e),maxSizeKB:200,previewSize:"lg",acceptedFormats:["image/png","image/jpeg","image/svg+xml"],className:"w-full"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Opcional: Logo alternativo para diferentes contextos"})]})]})]})}),jsxRuntimeExports.jsx(TabsContent,{value:"colors",className:"p-8",children:jsxRuntimeExports.jsxs("div",{className:"space-y-8",children:[jsxRuntimeExports.jsxs("div",{className:"text-center mb-8",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:"Configuración de Colores"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600",children:"Personaliza todos los colores de la aplicación organizados por categorías"})]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 2xl:grid-cols-3 gap-8",children:COLOR_CATEGORIES.map(e=>jsxRuntimeExports.jsxs(motion.div,{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*COLOR_CATEGORIES.indexOf(e)},children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-3 mb-4 pb-4 border-b border-gray-300",children:[jsxRuntimeExports.jsx("div",{className:"p-2 rounded-lg",style:{backgroundColor:"var(--color-primary-admin)"},children:jsxRuntimeExports.jsx(e.icon,{className:"w-5 h-5 text-white"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"font-semibold text-gray-900",children:e.label}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600",children:e.description})]})]}),jsxRuntimeExports.jsx("div",{className:"space-y-4",children:e.colors.map(e=>jsxRuntimeExports.jsx(ColorPickerUI,{id:e.key,label:e.label,value:s[e.key]||e.defaultValue,onChange:t=>U(e.key,t),defaultValue:e.defaultValue,showPreview:!0,className:"w-full"},e.key))})]},e.id))})]})})]})})]})}function BrandingConfigPage(){return jsxRuntimeExports.jsx(AlertProvider,{children:jsxRuntimeExports.jsx(BrandingConfigPageContent,{})})}const PRODUCTION_MENU_VISIBILITY={dashboard:!0,condominiums:!0,payments:!1,commonAreas:!0,visits:!1,incidents:!1,maintenance:!1,information:!1,settings:!0,residents:!0},ROUTE_CONFIG=[{path:"/dashboard",component:AdministrativeDashboard,requiredResource:Resource.DASHBOARD,requiredAction:Action.VIEW,showInSidebar:!0,sidebarLabel:"Dashboard",icon:LayoutDashboard,order:1,redirectTo:"/dashboard/administrative",children:[{path:"/dashboard/administrative",component:AdministrativeDashboard,requiredResource:SubResource.DASHBOARD_GENERAL,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN,UserRole.ADMIN_COMPANY,UserRole.ADMIN_CONDO],showInSidebar:!0,sidebarLabel:"Administrativo",icon:BarChart3,parentPath:"/dashboard",order:1,isDefault:!0},{path:"/dashboard/services",component:ServicesDashboard,requiredResource:SubResource.DASHBOARD_GENERAL,requiredAction:Action.VIEW,requiredRoles:[UserRole.SECURITY,UserRole.MAINTENANCE],showInSidebar:!0,sidebarLabel:"Servicios",icon:Shield,parentPath:"/dashboard",order:2},{path:"/dashboard/residents",component:ResidentsDashboard,requiredResource:SubResource.DASHBOARD_GENERAL,requiredAction:Action.VIEW,requiredRoles:[UserRole.RESIDENT,UserRole.TENANT],showInSidebar:!0,sidebarLabel:"Vecinos",icon:Users,parentPath:"/dashboard",order:3}]},{path:"/condominiums",component:ManagementCompanyAdvanced,requiredResource:Resource.CONDOMINIUMS,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN,UserRole.ADMIN_COMPANY,UserRole.ADMIN_CONDO],showInSidebar:!0,sidebarLabel:"Condominios",icon:Building2,order:2,redirectTo:"/condominiums/list",children:[{path:"/condominiums/list",component:ManagementCompanyAdvanced,requiredResource:SubResource.CONDOMINIUMS_LIST,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN,UserRole.ADMIN_COMPANY,UserRole.ADMIN_CONDO],showInSidebar:!0,sidebarLabel:"Listado",icon:List,parentPath:"/condominiums",order:1,isDefault:!0},{path:"/condominiums/data-bulk",component:DataBulkUpload,requiredResource:SubResource.CONDOMINIUMS_DATA_BULK,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN,UserRole.ADMIN_COMPANY,UserRole.ADMIN_CONDO],showInSidebar:!0,sidebarLabel:"Carga Masiva",icon:Upload,parentPath:"/condominiums",order:2},{path:"/condominiums/buildings",component:BuildingListAdvanced,requiredResource:SubResource.CONDOMINIUMS_LIST,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN,UserRole.ADMIN_COMPANY],showInSidebar:!1,sidebarLabel:"Edificios",icon:Building2,parentPath:"/condominiums",order:3},{path:"/condominiums/buildings/:companyId",component:BuildingListAdvanced,requiredResource:SubResource.CONDOMINIUMS_LIST,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN,UserRole.ADMIN_COMPANY],exact:!0},{path:"/condominiums/buildings/:companyId/:condoId",component:BuildingListAdvanced,requiredResource:SubResource.CONDOMINIUMS_LIST,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN,UserRole.ADMIN_COMPANY],exact:!0},{path:"/condominiums/departments",component:DepartmentListAdvanced,requiredResource:SubResource.CONDOMINIUMS_DEPARTMENTS,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN,UserRole.ADMIN_COMPANY,UserRole.ADMIN_CONDO],showInSidebar:!0,sidebarLabel:"Departamentos",icon:Home,parentPath:"/condominiums",order:4},{path:"/condominiums/departments/:companyId",component:DepartmentListAdvanced,requiredResource:SubResource.CONDOMINIUMS_DEPARTMENTS,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN,UserRole.ADMIN_COMPANY],exact:!0},{path:"/condominiums/departments/:companyId/:condoId",component:DepartmentListAdvanced,requiredResource:SubResource.CONDOMINIUMS_DEPARTMENTS,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN,UserRole.ADMIN_COMPANY],exact:!0},{path:"/condominiums/departments/:companyId/:condoId/:buildingId",component:DepartmentListAdvanced,requiredResource:SubResource.CONDOMINIUMS_DEPARTMENTS,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN,UserRole.ADMIN_COMPANY],exact:!0},{path:"/condominiums/common-areas",component:CommonAreaListAdvanced,requiredResource:SubResource.CONDOMINIUMS_COMMON_AREAS,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN,UserRole.ADMIN_COMPANY,UserRole.ADMIN_CONDO],showInSidebar:!0,sidebarLabel:"Áreas Comunes",icon:MapPin,parentPath:"/condominiums",order:5}]},{path:"/payments",component:MonthlyFeeList,requiredResource:Resource.PAYMENTS,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN,UserRole.ADMIN_COMPANY,UserRole.ADMIN_CONDO,UserRole.RESIDENT,UserRole.TENANT],showInSidebar:!0,sidebarLabel:"Pagos",icon:CreditCard,order:3,redirectTo:"/payments/monthly",children:[{path:"/payments/monthly",component:MonthlyFeeList,requiredResource:SubResource.PAYMENTS_MONTHLY,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN,UserRole.ADMIN_COMPANY,UserRole.ADMIN_CONDO,UserRole.RESIDENT,UserRole.TENANT],showInSidebar:!0,sidebarLabel:"Cuotas Mensuales",icon:DollarSign,parentPath:"/payments",order:1,isDefault:!0},{path:"/payments/list",component:PaymentList,requiredResource:SubResource.PAYMENTS_LIST,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN,UserRole.ADMIN_COMPANY,UserRole.ADMIN_CONDO,UserRole.RESIDENT,UserRole.TENANT],showInSidebar:!0,sidebarLabel:"Registro de Pagos",icon:List,parentPath:"/payments",order:2},{path:"/payments/overdue",component:DelinquencyList,requiredResource:SubResource.PAYMENTS_OVERDUE,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN,UserRole.ADMIN_COMPANY,UserRole.ADMIN_CONDO],showInSidebar:!0,sidebarLabel:"Morosos",icon:Clock,parentPath:"/payments",order:3}]},{path:"/common-areas",component:EventBookings,requiredResource:Resource.COMMON_AREAS,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN,UserRole.ADMIN_COMPANY,UserRole.ADMIN_CONDO,UserRole.RESIDENT,UserRole.TENANT],showInSidebar:!0,sidebarLabel:"Áreas Comunes",icon:MapPin,order:4,redirectTo:"/common-areas/bookings",children:[{path:"/common-areas/bookings",component:EventBookings,requiredResource:SubResource.COMMON_AREAS_BOOKINGS,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN,UserRole.ADMIN_COMPANY,UserRole.ADMIN_CONDO,UserRole.RESIDENT,UserRole.TENANT],showInSidebar:!0,sidebarLabel:"Reservas",icon:BookOpen,parentPath:"/common-areas",order:1,isDefault:!0},{path:"/common-areas/schedules",component:EventSchedules,requiredResource:SubResource.COMMON_AREAS_SCHEDULES,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN,UserRole.ADMIN_COMPANY,UserRole.ADMIN_CONDO,UserRole.RESIDENT,UserRole.TENANT],showInSidebar:!0,sidebarLabel:"Horarios",icon:CalendarDays,parentPath:"/common-areas",order:2}]},{path:"/visits",component:VisitRegistry,requiredResource:Resource.VISITS,requiredAction:Action.VIEW,showInSidebar:!0,sidebarLabel:"Visitas",icon:Users,order:5,redirectTo:"/visits/registry",children:[{path:"/visits/registry",component:VisitRegistry,requiredResource:SubResource.VISITS_REGISTRY,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN,UserRole.ADMIN_COMPANY,UserRole.ADMIN_CONDO,UserRole.SECURITY],showInSidebar:!0,sidebarLabel:"Registro",icon:UserPlus,parentPath:"/visits",order:1,isDefault:!0}]},{path:"/incidents",component:IncidentReports,requiredResource:Resource.INCIDENTS,requiredAction:Action.VIEW,showInSidebar:!0,sidebarLabel:"Incidentes",icon:AlertTriangle,order:6,redirectTo:"/incidents/reports",children:[{path:"/incidents/reports",component:IncidentReports,requiredResource:SubResource.INCIDENTS_REPORTS,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN,UserRole.ADMIN_COMPANY,UserRole.ADMIN_CONDO,UserRole.SECURITY,UserRole.MAINTENANCE,UserRole.RESIDENT,UserRole.TENANT],showInSidebar:!0,sidebarLabel:"Reportes",icon:Shield,parentPath:"/incidents",order:1,isDefault:!0},{path:"/incidents/log",component:IncidentLog,requiredResource:SubResource.INCIDENTS_LOG,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN,UserRole.ADMIN_COMPANY,UserRole.ADMIN_CONDO,UserRole.SECURITY,UserRole.MAINTENANCE,UserRole.RESIDENT,UserRole.TENANT],showInSidebar:!0,sidebarLabel:"Bitácora",icon:Clipboard,parentPath:"/incidents",order:2},{path:"/incidents/types",component:IncidentTypes,requiredResource:SubResource.INCIDENTS_TYPES,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN,UserRole.ADMIN_COMPANY,UserRole.ADMIN_CONDO],showInSidebar:!0,sidebarLabel:"Tipos",icon:Bug,parentPath:"/incidents",order:3}]},{path:"/maintenance",component:PreventiveMaintenance,requiredResource:Resource.MAINTENANCE,requiredAction:Action.VIEW,showInSidebar:!0,sidebarLabel:"Mantenimiento",icon:Wrench,order:7,redirectTo:"/maintenance/preventive",children:[{path:"/maintenance/preventive",component:PreventiveMaintenance,requiredResource:SubResource.MAINTENANCE_PREVENTIVE,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN,UserRole.ADMIN_COMPANY,UserRole.ADMIN_CONDO,UserRole.MAINTENANCE,UserRole.RESIDENT,UserRole.TENANT],showInSidebar:!0,sidebarLabel:"Preventivo",icon:Settings,parentPath:"/maintenance",order:1,isDefault:!0},{path:"/maintenance/corrective",component:CorrectiveMaintenance,requiredResource:SubResource.MAINTENANCE_CORRECTIVE,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN,UserRole.ADMIN_COMPANY,UserRole.ADMIN_CONDO,UserRole.MAINTENANCE,UserRole.RESIDENT,UserRole.TENANT],showInSidebar:!0,sidebarLabel:"Correctivo",icon:Hammer,parentPath:"/maintenance",order:2}]},{path:"/information",component:InformationPage,requiredResource:Resource.INFORMATION,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN,UserRole.ADMIN_COMPANY,UserRole.ADMIN_CONDO,UserRole.SECURITY,UserRole.MAINTENANCE,UserRole.RESIDENT,UserRole.TENANT],showInSidebar:!0,sidebarLabel:"Información",icon:FileText,order:8,children:[{path:"/information/documents",component:InformationPage,requiredResource:SubResource.INFORMATION_DOCUMENTS,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN,UserRole.ADMIN_COMPANY,UserRole.ADMIN_CONDO,UserRole.SECURITY,UserRole.MAINTENANCE,UserRole.RESIDENT,UserRole.TENANT],showInSidebar:!1,sidebarLabel:"Documentos",icon:Info,parentPath:"/information",order:1,isDefault:!0}]},{path:"/settings",component:SystemUserList,requiredResource:Resource.SETTINGS,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN,UserRole.ADMIN_COMPANY,UserRole.ADMIN_CONDO],showInSidebar:!0,sidebarLabel:"Configuración",icon:Settings,order:9,redirectTo:"/settings/users",children:[{path:"/settings/users",component:SystemUserList,requiredResource:SubResource.SETTINGS_USERS,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN,UserRole.ADMIN_COMPANY,UserRole.ADMIN_CONDO],showInSidebar:!0,sidebarLabel:"Usuarios",icon:UserCog,parentPath:"/settings",order:1,isDefault:!0},{path:"/settings/system-parameters",component:SystemParametersPage,requiredResource:SubResource.SETTINGS_SYSTEM_PARAMETERS,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN,UserRole.ADMIN_COMPANY,UserRole.ADMIN_CONDO],showInSidebar:!1,sidebarLabel:"Parámetros del Sistema",icon:Cog,parentPath:"/settings",order:2},{path:"/settings/branding",component:BrandingConfigPage,requiredResource:SubResource.SETTINGS_SYSTEM_PARAMETERS,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN],showInSidebar:!1,sidebarLabel:"Colores Corporativos",icon:Palette,parentPath:"/settings",order:3}]},{path:"/residents",component:SystemUserList,requiredResource:Resource.RESIDENTS,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN,UserRole.ADMIN_COMPANY,UserRole.ADMIN_CONDO,UserRole.SECURITY],showInSidebar:!0,sidebarLabel:"Residentes",icon:UserCheck,order:10,redirectTo:"/residents/management",children:[{path:"/residents/management",component:SystemUserList,requiredResource:SubResource.RESIDENTS_MANAGEMENT,requiredAction:Action.VIEW,requiredRoles:[UserRole.SUPER_ADMIN,UserRole.ADMIN_COMPANY,UserRole.ADMIN_CONDO,UserRole.SECURITY],showInSidebar:!0,sidebarLabel:"Gestión",icon:Users,parentPath:"/residents",order:1,isDefault:!0}]}],getFlatRoutes=()=>{const e=[],t=a=>{a.forEach(a=>{e.push(a),a.children&&t(a.children)})};return t(ROUTE_CONFIG),e},getSidebarRoutes=e=>{const t=a=>a.filter(t=>{if(!t.showInSidebar)return!1;return!!checkProductionVisibility(t.path)&&!(t.requiredRoles&&t.requiredRoles.length>0&&!t.requiredRoles.includes(e))}).map(e=>__spreadProps(__spreadValues({},e),{children:e.children?t(e.children):void 0})).sort((e,t)=>(e.order||0)-(t.order||0));return t(ROUTE_CONFIG)},checkProductionVisibility=e=>e.startsWith("/dashboard")?PRODUCTION_MENU_VISIBILITY.dashboard:e.startsWith("/condominiums")?PRODUCTION_MENU_VISIBILITY.condominiums:e.startsWith("/payments")?PRODUCTION_MENU_VISIBILITY.payments:e.startsWith("/common-areas")?PRODUCTION_MENU_VISIBILITY.commonAreas:e.startsWith("/visits")?PRODUCTION_MENU_VISIBILITY.visits:e.startsWith("/incidents")?PRODUCTION_MENU_VISIBILITY.incidents:e.startsWith("/maintenance")?PRODUCTION_MENU_VISIBILITY.maintenance:e.startsWith("/information")?PRODUCTION_MENU_VISIBILITY.information:e.startsWith("/settings")?PRODUCTION_MENU_VISIBILITY.settings:!e.startsWith("/residents")||PRODUCTION_MENU_VISIBILITY.residents,convertRouteConfigToMenuItem=e=>{var t;return{icon:e.icon||(()=>null),label:e.sidebarLabel||e.path,path:e.path,subItems:null==(t=e.children)?void 0:t.map(e=>({label:e.sidebarLabel||e.path,path:e.path,icon:e.icon}))}},getFilteredMenuItems=e=>e.filter(e=>e.showInSidebar).map(convertRouteConfigToMenuItem).sort((t,a)=>{const r=e.find(e=>e.path===t.path),s=e.find(e=>e.path===a.path);return((null==r?void 0:r.order)||0)-((null==s?void 0:s.order)||0)}),canUserAccessMenu=(e,t)=>!(e.requiredRoles&&e.requiredRoles.length>0)||e.requiredRoles.includes(t),filterSubMenus=(e,t,a)=>{if(!e.subItems)return e;const r=e.subItems.filter(e=>{const r=t.find(t=>t.path===e.path);return!r||canUserAccessMenu(r,a)});return __spreadProps(__spreadValues({},e),{subItems:r.length>0?r:void 0})};function Sidebar({isOpen:e,isCollapsed:t=!1,isMobile:a=!1,closeSidebar:r}){const[s,n]=reactExports.useState("/dashboard"),i=useLocation(),o=useNavigate(),{user:l}=useAuthorization(),c=reactExports.useMemo(()=>{if(!l)return[];const e=getSidebarRoutes(l.role),t=getFlatRoutes();return getFilteredMenuItems(e).map(e=>filterSubMenus(e,t,l.role))},[l]);reactExports.useEffect(()=>{const e=i.pathname,t=c.find(t=>{var a;return e.startsWith(t.path)||(null==(a=t.subItems)?void 0:a.some(t=>e.startsWith(t.path)))});t&&n(t.path)},[i.pathname,c]);const d=(e,t)=>{t.stopPropagation(),t.preventDefault();const s=e.startsWith("/")?e:`/${e}`;o(s),a&&r&&setTimeout(()=>{r()},150)},u=e=>i.pathname.startsWith(e);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[a&&e&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/50 z-30",onClick:e=>{e.stopPropagation(),r&&r()},"aria-hidden":"true"}),jsxRuntimeExports.jsx(motion.aside,{initial:{width:e?t?70:250:0},animate:{width:e?t?70:250:0},className:"shadow-lg border-r flex-shrink-0 overflow-hidden "+(a&&e?"fixed top-16 bottom-0 left-0 z-40":"relative z-20"),style:{backgroundColor:"var(--color-primary-mint)",borderRight:"1px solid var(--color-primary-admin)"},children:jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0},animate:{opacity:1},className:"flex flex-col h-full overflow-y-auto py-4",children:c.map(e=>{const i=u(e.path);return jsxRuntimeExports.jsxs("div",{className:"space-y-1",children:[jsxRuntimeExports.jsxs("button",{onClick:t=>((e,t,s)=>{s.stopPropagation(),s.preventDefault(),t?n(t=>t===e?"":e):(o(e),a&&r&&setTimeout(()=>{r()},150))})(e.path,!!e.subItems,t),className:"w-full flex items-center px-4 py-3 text-sm font-medium transition-all duration-200 border-l-4 group sidebar-item "+(i?"sidebar-item-active":""),style:{backgroundColor:i?"var(--color-primary-admin)":"transparent",color:i?"var(--color-text-inverse)":"var(--color-primary-admin)",borderLeftColor:i?"var(--color-primary-admin)":"transparent",boxShadow:i?"0 2px 4px rgba(0,0,0,0.1)":"none"},children:[jsxRuntimeExports.jsx(e.icon,{className:"h-5 w-5 flex-shrink-0 transition-colors duration-200 sidebar-icon "+(t?"mr-0":"mr-3"),style:{color:i?"var(--color-text-inverse)":"var(--color-primary-admin)"}}),!t&&jsxRuntimeExports.jsx("span",{className:"flex-1 text-left truncate",children:e.label}),!t&&e.subItems&&jsxRuntimeExports.jsx(motion.div,{animate:{rotate:s===e.path?180:0},transition:{duration:.2},children:jsxRuntimeExports.jsx(ChevronDown,{className:"h-4 w-4 sidebar-icon",style:{color:i?"var(--color-text-inverse)":"var(--color-primary-admin)"}})})]}),jsxRuntimeExports.jsx(AnimatePresence,{children:e.subItems&&s===e.path&&!t&&jsxRuntimeExports.jsx(motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"ml-4 pl-4 border-l border-gray-200",children:e.subItems.map(e=>jsxRuntimeExports.jsx("button",{onClick:t=>d(e.path,t),className:"block w-full text-left py-2 px-4 rounded-md text-sm transition-all duration-200 border sidebar-subitem "+(u(e.path)?"sidebar-subitem-active":""),style:{backgroundColor:u(e.path)?"var(--color-primary-admin)":"transparent",color:u(e.path)?"var(--color-text-inverse)":"var(--color-primary-admin)",borderColor:u(e.path)?"var(--color-primary-admin)":"transparent",opacity:u(e.path)?1:.8},type:"button",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[e.icon&&jsxRuntimeExports.jsx(e.icon,{className:"h-4 w-4 mr-2 sidebar-subicon",style:{color:u(e.path)?"var(--color-text-inverse)":"var(--color-action-edit)"}}),jsxRuntimeExports.jsx("span",{children:e.label})]})},e.path))})}),jsxRuntimeExports.jsx(AnimatePresence,{children:e.subItems&&s===e.path&&t&&jsxRuntimeExports.jsx(motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"mt-1 ml-3 pl-2",style:{borderLeft:"2px solid var(--color-primary-admin)",opacity:.3},children:e.subItems.map(e=>jsxRuntimeExports.jsxs("button",{onClick:t=>d(e.path,t),className:"flex justify-center w-full py-2 px-1 rounded-r-md text-sm transition-all duration-200 relative",style:{backgroundColor:u(e.path)?"var(--color-primary-admin)":"transparent",color:u(e.path)?"var(--color-text-inverse)":"#6b7280",borderLeft:u(e.path)?"2px solid var(--color-action-edit)":"none"},title:e.label,type:"button",children:[jsxRuntimeExports.jsx("div",{className:"absolute left-0 top-1/2 w-2 h-px",style:{backgroundColor:"var(--color-primary-admin)",opacity:.3}}),e.icon?jsxRuntimeExports.jsx("div",{className:"p-1 rounded-full border flex items-center justify-center transition-all duration-200",style:{width:"20px",height:"20px",backgroundColor:"white",borderColor:u(e.path)?"white":"#e5e7eb"},children:jsxRuntimeExports.jsx(e.icon,{className:"transition-colors duration-200",style:{width:"12px",height:"12px",color:u(e.path)?"var(--color-primary-admin)":"var(--color-action-edit)"}})}):jsxRuntimeExports.jsx("div",{className:"h-2 w-2 rounded-full transition-all duration-200",style:{backgroundColor:u(e.path)?"white":"var(--color-action-edit)",boxShadow:u(e.path)?"0 0 0 2px white":"0 0 0 2px var(--color-action-edit)",opacity:u(e.path)?1:.2}})]},e.path))})})]},e.path)})})})]})}function Layout({user:e,onLogout:t}){const[a,r]=reactExports.useState(!0),[s,n]=reactExports.useState(!1),[i,o]=reactExports.useState(!1),l=!i&&a?s?70:250:0,c={padding:"1.5rem",marginLeft:i?0:l,width:i?"100%":`calc(100% - ${l}px)`,transition:"all 0.2s ease-in-out",position:"absolute",left:0,right:0,top:"64px",bottom:0,backgroundColor:"var(--color-primary-mint)",overflow:"auto",zIndex:10};reactExports.useEffect(()=>{const e=()=>{const e=window.innerWidth<768;o(e),a||r(!e)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[a]);return jsxRuntimeExports.jsxs("div",{style:{backgroundColor:"var(--color-primary-mint)",minHeight:"100vh",display:"flex",flexDirection:"column"},children:[jsxRuntimeExports.jsx("div",{style:{position:"sticky",top:0,zIndex:50},children:jsxRuntimeExports.jsx(Header,{user:e,onMenuClick:()=>{i?r(!a):n(!s)},onLogout:t})}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",flex:1,overflow:"hidden"},children:[jsxRuntimeExports.jsx(Sidebar,{isOpen:a,isCollapsed:s,isMobile:i,closeSidebar:()=>{i&&r(!1)}}),jsxRuntimeExports.jsx(motion.main,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},style:c,children:jsxRuntimeExports.jsx(Outlet,{})})]})]})}const useApi=()=>{const{incrementLoading:e,decrementLoading:t}=useLoading();return reactExports.useEffect(()=>{ApiBaseService.setLoadingManager({incrementLoading:e,decrementLoading:t})},[e,t]),{}},getDefaultDashboardRoute=e=>{switch(e){case UserRole.SUPER_ADMIN:case UserRole.ADMIN_COMPANY:case UserRole.ADMIN_CONDO:return"/dashboard/administrative";case UserRole.SECURITY:case UserRole.MAINTENANCE:return"/dashboard/services";case UserRole.RESIDENT:case UserRole.TENANT:return"/dashboard/residents";default:return"/dashboard/administrative"}},mapProfileTypeToRole$1=e=>{switch(e){case 1:return UserRole.ADMIN_COMPANY;case 2:return UserRole.ADMIN_CONDO;case 3:case 4:case 7:default:return UserRole.RESIDENT;case 5:return UserRole.SECURITY;case 6:return UserRole.TENANT}},getDefaultDashboardRouteByProfileType=e=>{const t=mapProfileTypeToRole$1(e);return getDefaultDashboardRoute(t)};function Login({onLogin:e}){const t=useNavigate(),[a,r]=reactExports.useState(""),[s,n]=reactExports.useState(""),[i,o]=reactExports.useState(!1),[l,c]=reactExports.useState(!1),{login:d,error:u,clearError:m,user:p}=useAuth(),{getLogoSrc:x}=useBranding();useApi();const h=reactExports.useCallback(()=>{c(!l)},[l]),g=reactExports.useCallback(r=>__async(this,null,function*(){r.preventDefault(),m();try{const r={username:a,password:s};if(yield d(r)){e();const a=p,r=(null==a?void 0:a.profileTypeId)?getDefaultDashboardRouteByProfileType(a.profileTypeId):"/dashboard/administrative";t(r)}}catch(n){}}),[a,s,d,e,t,m,p]),y={color:"var(--color-primary-admin)"},v={"--tw-ring-color":"var(--color-primary-admin)"};return jsxRuntimeExports.jsx("div",{className:"min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",style:{background:"linear-gradient(135deg, var(--color-primary-mint) 0%, var(--color-surface-content) 100%)"},children:jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"max-w-md w-full space-y-8",children:jsxRuntimeExports.jsxs(motion.div,{initial:{scale:.95},animate:{scale:1},transition:{delay:.2},className:"bg-white rounded-2xl shadow-xl p-8 space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx(motion.div,{className:"flex justify-center mb-4",initial:{x:-100,opacity:0},animate:{x:0,opacity:1,scale:[.9,1,1.1,1]},transition:{duration:1.2,delay:.3,ease:"easeOut",scale:{times:[0,.5,.8,1],duration:1.2,ease:"easeInOut"}},children:jsxRuntimeExports.jsx("img",{src:x("primary"),alt:"Logo Principal",className:"h-24 w-auto"})}),jsxRuntimeExports.jsx(motion.div,{className:"flex justify-center mb-6",initial:{x:100,opacity:0},animate:{x:0,opacity:1,scale:[.9,1,1.1,1]},transition:{duration:1.2,delay:1,ease:"easeOut",scale:{times:[0,.5,.8,1],duration:1.2,ease:"easeInOut"}},children:jsxRuntimeExports.jsx("img",{src:x("secondary"),alt:"Logo Secundario",className:"h-7 w-auto"})}),jsxRuntimeExports.jsx(motion.p,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.6,delay:1.8},className:"text-sm text-gray-600",children:"Bienvenido a tu portal residencial"})]}),jsxRuntimeExports.jsxs(motion.form,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4},className:"mt-8 space-y-6",onSubmit:g,children:[u&&jsxRuntimeExports.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded-md",children:jsxRuntimeExports.jsx("div",{className:"flex",children:jsxRuntimeExports.jsx("div",{className:"ml-3",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-red-700",children:u})})})}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx(User,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),jsxRuntimeExports.jsx("input",{id:"username",name:"username",type:"text",autoComplete:"username",required:!0,className:"pl-10 w-full px-4 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:border-transparent transition-all duration-200",style:v,placeholder:"Nombre de usuario",value:a,onChange:e=>r(e.target.value)})]}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx(Lock,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),jsxRuntimeExports.jsx("input",{id:"password",name:"password",type:l?"text":"password",autoComplete:"current-password",required:!0,className:"pl-10 w-full px-4 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:border-transparent transition-all duration-200",style:v,placeholder:"Contraseña",value:s,onChange:e=>n(e.target.value)}),jsxRuntimeExports.jsx("button",{type:"button",onClick:h,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 focus:outline-none",children:l?jsxRuntimeExports.jsx(EyeOff,{size:20}):jsxRuntimeExports.jsx(Eye,{size:20})})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("input",{id:"remember-me",name:"remember-me",type:"checkbox",className:"h-4 w-4 border-gray-300 rounded transition-colors duration-200",style:{accentColor:"var(--color-primary-admin)",color:"var(--color-primary-admin)"},checked:i,onChange:e=>o(e.target.checked)}),jsxRuntimeExports.jsx("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-gray-900",children:"Recordar sesión"})]}),jsxRuntimeExports.jsx("div",{className:"text-sm",children:jsxRuntimeExports.jsx("a",{href:"#",className:"font-medium hover:opacity-80 transition-colors duration-200",style:y,children:"¿Olvidaste tu contraseña?"})})]}),jsxRuntimeExports.jsx(ButtonUI,{type:"submit",title:"Ingresar",icon:ArrowRight,iconPosition:"right",size:"l",theme:"primary",className:"w-full",tooltip:"Haz clic para ingresar"})]}),jsxRuntimeExports.jsx(motion.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.5},className:"mt-4 text-center",children:jsxRuntimeExports.jsxs("p",{className:"text-sm text-gray-600",children:["¿No tienes una cuenta?"," ",jsxRuntimeExports.jsx("a",{href:"#",className:"font-medium hover:opacity-80 transition-colors duration-200",style:y,children:"Contacta a tu administrador"})]})})]})})})}function AuthGuard({children:e}){const t=useNavigate(),{isAuthenticated:a,checkAuth:r}=useAuth();return reactExports.useEffect(()=>{r()||t("/login",{replace:!0})},[r,t]),a?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:e}):null}function TestBuildingWrapper(){const{companyId:e,condoId:t}=useParams();return jsxRuntimeExports.jsx(BuildingListAdvanced,{companyId:parseInt(e||"0"),condoId:parseInt(t||"0")})}function TestCondominiumWrapper(){const{companyId:e}=useParams();return jsxRuntimeExports.jsx(CondominiumListAdvanced,{companyId:parseInt(e||"0")})}function BuildingWrapper(){return jsxRuntimeExports.jsx(BuildingListAdvanced,{companyId:0,condoId:0})}function BuildingWithCompanyWrapper(){const{companyId:e}=useParams();return jsxRuntimeExports.jsx(BuildingListAdvanced,{companyId:parseInt(e||"0"),condoId:0})}function BuildingWithCompanyAndCondoWrapper(){const{companyId:e,condoId:t}=useParams();return jsxRuntimeExports.jsx(BuildingListAdvanced,{companyId:parseInt(e||"0"),condoId:parseInt(t||"0")})}function mapProfileTypeToRole(e){switch(e){case 1:return UserRole.ADMIN_COMPANY;case 2:return UserRole.ADMIN_CONDO;case 3:case 4:case 7:default:return UserRole.RESIDENT;case 5:return UserRole.SECURITY;case 6:return UserRole.TENANT}}function DynamicDashboardRedirect(){const{user:e}=useAuth(),t=reactExports.useMemo(()=>(null==e?void 0:e.profileTypeId)?getDefaultDashboardRouteByProfileType(e.profileTypeId):"/dashboard/administrative",[null==e?void 0:e.profileTypeId]);return jsxRuntimeExports.jsx(Navigate,{to:t,replace:!0})}function DashboardWrapper({children:e,allowedProfileTypes:t}){const{user:a,isAuthenticated:r}=useAuth();if(!r)return jsxRuntimeExports.jsx(Navigate,{to:"/login",replace:!0});if(!(null==a?void 0:a.profileTypeId))return jsxRuntimeExports.jsx(Navigate,{to:"/login",replace:!0});if(!t.includes(a.profileTypeId)){const e=getDefaultDashboardRouteByProfileType(a.profileTypeId);return jsxRuntimeExports.jsx(Navigate,{to:e,replace:!0})}return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:e})}const AppContent=()=>{const{isAuthenticated:e,user:t,logout:a,checkAuth:r}=useAuth();reactExports.useEffect(()=>{r()},[r]);const s=reactExports.useMemo(()=>{var e;return t?{id:(null==(e=t.id)?void 0:e.toString())||"",name:`${t.firstName||""} ${t.lastName||""}`.trim(),email:t.username||"",avatar:t.profilePicture||"https://via.placeholder.com/177"}:null},[t]),n=reactExports.useCallback(()=>{},[]),i=reactExports.useCallback(()=>{a()},[a]),o=reactExports.useMemo(()=>e&&t?{id:t.id||0,username:t.username||"",firstName:t.firstName||"",lastName:t.lastName||"",email:t.username||"",role:mapProfileTypeToRole(t.profileTypeId),profileTypeId:t.profileTypeId,condoId:t.condoId,companyId:t.companyId,isActive:!0}:null,[e,t]);return jsxRuntimeExports.jsx(AuthorizationProvider,{user:o,children:jsxRuntimeExports.jsx(BrowserRouter,{children:jsxRuntimeExports.jsx(AnimatePresence,{mode:"wait",children:jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"/login",element:e?jsxRuntimeExports.jsx(DynamicDashboardRedirect,{}):jsxRuntimeExports.jsx(Login,{onLogin:n})}),jsxRuntimeExports.jsxs(Route,{path:"/",element:jsxRuntimeExports.jsx(AuthGuard,{children:jsxRuntimeExports.jsx(Layout,{user:s,onLogout:i})}),children:[jsxRuntimeExports.jsx(Route,{path:"dashboard",element:jsxRuntimeExports.jsx(DynamicDashboardRedirect,{})}),jsxRuntimeExports.jsx(Route,{path:"dashboard/administrative",element:jsxRuntimeExports.jsx(DashboardWrapper,{allowedProfileTypes:[1,2],children:jsxRuntimeExports.jsx(AdministrativeDashboard,{})})}),jsxRuntimeExports.jsx(Route,{path:"dashboard/services",element:jsxRuntimeExports.jsx(DashboardWrapper,{allowedProfileTypes:[3,5],children:jsxRuntimeExports.jsx(ServicesDashboard,{})})}),jsxRuntimeExports.jsx(Route,{path:"dashboard/residents",element:jsxRuntimeExports.jsx(DashboardWrapper,{allowedProfileTypes:[4,6,7],children:jsxRuntimeExports.jsx(ResidentsDashboard,{})})}),jsxRuntimeExports.jsx(Route,{path:"dashboard/general",element:jsxRuntimeExports.jsx(DynamicDashboardRedirect,{})}),jsxRuntimeExports.jsx(Route,{path:"condominiums/list",element:jsxRuntimeExports.jsx(ManagementCompanyAdvanced,{})}),jsxRuntimeExports.jsx(Route,{path:"condominiums/data-bulk",element:jsxRuntimeExports.jsx(DataBulkUpload,{})}),jsxRuntimeExports.jsx(Route,{path:"condominiums/buildings",element:jsxRuntimeExports.jsx(BuildingWrapper,{})}),jsxRuntimeExports.jsx(Route,{path:"condominiums/buildings/:companyId",element:jsxRuntimeExports.jsx(BuildingWithCompanyWrapper,{})}),jsxRuntimeExports.jsx(Route,{path:"condominiums/buildings/:companyId/:condoId",element:jsxRuntimeExports.jsx(BuildingWithCompanyAndCondoWrapper,{})}),jsxRuntimeExports.jsx(Route,{path:"condominiums/departments",element:jsxRuntimeExports.jsx(DepartmentListAdvanced,{})}),jsxRuntimeExports.jsx(Route,{path:"condominiums/departments/:companyId?/:condoId?/:buildingId?",element:jsxRuntimeExports.jsx(DepartmentListAdvanced,{})}),jsxRuntimeExports.jsx(Route,{path:"condominiums/common-areas",element:jsxRuntimeExports.jsx(CommonAreaListAdvanced,{})}),jsxRuntimeExports.jsx(Route,{path:"condominiums/common-areas/:companyId?/:condoId?/:buildingId?",element:jsxRuntimeExports.jsx(CommonAreaListAdvanced,{})}),jsxRuntimeExports.jsx(Route,{path:"test/buildings/:companyId/:condoId",element:jsxRuntimeExports.jsx(TestBuildingWrapper,{})}),jsxRuntimeExports.jsx(Route,{path:"test/condominiums/:companyId",element:jsxRuntimeExports.jsx(TestCondominiumWrapper,{})}),jsxRuntimeExports.jsx(Route,{path:"test/departments",element:jsxRuntimeExports.jsx(DepartmentListAdvanced,{})}),jsxRuntimeExports.jsx(Route,{path:"test/common-areas",element:jsxRuntimeExports.jsx(CommonAreaListAdvanced,{})}),jsxRuntimeExports.jsx(Route,{path:"test/common-areas/:companyId?/:condoId?/:buildingId?",element:jsxRuntimeExports.jsx(CommonAreaListAdvanced,{})}),jsxRuntimeExports.jsx(Route,{path:"payments/monthly",element:jsxRuntimeExports.jsx(MonthlyFeeList,{})}),jsxRuntimeExports.jsx(Route,{path:"payments/list",element:jsxRuntimeExports.jsx(PaymentList,{})}),jsxRuntimeExports.jsx(Route,{path:"payments/:feeId/register",element:jsxRuntimeExports.jsx(PaymentList,{})}),jsxRuntimeExports.jsx(Route,{path:"payments/overdue",element:jsxRuntimeExports.jsx(DelinquencyList,{})}),jsxRuntimeExports.jsx(Route,{path:"common-areas",element:jsxRuntimeExports.jsx(Navigate,{to:"/common-areas/bookings",replace:!0})}),jsxRuntimeExports.jsx(Route,{path:"common-areas/bookings",element:jsxRuntimeExports.jsx(EventBookings,{})}),jsxRuntimeExports.jsx(Route,{path:"common-areas/schedules",element:jsxRuntimeExports.jsx(EventSchedules,{})}),jsxRuntimeExports.jsx(Route,{path:"visits",element:jsxRuntimeExports.jsx(Navigate,{to:"/visits/registry",replace:!0})}),jsxRuntimeExports.jsx(Route,{path:"visits/registry",element:jsxRuntimeExports.jsx(VisitRegistry,{})}),jsxRuntimeExports.jsx(Route,{path:"incidents",element:jsxRuntimeExports.jsx(Navigate,{to:"/incidents/reports",replace:!0})}),jsxRuntimeExports.jsx(Route,{path:"incidents/reports",element:jsxRuntimeExports.jsx(IncidentReports,{})}),jsxRuntimeExports.jsx(Route,{path:"incidents/log",element:jsxRuntimeExports.jsx(IncidentLog,{})}),jsxRuntimeExports.jsx(Route,{path:"incidents/types",element:jsxRuntimeExports.jsx(IncidentTypes,{})}),jsxRuntimeExports.jsx(Route,{path:"maintenance",element:jsxRuntimeExports.jsx(Navigate,{to:"/maintenance/preventive",replace:!0})}),jsxRuntimeExports.jsx(Route,{path:"maintenance/preventive",element:jsxRuntimeExports.jsx(PreventiveMaintenance,{})}),jsxRuntimeExports.jsx(Route,{path:"maintenance/corrective",element:jsxRuntimeExports.jsx(CorrectiveMaintenance,{})}),jsxRuntimeExports.jsx(Route,{path:"information",element:jsxRuntimeExports.jsx(InformationPage,{})}),jsxRuntimeExports.jsx(Route,{path:"settings/users",element:jsxRuntimeExports.jsx(SystemUserList,{})}),jsxRuntimeExports.jsx(Route,{path:"settings/system-parameters",element:jsxRuntimeExports.jsx(SystemParametersPage,{})}),jsxRuntimeExports.jsx(Route,{path:"settings/branding",element:jsxRuntimeExports.jsx(BrandingConfigPage,{})}),jsxRuntimeExports.jsx(Route,{path:"residents/management",element:jsxRuntimeExports.jsx(SystemUserList,{})}),jsxRuntimeExports.jsx(Route,{path:"",element:jsxRuntimeExports.jsx(DynamicDashboardRedirect,{})})]}),jsxRuntimeExports.jsx(Route,{path:"*",element:jsxRuntimeExports.jsx(DynamicDashboardRedirect,{})})]})})})})};function App(){return jsxRuntimeExports.jsx(LoadingProvider,{children:jsxRuntimeExports.jsx(BrandingProvider,{children:jsxRuntimeExports.jsx(BrandingLoading,{children:jsxRuntimeExports.jsx(AuthProvider,{children:jsxRuntimeExports.jsx(AppContent,{})})})})})}createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(reactExports.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}));export{ApiBaseService as A};
